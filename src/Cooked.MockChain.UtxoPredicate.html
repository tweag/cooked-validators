<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.UtxoPredicate</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Currencies.html"><span class="hs-identifier">Cooked.Currencies</span></a></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Ada</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">adaSymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">adaToken</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.AssocMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- * Predicates over Utxos</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | A 'UtxoPredicate' is a predicate that is used to filter and select utxos</span><span>
</span><span id="line-11"></span><span class="hs-comment">--  in 'utxosSuchThat'. We declare them through a type synonym to create a convenient</span><span>
</span><span id="line-12"></span><span class="hs-comment">--  shallow DSL of predicates.</span><span>
</span><span id="line-13"></span><span class="hs-keyword">type</span><span> </span><span id="UtxoPredicate"><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-var">UtxoPredicate</span></a></span></span><span> </span><span id="local-6989586621679514880"><span class="annot"><a href="#local-6989586621679514880"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679514880"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- * Basic building blocks</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">3</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#.%26%26"><span class="hs-operator hs-type">.&amp;&amp;</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- | Conjunction of 'UtxoPredicate's</span><span>
</span><span id="line-20"></span><span id="local-6989586621679514878"><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#.%26%26"><span class="hs-operator hs-type">(.&amp;&amp;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514878"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514878"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514878"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-21"></span><span id="local-6989586621679514877"><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514877"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id=".%26%26"><span class="annot"><span class="annottext">.&amp;&amp; :: UtxoPredicate a -&gt; UtxoPredicate a -&gt; UtxoPredicate a
</span><a href="Cooked.MockChain.UtxoPredicate.html#.%26%26"><span class="hs-operator hs-var hs-var">.&amp;&amp;</span></a></span></span><span> </span><span id="local-6989586621679514876"><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514876"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679514875"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679514875"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span id="local-6989586621679514874"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514874"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514877"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679514875"><span class="hs-identifier hs-var">md</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514874"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514876"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679514875"><span class="hs-identifier hs-var">md</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514874"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#.%7C%7C"><span class="hs-operator hs-type">.||</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- | Disjunction of 'UtxoPredicate's</span><span>
</span><span id="line-26"></span><span id="local-6989586621679514871"><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#.%7C%7C"><span class="hs-operator hs-type">(.||)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514871"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514871"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514871"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-27"></span><span id="local-6989586621679514870"><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514870"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id=".%7C%7C"><span class="annot"><span class="annottext">.|| :: UtxoPredicate a -&gt; UtxoPredicate a -&gt; UtxoPredicate a
</span><a href="Cooked.MockChain.UtxoPredicate.html#.%7C%7C"><span class="hs-operator hs-var hs-var">.||</span></a></span></span><span> </span><span id="local-6989586621679514869"><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514869"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679514868"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679514868"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span id="local-6989586621679514867"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514867"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514870"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679514868"><span class="hs-identifier hs-var">md</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514867"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679514869"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679514868"><span class="hs-identifier hs-var">md</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514867"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- | Lifts a predicate over values to a 'UtxoPredicate' by ignoring the datum</span><span>
</span><span id="line-30"></span><span id="local-6989586621679514865"><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#valueSat"><span class="hs-identifier hs-type">valueSat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514865"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-31"></span><span id="valueSat"><span class="annot"><span class="annottext">valueSat :: (Value -&gt; Bool) -&gt; UtxoPredicate a
</span><a href="Cooked.MockChain.UtxoPredicate.html#valueSat"><span class="hs-identifier hs-var hs-var">valueSat</span></a></span></span><span> </span><span id="local-6989586621679514863"><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621679514863"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621679514863"><span class="hs-identifier hs-var">predi</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Lifts a predicate over datums to a 'UtxoPredicate' by forcing the datum</span><span>
</span><span id="line-34"></span><span class="hs-comment">--  to be present and satisfy the predicate.</span><span>
</span><span id="line-35"></span><span id="local-6989586621679514862"><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#datumSat"><span class="hs-identifier hs-type">datumSat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679514862"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514862"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-36"></span><span id="datumSat"><span class="annot"><span class="annottext">datumSat :: (a -&gt; Bool) -&gt; UtxoPredicate a
</span><a href="Cooked.MockChain.UtxoPredicate.html#datumSat"><span class="hs-identifier hs-var hs-var">datumSat</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-37"></span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#datumSat"><span class="hs-identifier hs-var">datumSat</span></a></span><span> </span><span id="local-6989586621679514860"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679514860"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679514859"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679514859"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679514860"><span class="hs-identifier hs-var">predi</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679514859"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | Returns true when no datum is present</span><span>
</span><span id="line-40"></span><span id="local-6989586621679514858"><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#noDatum"><span class="hs-identifier hs-type">noDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679514858"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-41"></span><span id="noDatum"><span class="annot"><span class="annottext">noDatum :: UtxoPredicate a
</span><a href="Cooked.MockChain.UtxoPredicate.html#noDatum"><span class="hs-identifier hs-var hs-var">noDatum</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-42"></span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#noDatum"><span class="hs-identifier hs-var">noDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- * Predicatesover Values</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Returns whether or not a given value has a currency symbol present.</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#hasCurrencySymbol"><span class="hs-identifier hs-type">hasCurrencySymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.CurrencySymbol</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-48"></span><span id="hasCurrencySymbol"><span class="annot"><span class="annottext">hasCurrencySymbol :: CurrencySymbol -&gt; Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasCurrencySymbol"><span class="hs-identifier hs-var hs-var">hasCurrencySymbol</span></a></span></span><span> </span><span id="local-6989586621679514855"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679514855"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span id="local-6989586621679514853"><span class="annot"><span class="annottext">Map CurrencySymbol (Map TokenName Integer)
</span><a href="#local-6989586621679514853"><span class="hs-identifier hs-var">vl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
-&gt; Map CurrencySymbol (Map TokenName Integer) -&gt; Bool
forall k v. Eq k =&gt; k -&gt; Map k v -&gt; Bool
</span><span class="hs-identifier hs-var">Map.member</span></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679514855"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Map CurrencySymbol (Map TokenName Integer)
</span><a href="#local-6989586621679514853"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | Returns whether or not a given value has an asset class present</span><span>
</span><span id="line-51"></span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#hasAssetClass"><span class="hs-identifier hs-type">hasAssetClass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.AssetClass</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-52"></span><span id="hasAssetClass"><span class="annot"><span class="annottext">hasAssetClass :: AssetClass -&gt; Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasAssetClass"><span class="hs-identifier hs-var hs-var">hasAssetClass</span></a></span></span><span> </span><span id="local-6989586621679514850"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679514850"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span id="local-6989586621679514849"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514849"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; AssetClass -&gt; Integer
</span><span class="hs-identifier hs-var">Pl.assetClassValueOf</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514849"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679514850"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Returns whether or not a given value has multiple asset classes present</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#hasAssetClasses"><span class="hs-identifier hs-type">hasAssetClasses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pl.AssetClass</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-56"></span><span id="hasAssetClasses"><span class="annot"><span class="annottext">hasAssetClasses :: [AssetClass] -&gt; Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasAssetClasses"><span class="hs-identifier hs-var hs-var">hasAssetClasses</span></a></span></span><span> </span><span id="local-6989586621679514845"><span class="annot"><span class="annottext">[AssetClass]
</span><a href="#local-6989586621679514845"><span class="hs-identifier hs-var">acs</span></a></span></span><span> </span><span id="local-6989586621679514844"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514844"><span class="hs-identifier hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AssetClass -&gt; Bool) -&gt; [AssetClass] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetClass -&gt; Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasAssetClass"><span class="hs-operator hs-var">`hasAssetClass`</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514844"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[AssetClass]
</span><a href="#local-6989586621679514845"><span class="hs-identifier hs-var">acs</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Returns whether a value contains a &quot;quick value&quot;. Quick values are tokens</span><span>
</span><span id="line-59"></span><span class="hs-comment">--  belonging to &quot;quick currencies&quot;. Check 'quickValue' for more info.</span><span>
</span><span id="line-60"></span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#hasQuickValue"><span class="hs-identifier hs-type">hasQuickValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-61"></span><span id="hasQuickValue"><span class="annot"><span class="annottext">hasQuickValue :: String -&gt; Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasQuickValue"><span class="hs-identifier hs-var hs-var">hasQuickValue</span></a></span></span><span> </span><span id="local-6989586621679514841"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679514841"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssetClass -&gt; Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasAssetClass"><span class="hs-identifier hs-var">hasAssetClass</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; AssetClass
</span><a href="Cooked.Currencies.html#quickAssetClass"><span class="hs-identifier hs-var">quickAssetClass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679514841"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Returns whther or not a value has no token except for Ada</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#hasOnlyAda"><span class="hs-identifier hs-type">hasOnlyAda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-65"></span><span id="hasOnlyAda"><span class="annot"><span class="annottext">hasOnlyAda :: Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasOnlyAda"><span class="hs-identifier hs-var hs-var">hasOnlyAda</span></a></span></span><span> </span><span id="local-6989586621679514838"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514838"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Value -&gt; [(CurrencySymbol, TokenName, Integer)]
</span><span class="hs-identifier hs-var">Pl.flattenValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679514838"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679514836"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679514836"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679514835"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679514835"><span class="hs-identifier hs-var">tok</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679514836"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; CurrencySymbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><span class="hs-identifier hs-var">adaSymbol</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679514835"><span class="hs-identifier hs-var">tok</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; TokenName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><span class="hs-identifier hs-var">adaToken</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="annottext">[(CurrencySymbol, TokenName, Integer)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-69"></span></pre></body></html>
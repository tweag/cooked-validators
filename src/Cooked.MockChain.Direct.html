<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StrictData #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-name-shadowing #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-matches #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.Direct</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Cardano.Api.html"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Cardano.Api.Shelley.html"><span class="hs-identifier">Cardano.Api.Shelley</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Cardano.Ledger.Shelley.API.html"><span class="hs-identifier">Cardano.Ledger.Shelley.API</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CardanoLedger</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Cardano.Node.Emulator.Params.html"><span class="hs-identifier">Cardano.Node.Emulator.Params</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Cardano.Node.Emulator.Validation.html"><span class="hs-identifier">Cardano.Node.Emulator.Validation</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Control.Applicative.html"><span class="hs-identifier">Control.Applicative</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Control.Arrow.html"><span class="hs-identifier">Control.Arrow</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Control.Monad.Except.html"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Control.Monad.Identity.html"><span class="hs-identifier">Control.Monad.Identity</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Control.Monad.Reader.html"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Control.Monad.State.Strict.html"><span class="hs-identifier">Control.Monad.State.Strict</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html"><span class="hs-identifier">Cooked.InitialDistribution</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Balancing.html"><span class="hs-identifier">Cooked.MockChain.Balancing</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html"><span class="hs-identifier">Cooked.MockChain.BlockChain</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html"><span class="hs-identifier">Cooked.MockChain.UtxoState</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Output.html"><span class="hs-identifier">Cooked.Output</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html"><span class="hs-identifier">Cooked.Skeleton</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Bifunctor.html"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Bifunctor.html#bimap"><span class="hs-identifier">bimap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Default.html"><span class="hs-identifier">Data.Default</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Either.Combinators.html"><span class="hs-identifier">Data.Either.Combinators</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Either.Combinators.html#mapLeft"><span class="hs-identifier">mapLeft</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Foldable.html#foldl%27"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Maybe.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.Blockchain.html"><span class="hs-identifier">Ledger.Blockchain</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../Ledger.html"><span class="hs-identifier">Ledger</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.Index.html"><span class="hs-identifier">Ledger.Index</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../Ledger.html"><span class="hs-identifier">Ledger</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Ledger.Orphans.html"><span class="hs-identifier">Ledger.Orphans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.Slot.html"><span class="hs-identifier">Ledger.Slot</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../Ledger.html"><span class="hs-identifier">Ledger</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.Tx.html"><span class="hs-identifier">Ledger.Tx</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../Ledger.html"><span class="hs-identifier">Ledger</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.Tx.CardanoAPI.html"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../Ledger.html"><span class="hs-identifier">Ledger</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Optics.Core.html"><span class="hs-identifier">Optics.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Optics.Getter.html#view"><span class="hs-identifier">view</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Plutus.Script.Utils.Scripts.html"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Plutus.Script.Utils.V2.Scripts.html"><span class="hs-identifier">Plutus.Script.Utils.V2.Scripts</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Plutus.V2.Ledger.Api.html"><span class="hs-identifier">Plutus.V2.Ledger.Api</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PV2</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Plutus.V2.Ledger.Api.html"><span class="hs-identifier">Plutus.V2.Ledger.Api</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- * Direct Emulation</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- $mockchaindocstr</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- The MockChainT monad provides a direct emulator; that is, it gives us a</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- simple way to call validator scripts directly, without the need for all the</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- complexity the 'Contract' monad introduces.</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Running a 'MockChain' produces a 'UtxoState', a simplified view on</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- 'Pl.UtxoIndex', which we also keep in our state.</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#mcstToUtxoState"><span class="hs-identifier hs-type">mcstToUtxoState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span>
</span><span id="line-66"></span><span id="mcstToUtxoState"><span class="annot"><span class="annottext">mcstToUtxoState :: MockChainSt -&gt; UtxoState
</span><a href="Cooked.MockChain.Direct.html#mcstToUtxoState"><span class="hs-identifier hs-var hs-var">mcstToUtxoState</span></a></span></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679643595"><span class="annot"><span class="annottext">UtxoIndex
mcstIndex :: MockChainSt -&gt; UtxoIndex
mcstIndex :: UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#mcstIndex"><span class="hs-identifier hs-var hs-var">mcstIndex</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643593"><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
mcstDatums :: MockChainSt -&gt; Map DatumHash (TxSkelOutDatum, Integer)
mcstDatums :: Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="Cooked.MockChain.Direct.html#mcstDatums"><span class="hs-identifier hs-var hs-var">mcstDatums</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="annottext">Map Address UtxoPayloadSet -&gt; UtxoState
</span><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-var">UtxoState</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">(Map Address UtxoPayloadSet -&gt; UtxoState)
-&gt; (UtxoIndex -&gt; Map Address UtxoPayloadSet)
-&gt; UtxoIndex
-&gt; UtxoState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Address, UtxoPayloadSet)
 -&gt; Map Address UtxoPayloadSet -&gt; Map Address UtxoPayloadSet)
-&gt; Map Address UtxoPayloadSet
-&gt; [(Address, UtxoPayloadSet)]
-&gt; Map Address UtxoPayloadSet
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679643588"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679643588"><span class="hs-identifier hs-var">address</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643587"><span class="annot"><span class="annottext">UtxoPayloadSet
</span><a href="#local-6989586621679643587"><span class="hs-identifier hs-var">utxoValueSet</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679643586"><span class="annot"><span class="annottext">Map Address UtxoPayloadSet
</span><a href="#local-6989586621679643586"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UtxoPayloadSet -&gt; UtxoPayloadSet -&gt; UtxoPayloadSet)
-&gt; Address
-&gt; UtxoPayloadSet
-&gt; Map Address UtxoPayloadSet
-&gt; Map Address UtxoPayloadSet
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#insertWith"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoPayloadSet -&gt; UtxoPayloadSet -&gt; UtxoPayloadSet
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679643588"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoPayloadSet
</span><a href="#local-6989586621679643587"><span class="hs-identifier hs-var">utxoValueSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoPayloadSet
</span><a href="#local-6989586621679643586"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoPayloadSet
forall k a. Map k a
</span><a href="../Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">([(Address, UtxoPayloadSet)] -&gt; Map Address UtxoPayloadSet)
-&gt; (UtxoIndex -&gt; [(Address, UtxoPayloadSet)])
-&gt; UtxoIndex
-&gt; Map Address UtxoPayloadSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO BabbageEra)
 -&gt; Maybe (Address, UtxoPayloadSet))
-&gt; [(TxIn, TxOut CtxUTxO BabbageEra)]
-&gt; [(Address, UtxoPayloadSet)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span>
</span><span id="line-70"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; Maybe (Address, UtxoPayloadSet)
</span><a href="#local-6989586621679643583"><span class="hs-identifier hs-var">extractPayload</span></a></span><span>
</span><span id="line-71"></span><span>          </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; Maybe (Address, UtxoPayloadSet))
-&gt; ((TxIn, TxOut CtxUTxO BabbageEra) -&gt; (TxOutRef, TxOut))
-&gt; (TxIn, TxOut CtxUTxO BabbageEra)
-&gt; Maybe (Address, UtxoPayloadSet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxIn -&gt; TxOutRef)
-&gt; (TxOut CtxUTxO BabbageEra -&gt; TxOut)
-&gt; (TxIn, TxOut CtxUTxO BabbageEra)
-&gt; (TxOutRef, TxOut)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><a href="../Data.Bifunctor.html#bimap"><span class="hs-identifier hs-var">bimap</span></a></span><span>
</span><span id="line-72"></span><span>            </span><span class="annot"><span class="annottext">TxIn -&gt; TxOutRef
</span><a href="../Ledger.Tx.CardanoAPI.Internal.html#fromCardanoTxIn"><span class="hs-identifier hs-var">Ledger.fromCardanoTxIn</span></a></span><span>
</span><span id="line-73"></span><span>            </span><span class="annot"><span class="annottext">TxOut CtxUTxO BabbageEra -&gt; TxOut
forall era. TxOut CtxUTxO era -&gt; TxOut
</span><a href="../Ledger.Tx.CardanoAPI.Internal.html#fromCardanoTxOutToPV2TxInfoTxOut%27"><span class="hs-identifier hs-var">Ledger.fromCardanoTxOutToPV2TxInfoTxOut'</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">([(TxIn, TxOut CtxUTxO BabbageEra)] -&gt; [(Address, UtxoPayloadSet)])
-&gt; (UtxoIndex -&gt; [(TxIn, TxOut CtxUTxO BabbageEra)])
-&gt; UtxoIndex
-&gt; [(Address, UtxoPayloadSet)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO BabbageEra)
-&gt; [(TxIn, TxOut CtxUTxO BabbageEra)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO BabbageEra)
 -&gt; [(TxIn, TxOut CtxUTxO BabbageEra)])
-&gt; (UtxoIndex -&gt; Map TxIn (TxOut CtxUTxO BabbageEra))
-&gt; UtxoIndex
-&gt; [(TxIn, TxOut CtxUTxO BabbageEra)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex -&gt; Map TxIn (TxOut CtxUTxO BabbageEra)
forall era. UTxO era -&gt; Map TxIn (TxOut CtxUTxO era)
</span><a href="../Cardano.Api.Query.html#unUTxO"><span class="hs-identifier hs-var hs-var">C.unUTxO</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">(UtxoIndex -&gt; UtxoState) -&gt; UtxoIndex -&gt; UtxoState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643595"><span class="hs-identifier hs-var">mcstIndex</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="#local-6989586621679643583"><span class="hs-identifier hs-type">extractPayload</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Plutus.V1.Ledger.Tx.html#TxOutRef"><span class="hs-identifier hs-type">Pl.TxOutRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../Plutus.V2.Ledger.Tx.html#TxOut"><span class="hs-identifier hs-type">PV2.TxOut</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Plutus.V1.Ledger.Address.html#Address"><span class="hs-identifier hs-type">Pl.Address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoPayloadSet"><span class="hs-identifier hs-type">UtxoPayloadSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679643583"><span class="annot"><span class="annottext">extractPayload :: (TxOutRef, TxOut) -&gt; Maybe (Address, UtxoPayloadSet)
</span><a href="#local-6989586621679643583"><span class="hs-identifier hs-var hs-var">extractPayload</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679643578"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679643578"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643577"><span class="annot"><span class="annottext">out :: TxOut
</span><a href="#local-6989586621679643577"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="../Plutus.V2.Ledger.Tx.html#TxOut"><span class="hs-identifier hs-type">PV2.TxOut</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679643575"><span class="annot"><span class="annottext">Address
txOutAddress :: TxOut -&gt; Address
txOutAddress :: Address
</span><a href="../Plutus.V2.Ledger.Tx.html#txOutAddress"><span class="hs-identifier hs-var hs-var">PV2.txOutAddress</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643573"><span class="annot"><span class="annottext">Value
txOutValue :: TxOut -&gt; Value
txOutValue :: Value
</span><a href="../Plutus.V2.Ledger.Tx.html#txOutValue"><span class="hs-identifier hs-var hs-var">PV2.txOutValue</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643571"><span class="annot"><span class="annottext">OutputDatum
txOutDatum :: TxOut -&gt; OutputDatum
txOutDatum :: OutputDatum
</span><a href="../Plutus.V2.Ledger.Tx.html#txOutDatum"><span class="hs-identifier hs-var hs-var">PV2.txOutDatum</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679643569"><span class="annot"><span class="annottext">mRefScript :: Maybe ScriptHash
</span><a href="#local-6989586621679643569"><span class="hs-identifier hs-var hs-var">mRefScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Maybe ScriptHash
forall o.
(IsAbstractOutput o, ToScriptHash (ReferenceScriptType o)) =&gt;
o -&gt; Maybe ScriptHash
</span><a href="Cooked.Output.html#outputReferenceScriptHash"><span class="hs-identifier hs-var">outputReferenceScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679643577"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span id="local-6989586621679643567"><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679643567"><span class="hs-identifier hs-var">txSkelOutDatum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-84"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><a href="#local-6989586621679643571"><span class="hs-identifier hs-var">txOutDatum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>            </span><span class="annot"><span class="annottext">OutputDatum
</span><a href="../Plutus.V2.Ledger.Tx.html#NoOutputDatum"><span class="hs-identifier hs-var">Pl.NoOutputDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; Maybe TxSkelOutDatum
forall a. a -&gt; Maybe a
</span><a href="../GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span>
</span><span id="line-86"></span><span>            </span><span class="annot"><a href="../Plutus.V2.Ledger.Tx.html#OutputDatum"><span class="hs-identifier hs-type">Pl.OutputDatum</span></a></span><span> </span><span id="local-6989586621679643563"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679643563"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxSkelOutDatum, Integer) -&gt; TxSkelOutDatum
forall a b. (a, b) -&gt; a
</span><a href="../Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((TxSkelOutDatum, Integer) -&gt; TxSkelOutDatum)
-&gt; Maybe (TxSkelOutDatum, Integer) -&gt; Maybe TxSkelOutDatum
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Maybe (TxSkelOutDatum, Integer)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../Plutus.Script.Utils.Scripts.html#datumHash"><span class="hs-identifier hs-var">Pl.datumHash</span></a></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679643563"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643593"><span class="hs-identifier hs-var">mcstDatums</span></a></span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><a href="../Plutus.V2.Ledger.Tx.html#OutputDatumHash"><span class="hs-identifier hs-type">Pl.OutputDatumHash</span></a></span><span> </span><span id="local-6989586621679643558"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679643558"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxSkelOutDatum, Integer) -&gt; TxSkelOutDatum
forall a b. (a, b) -&gt; a
</span><a href="../Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((TxSkelOutDatum, Integer) -&gt; TxSkelOutDatum)
-&gt; Maybe (TxSkelOutDatum, Integer) -&gt; Maybe TxSkelOutDatum
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Maybe (TxSkelOutDatum, Integer)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679643558"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643593"><span class="hs-identifier hs-var">mcstDatums</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="annottext">(Address, UtxoPayloadSet) -&gt; Maybe (Address, UtxoPayloadSet)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-89"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679643575"><span class="hs-identifier hs-var">txOutAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>            </span><span class="annot"><span class="annottext">[UtxoPayload] -&gt; UtxoPayloadSet
</span><a href="Cooked.MockChain.UtxoState.html#UtxoPayloadSet"><span class="hs-identifier hs-var">UtxoPayloadSet</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TxOutRef
-&gt; Value -&gt; TxSkelOutDatum -&gt; Maybe ScriptHash -&gt; UtxoPayload
</span><a href="Cooked.MockChain.UtxoState.html#UtxoPayload"><span class="hs-identifier hs-var">UtxoPayload</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679643578"><span class="hs-identifier hs-var">txOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679643573"><span class="hs-identifier hs-var">txOutValue</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679643567"><span class="hs-identifier hs-var">txSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptHash
</span><a href="#local-6989586621679643569"><span class="hs-identifier hs-var">mRefScript</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Slightly more concrete version of 'UtxoState', used to actually run the</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- simulation.</span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="MockChainSt"><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-var">MockChainSt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MockChainSt"><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-var">MockChainSt</span></a></span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="mcstIndex"><span class="annot"><span class="annottext">MockChainSt -&gt; UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#mcstIndex"><span class="hs-identifier hs-var hs-var">mcstIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Ledger.Index.Internal.html#UtxoIndex"><span class="hs-identifier hs-type">Ledger.UtxoIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- map from datum hash to (datum, count), where count is the number of</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- UTxOs that currently have the datum. This map is used  to display the</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">-- contents of the state to the user, and to recover datums for transaction</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- generation.</span><span>
</span><span id="line-101"></span><span>    </span><span id="mcstDatums"><span class="annot"><span class="annottext">MockChainSt -&gt; Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="Cooked.MockChain.Direct.html#mcstDatums"><span class="hs-identifier hs-var hs-var">mcstDatums</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#DatumHash"><span class="hs-identifier hs-type">Pl.DatumHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>    </span><span id="mcstValidators"><span class="annot"><span class="annottext">MockChainSt -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.MockChain.Direct.html#mcstValidators"><span class="hs-identifier hs-var hs-var">mcstValidators</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#ValidatorHash"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Plutus.Script.Utils.Scripts.html#Versioned"><span class="hs-identifier hs-type">Pl.Versioned</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#Validator"><span class="hs-identifier hs-type">Pl.Validator</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>    </span><span id="mcstCurrentSlot"><span class="annot"><span class="annottext">MockChainSt -&gt; Slot
</span><a href="Cooked.MockChain.Direct.html#mcstCurrentSlot"><span class="hs-identifier hs-var hs-var">mcstCurrentSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Ledger.Slot.html#Slot"><span class="hs-identifier hs-type">Ledger.Slot</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679643548"><span id="local-6989586621679643550"><span id="local-6989586621679643552"><span class="annot"><span class="annottext">Int -&gt; MockChainSt -&gt; ShowS
[MockChainSt] -&gt; ShowS
MockChainSt -&gt; String
(Int -&gt; MockChainSt -&gt; ShowS)
-&gt; (MockChainSt -&gt; String)
-&gt; ([MockChainSt] -&gt; ShowS)
-&gt; Show MockChainSt
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MockChainSt] -&gt; ShowS
$cshowList :: [MockChainSt] -&gt; ShowS
show :: MockChainSt -&gt; String
$cshow :: MockChainSt -&gt; String
showsPrec :: Int -&gt; MockChainSt -&gt; ShowS
$cshowsPrec :: Int -&gt; MockChainSt -&gt; ShowS
</span><a href="../GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679643544"><span class="annot"><a href="../GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span id="local-6989586621679643542"><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643542"><span class="hs-identifier hs-var">index1</span></a></span></span><span> </span><span id="local-6989586621679643541"><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643541"><span class="hs-identifier hs-var">datums1</span></a></span></span><span> </span><span id="local-6989586621679643540"><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
</span><a href="#local-6989586621679643540"><span class="hs-identifier hs-var">validators1</span></a></span></span><span> </span><span id="local-6989586621679643539"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643539"><span class="hs-identifier hs-var">currentSlot1</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679643538"><span class="annot"><span class="annottext">== :: MockChainSt -&gt; MockChainSt -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span id="local-6989586621679643537"><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643537"><span class="hs-identifier hs-var">index2</span></a></span></span><span> </span><span id="local-6989586621679643536"><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643536"><span class="hs-identifier hs-var">datums2</span></a></span></span><span> </span><span id="local-6989586621679643535"><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
</span><a href="#local-6989586621679643535"><span class="hs-identifier hs-var">validators2</span></a></span></span><span> </span><span id="local-6989586621679643534"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643534"><span class="hs-identifier hs-var">currentSlot2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../Data.Foldable.html#and"><span class="hs-identifier hs-var">and</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643542"><span class="hs-identifier hs-var">index1</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex -&gt; UtxoIndex -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643537"><span class="hs-identifier hs-var">index2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>          </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643541"><span class="hs-identifier hs-var">datums1</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Map DatumHash (TxSkelOutDatum, Integer) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643536"><span class="hs-identifier hs-var">datums2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>          </span><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
</span><a href="#local-6989586621679643540"><span class="hs-identifier hs-var">validators1</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
-&gt; Map ValidatorHash (Versioned Validator) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
</span><a href="#local-6989586621679643535"><span class="hs-identifier hs-var">validators2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>          </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643539"><span class="hs-identifier hs-var">currentSlot1</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643534"><span class="hs-identifier hs-var">currentSlot2</span></a></span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../Data.Default.Class.html#Default"><span class="hs-identifier hs-type">Default</span></a></span><span> </span><span class="annot"><a href="../Ledger.Slot.html#Slot"><span class="hs-identifier hs-type">Ledger.Slot</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679643530"><span class="annot"><span class="annottext">def :: Slot
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
</span><a href="../Ledger.Slot.html#Slot"><span class="hs-identifier hs-var">Ledger.Slot</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">newtype</span><span> </span><span id="MockChainEnv"><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-var">MockChainEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MockChainEnv"><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-var">MockChainEnv</span></a></span></span><span> </span><span class="hs-special">{</span><span id="mceParams"><span class="annot"><span class="annottext">MockChainEnv -&gt; Params
</span><a href="Cooked.MockChain.Direct.html#mceParams"><span class="hs-identifier hs-var hs-var">mceParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Cardano.Node.Emulator.Params.html#Params"><span class="hs-identifier hs-type">Emulator.Params</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679643520"><span id="local-6989586621679643522"><span id="local-6989586621679643524"><span class="annot"><span class="annottext">Int -&gt; MockChainEnv -&gt; ShowS
[MockChainEnv] -&gt; ShowS
MockChainEnv -&gt; String
(Int -&gt; MockChainEnv -&gt; ShowS)
-&gt; (MockChainEnv -&gt; String)
-&gt; ([MockChainEnv] -&gt; ShowS)
-&gt; Show MockChainEnv
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MockChainEnv] -&gt; ShowS
$cshowList :: [MockChainEnv] -&gt; ShowS
show :: MockChainEnv -&gt; String
$cshow :: MockChainEnv -&gt; String
showsPrec :: Int -&gt; MockChainEnv -&gt; ShowS
$cshowsPrec :: Int -&gt; MockChainEnv -&gt; ShowS
</span><a href="../GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../Data.Default.Class.html#Default"><span class="hs-identifier hs-type">Default</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-type">MockChainEnv</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621679643518"><span class="annot"><span class="annottext">def :: MockChainEnv
</span><a href="#local-6989586621679643518"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params -&gt; MockChainEnv
</span><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-var">MockChainEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Params
forall a. Default a =&gt; a
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">newtype</span><span> </span><span id="MockChainT"><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-var">MockChainT</span></a></span></span><span> </span><span id="local-6989586621679643861"><span class="annot"><a href="#local-6989586621679643861"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679643860"><span class="annot"><a href="#local-6989586621679643860"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MockChainT"><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-var">MockChainT</span></a></span></span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">{</span><span id="unMockChain"><span class="annot"><span class="annottext">MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="Cooked.MockChain.Direct.html#unMockChain"><span class="hs-identifier hs-var hs-var">unMockChain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Control.Monad.Trans.Reader.html#ReaderT"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-type">MockChainEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Control.Monad.Trans.Except.html#ExceptT"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643861"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679643860"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679643512"><span id="local-6989586621679643514"><span class="annot"><span class="annottext">a -&gt; MockChainT m b -&gt; MockChainT m a
(a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
(forall a b. (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b)
-&gt; (forall a b. a -&gt; MockChainT m b -&gt; MockChainT m a)
-&gt; Functor (MockChainT m)
forall a b. a -&gt; MockChainT m b -&gt; MockChainT m a
forall a b. (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
forall (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; MockChainT m b -&gt; MockChainT m a
forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; MockChainT m b -&gt; MockChainT m a
$c&lt;$ :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
a -&gt; MockChainT m b -&gt; MockChainT m a
fmap :: (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
$cfmap :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
</span><a href="../GHC.Base.html#Functor"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643500"><span id="local-6989586621679643502"><span id="local-6989586621679643504"><span id="local-6989586621679643506"><span id="local-6989586621679643508"><span class="annot"><span class="annottext">Functor (MockChainT m)
a -&gt; MockChainT m a
Functor (MockChainT m)
-&gt; (forall a. a -&gt; MockChainT m a)
-&gt; (forall a b.
    MockChainT m (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m c)
-&gt; (forall a b. MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m b)
-&gt; (forall a b. MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m a)
-&gt; Applicative (MockChainT m)
MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m b
MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m a
MockChainT m (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
(a -&gt; b -&gt; c) -&gt; MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m c
forall a. a -&gt; MockChainT m a
forall a b. MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m a
forall a b. MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m b
forall a b.
MockChainT m (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m c
forall (m :: * -&gt; *). Monad m =&gt; Functor (MockChainT m)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; MockChainT m a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m b
forall (m :: * -&gt; *) a b.
Monad m =&gt;
MockChainT m (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m a
$c&lt;* :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m a
*&gt; :: MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m b
$c*&gt; :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m b
liftA2 :: (a -&gt; b -&gt; c) -&gt; MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m c
$cliftA2 :: forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; MockChainT m a -&gt; MockChainT m b -&gt; MockChainT m c
&lt;*&gt; :: MockChainT m (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
$c&lt;*&gt; :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
MockChainT m (a -&gt; b) -&gt; MockChainT m a -&gt; MockChainT m b
pure :: a -&gt; MockChainT m a
$cpure :: forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; MockChainT m a
$cp1Applicative :: forall (m :: * -&gt; *). Monad m =&gt; Functor (MockChainT m)
</span><a href="../GHC.Base.html#Applicative"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643492"><span id="local-6989586621679643494"><span id="local-6989586621679643496"><span class="annot"><a href="../Control.Monad.State.Class.html#MonadState"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643486"><span id="local-6989586621679643488"><span class="annot"><a href="../Control.Monad.Error.Class.html#MonadError"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643478"><span id="local-6989586621679643480"><span id="local-6989586621679643482"><span class="annot"><a href="../Control.Monad.Reader.Class.html#MonadReader"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-type">MockChainEnv</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">type</span><span> </span><span id="MockChain"><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChain"><span class="hs-identifier hs-var">MockChain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="../Data.Functor.Identity.html#Identity"><span class="hs-identifier hs-type">Identity</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | Custom monad instance made to increase the slot count automatically</span><span>
</span><span id="line-133"></span><span id="local-6989586621679643476"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679643472"><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643476"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643476"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679643469"><span class="annot"><span class="annottext">return :: a -&gt; MockChainT m a
</span><a href="../GHC.Base.html#return"><span class="hs-identifier hs-var hs-var hs-var hs-var">return</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; MockChainT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span id="local-6989586621679643468"><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="#local-6989586621679643468"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679643467"><span class="annot"><span class="annottext">&gt;&gt;= :: MockChainT m a -&gt; (a -&gt; MockChainT m b) -&gt; MockChainT m b
</span><a href="../GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var hs-var hs-var hs-var">&gt;&gt;=</span></a></span></span><span> </span><span id="local-6989586621679643466"><span class="annot"><span class="annottext">a -&gt; MockChainT m b
</span><a href="#local-6989586621679643466"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b
-&gt; MockChainT m b
forall (m :: * -&gt; *) a.
ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
</span><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-var">MockChainT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b
 -&gt; MockChainT m b)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b
-&gt; MockChainT m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="#local-6989586621679643468"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; (a
    -&gt; ReaderT
         MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m b
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b
forall (m :: * -&gt; *) a.
MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="Cooked.MockChain.Direct.html#unMockChain"><span class="hs-identifier hs-var hs-var">unMockChain</span></a></span><span> </span><span class="annot"><span class="annottext">(MockChainT m b
 -&gt; ReaderT
      MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b)
-&gt; (a -&gt; MockChainT m b)
-&gt; a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; MockChainT m b
</span><a href="#local-6989586621679643466"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679643465"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643465"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643465"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679643461"><span class="annot"><span class="annottext">fail :: String -&gt; MockChainT m a
</span><a href="../Control.Monad.Fail.html#fail"><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; MockChainT m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../Control.Monad.Error.Class.html#throwError"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; MockChainT m a)
-&gt; (String -&gt; MockChainError) -&gt; String -&gt; MockChainT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#FailWith"><span class="hs-identifier hs-var">FailWith</span></a></span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../Control.Monad.Trans.Class.html#MonadTrans"><span class="hs-identifier hs-type">MonadTrans</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679643456"><span class="annot"><span class="annottext">lift :: m a -&gt; MockChainT m a
</span><a href="../Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var hs-var hs-var hs-var">lift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
forall (m :: * -&gt; *) a.
ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
</span><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-var">MockChainT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
 -&gt; MockChainT m a)
-&gt; (m a
    -&gt; ReaderT
         MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a)
-&gt; m a
-&gt; MockChainT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MockChainSt (ExceptT MockChainError m) a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT MockChainSt (ExceptT MockChainError m) a
 -&gt; ReaderT
      MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a)
-&gt; (m a -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT MockChainError m a
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MockChainError m a
 -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; (m a -&gt; ExceptT MockChainError m a)
-&gt; m a
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">m a -&gt; ExceptT MockChainError m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="../Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span id="local-6989586621679643454"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679643447"><span id="local-6989586621679643449"><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643454"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../GHC.Base.html#Alternative"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643454"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../GHC.Base.html#Alternative"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643454"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679643445"><span class="annot"><span class="annottext">empty :: MockChainT m a
</span><a href="../GHC.Base.html#empty"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
forall (m :: * -&gt; *) a.
ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
</span><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-var">MockChainT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
 -&gt; MockChainT m a)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><a href="../Control.Monad.Trans.Reader.html#ReaderT"><span class="hs-identifier hs-var">ReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">((MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
 -&gt; ReaderT
      MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a)
-&gt; (MockChainEnv
    -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MockChainSt (ExceptT MockChainError m) a
-&gt; MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall a b. a -&gt; b -&gt; a
</span><a href="../GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT MockChainSt (ExceptT MockChainError m) a
 -&gt; MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
-&gt; MockChainEnv
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; ExceptT MockChainError m (a, MockChainSt))
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><a href="../Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-var">StateT</span></a></span><span> </span><span class="annot"><span class="annottext">((MockChainSt -&gt; ExceptT MockChainError m (a, MockChainSt))
 -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; (MockChainSt -&gt; ExceptT MockChainError m (a, MockChainSt))
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT MockChainError m (a, MockChainSt)
-&gt; MockChainSt -&gt; ExceptT MockChainError m (a, MockChainSt)
forall a b. a -&gt; b -&gt; a
</span><a href="../GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MockChainError m (a, MockChainSt)
 -&gt; MockChainSt -&gt; ExceptT MockChainError m (a, MockChainSt))
-&gt; ExceptT MockChainError m (a, MockChainSt)
-&gt; MockChainSt
-&gt; ExceptT MockChainError m (a, MockChainSt)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either MockChainError (a, MockChainSt))
-&gt; ExceptT MockChainError m (a, MockChainSt)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../Control.Monad.Trans.Except.html#ExceptT"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either MockChainError (a, MockChainSt))
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../GHC.Base.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679643439"><span class="annot"><span class="annottext">&lt;|&gt; :: MockChainT m a -&gt; MockChainT m a -&gt; MockChainT m a
</span><a href="../GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;|&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. m a -&gt; m a -&gt; m a)
-&gt; MockChainT m a -&gt; MockChainT m a -&gt; MockChainT m a
forall (m :: * -&gt; *) x.
Monad m =&gt;
(forall a. m a -&gt; m a -&gt; m a)
-&gt; MockChainT m x -&gt; MockChainT m x -&gt; MockChainT m x
</span><a href="Cooked.MockChain.Direct.html#combineMockChainT"><span class="hs-identifier hs-var">combineMockChainT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. m a -&gt; m a -&gt; m a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">(&lt;|&gt;)</span></a></span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679643826"><span id="local-6989586621679643827"><span class="annot"><a href="Cooked.MockChain.Direct.html#combineMockChainT"><span class="hs-identifier hs-type">combineMockChainT</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643827"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679643828"><span class="annot"><a href="#local-6989586621679643828"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679643827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643828"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679643827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643828"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679643827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643828"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643826"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643826"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643827"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643826"><span class="hs-identifier hs-type">x</span></a></span></span></span><span>
</span><span id="line-153"></span><span id="combineMockChainT"><span class="annot"><span class="annottext">combineMockChainT :: (forall a. m a -&gt; m a -&gt; m a)
-&gt; MockChainT m x -&gt; MockChainT m x -&gt; MockChainT m x
</span><a href="Cooked.MockChain.Direct.html#combineMockChainT"><span class="hs-identifier hs-var hs-var">combineMockChainT</span></a></span></span><span> </span><span id="local-6989586621679643436"><span class="annot"><span class="annottext">forall a. m a -&gt; m a -&gt; m a
</span><a href="#local-6989586621679643436"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679643435"><span class="annot"><span class="annottext">MockChainT m x
</span><a href="#local-6989586621679643435"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679643434"><span class="annot"><span class="annottext">MockChainT m x
</span><a href="#local-6989586621679643434"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
-&gt; MockChainT m x
forall (m :: * -&gt; *) a.
ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
</span><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-var">MockChainT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
 -&gt; MockChainT m x)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
-&gt; MockChainT m x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="annottext">(MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) x)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><a href="../Control.Monad.Trans.Reader.html#ReaderT"><span class="hs-identifier hs-var">ReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">((MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) x)
 -&gt; ReaderT
      MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x)
-&gt; (MockChainEnv
    -&gt; StateT MockChainSt (ExceptT MockChainError m) x)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679643433"><span class="annot"><span class="annottext">MockChainEnv
</span><a href="#local-6989586621679643433"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">(MockChainSt -&gt; ExceptT MockChainError m (x, MockChainSt))
-&gt; StateT MockChainSt (ExceptT MockChainError m) x
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><a href="../Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-var">StateT</span></a></span><span> </span><span class="annot"><span class="annottext">((MockChainSt -&gt; ExceptT MockChainError m (x, MockChainSt))
 -&gt; StateT MockChainSt (ExceptT MockChainError m) x)
-&gt; (MockChainSt -&gt; ExceptT MockChainError m (x, MockChainSt))
-&gt; StateT MockChainSt (ExceptT MockChainError m) x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679643432"><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643432"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679643431"><span class="annot"><span class="annottext">resA :: m (Either MockChainError (x, MockChainSt))
</span><a href="#local-6989586621679643431"><span class="hs-identifier hs-var hs-var">resA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT MockChainError m (x, MockChainSt)
-&gt; m (Either MockChainError (x, MockChainSt))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MockChainError m (x, MockChainSt)
 -&gt; m (Either MockChainError (x, MockChainSt)))
-&gt; ExceptT MockChainError m (x, MockChainSt)
-&gt; m (Either MockChainError (x, MockChainSt))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MockChainSt (ExceptT MockChainError m) x
-&gt; MockChainSt -&gt; ExceptT MockChainError m (x, MockChainSt)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="../Control.Monad.Trans.State.Strict.html#runStateT"><span class="hs-identifier hs-var hs-var">runStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
-&gt; MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) x
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../Control.Monad.Trans.Reader.html#runReaderT"><span class="hs-identifier hs-var hs-var">runReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainT m x
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
forall (m :: * -&gt; *) a.
MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="Cooked.MockChain.Direct.html#unMockChain"><span class="hs-identifier hs-var hs-var">unMockChain</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m x
</span><a href="#local-6989586621679643435"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainEnv
</span><a href="#local-6989586621679643433"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643432"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-157"></span><span>          </span><span id="local-6989586621679643427"><span class="annot"><span class="annottext">resB :: m (Either MockChainError (x, MockChainSt))
</span><a href="#local-6989586621679643427"><span class="hs-identifier hs-var hs-var">resB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExceptT MockChainError m (x, MockChainSt)
-&gt; m (Either MockChainError (x, MockChainSt))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT MockChainError m (x, MockChainSt)
 -&gt; m (Either MockChainError (x, MockChainSt)))
-&gt; ExceptT MockChainError m (x, MockChainSt)
-&gt; m (Either MockChainError (x, MockChainSt))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MockChainSt (ExceptT MockChainError m) x
-&gt; MockChainSt -&gt; ExceptT MockChainError m (x, MockChainSt)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="../Control.Monad.Trans.State.Strict.html#runStateT"><span class="hs-identifier hs-var hs-var">runStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
-&gt; MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) x
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../Control.Monad.Trans.Reader.html#runReaderT"><span class="hs-identifier hs-var hs-var">runReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainT m x
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) x
forall (m :: * -&gt; *) a.
MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="Cooked.MockChain.Direct.html#unMockChain"><span class="hs-identifier hs-var hs-var">unMockChain</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m x
</span><a href="#local-6989586621679643434"><span class="hs-identifier hs-var">mb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainEnv
</span><a href="#local-6989586621679643433"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643432"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-158"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">m (Either MockChainError (x, MockChainSt))
-&gt; ExceptT MockChainError m (x, MockChainSt)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../Control.Monad.Trans.Except.html#ExceptT"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either MockChainError (x, MockChainSt))
 -&gt; ExceptT MockChainError m (x, MockChainSt))
-&gt; m (Either MockChainError (x, MockChainSt))
-&gt; ExceptT MockChainError m (x, MockChainSt)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either MockChainError (x, MockChainSt))
-&gt; m (Either MockChainError (x, MockChainSt))
-&gt; m (Either MockChainError (x, MockChainSt))
forall a. m a -&gt; m a -&gt; m a
</span><a href="#local-6989586621679643436"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either MockChainError (x, MockChainSt))
</span><a href="#local-6989586621679643431"><span class="hs-identifier hs-var">resA</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either MockChainError (x, MockChainSt))
</span><a href="#local-6989586621679643427"><span class="hs-identifier hs-var">resB</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679643423"><span id="local-6989586621679643424"><span id="local-6989586621679643425"><span id="local-6989586621679643426"><span class="annot"><a href="Cooked.MockChain.Direct.html#mapMockChainT"><span class="hs-identifier hs-type">mapMockChainT</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643426"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643425"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679643424"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643423"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643426"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643425"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643424"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643423"><span class="hs-identifier hs-type">b</span></a></span></span></span></span></span><span>
</span><span id="line-164"></span><span id="mapMockChainT"><span class="annot"><span class="annottext">mapMockChainT :: (m (Either MockChainError (a, MockChainSt))
 -&gt; n (Either MockChainError (b, MockChainSt)))
-&gt; MockChainT m a -&gt; MockChainT n b
</span><a href="Cooked.MockChain.Direct.html#mapMockChainT"><span class="hs-identifier hs-var hs-var">mapMockChainT</span></a></span></span><span> </span><span id="local-6989586621679643421"><span class="annot"><span class="annottext">m (Either MockChainError (a, MockChainSt))
-&gt; n (Either MockChainError (b, MockChainSt))
</span><a href="#local-6989586621679643421"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError n)) b
-&gt; MockChainT n b
forall (m :: * -&gt; *) a.
ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainT m a
</span><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-var">MockChainT</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError n)) b
 -&gt; MockChainT n b)
-&gt; (MockChainT m a
    -&gt; ReaderT
         MockChainEnv (StateT MockChainSt (ExceptT MockChainError n)) b)
-&gt; MockChainT m a
-&gt; MockChainT n b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT MockChainSt (ExceptT MockChainError m) a
 -&gt; StateT MockChainSt (ExceptT MockChainError n) b)
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError n)) b
forall (m :: * -&gt; *) a (n :: * -&gt; *) b r.
(m a -&gt; n b) -&gt; ReaderT r m a -&gt; ReaderT r n b
</span><a href="../Control.Monad.Trans.Reader.html#mapReaderT"><span class="hs-identifier hs-var">mapReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ExceptT MockChainError m (a, MockChainSt)
 -&gt; ExceptT MockChainError n (b, MockChainSt))
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
-&gt; StateT MockChainSt (ExceptT MockChainError n) b
forall (m :: * -&gt; *) a s (n :: * -&gt; *) b.
(m (a, s) -&gt; n (b, s)) -&gt; StateT s m a -&gt; StateT s n b
</span><a href="../Control.Monad.Trans.State.Strict.html#mapStateT"><span class="hs-identifier hs-var">mapStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(m (Either MockChainError (a, MockChainSt))
 -&gt; n (Either MockChainError (b, MockChainSt)))
-&gt; ExceptT MockChainError m (a, MockChainSt)
-&gt; ExceptT MockChainError n (b, MockChainSt)
forall (m :: * -&gt; *) e a (n :: * -&gt; *) e' b.
(m (Either e a) -&gt; n (Either e' b))
-&gt; ExceptT e m a -&gt; ExceptT e' n b
</span><a href="../Control.Monad.Trans.Except.html#mapExceptT"><span class="hs-identifier hs-var">mapExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either MockChainError (a, MockChainSt))
-&gt; n (Either MockChainError (b, MockChainSt))
</span><a href="#local-6989586621679643421"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
 -&gt; ReaderT
      MockChainEnv (StateT MockChainSt (ExceptT MockChainError n)) b)
-&gt; (MockChainT m a
    -&gt; ReaderT
         MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a)
-&gt; MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError n)) b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
forall (m :: * -&gt; *) a.
MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="Cooked.MockChain.Direct.html#unMockChain"><span class="hs-identifier hs-var hs-var">unMockChain</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Executes a 'MockChainT' from some initial state and environment; does /not/</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- convert the 'MockChainSt' into a 'UtxoState'.</span><span>
</span><span id="line-168"></span><span id="local-6989586621679643780"><span id="local-6989586621679643781"><span class="annot"><a href="Cooked.MockChain.Direct.html#runMockChainTRaw"><span class="hs-identifier hs-type">runMockChainTRaw</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643781"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-type">MockChainEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="#local-6989586621679643781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-174"></span><span id="runMockChainTRaw"><span class="annot"><span class="annottext">runMockChainTRaw :: MockChainEnv
-&gt; MockChainSt
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, MockChainSt))
</span><a href="Cooked.MockChain.Direct.html#runMockChainTRaw"><span class="hs-identifier hs-var hs-var">runMockChainTRaw</span></a></span></span><span> </span><span id="local-6989586621679643416"><span class="annot"><span class="annottext">MockChainEnv
</span><a href="#local-6989586621679643416"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span id="local-6989586621679643415"><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643415"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><span class="annottext">ExceptT MockChainError m (a, MockChainSt)
-&gt; m (Either MockChainError (a, MockChainSt))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">(ExceptT MockChainError m (a, MockChainSt)
 -&gt; m (Either MockChainError (a, MockChainSt)))
-&gt; (MockChainT m a -&gt; ExceptT MockChainError m (a, MockChainSt))
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, MockChainSt))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT MockChainSt (ExceptT MockChainError m) a
 -&gt; MockChainSt -&gt; ExceptT MockChainError m (a, MockChainSt))
-&gt; MockChainSt
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
-&gt; ExceptT MockChainError m (a, MockChainSt)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MockChainSt (ExceptT MockChainError m) a
-&gt; MockChainSt -&gt; ExceptT MockChainError m (a, MockChainSt)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="../Control.Monad.Trans.State.Strict.html#runStateT"><span class="hs-identifier hs-var hs-var">runStateT</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643415"><span class="hs-identifier hs-var">i0</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">(StateT MockChainSt (ExceptT MockChainError m) a
 -&gt; ExceptT MockChainError m (a, MockChainSt))
-&gt; (MockChainT m a
    -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; MockChainT m a
-&gt; ExceptT MockChainError m (a, MockChainSt)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
 -&gt; MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; MockChainEnv
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
-&gt; MockChainEnv -&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><a href="../Control.Monad.Trans.Reader.html#runReaderT"><span class="hs-identifier hs-var hs-var">runReaderT</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainEnv
</span><a href="#local-6989586621679643416"><span class="hs-identifier hs-var">e0</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">(ReaderT
   MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
 -&gt; StateT MockChainSt (ExceptT MockChainError m) a)
-&gt; (MockChainT m a
    -&gt; ReaderT
         MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a)
-&gt; MockChainT m a
-&gt; StateT MockChainSt (ExceptT MockChainError m) a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
forall (m :: * -&gt; *) a.
MockChainT m a
-&gt; ReaderT
     MockChainEnv (StateT MockChainSt (ExceptT MockChainError m)) a
</span><a href="Cooked.MockChain.Direct.html#unMockChain"><span class="hs-identifier hs-var hs-var">unMockChain</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Executes a 'MockChainT' from an initial state set up with the given</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- initial value distribution. Similar to 'runMockChainT', uses the default</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- environment. Returns a 'UtxoState' instead of a 'MockChainSt'. If you need</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- the later, use 'runMockChainTRaw'</span><span>
</span><span id="line-184"></span><span id="local-6989586621679643776"><span id="local-6989586621679643777"><span class="annot"><a href="Cooked.MockChain.Direct.html#runMockChainTFrom"><span class="hs-identifier hs-type">runMockChainTFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643777"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643777"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643776"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="#local-6989586621679643777"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-189"></span><span id="runMockChainTFrom"><span class="annot"><span class="annottext">runMockChainTFrom :: InitialDistribution
-&gt; MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
</span><a href="Cooked.MockChain.Direct.html#runMockChainTFrom"><span class="hs-identifier hs-var hs-var">runMockChainTFrom</span></a></span></span><span> </span><span id="local-6989586621679643412"><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643412"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="annottext">(Either MockChainError (a, MockChainSt)
 -&gt; Either MockChainError (a, UtxoState))
-&gt; m (Either MockChainError (a, MockChainSt))
-&gt; m (Either MockChainError (a, UtxoState))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((a, MockChainSt) -&gt; (a, UtxoState))
-&gt; Either MockChainError (a, MockChainSt)
-&gt; Either MockChainError (a, UtxoState)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(((a, MockChainSt) -&gt; (a, UtxoState))
 -&gt; Either MockChainError (a, MockChainSt)
 -&gt; Either MockChainError (a, UtxoState))
-&gt; ((a, MockChainSt) -&gt; (a, UtxoState))
-&gt; Either MockChainError (a, MockChainSt)
-&gt; Either MockChainError (a, UtxoState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; UtxoState) -&gt; (a, MockChainSt) -&gt; (a, UtxoState)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><a href="../Control.Arrow.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; UtxoState
</span><a href="Cooked.MockChain.Direct.html#mcstToUtxoState"><span class="hs-identifier hs-var">mcstToUtxoState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Either MockChainError (a, MockChainSt))
 -&gt; m (Either MockChainError (a, UtxoState)))
-&gt; (MockChainT m a -&gt; m (Either MockChainError (a, MockChainSt)))
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, UtxoState))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainEnv
-&gt; MockChainSt
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, MockChainSt))
forall (m :: * -&gt; *) a.
Monad m =&gt;
MockChainEnv
-&gt; MockChainSt
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, MockChainSt))
</span><a href="Cooked.MockChain.Direct.html#runMockChainTRaw"><span class="hs-identifier hs-var">runMockChainTRaw</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainEnv
forall a. Default a =&gt; a
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution -&gt; MockChainSt
</span><a href="Cooked.MockChain.Direct.html#mockChainSt0From"><span class="hs-identifier hs-var">mockChainSt0From</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643412"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Executes a 'MockChainT' from the canonical initial state and environment.</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- The canonical environment uses the default 'SlotConfig' and</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- @Cooked.Wallet.wallet 1@ as the sole wallet signing transactions.</span><span>
</span><span id="line-195"></span><span id="local-6989586621679643768"><span id="local-6989586621679643769"><span class="annot"><a href="Cooked.MockChain.Direct.html#runMockChainT"><span class="hs-identifier hs-type">runMockChainT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643769"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643769"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643768"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679643769"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-196"></span><span id="runMockChainT"><span class="annot"><span class="annottext">runMockChainT :: MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
</span><a href="Cooked.MockChain.Direct.html#runMockChainT"><span class="hs-identifier hs-var hs-var">runMockChainT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialDistribution
-&gt; MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
forall (m :: * -&gt; *) a.
Monad m =&gt;
InitialDistribution
-&gt; MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
</span><a href="Cooked.MockChain.Direct.html#runMockChainTFrom"><span class="hs-identifier hs-var">runMockChainTFrom</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | See 'runMockChainTRaw'</span><span>
</span><span id="line-199"></span><span id="local-6989586621679643408"><span class="annot"><a href="Cooked.MockChain.Direct.html#runMockChainRaw"><span class="hs-identifier hs-type">runMockChainRaw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainEnv"><span class="hs-identifier hs-type">MockChainEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChain"><span class="hs-identifier hs-type">MockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643408"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643408"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-200"></span><span id="runMockChainRaw"><span class="annot"><span class="annottext">runMockChainRaw :: MockChainEnv
-&gt; MockChainSt
-&gt; MockChain a
-&gt; Either MockChainError (a, MockChainSt)
</span><a href="Cooked.MockChain.Direct.html#runMockChainRaw"><span class="hs-identifier hs-var hs-var">runMockChainRaw</span></a></span></span><span> </span><span id="local-6989586621679643406"><span class="annot"><span class="annottext">MockChainEnv
</span><a href="#local-6989586621679643406"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span id="local-6989586621679643405"><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643405"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Either MockChainError (a, MockChainSt))
-&gt; Either MockChainError (a, MockChainSt)
forall a. Identity a -&gt; a
</span><a href="../Data.Functor.Identity.html#runIdentity"><span class="hs-identifier hs-var hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">(Identity (Either MockChainError (a, MockChainSt))
 -&gt; Either MockChainError (a, MockChainSt))
-&gt; (MockChain a
    -&gt; Identity (Either MockChainError (a, MockChainSt)))
-&gt; MockChain a
-&gt; Either MockChainError (a, MockChainSt)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainEnv
-&gt; MockChainSt
-&gt; MockChain a
-&gt; Identity (Either MockChainError (a, MockChainSt))
forall (m :: * -&gt; *) a.
Monad m =&gt;
MockChainEnv
-&gt; MockChainSt
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, MockChainSt))
</span><a href="Cooked.MockChain.Direct.html#runMockChainTRaw"><span class="hs-identifier hs-var">runMockChainTRaw</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainEnv
</span><a href="#local-6989586621679643406"><span class="hs-identifier hs-var">e0</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643405"><span class="hs-identifier hs-var">i0</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | See 'runMockChainTFrom'</span><span>
</span><span id="line-203"></span><span id="local-6989586621679643403"><span class="annot"><a href="Cooked.MockChain.Direct.html#runMockChainFrom"><span class="hs-identifier hs-type">runMockChainFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChain"><span class="hs-identifier hs-type">MockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643403"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643403"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-205"></span><span id="runMockChainFrom"><span class="annot"><span class="annottext">runMockChainFrom :: InitialDistribution
-&gt; MockChain a -&gt; Either MockChainError (a, UtxoState)
</span><a href="Cooked.MockChain.Direct.html#runMockChainFrom"><span class="hs-identifier hs-var hs-var">runMockChainFrom</span></a></span></span><span> </span><span id="local-6989586621679643401"><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643401"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Either MockChainError (a, UtxoState))
-&gt; Either MockChainError (a, UtxoState)
forall a. Identity a -&gt; a
</span><a href="../Data.Functor.Identity.html#runIdentity"><span class="hs-identifier hs-var hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">(Identity (Either MockChainError (a, UtxoState))
 -&gt; Either MockChainError (a, UtxoState))
-&gt; (MockChain a -&gt; Identity (Either MockChainError (a, UtxoState)))
-&gt; MockChain a
-&gt; Either MockChainError (a, UtxoState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
-&gt; MockChain a -&gt; Identity (Either MockChainError (a, UtxoState))
forall (m :: * -&gt; *) a.
Monad m =&gt;
InitialDistribution
-&gt; MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
</span><a href="Cooked.MockChain.Direct.html#runMockChainTFrom"><span class="hs-identifier hs-var">runMockChainTFrom</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643401"><span class="hs-identifier hs-var">i0</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | See 'runMockChainT'</span><span>
</span><span id="line-208"></span><span id="local-6989586621679643400"><span class="annot"><a href="Cooked.MockChain.Direct.html#runMockChain"><span class="hs-identifier hs-type">runMockChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChain"><span class="hs-identifier hs-type">MockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643400"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679643400"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-209"></span><span id="runMockChain"><span class="annot"><span class="annottext">runMockChain :: MockChain a -&gt; Either MockChainError (a, UtxoState)
</span><a href="Cooked.MockChain.Direct.html#runMockChain"><span class="hs-identifier hs-var hs-var">runMockChain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Either MockChainError (a, UtxoState))
-&gt; Either MockChainError (a, UtxoState)
forall a. Identity a -&gt; a
</span><a href="../Data.Functor.Identity.html#runIdentity"><span class="hs-identifier hs-var hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">(Identity (Either MockChainError (a, UtxoState))
 -&gt; Either MockChainError (a, UtxoState))
-&gt; (MockChain a -&gt; Identity (Either MockChainError (a, UtxoState)))
-&gt; MockChain a
-&gt; Either MockChainError (a, UtxoState)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChain a -&gt; Identity (Either MockChainError (a, UtxoState))
forall (m :: * -&gt; *) a.
Monad m =&gt;
MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
</span><a href="Cooked.MockChain.Direct.html#runMockChainT"><span class="hs-identifier hs-var">runMockChainT</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- * Canonical initial values</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#utxoState0"><span class="hs-identifier hs-type">utxoState0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span>
</span><span id="line-214"></span><span id="utxoState0"><span class="annot"><span class="annottext">utxoState0 :: UtxoState
</span><a href="Cooked.MockChain.Direct.html#utxoState0"><span class="hs-identifier hs-var hs-var">utxoState0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; UtxoState
</span><a href="Cooked.MockChain.Direct.html#mcstToUtxoState"><span class="hs-identifier hs-var">mcstToUtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="Cooked.MockChain.Direct.html#mockChainSt0"><span class="hs-identifier hs-var">mockChainSt0</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#mockChainSt0"><span class="hs-identifier hs-type">mockChainSt0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span>
</span><span id="line-217"></span><span id="mockChainSt0"><span class="annot"><span class="annottext">mockChainSt0 :: MockChainSt
</span><a href="Cooked.MockChain.Direct.html#mockChainSt0"><span class="hs-identifier hs-var hs-var">mockChainSt0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UtxoIndex
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; Slot
-&gt; MockChainSt
</span><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-var">MockChainSt</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#utxoIndex0"><span class="hs-identifier hs-var">utxoIndex0</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
forall k a. Map k a
</span><a href="../Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
forall k a. Map k a
</span><a href="../Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
forall a. Default a =&gt; a
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- * Initial `MockChainSt` from an initial distribution</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#mockChainSt0From"><span class="hs-identifier hs-type">mockChainSt0From</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span>
</span><span id="line-222"></span><span id="mockChainSt0From"><span class="annot"><span class="annottext">mockChainSt0From :: InitialDistribution -&gt; MockChainSt
</span><a href="Cooked.MockChain.Direct.html#mockChainSt0From"><span class="hs-identifier hs-var hs-var">mockChainSt0From</span></a></span></span><span> </span><span id="local-6989586621679643395"><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643395"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="annottext">UtxoIndex
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; Slot
-&gt; MockChainSt
</span><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-var">MockChainSt</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution -&gt; UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#utxoIndex0From"><span class="hs-identifier hs-var">utxoIndex0From</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643395"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution -&gt; Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="Cooked.MockChain.Direct.html#datumMap0From"><span class="hs-identifier hs-var">datumMap0From</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643395"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.MockChain.Direct.html#referenceScriptMap0From"><span class="hs-identifier hs-var">referenceScriptMap0From</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679643395"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">Slot
forall a. Default a =&gt; a
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../Data.Default.Class.html#Default"><span class="hs-identifier hs-type">Default</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679643390"><span class="annot"><span class="annottext">def :: MockChainSt
</span><a href="#local-6989586621679643390"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="Cooked.MockChain.Direct.html#mockChainSt0"><span class="hs-identifier hs-var">mockChainSt0</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Reference scripts from initial distributions should be accounted</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- for in the `MockChainSt` which is done using this function.</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#referenceScriptMap0From"><span class="hs-identifier hs-type">referenceScriptMap0From</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#ValidatorHash"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Plutus.Script.Utils.Scripts.html#Versioned"><span class="hs-identifier hs-type">Pl.Versioned</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#Validator"><span class="hs-identifier hs-type">Pl.Validator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="referenceScriptMap0From"><span class="annot"><span class="annottext">referenceScriptMap0From :: InitialDistribution -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.MockChain.Direct.html#referenceScriptMap0From"><span class="hs-identifier hs-var hs-var">referenceScriptMap0From</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span id="local-6989586621679643388"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679643388"><span class="hs-identifier hs-var">initDist</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">-- This builds a map of entries from the reference scripts contained</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-comment">-- in the initial distribution</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">[(ValidatorHash, Versioned Validator)]
-&gt; Map ValidatorHash (Versioned Validator)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(ValidatorHash, Versioned Validator)]
 -&gt; Map ValidatorHash (Versioned Validator))
-&gt; [(ValidatorHash, Versioned Validator)]
-&gt; Map ValidatorHash (Versioned Validator)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Maybe (ValidatorHash, Versioned Validator))
-&gt; [TxSkelOut] -&gt; [(ValidatorHash, Versioned Validator)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; Maybe (ValidatorHash, Versioned Validator)
</span><a href="#local-6989586621679643386"><span class="hs-identifier hs-var">unitMaybeFrom</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679643388"><span class="hs-identifier hs-var">initDist</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-comment">-- This takes a single output and returns a possible map entry</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- when it contains a reference script</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><a href="#local-6989586621679643386"><span class="hs-identifier hs-type">unitMaybeFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#ValidatorHash"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../Plutus.Script.Utils.Scripts.html#Versioned"><span class="hs-identifier hs-type">Pl.Versioned</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#Validator"><span class="hs-identifier hs-type">Pl.Validator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679643386"><span class="annot"><span class="annottext">unitMaybeFrom :: TxSkelOut -&gt; Maybe (ValidatorHash, Versioned Validator)
</span><a href="#local-6989586621679643386"><span class="hs-identifier hs-var hs-var">unitMaybeFrom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679643384"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679643384"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-244"></span><span>      </span><span id="local-6989586621679643383"><span class="annot"><span class="annottext">ReferenceScriptType o
</span><a href="#local-6989586621679643383"><span class="hs-identifier hs-var">refScript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx o (Maybe (ReferenceScriptType o))
-&gt; o -&gt; Maybe (ReferenceScriptType o)
forall k (is :: IxList) s a.
Is k A_Getter =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><a href="../Optics.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx o (Maybe (ReferenceScriptType o))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679643384"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679643381"><span class="annot"><span class="annottext">vScript :: Versioned Script
</span><a href="#local-6989586621679643381"><span class="hs-identifier hs-var">vScript</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../Plutus.Script.Utils.Scripts.html#Versioned"><span class="hs-identifier hs-type">Pl.Versioned</span></a></span><span> </span><span id="local-6989586621679643379"><span class="annot"><span class="annottext">Script
</span><a href="#local-6989586621679643379"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span id="local-6989586621679643378"><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621679643378"><span class="hs-identifier hs-var">version</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReferenceScriptType o -&gt; Versioned Script
forall a. ToScript a =&gt; a -&gt; Versioned Script
</span><a href="Cooked.Output.html#toScript"><span class="hs-identifier hs-var">toScript</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScriptType o
</span><a href="#local-6989586621679643383"><span class="hs-identifier hs-var">refScript</span></a></span><span>
</span><span id="line-246"></span><span>          </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#ScriptHash"><span class="hs-identifier hs-type">Pl.ScriptHash</span></a></span><span> </span><span id="local-6989586621679643375"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679643375"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; ScriptHash
forall a. ToScriptHash a =&gt; a -&gt; ScriptHash
</span><a href="Cooked.Output.html#toScriptHash"><span class="hs-identifier hs-var">toScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned Script
</span><a href="#local-6989586621679643381"><span class="hs-identifier hs-var">vScript</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">(ValidatorHash, Versioned Validator)
-&gt; Maybe (ValidatorHash, Versioned Validator)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinByteString -&gt; ValidatorHash
</span><a href="../Plutus.V1.Ledger.Scripts.html#ValidatorHash"><span class="hs-identifier hs-var">Pl.ValidatorHash</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679643375"><span class="hs-identifier hs-var">scriptHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Validator -&gt; Language -&gt; Versioned Validator
forall script. script -&gt; Language -&gt; Versioned script
</span><a href="../Plutus.Script.Utils.Scripts.html#Versioned"><span class="hs-identifier hs-var">Pl.Versioned</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Script -&gt; Validator
</span><a href="../Plutus.V1.Ledger.Scripts.html#Validator"><span class="hs-identifier hs-var">Pl.Validator</span></a></span><span> </span><span class="annot"><span class="annottext">Script
</span><a href="#local-6989586621679643379"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621679643378"><span class="hs-identifier hs-var">version</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | Datums from initial distributions should be accounted for in the</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- `MockChainSt` which is done using this function.</span><span>
</span><span id="line-251"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#datumMap0From"><span class="hs-identifier hs-type">datumMap0From</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#DatumHash"><span class="hs-identifier hs-type">Pl.DatumHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span id="datumMap0From"><span class="annot"><span class="annottext">datumMap0From :: InitialDistribution -&gt; Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="Cooked.MockChain.Direct.html#datumMap0From"><span class="hs-identifier hs-var hs-var">datumMap0From</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span id="local-6989586621679643371"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679643371"><span class="hs-identifier hs-var">initDist</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-comment">-- This concatenates singleton maps from inputs and accounts for the</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-comment">-- number of occurrences of similar datums</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="annottext">(Map DatumHash (TxSkelOutDatum, Integer)
 -&gt; TxSkelOut -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; [TxSkelOut]
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679643370"><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643370"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((TxSkelOutDatum, Integer)
 -&gt; (TxSkelOutDatum, Integer) -&gt; (TxSkelOutDatum, Integer))
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#unionWith"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679643368"><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679643368"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643367"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679643367"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643366"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679643366"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679643368"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679643367"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679643366"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643370"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Map DatumHash (TxSkelOutDatum, Integer)
 -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; (TxSkelOut -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; TxSkelOut
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643364"><span class="hs-identifier hs-var">unitMapFrom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
forall k a. Map k a
</span><a href="../Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679643371"><span class="hs-identifier hs-var">initDist</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">-- This takes a single output and creates an empty map if it</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- contains no datum, or a singleton map if it contains one</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="#local-6989586621679643364"><span class="hs-identifier hs-type">unitMapFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#DatumHash"><span class="hs-identifier hs-type">Pl.DatumHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../GHC.Integer.Type.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621679643364"><span class="annot"><span class="annottext">unitMapFrom :: TxSkelOut -&gt; Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="#local-6989586621679643364"><span class="hs-identifier hs-var hs-var">unitMapFrom</span></a></span></span><span> </span><span id="local-6989586621679643363"><span class="annot"><span class="annottext">TxSkelOut
</span><a href="#local-6989586621679643363"><span class="hs-identifier hs-var">txSkelOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679643362"><span class="annot"><span class="annottext">datum :: TxSkelOutDatum
</span><a href="#local-6989586621679643362"><span class="hs-identifier hs-var hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxSkelOut TxSkelOutDatum
-&gt; TxSkelOut -&gt; TxSkelOutDatum
forall k (is :: IxList) s a.
Is k A_Getter =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><a href="../Optics.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxSkelOut TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#txSkelOutDatumL"><span class="hs-identifier hs-var">txSkelOutDatumL</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOut
</span><a href="#local-6989586621679643363"><span class="hs-identifier hs-var">txSkelOut</span></a></span><span>
</span><span id="line-262"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
-&gt; (Datum -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; Maybe Datum
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
forall k a. Map k a
</span><a href="../Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DatumHash
 -&gt; (TxSkelOutDatum, Integer)
 -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; (TxSkelOutDatum, Integer)
-&gt; DatumHash
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
-&gt; (TxSkelOutDatum, Integer)
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#singleton"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679643362"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DatumHash -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; (Datum -&gt; DatumHash)
-&gt; Datum
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><a href="../Plutus.Script.Utils.Scripts.html#datumHash"><span class="hs-identifier hs-var">Pl.datumHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Datum -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; Maybe Datum -&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutUntypedDatum"><span class="hs-identifier hs-var">txSkelOutUntypedDatum</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679643362"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | This creates the initial UtxoIndex from an initial distribution</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- by submitting an initial transaction with the appropriate content:</span><span>
</span><span id="line-266"></span><span class="hs-comment">--</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- - inputs consist of a single dummy pseudo input</span><span>
</span><span id="line-268"></span><span class="hs-comment">--</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- - all non-ada assets in outputs are considered minted</span><span>
</span><span id="line-270"></span><span class="hs-comment">--</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- - outputs are translated from the `TxSkelOut` list in the initial</span><span>
</span><span id="line-272"></span><span class="hs-comment">--   distribution</span><span>
</span><span id="line-273"></span><span class="hs-comment">--</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- Two things to note:</span><span>
</span><span id="line-275"></span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- - We don't know what &quot;Magic&quot; means for the network ID (TODO)</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- - The genesis key hash has been taken from</span><span>
</span><span id="line-279"></span><span class="hs-comment">--   https://github.com/input-output-hk/cardano-node/blob/543b267d75d3d448e1940f9ec04b42bd01bbb16b/cardano-api/test/Test/Cardano/Api/Genesis.hs#L60</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#utxoIndex0From"><span class="hs-identifier hs-type">utxoIndex0From</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Ledger.Index.Internal.html#UtxoIndex"><span class="hs-identifier hs-type">Ledger.UtxoIndex</span></a></span><span>
</span><span id="line-281"></span><span id="utxoIndex0From"><span class="annot"><span class="annottext">utxoIndex0From :: InitialDistribution -&gt; UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#utxoIndex0From"><span class="hs-identifier hs-var hs-var">utxoIndex0From</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span id="local-6989586621679643357"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679643357"><span class="hs-identifier hs-var">initDist</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either GenerateTxError (TxBody BabbageEra)
</span><a href="#local-6989586621679643356"><span class="hs-identifier hs-var">mkBody</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><a href="../Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679643355"><span class="annot"><span class="annottext">GenerateTxError
</span><a href="#local-6989586621679643355"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; UtxoIndex
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; UtxoIndex) -&gt; String -&gt; UtxoIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GenerateTxError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">GenerateTxError
</span><a href="#local-6989586621679643355"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="../Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679643352"><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621679643352"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Blockchain -&gt; UtxoIndex
</span><a href="../Ledger.Index.html#initialise"><span class="hs-identifier hs-var">Ledger.initialise</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoTx -&gt; OnChainTx
</span><a href="../Ledger.Blockchain.html#Valid"><span class="hs-identifier hs-var">Ledger.Valid</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; OnChainTx) -&gt; CardanoTx -&gt; OnChainTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; CardanoTx
</span><a href="../Ledger.Tx.html#CardanoEmulatorEraTx"><span class="hs-identifier hs-var">Ledger.CardanoEmulatorEraTx</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx BabbageEra -&gt; CardanoTx) -&gt; Tx BabbageEra -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra -&gt; [KeyWitness BabbageEra] -&gt; Tx BabbageEra
forall era. TxBody era -&gt; [KeyWitness era] -&gt; Tx era
</span><a href="../Cardano.Api.Tx.html#Tx"><span class="hs-identifier hs-var">C.Tx</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621679643352"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="#local-6989586621679643356"><span class="hs-identifier hs-type">mkBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.html#GenerateTxError"><span class="hs-identifier hs-type">GenerateTxError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Cardano.Api.TxBody.html#TxBody"><span class="hs-identifier hs-type">C.TxBody</span></a></span><span> </span><span class="annot"><a href="../Cardano.Api.Eras.html#BabbageEra"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679643356"><span class="annot"><span class="annottext">mkBody :: Either GenerateTxError (TxBody BabbageEra)
</span><a href="#local-6989586621679643356"><span class="hs-identifier hs-var hs-var">mkBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>      </span><span id="local-6989586621679643347"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679643347"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; GenerateTxError)
-&gt; Either ToCardanoError Value -&gt; Either GenerateTxError Value
forall a c b. (a -&gt; c) -&gt; Either a b -&gt; Either c b
</span><a href="../Data.Either.Combinators.html#mapLeft"><span class="hs-identifier hs-var">mapLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ToCardanoError -&gt; GenerateTxError
</span><a href="Cooked.MockChain.GenerateTx.html#ToCardanoError"><span class="hs-identifier hs-var">ToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Value error&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError Value -&gt; Either GenerateTxError Value)
-&gt; Either ToCardanoError Value -&gt; Either GenerateTxError Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either ToCardanoError Value
</span><a href="../Ledger.Tx.CardanoAPI.Internal.html#toCardanoValue"><span class="hs-identifier hs-var">Ledger.toCardanoValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; TxSkelOut -&gt; Value) -&gt; Value -&gt; [TxSkelOut] -&gt; Value
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679643344"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679643344"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679643344"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; (TxSkelOut -&gt; Value) -&gt; TxSkelOut -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxSkelOut Value -&gt; TxSkelOut -&gt; Value
forall k (is :: IxList) s a.
Is k A_Getter =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><a href="../Optics.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxSkelOut Value
</span><a href="Cooked.Skeleton.html#txSkelOutValueL"><span class="hs-identifier hs-var">txSkelOutValueL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679643357"><span class="hs-identifier hs-var">initDist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679643342"><span class="annot"><span class="annottext">mintValue :: TxMintValue BuildTx BabbageEra
</span><a href="#local-6989586621679643342"><span class="hs-identifier hs-var hs-var">mintValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Value
 -&gt; BuildTxWith
      BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
 -&gt; TxMintValue BuildTx BabbageEra)
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; Value
-&gt; TxMintValue BuildTx BabbageEra
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
-&gt; Value
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; TxMintValue BuildTx BabbageEra
forall era build.
MultiAssetSupportedInEra era
-&gt; Value
-&gt; BuildTxWith build (Map PolicyId (ScriptWitness WitCtxMint era))
-&gt; TxMintValue build era
</span><a href="../Cardano.Api.TxBody.html#TxMintValue"><span class="hs-identifier hs-var">C.TxMintValue</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
</span><a href="../Cardano.Api.TxBody.html#MultiAssetInBabbageEra"><span class="hs-identifier hs-var">C.MultiAssetInBabbageEra</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../Cardano.Api.TxBody.html#BuildTxWith"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
forall a. Monoid a =&gt; a
</span><a href="../GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; TxMintValue BuildTx BabbageEra)
-&gt; (Value -&gt; Value) -&gt; Value -&gt; TxMintValue BuildTx BabbageEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; Bool) -&gt; Value -&gt; Value
</span><a href="../Cardano.Api.Value.html#filterValue"><span class="hs-identifier hs-var">C.filterValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetId -&gt; AssetId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><a href="../Cardano.Api.Value.html#AdaAssetId"><span class="hs-identifier hs-var">C.AdaAssetId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; TxMintValue BuildTx BabbageEra)
-&gt; Value -&gt; TxMintValue BuildTx BabbageEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679643347"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-289"></span><span>          </span><span id="local-6989586621679643335"><span class="annot"><span class="annottext">theNetworkId :: NetworkId
</span><a href="#local-6989586621679643335"><span class="hs-identifier hs-var hs-var">theNetworkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkMagic -&gt; NetworkId
</span><a href="../Cardano.Api.NetworkId.html#Testnet"><span class="hs-identifier hs-var">C.Testnet</span></a></span><span> </span><span class="annot"><span class="annottext">(NetworkMagic -&gt; NetworkId) -&gt; NetworkMagic -&gt; NetworkId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; NetworkMagic
</span><a href="../Ouroboros.Network.Magic.html#NetworkMagic"><span class="hs-identifier hs-var">C.NetworkMagic</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">42</span></span><span>
</span><span id="line-290"></span><span>          </span><span id="local-6989586621679643332"><span class="annot"><span class="annottext">genesisKeyHash :: Hash GenesisUTxOKey
</span><a href="#local-6989586621679643332"><span class="hs-identifier hs-var hs-var">genesisKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyHash 'Payment StandardCrypto -&gt; Hash GenesisUTxOKey
</span><a href="../Cardano.Api.KeysShelley.html#GenesisUTxOKeyHash"><span class="hs-identifier hs-var">C.GenesisUTxOKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash 'Payment StandardCrypto -&gt; Hash GenesisUTxOKey)
-&gt; KeyHash 'Payment StandardCrypto -&gt; Hash GenesisUTxOKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Hash (ADDRHASH StandardCrypto) (VerKeyDSIGN (DSIGN StandardCrypto))
-&gt; KeyHash 'Payment StandardCrypto
forall (discriminator :: KeyRole) crypto.
Hash (ADDRHASH crypto) (VerKeyDSIGN (DSIGN crypto))
-&gt; KeyHash discriminator crypto
</span><a href="../Cardano.Ledger.Keys.html#KeyHash"><span class="hs-identifier hs-var">CardanoLedger.KeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Hash (ADDRHASH StandardCrypto) (VerKeyDSIGN (DSIGN StandardCrypto))
</span><span class="hs-string">&quot;23d51e91ae5adc7ae801e9de4cd54175fb7464ec2680b25686bbb194&quot;</span></span><span>
</span><span id="line-291"></span><span>          </span><span id="local-6989586621679643329"><span class="annot"><span class="annottext">inputs :: [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn era))]
</span><a href="#local-6989586621679643329"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId -&gt; Hash GenesisUTxOKey -&gt; TxIn
</span><a href="../Cardano.Api.TxBody.html#genesisUTxOPseudoTxIn"><span class="hs-identifier hs-var">C.genesisUTxOPseudoTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679643335"><span class="hs-identifier hs-var">theNetworkId</span></a></span><span> </span><span class="annot"><span class="annottext">Hash GenesisUTxOKey
</span><a href="#local-6989586621679643332"><span class="hs-identifier hs-var">genesisKeyHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn era
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn era)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../Cardano.Api.TxBody.html#BuildTxWith"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Witness WitCtxTxIn era
 -&gt; BuildTxWith BuildTx (Witness WitCtxTxIn era))
-&gt; Witness WitCtxTxIn era
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn -&gt; Witness WitCtxTxIn era
forall witctx era. KeyWitnessInCtx witctx -&gt; Witness witctx era
</span><a href="../Cardano.Api.Script.html#KeyWitness"><span class="hs-identifier hs-var">C.KeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn
</span><a href="../Cardano.Api.Script.html#KeyWitnessForSpending"><span class="hs-identifier hs-var">C.KeyWitnessForSpending</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-292"></span><span>      </span><span id="local-6989586621679643325"><span class="annot"><span class="annottext">[TxOut CtxTx BabbageEra]
</span><a href="#local-6989586621679643325"><span class="hs-identifier hs-var">outputs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Either GenerateTxError (TxOut CtxTx BabbageEra))
-&gt; [TxSkelOut] -&gt; Either GenerateTxError [TxOut CtxTx BabbageEra]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId
-&gt; TxSkelOut -&gt; Either GenerateTxError (TxOut CtxTx BabbageEra)
</span><a href="Cooked.MockChain.GenerateTx.html#txSkelOutToCardanoTxOut"><span class="hs-identifier hs-var">txSkelOutToCardanoTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679643335"><span class="hs-identifier hs-var">theNetworkId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679643357"><span class="hs-identifier hs-var">initDist</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">(TxBodyError -&gt; GenerateTxError)
-&gt; Either TxBodyError (TxBody BabbageEra)
-&gt; Either GenerateTxError (TxBody BabbageEra)
forall a c b. (a -&gt; c) -&gt; Either a b -&gt; Either c b
</span><a href="../Data.Either.Combinators.html#mapLeft"><span class="hs-identifier hs-var">mapLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TxBodyError -&gt; GenerateTxError
</span><a href="Cooked.MockChain.GenerateTx.html#TxBodyError"><span class="hs-identifier hs-var">TxBodyError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Body error&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either TxBodyError (TxBody BabbageEra)
 -&gt; Either GenerateTxError (TxBody BabbageEra))
-&gt; Either TxBodyError (TxBody BabbageEra)
-&gt; Either GenerateTxError (TxBody BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
-&gt; Either TxBodyError (TxBody BabbageEra)
forall era.
IsCardanoEra era =&gt;
TxBodyContent BuildTx era -&gt; Either TxBodyError (TxBody era)
</span><a href="../Cardano.Api.TxBody.html#makeTransactionBody"><span class="hs-identifier hs-var">C.makeTransactionBody</span></a></span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; Either TxBodyError (TxBody BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; Either TxBodyError (TxBody BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="../Ledger.Tx.Internal.html#emptyTxBodyContent"><span class="hs-identifier hs-var">Ledger.emptyTxBodyContent</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">txMintValue :: TxMintValue BuildTx BabbageEra
</span><a href="../Cardano.Api.TxBody.html#txMintValue"><span class="hs-identifier hs-var">C.txMintValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMintValue BuildTx BabbageEra
</span><a href="#local-6989586621679643342"><span class="hs-identifier hs-var">mintValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut CtxTx BabbageEra]
</span><a href="../Cardano.Api.TxBody.html#txOuts"><span class="hs-identifier hs-var">C.txOuts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOut CtxTx BabbageEra]
</span><a href="#local-6989586621679643325"><span class="hs-identifier hs-var">outputs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txIns :: TxIns BuildTx BabbageEra
</span><a href="../Cardano.Api.TxBody.html#txIns"><span class="hs-identifier hs-var">C.txIns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxIns BuildTx BabbageEra
forall era. [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn era))]
</span><a href="#local-6989586621679643329"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#utxoIndex0"><span class="hs-identifier hs-type">utxoIndex0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Ledger.Index.Internal.html#UtxoIndex"><span class="hs-identifier hs-type">Ledger.UtxoIndex</span></a></span><span>
</span><span id="line-296"></span><span id="utxoIndex0"><span class="annot"><span class="annottext">utxoIndex0 :: UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#utxoIndex0"><span class="hs-identifier hs-var hs-var">utxoIndex0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialDistribution -&gt; UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#utxoIndex0From"><span class="hs-identifier hs-var">utxoIndex0From</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-comment">-- * Direct Interpretation of Operations</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Cooked.MockChain.Direct.html#getIndex"><span class="hs-identifier hs-type">getIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Ledger.Index.Internal.html#UtxoIndex"><span class="hs-identifier hs-type">Ledger.UtxoIndex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Tx.html#TxOutRef"><span class="hs-identifier hs-type">Pl.TxOutRef</span></a></span><span> </span><span class="annot"><a href="../Ledger.Tx.Internal.html#TxOut"><span class="hs-identifier hs-type">Ledger.TxOut</span></a></span><span>
</span><span id="line-301"></span><span id="getIndex"><span class="annot"><span class="annottext">getIndex :: UtxoIndex -&gt; Map TxOutRef TxOut
</span><a href="Cooked.MockChain.Direct.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">[(TxOutRef, TxOut)] -&gt; Map TxOutRef TxOut
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; Map TxOutRef TxOut)
-&gt; (UtxoIndex -&gt; [(TxOutRef, TxOut)])
-&gt; UtxoIndex
-&gt; Map TxOutRef TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((TxIn, TxOut CtxUTxO BabbageEra) -&gt; (TxOutRef, TxOut))
-&gt; [(TxIn, TxOut CtxUTxO BabbageEra)] -&gt; [(TxOutRef, TxOut)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxIn -&gt; TxOutRef)
-&gt; (TxOut CtxUTxO BabbageEra -&gt; TxOut)
-&gt; (TxIn, TxOut CtxUTxO BabbageEra)
-&gt; (TxOutRef, TxOut)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><a href="../Data.Bifunctor.html#bimap"><span class="hs-identifier hs-var">bimap</span></a></span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOutRef
</span><a href="../Ledger.Tx.CardanoAPI.Internal.html#fromCardanoTxIn"><span class="hs-identifier hs-var">Ledger.fromCardanoTxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut CtxTx BabbageEra -&gt; TxOut
</span><a href="../Ledger.Tx.Internal.html#TxOut"><span class="hs-identifier hs-var">Ledger.TxOut</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx BabbageEra -&gt; TxOut)
-&gt; (TxOut CtxUTxO BabbageEra -&gt; TxOut CtxTx BabbageEra)
-&gt; TxOut CtxUTxO BabbageEra
-&gt; TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO BabbageEra -&gt; TxOut CtxTx BabbageEra
forall era. TxOut CtxUTxO era -&gt; TxOut CtxTx era
</span><a href="#local-6989586621679643314"><span class="hs-identifier hs-var">toCtxTxTxOut</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">([(TxIn, TxOut CtxUTxO BabbageEra)] -&gt; [(TxOutRef, TxOut)])
-&gt; (UtxoIndex -&gt; [(TxIn, TxOut CtxUTxO BabbageEra)])
-&gt; UtxoIndex
-&gt; [(TxOutRef, TxOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO BabbageEra)
-&gt; [(TxIn, TxOut CtxUTxO BabbageEra)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO BabbageEra)
 -&gt; [(TxIn, TxOut CtxUTxO BabbageEra)])
-&gt; (UtxoIndex -&gt; Map TxIn (TxOut CtxUTxO BabbageEra))
-&gt; UtxoIndex
-&gt; [(TxIn, TxOut CtxUTxO BabbageEra)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex -&gt; Map TxIn (TxOut CtxUTxO BabbageEra)
forall era. UTxO era -&gt; Map TxIn (TxOut CtxUTxO era)
</span><a href="../Cardano.Api.Query.html#unUTxO"><span class="hs-identifier hs-var hs-var">C.unUTxO</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- We need to convert a UTxO context TxOut to a Transaction context Tx out.</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-comment">-- One could be forgiven for thinking this exists somewhere, but I couldn't find</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-comment">-- it. It's this complicated because the datum type is indexed by the context.</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679643674"><span class="annot"><a href="#local-6989586621679643314"><span class="hs-identifier hs-type">toCtxTxTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Cardano.Api.TxBody.html#TxOut"><span class="hs-identifier hs-type">C.TxOut</span></a></span><span> </span><span class="annot"><a href="../Cardano.Api.TxBody.html#CtxUTxO"><span class="hs-identifier hs-type">C.CtxUTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643674"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Cardano.Api.TxBody.html#TxOut"><span class="hs-identifier hs-type">C.TxOut</span></a></span><span> </span><span class="annot"><a href="../Cardano.Api.TxBody.html#CtxTx"><span class="hs-identifier hs-type">C.CtxTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643674"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621679643314"><span class="annot"><span class="annottext">toCtxTxTxOut :: TxOut CtxUTxO era -&gt; TxOut CtxTx era
</span><a href="#local-6989586621679643314"><span class="hs-identifier hs-var hs-var">toCtxTxTxOut</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Cardano.Api.TxBody.html#TxOut"><span class="hs-identifier hs-type">C.TxOut</span></a></span><span> </span><span id="local-6989586621679643312"><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679643312"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679643311"><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679643311"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679643310"><span class="annot"><span class="annottext">TxOutDatum CtxUTxO era
</span><a href="#local-6989586621679643310"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679643309"><span class="annot"><span class="annottext">ReferenceScript era
</span><a href="#local-6989586621679643309"><span class="hs-identifier hs-var">refS</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679643308"><span class="annot"><span class="annottext">dat :: TxOutDatum CtxTx era
</span><a href="#local-6989586621679643308"><span class="hs-identifier hs-var hs-var">dat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO era
</span><a href="#local-6989586621679643310"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO era
</span><a href="../Cardano.Api.TxBody.html#TxOutDatumNone"><span class="hs-identifier hs-var">C.TxOutDatumNone</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx era
forall ctx era. TxOutDatum ctx era
</span><a href="../Cardano.Api.TxBody.html#TxOutDatumNone"><span class="hs-identifier hs-var">C.TxOutDatumNone</span></a></span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><a href="../Cardano.Api.TxBody.html#TxOutDatumHash"><span class="hs-identifier hs-type">C.TxOutDatumHash</span></a></span><span> </span><span id="local-6989586621679643305"><span class="annot"><span class="annottext">ScriptDataSupportedInEra era
</span><a href="#local-6989586621679643305"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679643304"><span class="annot"><span class="annottext">Hash ScriptData
</span><a href="#local-6989586621679643304"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra era
-&gt; Hash ScriptData -&gt; TxOutDatum CtxTx era
forall era ctx.
ScriptDataSupportedInEra era
-&gt; Hash ScriptData -&gt; TxOutDatum ctx era
</span><a href="../Cardano.Api.TxBody.html#TxOutDatumHash"><span class="hs-identifier hs-var">C.TxOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDataSupportedInEra era
</span><a href="#local-6989586621679643305"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Hash ScriptData
</span><a href="#local-6989586621679643304"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-315"></span><span>            </span><span class="annot"><a href="../Cardano.Api.TxBody.html#TxOutDatumInline"><span class="hs-identifier hs-type">C.TxOutDatumInline</span></a></span><span> </span><span id="local-6989586621679643302"><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra era
</span><a href="#local-6989586621679643302"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679643301"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679643301"><span class="hs-identifier hs-var">sd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra era
-&gt; ScriptData -&gt; TxOutDatum CtxTx era
forall era ctx.
ReferenceTxInsScriptsInlineDatumsSupportedInEra era
-&gt; ScriptData -&gt; TxOutDatum ctx era
</span><a href="../Cardano.Api.TxBody.html#TxOutDatumInline"><span class="hs-identifier hs-var">C.TxOutDatumInline</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceTxInsScriptsInlineDatumsSupportedInEra era
</span><a href="#local-6989586621679643302"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679643301"><span class="hs-identifier hs-var">sd</span></a></span><span>
</span><span id="line-316"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">AddressInEra era
-&gt; TxOutValue era
-&gt; TxOutDatum CtxTx era
-&gt; ReferenceScript era
-&gt; TxOut CtxTx era
forall ctx era.
AddressInEra era
-&gt; TxOutValue era
-&gt; TxOutDatum ctx era
-&gt; ReferenceScript era
-&gt; TxOut ctx era
</span><a href="../Cardano.Api.TxBody.html#TxOut"><span class="hs-identifier hs-var">C.TxOut</span></a></span><span> </span><span class="annot"><span class="annottext">AddressInEra era
</span><a href="#local-6989586621679643312"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutValue era
</span><a href="#local-6989586621679643311"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxTx era
</span><a href="#local-6989586621679643308"><span class="hs-identifier hs-var">dat</span></a></span><span> </span><span class="annot"><span class="annottext">ReferenceScript era
</span><a href="#local-6989586621679643309"><span class="hs-identifier hs-var">refS</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span id="local-6989586621679643300"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643300"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643300"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679643291"><span class="annot"><span class="annottext">getParams :: MockChainT m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">getParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MockChainEnv -&gt; Params) -&gt; MockChainT m Params
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><a href="../Control.Monad.Reader.Class.html#asks"><span class="hs-identifier hs-var">asks</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainEnv -&gt; Params
</span><a href="Cooked.MockChain.Direct.html#mceParams"><span class="hs-identifier hs-var hs-var">mceParams</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679643288"><span class="annot"><span class="annottext">validatorFromHash :: ValidatorHash -&gt; MockChainT m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatorFromHash</span></a></span></span><span> </span><span id="local-6989586621679643286"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679643286"><span class="hs-identifier hs-var">valHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; Maybe (Versioned Validator))
-&gt; MockChainT m (Maybe (Versioned Validator))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="../Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">((MockChainSt -&gt; Maybe (Versioned Validator))
 -&gt; MockChainT m (Maybe (Versioned Validator)))
-&gt; (MockChainSt -&gt; Maybe (Versioned Validator))
-&gt; MockChainT m (Maybe (Versioned Validator))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; Maybe (Versioned Validator)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679643286"><span class="hs-identifier hs-var">valHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ValidatorHash (Versioned Validator)
 -&gt; Maybe (Versioned Validator))
-&gt; (MockChainSt -&gt; Map ValidatorHash (Versioned Validator))
-&gt; MockChainSt
-&gt; Maybe (Versioned Validator)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.MockChain.Direct.html#mcstValidators"><span class="hs-identifier hs-var hs-var">mcstValidators</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679643284"><span class="annot"><span class="annottext">txOutByRefLedger :: TxOutRef -&gt; MockChainT m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">txOutByRefLedger</span></a></span></span><span> </span><span id="local-6989586621679643282"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679643282"><span class="hs-identifier hs-var">outref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; Maybe TxOut) -&gt; MockChainT m (Maybe TxOut)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="../Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">((MockChainSt -&gt; Maybe TxOut) -&gt; MockChainT m (Maybe TxOut))
-&gt; (MockChainSt -&gt; Maybe TxOut) -&gt; MockChainT m (Maybe TxOut)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Map TxOutRef TxOut -&gt; Maybe TxOut
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679643282"><span class="hs-identifier hs-var">outref</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxOut -&gt; Maybe TxOut)
-&gt; (MockChainSt -&gt; Map TxOutRef TxOut)
-&gt; MockChainSt
-&gt; Maybe TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex -&gt; Map TxOutRef TxOut
</span><a href="Cooked.MockChain.Direct.html#getIndex"><span class="hs-identifier hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxoIndex -&gt; Map TxOutRef TxOut)
-&gt; (MockChainSt -&gt; UtxoIndex) -&gt; MockChainSt -&gt; Map TxOutRef TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#mcstIndex"><span class="hs-identifier hs-var hs-var">mcstIndex</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679643281"><span class="annot"><span class="annottext">datumFromHash :: DatumHash -&gt; MockChainT m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var hs-var hs-var hs-var">datumFromHash</span></a></span></span><span> </span><span id="local-6989586621679643279"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679643279"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutUntypedDatum"><span class="hs-identifier hs-var">txSkelOutUntypedDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOutDatum -&gt; Maybe Datum)
-&gt; (Map DatumHash (TxSkelOutDatum, Integer)
    -&gt; Maybe TxSkelOutDatum)
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Maybe Datum
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="../Control.Monad.html#%3C%3D%3C"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; Maybe TxSkelOutDatum
forall a. a -&gt; Maybe a
</span><a href="../GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOutDatum -&gt; Maybe TxSkelOutDatum)
-&gt; ((TxSkelOutDatum, Integer) -&gt; TxSkelOutDatum)
-&gt; (TxSkelOutDatum, Integer)
-&gt; Maybe TxSkelOutDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOutDatum, Integer) -&gt; TxSkelOutDatum
forall a b. (a, b) -&gt; a
</span><a href="../Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((TxSkelOutDatum, Integer) -&gt; Maybe TxSkelOutDatum)
-&gt; (Map DatumHash (TxSkelOutDatum, Integer)
    -&gt; Maybe (TxSkelOutDatum, Integer))
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Maybe TxSkelOutDatum
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="../Control.Monad.html#%3C%3D%3C"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Maybe (TxSkelOutDatum, Integer)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679643279"><span class="hs-identifier hs-var">datumHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map DatumHash (TxSkelOutDatum, Integer) -&gt; Maybe Datum)
-&gt; MockChainT m (Map DatumHash (TxSkelOutDatum, Integer))
-&gt; MockChainT m (Maybe Datum)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; Map DatumHash (TxSkelOutDatum, Integer))
-&gt; MockChainT m (Map DatumHash (TxSkelOutDatum, Integer))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="../Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="Cooked.MockChain.Direct.html#mcstDatums"><span class="hs-identifier hs-var hs-var">mcstDatums</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679643277"><span class="annot"><span class="annottext">utxosAtLedger :: Address -&gt; MockChainT m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAtLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">utxosAtLedger</span></a></span></span><span> </span><span id="local-6989586621679643275"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679643275"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; Bool)
-&gt; [(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679643275"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Address -&gt; Address -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Bool)
-&gt; ((TxOutRef, TxOut) -&gt; Address) -&gt; (TxOutRef, TxOut) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Address
forall o.
(IsAbstractOutput o, ToCredential (OwnerType o)) =&gt;
o -&gt; Address
</span><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-var">outputAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Address)
-&gt; ((TxOutRef, TxOut) -&gt; TxOut) -&gt; (TxOutRef, TxOut) -&gt; Address
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut)
-&gt; ((TxOutRef, TxOut) -&gt; TxOut) -&gt; (TxOutRef, TxOut) -&gt; TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; TxOut
forall a b. (a, b) -&gt; b
</span><a href="../Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)])
-&gt; MockChainT m [(TxOutRef, TxOut)]
-&gt; MockChainT m [(TxOutRef, TxOut)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxosLedger"><span class="hs-identifier hs-var">allUtxosLedger</span></a></span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621679643271"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643271"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643271"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621679643265"><span class="annot"><span class="annottext">allUtxosLedger :: MockChainT m [(TxOutRef, TxOut)]
</span><a href="#local-6989586621679643265"><span class="hs-identifier hs-var hs-var hs-var hs-var">allUtxosLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; [(TxOutRef, TxOut)])
-&gt; MockChainT m [(TxOutRef, TxOut)]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="../Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">((MockChainSt -&gt; [(TxOutRef, TxOut)])
 -&gt; MockChainT m [(TxOutRef, TxOut)])
-&gt; (MockChainSt -&gt; [(TxOutRef, TxOut)])
-&gt; MockChainT m [(TxOutRef, TxOut)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; [(TxOutRef, TxOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxOut -&gt; [(TxOutRef, TxOut)])
-&gt; (MockChainSt -&gt; Map TxOutRef TxOut)
-&gt; MockChainSt
-&gt; [(TxOutRef, TxOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex -&gt; Map TxOutRef TxOut
</span><a href="Cooked.MockChain.Direct.html#getIndex"><span class="hs-identifier hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxoIndex -&gt; Map TxOutRef TxOut)
-&gt; (MockChainSt -&gt; UtxoIndex) -&gt; MockChainSt -&gt; Map TxOutRef TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#mcstIndex"><span class="hs-identifier hs-var hs-var">mcstIndex</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679643264"><span class="annot"><span class="annottext">currentSlot :: MockChainT m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var hs-var hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; Slot) -&gt; MockChainT m Slot
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="../Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; Slot
</span><a href="Cooked.MockChain.Direct.html#mcstCurrentSlot"><span class="hs-identifier hs-var hs-var">mcstCurrentSlot</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621679643262"><span class="annot"><span class="annottext">awaitSlot :: Slot -&gt; MockChainT m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var hs-var hs-var hs-var">awaitSlot</span></a></span></span><span> </span><span id="local-6989586621679643260"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643260"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; MockChainSt) -&gt; MockChainT m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../Control.Monad.State.Class.html#modify%27"><span class="hs-identifier hs-var">modify'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679643258"><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643258"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643258"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mcstCurrentSlot :: Slot
</span><a href="Cooked.MockChain.Direct.html#mcstCurrentSlot"><span class="hs-identifier hs-var">mcstCurrentSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Classes.html#max"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643260"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainSt -&gt; Slot
</span><a href="Cooked.MockChain.Direct.html#mcstCurrentSlot"><span class="hs-identifier hs-var hs-var">mcstCurrentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643258"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainT m () -&gt; MockChainT m Slot -&gt; MockChainT m Slot
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span id="local-6989586621679643256"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643256"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643256"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679643252"><span class="annot"><span class="annottext">validateTxSkel :: TxSkel -&gt; MockChainT m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var hs-var hs-var hs-var">validateTxSkel</span></a></span></span><span> </span><span id="local-6989586621679643250"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643250"><span class="hs-identifier hs-var">skelUnbal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679643249"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643248"><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679643248"><span class="hs-identifier hs-var">fee</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643247"><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679643247"><span class="hs-identifier hs-var">collateralInputs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; MockChainT m (TxSkel, Fee, Set TxOutRef)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (TxSkel, Fee, Set TxOutRef)
</span><a href="Cooked.MockChain.Balancing.html#balancedTxSkel"><span class="hs-identifier hs-var">balancedTxSkel</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643250"><span class="hs-identifier hs-var">skelUnbal</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621679643245"><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621679643245"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxSkel, Fee, Set TxOutRef) -&gt; MockChainT m (Tx BabbageEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
(TxSkel, Fee, Set TxOutRef) -&gt; m (Tx BabbageEra)
</span><a href="Cooked.MockChain.Balancing.html#balancedTx"><span class="hs-identifier hs-var">balancedTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679643248"><span class="hs-identifier hs-var">fee</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679643247"><span class="hs-identifier hs-var">collateralInputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679643243"><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679643243"><span class="hs-identifier hs-var">consumedData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; MockChainT m (Map DatumHash Datum)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map DatumHash Datum)
</span><a href="Cooked.MockChain.Balancing.html#txSkelInputData"><span class="hs-identifier hs-var">txSkelInputData</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span id="local-6989586621679643241"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679643241"><span class="hs-identifier hs-var">theParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe EmulatorParamsModification -&gt; Params -&gt; Params
</span><a href="Cooked.Skeleton.html#applyEmulatorParamsModification"><span class="hs-identifier hs-var">applyEmulatorParamsModification</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOpts -&gt; Maybe EmulatorParamsModification
</span><a href="Cooked.Skeleton.html#txOptEmulatorParamsModification"><span class="hs-identifier hs-var hs-var">txOptEmulatorParamsModification</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOpts -&gt; Maybe EmulatorParamsModification)
-&gt; (TxSkel -&gt; TxOpts) -&gt; TxSkel -&gt; Maybe EmulatorParamsModification
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; TxOpts
</span><a href="Cooked.Skeleton.html#txSkelOpts"><span class="hs-identifier hs-var hs-var">txSkelOpts</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkel -&gt; Maybe EmulatorParamsModification)
-&gt; TxSkel -&gt; Maybe EmulatorParamsModification
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Params) -&gt; MockChainT m Params -&gt; MockChainT m Params
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainT m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679643237"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679643237"><span class="hs-identifier hs-var">someCardanoTx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">Params
-&gt; Tx BabbageEra
-&gt; [RawModTx]
-&gt; Map DatumHash Datum
-&gt; Map DatumHash TxSkelOutDatum
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; MockChainT m CardanoTx
forall (m :: * -&gt; *).
Monad m =&gt;
Params
-&gt; Tx BabbageEra
-&gt; [RawModTx]
-&gt; Map DatumHash Datum
-&gt; Map DatumHash TxSkelOutDatum
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; MockChainT m CardanoTx
</span><a href="Cooked.MockChain.Direct.html#runTransactionValidation"><span class="hs-identifier hs-var">runTransactionValidation</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679643241"><span class="hs-identifier hs-var">theParams</span></a></span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621679643245"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOpts -&gt; [RawModTx]
</span><a href="Cooked.Skeleton.html#txOptUnsafeModTx"><span class="hs-identifier hs-var hs-var">txOptUnsafeModTx</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOpts -&gt; [RawModTx]) -&gt; TxOpts -&gt; [RawModTx]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; TxOpts
</span><a href="Cooked.Skeleton.html#txSkelOpts"><span class="hs-identifier hs-var hs-var">txSkelOpts</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679643243"><span class="hs-identifier hs-var">consumedData</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkel -&gt; Map DatumHash TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#txSkelOutputData"><span class="hs-identifier hs-var">txSkelOutputData</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkel -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.Skeleton.html#txSkelOutValidators"><span class="hs-identifier hs-var">txSkelOutValidators</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; Map ValidatorHash (Versioned Validator)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.Skeleton.html#txSkelOutReferenceScripts"><span class="hs-identifier hs-var">txSkelOutReferenceScripts</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; MockChainT m () -&gt; MockChainT m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Skeleton.html#txOptAutoSlotIncrease"><span class="hs-identifier hs-var hs-var">txOptAutoSlotIncrease</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOpts -&gt; Bool) -&gt; TxOpts -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; TxOpts
</span><a href="Cooked.Skeleton.html#txSkelOpts"><span class="hs-identifier hs-var hs-var">txSkelOpts</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679643249"><span class="hs-identifier hs-var">skel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MockChainT m () -&gt; MockChainT m ())
-&gt; MockChainT m () -&gt; MockChainT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="annottext">(MockChainSt -&gt; MockChainSt) -&gt; MockChainT m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../Control.Monad.State.Class.html#modify%27"><span class="hs-identifier hs-var">modify'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679643229"><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643229"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643229"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mcstCurrentSlot :: Slot
</span><a href="Cooked.MockChain.Direct.html#mcstCurrentSlot"><span class="hs-identifier hs-var">mcstCurrentSlot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; Slot
</span><a href="Cooked.MockChain.Direct.html#mcstCurrentSlot"><span class="hs-identifier hs-var hs-var">mcstCurrentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643229"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">CardanoTx -&gt; MockChainT m CardanoTx
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679643237"><span class="hs-identifier hs-var">someCardanoTx</span></a></span></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span id="local-6989586621679643624"><span class="annot"><a href="Cooked.MockChain.Direct.html#runTransactionValidation"><span class="hs-identifier hs-type">runTransactionValidation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643624"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-comment">-- | The emulator parameters to use. They might have been changed by the 'txOptEmulatorParamsModification'.</span><span>
</span><span id="line-353"></span><span>  </span><span class="annot"><a href="../Cardano.Node.Emulator.Params.html#Params"><span class="hs-identifier hs-type">Emulator.Params</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-comment">-- | The transaction to validate. It should already be balanced, and include</span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-comment">-- appropriate fees and collateral.</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="../Cardano.Api.Tx.html#Tx"><span class="hs-identifier hs-type">C.Tx</span></a></span><span> </span><span class="annot"><a href="../Cardano.Api.Eras.html#BabbageEra"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-comment">-- | Modifications to apply to the transaction right before it is submitted.</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Skeleton.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-comment">-- | The data consumed by the transaction</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#DatumHash"><span class="hs-identifier hs-type">Pl.DatumHash</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#Datum"><span class="hs-identifier hs-type">Pl.Datum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-comment">-- | The data produced by the transaction</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#DatumHash"><span class="hs-identifier hs-type">Pl.DatumHash</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-comment">-- | The validators protecting transaction outputs, and the validators in the</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-comment">-- reference script field of transaction outputs. The 'MockChain' will</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-comment">-- remember them.</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#ValidatorHash"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Plutus.Script.Utils.Scripts.html#Versioned"><span class="hs-identifier hs-type">Pl.Versioned</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Scripts.html#Validator"><span class="hs-identifier hs-type">Pl.Validator</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainT"><span class="hs-identifier hs-type">MockChainT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679643624"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../Ledger.Tx.CardanoAPI.Internal.html#CardanoTx"><span class="hs-identifier hs-type">Ledger.CardanoTx</span></a></span></span><span>
</span><span id="line-368"></span><span id="runTransactionValidation"><span class="annot"><span class="annottext">runTransactionValidation :: Params
-&gt; Tx BabbageEra
-&gt; [RawModTx]
-&gt; Map DatumHash Datum
-&gt; Map DatumHash TxSkelOutDatum
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; MockChainT m CardanoTx
</span><a href="Cooked.MockChain.Direct.html#runTransactionValidation"><span class="hs-identifier hs-var hs-var">runTransactionValidation</span></a></span></span><span> </span><span id="local-6989586621679643228"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679643228"><span class="hs-identifier hs-var">theParams</span></a></span></span><span> </span><span id="local-6989586621679643227"><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621679643227"><span class="hs-identifier hs-var">cardanoTx</span></a></span></span><span> </span><span id="local-6989586621679643226"><span class="annot"><span class="annottext">[RawModTx]
</span><a href="#local-6989586621679643226"><span class="hs-identifier hs-var">rawModTx</span></a></span></span><span> </span><span id="local-6989586621679643225"><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679643225"><span class="hs-identifier hs-var">consumedData</span></a></span></span><span> </span><span id="local-6989586621679643224"><span class="annot"><span class="annottext">Map DatumHash TxSkelOutDatum
</span><a href="#local-6989586621679643224"><span class="hs-identifier hs-var">producedData</span></a></span></span><span> </span><span id="local-6989586621679643223"><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
</span><a href="#local-6989586621679643223"><span class="hs-identifier hs-var">outputValidators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679643222"><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643222"><span class="hs-identifier hs-var">utxoIndex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(MockChainSt -&gt; UtxoIndex) -&gt; MockChainT m UtxoIndex
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><a href="../Control.Monad.State.Class.html#gets"><span class="hs-identifier hs-var">gets</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#mcstIndex"><span class="hs-identifier hs-var hs-var">mcstIndex</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679643221"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643221"><span class="hs-identifier hs-var">theSlot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MockChainT m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679643220"><span class="hs-identifier hs-type">cardanoIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Cardano.Ledger.Shelley.UTxO.html#UTxO"><span class="hs-identifier hs-type">CardanoLedger.UTxO</span></a></span><span> </span><span class="annot"><a href="../Cardano.Node.Emulator.Params.html#EmulatorEra"><span class="hs-identifier hs-type">Emulator.EmulatorEra</span></a></span><span>
</span><span id="line-372"></span><span>      </span><span id="local-6989586621679643220"><span class="annot"><span class="annottext">cardanoIndex :: UTxO EmulatorEra
</span><a href="#local-6989586621679643220"><span class="hs-identifier hs-var hs-var">cardanoIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UtxoIndex -&gt; UTxO EmulatorEra
</span><a href="../Ledger.Tx.CardanoAPI.html#fromPlutusIndex"><span class="hs-identifier hs-var">Ledger.fromPlutusIndex</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643222"><span class="hs-identifier hs-var">utxoIndex</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-comment">-- &quot;Ledger.CardanoTx&quot; is a plutus-apps type 'Tx BabbageEra' is a</span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-comment">-- cardano-api type with the information we need. This wraps the latter</span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-comment">-- inside the former.</span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><a href="#local-6989586621679643218"><span class="hs-identifier hs-type">txWrapped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Ledger.Tx.CardanoAPI.Internal.html#CardanoTx"><span class="hs-identifier hs-type">Ledger.CardanoTx</span></a></span><span>
</span><span id="line-378"></span><span>      </span><span id="local-6989586621679643218"><span class="annot"><span class="annottext">txWrapped :: CardanoTx
</span><a href="#local-6989586621679643218"><span class="hs-identifier hs-var hs-var">txWrapped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; CardanoTx
</span><a href="../Ledger.Tx.html#CardanoEmulatorEraTx"><span class="hs-identifier hs-var">Ledger.CardanoEmulatorEraTx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621679643227"><span class="hs-identifier hs-var">cardanoTx</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><a href="#local-6989586621679643217"><span class="hs-identifier hs-type">mValidationError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Data.Either.html#Either"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../Ledger.Index.Internal.html#ValidationErrorInPhase"><span class="hs-identifier hs-type">Ledger.ValidationErrorInPhase</span></a></span><span> </span><span class="annot"><a href="../Ledger.Index.Internal.html#ValidationSuccess"><span class="hs-identifier hs-type">Ledger.ValidationSuccess</span></a></span><span>
</span><span id="line-381"></span><span>      </span><span id="local-6989586621679643217"><span class="annot"><span class="annottext">mValidationError :: Either ValidationErrorInPhase ValidationSuccess
</span><a href="#local-6989586621679643217"><span class="hs-identifier hs-var hs-var">mValidationError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Slot
-&gt; UTxO EmulatorEra
-&gt; CardanoTx
-&gt; Either ValidationErrorInPhase ValidationSuccess
</span><a href="../Cardano.Node.Emulator.Validation.html#validateCardanoTx"><span class="hs-identifier hs-var">Emulator.validateCardanoTx</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679643228"><span class="hs-identifier hs-var">theParams</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679643221"><span class="hs-identifier hs-var">theSlot</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO EmulatorEra
</span><a href="#local-6989586621679643220"><span class="hs-identifier hs-var">cardanoIndex</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679643218"><span class="hs-identifier hs-var">txWrapped</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><a href="#local-6989586621679643215"><span class="hs-identifier hs-type">newUtxoIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Ledger.Index.Internal.html#UtxoIndex"><span class="hs-identifier hs-type">Ledger.UtxoIndex</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span id="local-6989586621679643215"><span class="annot"><span class="annottext">newUtxoIndex :: UtxoIndex
</span><a href="#local-6989586621679643215"><span class="hs-identifier hs-var hs-var">newUtxoIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ValidationErrorInPhase ValidationSuccess
</span><a href="#local-6989586621679643217"><span class="hs-identifier hs-var">mValidationError</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><a href="../Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidationPhase
</span><a href="../Ledger.Index.Internal.html#Phase1"><span class="hs-identifier hs-var">Ledger.Phase1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643222"><span class="hs-identifier hs-var">utxoIndex</span></a></span><span>
</span><span id="line-386"></span><span>        </span><span class="annot"><a href="../Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidationPhase
</span><a href="../Ledger.Index.Internal.html#Phase2"><span class="hs-identifier hs-var">Ledger.Phase2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>          </span><span class="hs-comment">-- Despite its name, this actually deletes the collateral UTxOs from</span><span>
</span><span id="line-388"></span><span>          </span><span class="hs-comment">-- the index</span><span>
</span><span id="line-389"></span><span>          </span><span class="annot"><span class="annottext">CardanoTx -&gt; UtxoIndex -&gt; UtxoIndex
</span><a href="../Ledger.Index.html#insertCollateral"><span class="hs-identifier hs-var">Ledger.insertCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679643218"><span class="hs-identifier hs-var">txWrapped</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643222"><span class="hs-identifier hs-var">utxoIndex</span></a></span><span>
</span><span id="line-390"></span><span>        </span><span class="annot"><a href="../Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationSuccess
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; UtxoIndex -&gt; UtxoIndex
</span><a href="../Ledger.Index.html#insert"><span class="hs-identifier hs-var">Ledger.insert</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679643218"><span class="hs-identifier hs-var">txWrapped</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643222"><span class="hs-identifier hs-var">utxoIndex</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ValidationErrorInPhase ValidationSuccess
</span><a href="#local-6989586621679643217"><span class="hs-identifier hs-var">mValidationError</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="../Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679643210"><span class="annot"><span class="annottext">ValidationErrorInPhase
</span><a href="#local-6989586621679643210"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; MockChainT m CardanoTx
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><a href="../Control.Monad.Error.Class.html#throwError"><span class="hs-identifier hs-var">throwError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidationErrorInPhase -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-var">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationErrorInPhase
</span><a href="#local-6989586621679643210"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="../Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationSuccess
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>      </span><span class="hs-comment">-- Validation succeeded; now we update the UTxO index, the managed</span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-comment">-- datums, and the managed Validators. The new mcstIndex is just</span><span>
</span><span id="line-396"></span><span>      </span><span class="hs-comment">-- `newUtxoIndex`; the new mcstDatums is computed by adding those that</span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-comment">-- have been created in the transaction and removing those that were</span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-comment">-- consumed (or reducing their count in the 'mcstDatums').</span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><span class="annottext">(MockChainSt -&gt; MockChainSt) -&gt; MockChainT m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><a href="../Control.Monad.State.Class.html#modify%27"><span class="hs-identifier hs-var">modify'</span></a></span><span>
</span><span id="line-400"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679643208"><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643208"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>            </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643208"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-402"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mcstIndex :: UtxoIndex
</span><a href="Cooked.MockChain.Direct.html#mcstIndex"><span class="hs-identifier hs-var">mcstIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UtxoIndex
</span><a href="#local-6989586621679643215"><span class="hs-identifier hs-var">newUtxoIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-403"></span><span>                </span><span class="annot"><span class="annottext">mcstDatums :: Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="Cooked.MockChain.Direct.html#mcstDatums"><span class="hs-identifier hs-var">mcstDatums</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainSt -&gt; Map DatumHash (TxSkelOutDatum, Integer)
</span><a href="Cooked.MockChain.Direct.html#mcstDatums"><span class="hs-identifier hs-var hs-var">mcstDatums</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643208"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Map DatumHash Datum -&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall a b.
Map DatumHash (a, Integer)
-&gt; Map DatumHash b -&gt; Map DatumHash (a, Integer)
</span><a href="#local-6989586621679643207"><span class="hs-operator hs-var">`removeMcstDatums`</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash Datum
</span><a href="#local-6989586621679643225"><span class="hs-identifier hs-var">consumedData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map DatumHash (TxSkelOutDatum, Integer)
-&gt; Map DatumHash TxSkelOutDatum
-&gt; Map DatumHash (TxSkelOutDatum, Integer)
forall k a a.
(Ord k, Num a) =&gt;
Map k (a, a) -&gt; Map k a -&gt; Map k (a, a)
</span><a href="#local-6989586621679643206"><span class="hs-operator hs-var">`addMcstDatums`</span></a></span><span> </span><span class="annot"><span class="annottext">Map DatumHash TxSkelOutDatum
</span><a href="#local-6989586621679643224"><span class="hs-identifier hs-var">producedData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-404"></span><span>                </span><span class="annot"><span class="annottext">mcstValidators :: Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.MockChain.Direct.html#mcstValidators"><span class="hs-identifier hs-var">mcstValidators</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MockChainSt -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.MockChain.Direct.html#mcstValidators"><span class="hs-identifier hs-var hs-var">mcstValidators</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679643208"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
-&gt; Map ValidatorHash (Versioned Validator)
-&gt; Map ValidatorHash (Versioned Validator)
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../Data.Map.Internal.html#union"><span class="hs-operator hs-var">`Map.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map ValidatorHash (Versioned Validator)
</span><a href="#local-6989586621679643223"><span class="hs-identifier hs-var">outputValidators</span></a></span><span>
</span><span id="line-405"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-406"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><span class="annottext">CardanoTx -&gt; MockChainT m CardanoTx
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; CardanoTx
</span><a href="../Ledger.Tx.html#CardanoEmulatorEraTx"><span class="hs-identifier hs-var">Ledger.CardanoEmulatorEraTx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra
</span><a href="#local-6989586621679643227"><span class="hs-identifier hs-var">cardanoTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679643206"><span class="annot"><span class="annottext">addMcstDatums :: Map k (a, a) -&gt; Map k a -&gt; Map k (a, a)
</span><a href="#local-6989586621679643206"><span class="hs-identifier hs-var hs-var">addMcstDatums</span></a></span></span><span> </span><span id="local-6989586621679643204"><span class="annot"><span class="annottext">Map k (a, a)
</span><a href="#local-6989586621679643204"><span class="hs-identifier hs-var">stored</span></a></span></span><span> </span><span id="local-6989586621679643203"><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679643203"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; (a, a) -&gt; (a, a))
-&gt; Map k (a, a) -&gt; Map k (a, a) -&gt; Map k (a, a)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#unionWith"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679643202"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643202"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643201"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643201"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643200"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643200"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643202"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643201"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643200"><span class="hs-identifier hs-var">n2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k (a, a)
</span><a href="#local-6989586621679643204"><span class="hs-identifier hs-var">stored</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; (a, a)) -&gt; Map k a -&gt; Map k (a, a)
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="../Data.Map.Strict.Internal.html#map"><span class="hs-identifier hs-var">Map.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k a
</span><a href="#local-6989586621679643203"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621679643207"><span class="annot"><span class="annottext">removeMcstDatums :: Map DatumHash (a, Integer)
-&gt; Map DatumHash b -&gt; Map DatumHash (a, Integer)
</span><a href="#local-6989586621679643207"><span class="hs-identifier hs-var hs-var">removeMcstDatums</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, Integer) -&gt; b -&gt; Maybe (a, Integer))
-&gt; Map DatumHash (a, Integer)
-&gt; Map DatumHash b
-&gt; Map DatumHash (a, Integer)
forall k a b.
Ord k =&gt;
(a -&gt; b -&gt; Maybe a) -&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#differenceWith"><span class="hs-identifier hs-var">Map.differenceWith</span></a></span><span> </span><span class="annot"><span class="annottext">(((a, Integer) -&gt; b -&gt; Maybe (a, Integer))
 -&gt; Map DatumHash (a, Integer)
 -&gt; Map DatumHash b
 -&gt; Map DatumHash (a, Integer))
-&gt; ((a, Integer) -&gt; b -&gt; Maybe (a, Integer))
-&gt; Map DatumHash (a, Integer)
-&gt; Map DatumHash b
-&gt; Map DatumHash (a, Integer)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679643197"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643197"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679643196"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679643196"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679643196"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (a, Integer)
forall a. Maybe a
</span><a href="../GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(a, Integer) -&gt; Maybe (a, Integer)
forall a. a -&gt; Maybe a
</span><a href="../GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679643197"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679643196"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span></pre></body></html>
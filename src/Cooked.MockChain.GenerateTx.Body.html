<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This modules exposes entry points to convert a 'TxSkel' into a fully</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- fledged transaction body</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.GenerateTx.Body</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBody"><span class="hs-identifier">txSkelToTxBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txBodyContentToTxBody"><span class="hs-identifier">txBodyContentToTxBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBodyContent"><span class="hs-identifier">txSkelToTxBodyContent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToIndex"><span class="hs-identifier">txSkelToIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSignatoriesAndBodyToCardanoTx"><span class="hs-identifier">txSignatoriesAndBodyToCardanoTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToCardanoTx"><span class="hs-identifier">txSkelToCardanoTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cardano</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html"><span class="hs-identifier">Cooked.MockChain.BlockChain</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Certificate.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Certificate</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Collateral.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Collateral</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Common.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Common</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Input.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Input</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Mint.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Mint</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Output.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Output</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Proposal.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Proposal</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.ReferenceInputs.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.ReferenceInputs</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Withdrawals.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Withdrawals</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Witness.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx.Witness</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html"><span class="hs-identifier">Cooked.Skeleton</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Address</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Address</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><span class="hs-comment">-- | Generates a body content from a skeleton</span></span><span>
</span><span id="line-37"></span><span id="local-6989586621679876434"><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBodyContent"><span class="hs-identifier hs-type">txSkelToTxBodyContent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679876434"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#Fee"><span class="hs-identifier hs-type">Fee</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#Collaterals"><span class="hs-identifier hs-type">Collaterals</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679876434"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cardano.TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.BuildTx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-38"></span><span id="txSkelToTxBodyContent"><span class="annot"><span class="annottext">txSkelToTxBodyContent :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; Fee -&gt; Collaterals -&gt; m (TxBodyContent BuildTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBodyContent"><span class="hs-identifier hs-var hs-var">txSkelToTxBodyContent</span></a></span></span><span> </span><span id="local-6989586621679876674"><span class="annot"><span class="annottext">skel :: TxSkel
</span><a href="#local-6989586621679876674"><span class="hs-identifier hs-var">skel</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679876675"><span id="local-6989586621679876676"><span id="local-6989586621679876677"><span id="local-6989586621679876678"><span id="local-6989586621679876679"><span id="local-6989586621679876680"><span id="local-6989586621679876681"><span id="local-6989586621679876682"><span id="local-6989586621679876683"><span id="local-6989586621679876684"><span id="local-6989586621679876685"><span class="annot"><span class="annottext">[TxSkelSignatory]
[TxSkelProposal]
[TxSkelCertificate]
[TxSkelOut]
Set TxOutRef
Set TxSkelLabel
Map TxOutRef TxSkelRedeemer
SlotRange
TxSkelOpts
TxSkelWithdrawals
TxSkelMints
txSkelLabel :: Set TxSkelLabel
txSkelOpts :: TxSkelOpts
txSkelMints :: TxSkelMints
txSkelSignatories :: [TxSkelSignatory]
txSkelValidityRange :: SlotRange
txSkelIns :: Map TxOutRef TxSkelRedeemer
txSkelInsReference :: Set TxOutRef
txSkelOuts :: [TxSkelOut]
txSkelProposals :: [TxSkelProposal]
txSkelWithdrawals :: TxSkelWithdrawals
txSkelCertificates :: [TxSkelCertificate]
txSkelLabel :: TxSkel -&gt; Set TxSkelLabel
txSkelOpts :: TxSkel -&gt; TxSkelOpts
txSkelMints :: TxSkel -&gt; TxSkelMints
txSkelSignatories :: TxSkel -&gt; [TxSkelSignatory]
txSkelValidityRange :: TxSkel -&gt; SlotRange
txSkelIns :: TxSkel -&gt; Map TxOutRef TxSkelRedeemer
txSkelInsReference :: TxSkel -&gt; Set TxOutRef
txSkelOuts :: TxSkel -&gt; [TxSkelOut]
txSkelProposals :: TxSkel -&gt; [TxSkelProposal]
txSkelWithdrawals :: TxSkel -&gt; TxSkelWithdrawals
txSkelCertificates :: TxSkel -&gt; [TxSkelCertificate]
</span><a href="#local-6989586621679876675"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679876697"><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679876697"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span id="local-6989586621679876698"><span class="annot"><span class="annottext">Collaterals
</span><a href="#local-6989586621679876698"><span class="hs-identifier hs-var">mCollaterals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-39"></span><span>  </span><span id="local-6989586621679876699"><span class="annot"><span class="annottext">[(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))]
</span><a href="#local-6989586621679876699"><span class="hs-identifier hs-var">txIns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxSkelRedeemer)
 -&gt; m (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra)))
-&gt; [(TxOutRef, TxSkelRedeemer)]
-&gt; m [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxSkelRedeemer)
-&gt; m (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
(TxOutRef, TxSkelRedeemer)
-&gt; m (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))
</span><a href="Cooked.MockChain.GenerateTx.Input.html#toTxInAndWitness"><span class="hs-identifier hs-var">toTxInAndWitness</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxSkelRedeemer)]
 -&gt; m [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))])
-&gt; [(TxOutRef, TxSkelRedeemer)]
-&gt; m [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [(TxOutRef, TxSkelRedeemer)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679876680"><span class="hs-identifier hs-var">txSkelIns</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679876703"><span class="annot"><span class="annottext">TxInsReference BuildTx ConwayEra
</span><a href="#local-6989586621679876703"><span class="hs-identifier hs-var">txInsReference</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m (TxInsReference BuildTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (TxInsReference BuildTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.ReferenceInputs.html#toInsReference"><span class="hs-identifier hs-var">toInsReference</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876674"><span class="hs-identifier hs-var">skel</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679876705"><span class="annot"><span class="annottext">TxInsCollateral ConwayEra
</span><a href="#local-6989586621679876705"><span class="hs-identifier hs-var">txInsCollateral</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679876706"><span class="annot"><span class="annottext">TxTotalCollateral ConwayEra
</span><a href="#local-6989586621679876706"><span class="hs-identifier hs-var">txTotalCollateral</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679876707"><span class="annot"><span class="annottext">TxReturnCollateral CtxTx ConwayEra
</span><a href="#local-6989586621679876707"><span class="hs-identifier hs-var">txReturnCollateral</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fee
-&gt; Collaterals
-&gt; m (TxInsCollateral ConwayEra, TxTotalCollateral ConwayEra,
      TxReturnCollateral CtxTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
Fee
-&gt; Collaterals
-&gt; m (TxInsCollateral ConwayEra, TxTotalCollateral ConwayEra,
      TxReturnCollateral CtxTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Collateral.html#toCollateralTriplet"><span class="hs-identifier hs-var">toCollateralTriplet</span></a></span><span> </span><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679876697"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">Collaterals
</span><a href="#local-6989586621679876698"><span class="hs-identifier hs-var">mCollaterals</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621679876709"><span class="annot"><span class="annottext">[TxOut CtxTx ConwayEra]
</span><a href="#local-6989586621679876709"><span class="hs-identifier hs-var">txOuts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; m (TxOut CtxTx ConwayEra))
-&gt; [TxSkelOut] -&gt; m [TxOut CtxTx ConwayEra]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; m (TxOut CtxTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkelOut -&gt; m (TxOut CtxTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Output.html#toCardanoTxOut"><span class="hs-identifier hs-var">toCardanoTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679876682"><span class="hs-identifier hs-var">txSkelOuts</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679876711"><span class="annot"><span class="annottext">TxValidityLowerBound ConwayEra
</span><a href="#local-6989586621679876711"><span class="hs-identifier hs-var">txValidityLowerBound</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679876712"><span class="annot"><span class="annottext">TxValidityUpperBound ConwayEra
</span><a href="#local-6989586621679876712"><span class="hs-identifier hs-var">txValidityUpperBound</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><span class="annottext">String
-&gt; Either
     ToCardanoError
     (TxValidityLowerBound ConwayEra, TxValidityUpperBound ConwayEra)
-&gt; m (TxValidityLowerBound ConwayEra,
      TxValidityUpperBound ConwayEra)
forall (m :: * -&gt; *) a.
MonadError MockChainError m =&gt;
String -&gt; Either ToCardanoError a -&gt; m a
</span><a href="Cooked.MockChain.GenerateTx.Common.html#throwOnToCardanoError"><span class="hs-identifier hs-var">throwOnToCardanoError</span></a></span><span>
</span><span id="line-45"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;txSkelToBodyContent: Unable to translate transaction validity range.&quot;</span></span><span>
</span><span id="line-46"></span><span>      </span><span class="annot"><span class="annottext">(Either
   ToCardanoError
   (TxValidityLowerBound ConwayEra, TxValidityUpperBound ConwayEra)
 -&gt; m (TxValidityLowerBound ConwayEra,
       TxValidityUpperBound ConwayEra))
-&gt; Either
     ToCardanoError
     (TxValidityLowerBound ConwayEra, TxValidityUpperBound ConwayEra)
-&gt; m (TxValidityLowerBound ConwayEra,
      TxValidityUpperBound ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SlotRange
-&gt; Either
     ToCardanoError
     (TxValidityLowerBound ConwayEra, TxValidityUpperBound ConwayEra)
</span><span class="hs-identifier hs-var">Ledger.toCardanoValidityRange</span></span><span> </span><span class="annot"><span class="annottext">SlotRange
</span><a href="#local-6989586621679876679"><span class="hs-identifier hs-var">txSkelValidityRange</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679876715"><span class="annot"><span class="annottext">TxMintValue BuildTx ConwayEra
</span><a href="#local-6989586621679876715"><span class="hs-identifier hs-var">txMintValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxSkelMints -&gt; m (TxMintValue BuildTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkelMints -&gt; m (TxMintValue BuildTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Mint.html#toMintValue"><span class="hs-identifier hs-var">toMintValue</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679876677"><span class="hs-identifier hs-var">txSkelMints</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679876717"><span class="annot"><span class="annottext">TxExtraKeyWitnesses ConwayEra
</span><a href="#local-6989586621679876717"><span class="hs-identifier hs-var">txExtraKeyWits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[TxSkelSignatory] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelSignatory]
</span><a href="#local-6989586621679876678"><span class="hs-identifier hs-var">txSkelSignatories</span></a></span><span>
</span><span id="line-50"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses ConwayEra -&gt; m (TxExtraKeyWitnesses ConwayEra)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses ConwayEra
forall era. TxExtraKeyWitnesses era
</span><span class="hs-identifier hs-var">Cardano.TxExtraKeyWitnessesNone</span></span><span>
</span><span id="line-51"></span><span>      </span><span class="hs-keyword">else</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; ([Hash PaymentKey] -&gt; TxExtraKeyWitnesses ConwayEra)
-&gt; Either ToCardanoError [Hash PaymentKey]
-&gt; m (TxExtraKeyWitnesses ConwayEra)
forall (m :: * -&gt; *) a b.
MonadError MockChainError m =&gt;
String -&gt; (a -&gt; b) -&gt; Either ToCardanoError a -&gt; m b
</span><a href="Cooked.MockChain.GenerateTx.Common.html#throwOnToCardanoErrorOrApply"><span class="hs-identifier hs-var">throwOnToCardanoErrorOrApply</span></a></span><span>
</span><span id="line-53"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;txSkelToBodyContent: Unable to translate the required signatories&quot;</span></span><span>
</span><span id="line-54"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlonzoEraOnwards ConwayEra
-&gt; [Hash PaymentKey] -&gt; TxExtraKeyWitnesses ConwayEra
forall era.
AlonzoEraOnwards era
-&gt; [Hash PaymentKey] -&gt; TxExtraKeyWitnesses era
</span><span class="hs-identifier hs-var">Cardano.TxExtraKeyWitnesses</span></span><span> </span><span class="annot"><span class="annottext">AlonzoEraOnwards ConwayEra
</span><span class="hs-identifier hs-var">Cardano.AlonzoEraOnwardsConway</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>          </span><span class="annot"><span class="annottext">(Either ToCardanoError [Hash PaymentKey]
 -&gt; m (TxExtraKeyWitnesses ConwayEra))
-&gt; Either ToCardanoError [Hash PaymentKey]
-&gt; m (TxExtraKeyWitnesses ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TxSkelSignatory -&gt; Either ToCardanoError (Hash PaymentKey))
-&gt; [TxSkelSignatory] -&gt; Either ToCardanoError [Hash PaymentKey]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaymentPubKeyHash -&gt; Either ToCardanoError (Hash PaymentKey)
</span><span class="hs-identifier hs-var">Ledger.toCardanoPaymentKeyHash</span></span><span> </span><span class="annot"><span class="annottext">(PaymentPubKeyHash -&gt; Either ToCardanoError (Hash PaymentKey))
-&gt; (TxSkelSignatory -&gt; PaymentPubKeyHash)
-&gt; TxSkelSignatory
-&gt; Either ToCardanoError (Hash PaymentKey)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; PaymentPubKeyHash
</span><span class="hs-identifier hs-var">Ledger.PaymentPubKeyHash</span></span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; PaymentPubKeyHash)
-&gt; (TxSkelSignatory -&gt; PubKeyHash)
-&gt; TxSkelSignatory
-&gt; PaymentPubKeyHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkelSignatory -&gt; PubKeyHash
forall a. ToPubKeyHash a =&gt; a -&gt; PubKeyHash
</span><span class="hs-identifier hs-var">Script.toPubKeyHash</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxSkelSignatory]
</span><a href="#local-6989586621679876678"><span class="hs-identifier hs-var">txSkelSignatories</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679876727"><span class="annot"><span class="annottext">BuildTxWith BuildTx (Maybe (LedgerProtocolParameters ConwayEra))
</span><a href="#local-6989586621679876727"><span class="hs-identifier hs-var">txProtocolParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (LedgerProtocolParameters ConwayEra)
-&gt; BuildTxWith BuildTx (Maybe (LedgerProtocolParameters ConwayEra))
forall a. a -&gt; BuildTxWith BuildTx a
</span><span class="hs-identifier hs-var">Cardano.BuildTxWith</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (LedgerProtocolParameters ConwayEra)
 -&gt; BuildTxWith
      BuildTx (Maybe (LedgerProtocolParameters ConwayEra)))
-&gt; (Params -&gt; Maybe (LedgerProtocolParameters ConwayEra))
-&gt; Params
-&gt; BuildTxWith BuildTx (Maybe (LedgerProtocolParameters ConwayEra))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LedgerProtocolParameters ConwayEra
-&gt; Maybe (LedgerProtocolParameters ConwayEra)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LedgerProtocolParameters ConwayEra
 -&gt; Maybe (LedgerProtocolParameters ConwayEra))
-&gt; (Params -&gt; LedgerProtocolParameters ConwayEra)
-&gt; Params
-&gt; Maybe (LedgerProtocolParameters ConwayEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; LedgerProtocolParameters ConwayEra
</span><span class="hs-identifier hs-var">Emulator.ledgerProtocolParameters</span></span><span> </span><span class="annot"><span class="annottext">(Params
 -&gt; BuildTxWith
      BuildTx (Maybe (LedgerProtocolParameters ConwayEra)))
-&gt; m Params
-&gt; m (BuildTxWith
        BuildTx (Maybe (LedgerProtocolParameters ConwayEra)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679876732"><span class="annot"><span class="annottext">Maybe
  (Featured
     ConwayEraOnwards
     ConwayEra
     (TxProposalProcedures BuildTx ConwayEra))
</span><a href="#local-6989586621679876732"><span class="hs-identifier hs-var">txProposalProcedures</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Featured
  ConwayEraOnwards ConwayEra (TxProposalProcedures BuildTx ConwayEra)
-&gt; Maybe
     (Featured
        ConwayEraOnwards
        ConwayEra
        (TxProposalProcedures BuildTx ConwayEra))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Featured
   ConwayEraOnwards ConwayEra (TxProposalProcedures BuildTx ConwayEra)
 -&gt; Maybe
      (Featured
         ConwayEraOnwards
         ConwayEra
         (TxProposalProcedures BuildTx ConwayEra)))
-&gt; (TxProposalProcedures BuildTx ConwayEra
    -&gt; Featured
         ConwayEraOnwards
         ConwayEra
         (TxProposalProcedures BuildTx ConwayEra))
-&gt; TxProposalProcedures BuildTx ConwayEra
-&gt; Maybe
     (Featured
        ConwayEraOnwards
        ConwayEra
        (TxProposalProcedures BuildTx ConwayEra))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards ConwayEra
-&gt; TxProposalProcedures BuildTx ConwayEra
-&gt; Featured
     ConwayEraOnwards ConwayEra (TxProposalProcedures BuildTx ConwayEra)
forall (eon :: * -&gt; *) era a. eon era -&gt; a -&gt; Featured eon era a
</span><span class="hs-identifier hs-var">Cardano.Featured</span></span><span> </span><span class="annot"><span class="annottext">ConwayEraOnwards ConwayEra
</span><span class="hs-identifier hs-var">Cardano.ConwayEraOnwardsConway</span></span><span> </span><span class="annot"><span class="annottext">(TxProposalProcedures BuildTx ConwayEra
 -&gt; Maybe
      (Featured
         ConwayEraOnwards
         ConwayEra
         (TxProposalProcedures BuildTx ConwayEra)))
-&gt; m (TxProposalProcedures BuildTx ConwayEra)
-&gt; m (Maybe
        (Featured
           ConwayEraOnwards
           ConwayEra
           (TxProposalProcedures BuildTx ConwayEra)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelProposal] -&gt; m (TxProposalProcedures BuildTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxSkelProposal] -&gt; m (TxProposalProcedures BuildTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Proposal.html#toProposalProcedures"><span class="hs-identifier hs-var">toProposalProcedures</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelProposal]
</span><a href="#local-6989586621679876683"><span class="hs-identifier hs-var">txSkelProposals</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679876736"><span class="annot"><span class="annottext">TxWithdrawals BuildTx ConwayEra
</span><a href="#local-6989586621679876736"><span class="hs-identifier hs-var">txWithdrawals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxSkelWithdrawals -&gt; m (TxWithdrawals BuildTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkelWithdrawals -&gt; m (TxWithdrawals BuildTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Withdrawals.html#toWithdrawals"><span class="hs-identifier hs-var">toWithdrawals</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelWithdrawals
</span><a href="#local-6989586621679876684"><span class="hs-identifier hs-var">txSkelWithdrawals</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679876738"><span class="annot"><span class="annottext">TxCertificates BuildTx ConwayEra
</span><a href="#local-6989586621679876738"><span class="hs-identifier hs-var">txCertificates</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxSkelCertificate] -&gt; m (TxCertificates BuildTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxSkelCertificate] -&gt; m (TxCertificates BuildTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Certificate.html#toCertificates"><span class="hs-identifier hs-var">toCertificates</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelCertificate]
</span><a href="#local-6989586621679876685"><span class="hs-identifier hs-var">txSkelCertificates</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679876740"><span class="annot"><span class="annottext">txFee :: TxFee ConwayEra
</span><a href="#local-6989586621679876740"><span class="hs-identifier hs-var hs-var">txFee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra -&gt; Coin -&gt; TxFee ConwayEra
forall era. ShelleyBasedEra era -&gt; Coin -&gt; TxFee era
</span><span class="hs-identifier hs-var">Cardano.TxFeeExplicit</span></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra ConwayEra
</span><span class="hs-identifier hs-var">Cardano.ShelleyBasedEraConway</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; TxFee ConwayEra) -&gt; Coin -&gt; TxFee ConwayEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Fee -&gt; Coin
</span><span class="hs-identifier hs-var">Cardano.Coin</span></span><span> </span><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679876697"><span class="hs-identifier hs-var">fee</span></a></span><span>
</span><span id="line-61"></span><span>      </span><span id="local-6989586621679876744"><span class="annot"><span class="annottext">txMetadata :: TxMetadataInEra era
</span><a href="#local-6989586621679876744"><span class="hs-identifier hs-var hs-var">txMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMetadataInEra era
forall era. TxMetadataInEra era
</span><span class="hs-identifier hs-var">Cardano.TxMetadataNone</span></span><span>
</span><span id="line-62"></span><span>      </span><span id="local-6989586621679876746"><span class="annot"><span class="annottext">txAuxScripts :: TxAuxScripts era
</span><a href="#local-6989586621679876746"><span class="hs-identifier hs-var hs-var">txAuxScripts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxAuxScripts era
forall era. TxAuxScripts era
</span><span class="hs-identifier hs-var">Cardano.TxAuxScriptsNone</span></span><span>
</span><span id="line-63"></span><span>      </span><span id="local-6989586621679876748"><span class="annot"><span class="annottext">txUpdateProposal :: TxUpdateProposal era
</span><a href="#local-6989586621679876748"><span class="hs-identifier hs-var hs-var">txUpdateProposal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxUpdateProposal era
forall era. TxUpdateProposal era
</span><span class="hs-identifier hs-var">Cardano.TxUpdateProposalNone</span></span><span>
</span><span id="line-64"></span><span>      </span><span id="local-6989586621679876750"><span class="annot"><span class="annottext">txScriptValidity :: TxScriptValidity era
</span><a href="#local-6989586621679876750"><span class="hs-identifier hs-var hs-var">txScriptValidity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxScriptValidity era
forall era. TxScriptValidity era
</span><span class="hs-identifier hs-var">Cardano.TxScriptValidityNone</span></span><span>
</span><span id="line-65"></span><span>      </span><span id="local-6989586621679876752"><span class="annot"><span class="annottext">txVotingProcedures :: Maybe a
</span><a href="#local-6989586621679876752"><span class="hs-identifier hs-var hs-var">txVotingProcedures</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-66"></span><span>      </span><span id="local-6989586621679876753"><span class="annot"><span class="annottext">txCurrentTreasuryValue :: Maybe a
</span><a href="#local-6989586621679876753"><span class="hs-identifier hs-var hs-var">txCurrentTreasuryValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-67"></span><span>      </span><span id="local-6989586621679876754"><span class="annot"><span class="annottext">txTreasuryDonation :: Maybe a
</span><a href="#local-6989586621679876754"><span class="hs-identifier hs-var hs-var">txTreasuryDonation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
-&gt; m (TxBodyContent BuildTx ConwayEra)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.TxBodyContent</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">[(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))]
[TxOut CtxTx ConwayEra]
Maybe (Featured ConwayEraOnwards ConwayEra (Maybe Coin))
Maybe (Featured ConwayEraOnwards ConwayEra Coin)
Maybe
  (Featured
     ConwayEraOnwards
     ConwayEra
     (TxProposalProcedures BuildTx ConwayEra))
Maybe
  (Featured
     ConwayEraOnwards ConwayEra (TxVotingProcedures BuildTx ConwayEra))
BuildTxWith BuildTx (Maybe (LedgerProtocolParameters ConwayEra))
TxScriptValidity ConwayEra
TxAuxScripts ConwayEra
TxCertificates BuildTx ConwayEra
TxExtraKeyWitnesses ConwayEra
TxFee ConwayEra
TxInsCollateral ConwayEra
TxInsReference BuildTx ConwayEra
TxMetadataInEra ConwayEra
TxMintValue BuildTx ConwayEra
TxReturnCollateral CtxTx ConwayEra
TxTotalCollateral ConwayEra
TxUpdateProposal ConwayEra
TxValidityLowerBound ConwayEra
TxValidityUpperBound ConwayEra
TxWithdrawals BuildTx ConwayEra
forall a. Maybe a
forall era. TxScriptValidity era
forall era. TxAuxScripts era
forall era. TxMetadataInEra era
forall era. TxUpdateProposal era
txIns :: [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))]
txInsReference :: TxInsReference BuildTx ConwayEra
txInsCollateral :: TxInsCollateral ConwayEra
txTotalCollateral :: TxTotalCollateral ConwayEra
txReturnCollateral :: TxReturnCollateral CtxTx ConwayEra
txOuts :: [TxOut CtxTx ConwayEra]
txValidityLowerBound :: TxValidityLowerBound ConwayEra
txValidityUpperBound :: TxValidityUpperBound ConwayEra
txMintValue :: TxMintValue BuildTx ConwayEra
txExtraKeyWits :: TxExtraKeyWitnesses ConwayEra
txProtocolParams :: BuildTxWith BuildTx (Maybe (LedgerProtocolParameters ConwayEra))
txProposalProcedures :: Maybe
  (Featured
     ConwayEraOnwards
     ConwayEra
     (TxProposalProcedures BuildTx ConwayEra))
txWithdrawals :: TxWithdrawals BuildTx ConwayEra
txCertificates :: TxCertificates BuildTx ConwayEra
txFee :: TxFee ConwayEra
txMetadata :: forall era. TxMetadataInEra era
txAuxScripts :: forall era. TxAuxScripts era
txUpdateProposal :: forall era. TxUpdateProposal era
txScriptValidity :: forall era. TxScriptValidity era
txVotingProcedures :: forall a. Maybe a
txCurrentTreasuryValue :: forall a. Maybe a
txTreasuryDonation :: forall a. Maybe a
txAuxScripts :: TxAuxScripts ConwayEra
txCertificates :: TxCertificates BuildTx ConwayEra
txCurrentTreasuryValue :: Maybe (Featured ConwayEraOnwards ConwayEra (Maybe Coin))
txExtraKeyWits :: TxExtraKeyWitnesses ConwayEra
txFee :: TxFee ConwayEra
txIns :: [(TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn ConwayEra))]
txInsCollateral :: TxInsCollateral ConwayEra
txInsReference :: TxInsReference BuildTx ConwayEra
txMetadata :: TxMetadataInEra ConwayEra
txMintValue :: TxMintValue BuildTx ConwayEra
txOuts :: [TxOut CtxTx ConwayEra]
txProposalProcedures :: Maybe
  (Featured
     ConwayEraOnwards
     ConwayEra
     (TxProposalProcedures BuildTx ConwayEra))
txProtocolParams :: BuildTxWith BuildTx (Maybe (LedgerProtocolParameters ConwayEra))
txReturnCollateral :: TxReturnCollateral CtxTx ConwayEra
txScriptValidity :: TxScriptValidity ConwayEra
txTotalCollateral :: TxTotalCollateral ConwayEra
txTreasuryDonation :: Maybe (Featured ConwayEraOnwards ConwayEra Coin)
txUpdateProposal :: TxUpdateProposal ConwayEra
txValidityLowerBound :: TxValidityLowerBound ConwayEra
txValidityUpperBound :: TxValidityUpperBound ConwayEra
txVotingProcedures :: Maybe
  (Featured
     ConwayEraOnwards ConwayEra (TxVotingProcedures BuildTx ConwayEra))
txWithdrawals :: TxWithdrawals BuildTx ConwayEra
</span><a href="#local-6989586621679876699"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="annot"><span class="hs-comment">-- | Generates a transaction body from a body content</span></span><span>
</span><span id="line-71"></span><span id="local-6989586621679876549"><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txBodyContentToTxBody"><span class="hs-identifier hs-type">txBodyContentToTxBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679876549"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.TxBodyContent</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.BuildTx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679876549"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cardano.TxBody</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-72"></span><span id="txBodyContentToTxBody"><span class="annot"><span class="annottext">txBodyContentToTxBody :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxBodyContent BuildTx ConwayEra -&gt; m (TxBody ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txBodyContentToTxBody"><span class="hs-identifier hs-var hs-var">txBodyContentToTxBody</span></a></span></span><span> </span><span id="local-6989586621679876786"><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
</span><a href="#local-6989586621679876786"><span class="hs-identifier hs-var">txBodyContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679876787"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679876787"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- We create the associated Shelley TxBody</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; m (TxBody ConwayEra))
-&gt; (TxBody ConwayEra -&gt; m (TxBody ConwayEra))
-&gt; Either ToCardanoError (TxBody ConwayEra)
-&gt; m (TxBody ConwayEra)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainError -&gt; m (TxBody ConwayEra)
forall a. MockChainError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; m (TxBody ConwayEra))
-&gt; (ToCardanoError -&gt; MockChainError)
-&gt; ToCardanoError
-&gt; m (TxBody ConwayEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ToCardanoError -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#MCEToCardanoError"><span class="hs-identifier hs-var">MCEToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;generateTx :&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">TxBody ConwayEra -&gt; m (TxBody ConwayEra)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Params
-&gt; CardanoBuildTx -&gt; Either ToCardanoError (TxBody ConwayEra)
</span><span class="hs-identifier hs-var">Emulator.createTransactionBody</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679876787"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra -&gt; CardanoBuildTx
</span><span class="hs-identifier hs-var">Ledger.CardanoBuildTx</span></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
</span><a href="#local-6989586621679876786"><span class="hs-identifier hs-var">txBodyContent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- | Generates an index with utxos known to a 'TxSkel'</span></span><span>
</span><span id="line-81"></span><span id="local-6989586621679876559"><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToIndex"><span class="hs-identifier hs-type">txSkelToIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679876559"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#Collaterals"><span class="hs-identifier hs-type">Collaterals</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679876559"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cardano.UTxO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-82"></span><span id="txSkelToIndex"><span class="annot"><span class="annottext">txSkelToIndex :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; Collaterals -&gt; m (UTxO ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToIndex"><span class="hs-identifier hs-var hs-var">txSkelToIndex</span></a></span></span><span> </span><span id="local-6989586621679876818"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876818"><span class="hs-identifier hs-var">txSkel</span></a></span></span><span> </span><span id="local-6989586621679876819"><span class="annot"><span class="annottext">Collaterals
</span><a href="#local-6989586621679876819"><span class="hs-identifier hs-var">mCollaterals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-comment">-- We build the index of UTxOs which are known to this skeleton. This includes</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- collateral inputs, inputs and reference inputs.</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679876820"><span class="annot"><span class="annottext">collateralIns :: [TxOutRef]
</span><a href="#local-6989586621679876820"><span class="hs-identifier hs-var hs-var">collateralIns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Collaterals
</span><a href="#local-6989586621679876819"><span class="hs-identifier hs-var">mCollaterals</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">Collaterals
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679876821"><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679876821"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Peer
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef -&gt; [TxOutRef]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
</span><a href="#local-6989586621679876821"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- We retrieve all the outputs known to the skeleton</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679876823"><span class="annot"><span class="annottext">[TxOutRef]
</span><a href="#local-6989586621679876823"><span class="hs-identifier hs-var">knownTxORefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679876824"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679876824"><span class="hs-identifier hs-var">knownTxOuts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(TxOutRef, TxSkelOut)] -&gt; ([TxOutRef], [TxSkelOut])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxSkelOut)] -&gt; ([TxOutRef], [TxSkelOut]))
-&gt; (Map TxOutRef TxSkelOut -&gt; [(TxOutRef, TxSkelOut)])
-&gt; Map TxOutRef TxSkelOut
-&gt; ([TxOutRef], [TxSkelOut])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelOut -&gt; [(TxOutRef, TxSkelOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxSkelOut -&gt; ([TxOutRef], [TxSkelOut]))
-&gt; m (Map TxOutRef TxSkelOut) -&gt; m ([TxOutRef], [TxSkelOut])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxOutRef] -&gt; m (Map TxOutRef TxSkelOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxSkelOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-var">lookupUtxos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set TxOutRef -&gt; [TxOutRef]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkel -&gt; Set TxOutRef
</span><a href="Cooked.Skeleton.html#txSkelKnownTxOutRefs"><span class="hs-identifier hs-var">txSkelKnownTxOutRefs</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876818"><span class="hs-identifier hs-var">txSkel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxOutRef] -&gt; [TxOutRef] -&gt; [TxOutRef]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxOutRef]
</span><a href="#local-6989586621679876820"><span class="hs-identifier hs-var">collateralIns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- We then compute their Cardano counterparts</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679876828"><span class="annot"><span class="annottext">[TxOut CtxTx ConwayEra]
</span><a href="#local-6989586621679876828"><span class="hs-identifier hs-var">txOutL</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
-&gt; (TxSkelOut -&gt; m (TxOut CtxTx ConwayEra))
-&gt; m [TxOut CtxTx ConwayEra]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679876824"><span class="hs-identifier hs-var">knownTxOuts</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; m (TxOut CtxTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkelOut -&gt; m (TxOut CtxTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Output.html#toCardanoTxOut"><span class="hs-identifier hs-var">toCardanoTxOut</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">-- We build the index and handle the possible error</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; m (UTxO ConwayEra))
-&gt; (UTxO ConwayEra -&gt; m (UTxO ConwayEra))
-&gt; Either ToCardanoError (UTxO ConwayEra)
-&gt; m (UTxO ConwayEra)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainError -&gt; m (UTxO ConwayEra)
forall a. MockChainError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; m (UTxO ConwayEra))
-&gt; (ToCardanoError -&gt; MockChainError)
-&gt; ToCardanoError
-&gt; m (UTxO ConwayEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ToCardanoError -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#MCEToCardanoError"><span class="hs-identifier hs-var">MCEToCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;txSkelToIndex:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxO ConwayEra -&gt; m (UTxO ConwayEra)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (UTxO ConwayEra) -&gt; m (UTxO ConwayEra))
-&gt; Either ToCardanoError (UTxO ConwayEra) -&gt; m (UTxO ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621679876830"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679876830"><span class="hs-identifier hs-var">txInL</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxOutRef]
-&gt; (TxOutRef -&gt; Either ToCardanoError TxIn)
-&gt; Either ToCardanoError [TxIn]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[TxOutRef]
</span><a href="#local-6989586621679876823"><span class="hs-identifier hs-var">knownTxORefs</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><span class="hs-identifier hs-var">Ledger.toCardanoTxIn</span></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">UTxO ConwayEra -&gt; Either ToCardanoError (UTxO ConwayEra)
forall a. a -&gt; Either ToCardanoError a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(UTxO ConwayEra -&gt; Either ToCardanoError (UTxO ConwayEra))
-&gt; UTxO ConwayEra -&gt; Either ToCardanoError (UTxO ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO ConwayEra) -&gt; UTxO ConwayEra
forall era. Map TxIn (TxOut CtxUTxO era) -&gt; UTxO era
</span><span class="hs-identifier hs-var">Cardano.UTxO</span></span><span> </span><span class="annot"><span class="annottext">(Map TxIn (TxOut CtxUTxO ConwayEra) -&gt; UTxO ConwayEra)
-&gt; Map TxIn (TxOut CtxUTxO ConwayEra) -&gt; UTxO ConwayEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(TxIn, TxOut CtxUTxO ConwayEra)]
-&gt; Map TxIn (TxOut CtxUTxO ConwayEra)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(TxIn, TxOut CtxUTxO ConwayEra)]
 -&gt; Map TxIn (TxOut CtxUTxO ConwayEra))
-&gt; [(TxIn, TxOut CtxUTxO ConwayEra)]
-&gt; Map TxIn (TxOut CtxUTxO ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TxIn]
-&gt; [TxOut CtxUTxO ConwayEra] -&gt; [(TxIn, TxOut CtxUTxO ConwayEra)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679876830"><span class="hs-identifier hs-var">txInL</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOut CtxUTxO ConwayEra] -&gt; [(TxIn, TxOut CtxUTxO ConwayEra)])
-&gt; [TxOut CtxUTxO ConwayEra] -&gt; [(TxIn, TxOut CtxUTxO ConwayEra)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx ConwayEra -&gt; TxOut CtxUTxO ConwayEra
forall era. TxOut CtxTx era -&gt; TxOut CtxUTxO era
</span><span class="hs-identifier hs-var">Cardano.toCtxUTxOTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx ConwayEra -&gt; TxOut CtxUTxO ConwayEra)
-&gt; [TxOut CtxTx ConwayEra] -&gt; [TxOut CtxUTxO ConwayEra]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxOut CtxTx ConwayEra]
</span><a href="#local-6989586621679876828"><span class="hs-identifier hs-var">txOutL</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- | Generates a transaction body from a 'TxSkel' and associated fee and</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- collateral information. This transaction body accounts for the actual</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- execution units of each of the scripts involved in the skeleton.</span><span>
</span><span id="line-100"></span><span id="local-6989586621679876580"><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBody"><span class="hs-identifier hs-type">txSkelToTxBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679876580"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#Fee"><span class="hs-identifier hs-type">Fee</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#Collaterals"><span class="hs-identifier hs-type">Collaterals</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679876580"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cardano.TxBody</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-101"></span><span id="txSkelToTxBody"><span class="annot"><span class="annottext">txSkelToTxBody :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; Fee -&gt; Collaterals -&gt; m (TxBody ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBody"><span class="hs-identifier hs-var hs-var">txSkelToTxBody</span></a></span></span><span> </span><span id="local-6989586621679876852"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876852"><span class="hs-identifier hs-var">txSkel</span></a></span></span><span> </span><span id="local-6989586621679876853"><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679876853"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span id="local-6989586621679876854"><span class="annot"><span class="annottext">Collaterals
</span><a href="#local-6989586621679876854"><span class="hs-identifier hs-var">mCollaterals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- We create a first body content and body, without execution units</span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679876855"><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
</span><a href="#local-6989586621679876855"><span class="hs-identifier hs-var">txBodyContent'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Fee -&gt; Collaterals -&gt; m (TxBodyContent BuildTx ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; Fee -&gt; Collaterals -&gt; m (TxBodyContent BuildTx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBodyContent"><span class="hs-identifier hs-var">txSkelToTxBodyContent</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876852"><span class="hs-identifier hs-var">txSkel</span></a></span><span> </span><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679876853"><span class="hs-identifier hs-var">fee</span></a></span><span> </span><span class="annot"><span class="annottext">Collaterals
</span><a href="#local-6989586621679876854"><span class="hs-identifier hs-var">mCollaterals</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679876856"><span class="annot"><span class="annottext">TxBody ConwayEra
</span><a href="#local-6989586621679876856"><span class="hs-identifier hs-var">txBody'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra -&gt; m (TxBody ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxBodyContent BuildTx ConwayEra -&gt; m (TxBody ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txBodyContentToTxBody"><span class="hs-identifier hs-var">txBodyContentToTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
</span><a href="#local-6989586621679876855"><span class="hs-identifier hs-var">txBodyContent'</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">-- We create a full transaction from the body</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679876857"><span class="annot"><span class="annottext">tx' :: Tx ConwayEra
</span><a href="#local-6989586621679876857"><span class="hs-identifier hs-var hs-var">tx'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxSkelSignatory] -&gt; TxBody ConwayEra -&gt; Tx ConwayEra
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSignatoriesAndBodyToCardanoTx"><span class="hs-identifier hs-var">txSignatoriesAndBodyToCardanoTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkel -&gt; [TxSkelSignatory]
</span><a href="Cooked.Skeleton.html#txSkelSignatories"><span class="hs-identifier hs-var">txSkelSignatories</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876852"><span class="hs-identifier hs-var">txSkel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxBody ConwayEra
</span><a href="#local-6989586621679876856"><span class="hs-identifier hs-var">txBody'</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- We retrieve the index and parameters to feed to @getTxExUnitsWithLogs@</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679876858"><span class="annot"><span class="annottext">UTxO ConwayEra
</span><a href="#local-6989586621679876858"><span class="hs-identifier hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Collaterals -&gt; m (UTxO ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; Collaterals -&gt; m (UTxO ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToIndex"><span class="hs-identifier hs-var">txSkelToIndex</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876852"><span class="hs-identifier hs-var">txSkel</span></a></span><span> </span><span class="annot"><span class="annottext">Collaterals
</span><a href="#local-6989586621679876854"><span class="hs-identifier hs-var">mCollaterals</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679876859"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679876859"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">-- We retrieve the execution units associated with the transaction</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Params
-&gt; UTxO ConwayEra
-&gt; Tx ConwayEra
-&gt; Either ValidationErrorInPhase RedeemerReport
</span><span class="hs-identifier hs-var">Emulator.getTxExUnitsWithLogs</span></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679876859"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO ConwayEra -&gt; UTxO ConwayEra
</span><span class="hs-identifier hs-var">Ledger.fromPlutusIndex</span></span><span> </span><span class="annot"><span class="annottext">UTxO ConwayEra
</span><a href="#local-6989586621679876858"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tx ConwayEra
</span><a href="#local-6989586621679876857"><span class="hs-identifier hs-var">tx'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- Computing the execution units can result in all kinds of validation</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- errors except for the ones related to the execution units themselves.</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679876862"><span class="annot"><span class="annottext">ValidationErrorInPhase
</span><a href="#local-6989586621679876862"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; m (TxBody ConwayEra)
forall a. MockChainError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; m (TxBody ConwayEra))
-&gt; MockChainError -&gt; m (TxBody ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ValidationPhase -&gt; ValidationError -&gt; MockChainError)
-&gt; ValidationErrorInPhase -&gt; MockChainError
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">ValidationPhase -&gt; ValidationError -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-var">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationErrorInPhase
</span><a href="#local-6989586621679876862"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- When no error arises, we get an execution unit for each script usage. We</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- first have to transform this Ledger map to a cardano API map.</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ConwayPlutusPurpose AsIx ConwayEra -&gt; ScriptWitnessIndex)
-&gt; Map (ConwayPlutusPurpose AsIx ConwayEra) ExecutionUnits
-&gt; Map ScriptWitnessIndex ExecutionUnits
forall k1 k2 a. (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">Map.mapKeysMonotonic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlonzoEraOnwards ConwayEra
-&gt; PlutusPurpose AsIx (ShelleyLedgerEra ConwayEra)
-&gt; ScriptWitnessIndex
forall era.
AlonzoEraOnwards era
-&gt; PlutusPurpose AsIx (ShelleyLedgerEra era) -&gt; ScriptWitnessIndex
</span><span class="hs-identifier hs-var">Cardano.toScriptIndex</span></span><span> </span><span class="annot"><span class="annottext">AlonzoEraOnwards ConwayEra
</span><span class="hs-identifier hs-var">Cardano.AlonzoEraOnwardsConway</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map (ConwayPlutusPurpose AsIx ConwayEra) ExecutionUnits
 -&gt; Map ScriptWitnessIndex ExecutionUnits)
-&gt; (Map (ConwayPlutusPurpose AsIx ConwayEra) ([Text], ExUnits)
    -&gt; Map (ConwayPlutusPurpose AsIx ConwayEra) ExecutionUnits)
-&gt; Map (ConwayPlutusPurpose AsIx ConwayEra) ([Text], ExUnits)
-&gt; Map ScriptWitnessIndex ExecutionUnits
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(([Text], ExUnits) -&gt; ExecutionUnits)
-&gt; Map (ConwayPlutusPurpose AsIx ConwayEra) ([Text], ExUnits)
-&gt; Map (ConwayPlutusPurpose AsIx ConwayEra) ExecutionUnits
forall a b.
(a -&gt; b)
-&gt; Map (ConwayPlutusPurpose AsIx ConwayEra) a
-&gt; Map (ConwayPlutusPurpose AsIx ConwayEra) b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExUnits -&gt; ExecutionUnits
</span><span class="hs-identifier hs-var">Cardano.fromAlonzoExUnits</span></span><span> </span><span class="annot"><span class="annottext">(ExUnits -&gt; ExecutionUnits)
-&gt; (([Text], ExUnits) -&gt; ExUnits)
-&gt; ([Text], ExUnits)
-&gt; ExecutionUnits
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Text], ExUnits) -&gt; ExUnits
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679876869"><span class="annot"><span class="annottext">Map ScriptWitnessIndex ExecutionUnits
</span><a href="#local-6989586621679876869"><span class="hs-identifier hs-var">exUnits</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-comment">-- We can then assign the right execution units to the body content</span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map ScriptWitnessIndex ExecutionUnits
-&gt; TxBodyContent BuildTx ConwayEra
-&gt; Either
     (TxBodyErrorAutoBalance ConwayEra)
     (TxBodyContent BuildTx ConwayEra)
forall era.
Map ScriptWitnessIndex ExecutionUnits
-&gt; TxBodyContent BuildTx era
-&gt; Either (TxBodyErrorAutoBalance era) (TxBodyContent BuildTx era)
</span><span class="hs-identifier hs-var">Cardano.substituteExecutionUnits</span></span><span> </span><span class="annot"><span class="annottext">Map ScriptWitnessIndex ExecutionUnits
</span><a href="#local-6989586621679876869"><span class="hs-identifier hs-var">exUnits</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
</span><a href="#local-6989586621679876855"><span class="hs-identifier hs-var">txBodyContent'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-comment">-- This can only be a @TxBodyErrorScriptWitnessIndexMissingFromExecUnitsMap@</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">TxBodyErrorAutoBalance ConwayEra
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; m (TxBody ConwayEra)
forall a. MockChainError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; m (TxBody ConwayEra))
-&gt; MockChainError -&gt; m (TxBody ConwayEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#FailWith"><span class="hs-identifier hs-var">FailWith</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error while assigning execution units&quot;</span></span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-comment">-- We now have a body content with proper execution units and can create</span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-comment">-- the final body from it</span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679876872"><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
</span><a href="#local-6989586621679876872"><span class="hs-identifier hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra -&gt; m (TxBody ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxBodyContent BuildTx ConwayEra -&gt; m (TxBody ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txBodyContentToTxBody"><span class="hs-identifier hs-var">txBodyContentToTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx ConwayEra
</span><a href="#local-6989586621679876872"><span class="hs-identifier hs-var">txBody</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="annot"><span class="hs-comment">-- | Generates a Cardano transaction and signs it</span></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSignatoriesAndBodyToCardanoTx"><span class="hs-identifier hs-type">txSignatoriesAndBodyToCardanoTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Skeleton.Signatory.html#TxSkelSignatory"><span class="hs-identifier hs-type">TxSkelSignatory</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.TxBody</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.Tx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span>
</span><span id="line-128"></span><span id="txSignatoriesAndBodyToCardanoTx"><span class="annot"><span class="annottext">txSignatoriesAndBodyToCardanoTx :: [TxSkelSignatory] -&gt; TxBody ConwayEra -&gt; Tx ConwayEra
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSignatoriesAndBodyToCardanoTx"><span class="hs-identifier hs-var hs-var">txSignatoriesAndBodyToCardanoTx</span></a></span></span><span> </span><span id="local-6989586621679876873"><span class="annot"><span class="annottext">[TxSkelSignatory]
</span><a href="#local-6989586621679876873"><span class="hs-identifier hs-var">signatories</span></a></span></span><span> </span><span id="local-6989586621679876874"><span class="annot"><span class="annottext">TxBody ConwayEra
</span><a href="#local-6989586621679876874"><span class="hs-identifier hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody ConwayEra -&gt; [KeyWitness ConwayEra] -&gt; Tx ConwayEra
forall era. TxBody era -&gt; [KeyWitness era] -&gt; Tx era
</span><span class="hs-identifier hs-var">Cardano.Tx</span></span><span> </span><span class="annot"><span class="annottext">TxBody ConwayEra
</span><a href="#local-6989586621679876874"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="annot"><span class="annottext">([KeyWitness ConwayEra] -&gt; Tx ConwayEra)
-&gt; [KeyWitness ConwayEra] -&gt; Tx ConwayEra
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TxSkelSignatory -&gt; Maybe (KeyWitness ConwayEra))
-&gt; [TxSkelSignatory] -&gt; [KeyWitness ConwayEra]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody ConwayEra -&gt; TxSkelSignatory -&gt; Maybe (KeyWitness ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Witness.html#toKeyWitness"><span class="hs-identifier hs-var">toKeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody ConwayEra
</span><a href="#local-6989586621679876874"><span class="hs-identifier hs-var">txBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxSkelSignatory]
</span><a href="#local-6989586621679876873"><span class="hs-identifier hs-var">signatories</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><span class="hs-comment">-- | Generates a full Cardano transaction from a skeleton, fees and collaterals</span></span><span>
</span><span id="line-131"></span><span id="local-6989586621679876616"><span class="annot"><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToCardanoTx"><span class="hs-identifier hs-type">txSkelToCardanoTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679876616"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#Fee"><span class="hs-identifier hs-type">Fee</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#Collaterals"><span class="hs-identifier hs-type">Collaterals</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679876616"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Cardano.Tx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cardano.ConwayEra</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-132"></span><span id="txSkelToCardanoTx"><span class="annot"><span class="annottext">txSkelToCardanoTx :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; Fee -&gt; Collaterals -&gt; m (Tx ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToCardanoTx"><span class="hs-identifier hs-var hs-var">txSkelToCardanoTx</span></a></span></span><span> </span><span id="local-6989586621679876885"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876885"><span class="hs-identifier hs-var">txSkel</span></a></span></span><span> </span><span id="local-6989586621679876886"><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679876886"><span class="hs-identifier hs-var">fee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxBody ConwayEra -&gt; Tx ConwayEra)
-&gt; m (TxBody ConwayEra) -&gt; m (Tx ConwayEra)
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxSkelSignatory] -&gt; TxBody ConwayEra -&gt; Tx ConwayEra
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSignatoriesAndBodyToCardanoTx"><span class="hs-identifier hs-var">txSignatoriesAndBodyToCardanoTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkel -&gt; [TxSkelSignatory]
</span><a href="Cooked.Skeleton.html#txSkelSignatories"><span class="hs-identifier hs-var">txSkelSignatories</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876885"><span class="hs-identifier hs-var">txSkel</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (TxBody ConwayEra) -&gt; m (Tx ConwayEra))
-&gt; (Collaterals -&gt; m (TxBody ConwayEra))
-&gt; Collaterals
-&gt; m (Tx ConwayEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Fee -&gt; Collaterals -&gt; m (TxBody ConwayEra)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; Fee -&gt; Collaterals -&gt; m (TxBody ConwayEra)
</span><a href="Cooked.MockChain.GenerateTx.Body.html#txSkelToTxBody"><span class="hs-identifier hs-var">txSkelToTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679876885"><span class="hs-identifier hs-var">txSkel</span></a></span><span> </span><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679876886"><span class="hs-identifier hs-var">fee</span></a></span><span>
</span><span id="line-133"></span></pre></body></html>
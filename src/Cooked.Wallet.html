<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- | This module defines convenient wrappers for mock chain wallets (around</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Plutus mock wallets) and initial distributions (that is the initial state</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- associating a list of UTxOs with some initial values to each known wallet).</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- It also exposes a convenient API to construct wallets and distributions,</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- manipulate them, and fetch information (such as public/private keys and</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- staking keys).</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Wallet</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#knownWallets"><span class="hs-identifier">knownWallets</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#wallet"><span class="hs-identifier">wallet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletPKHashToId"><span class="hs-identifier">walletPKHashToId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletPK"><span class="hs-identifier">walletPK</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletStakingPK"><span class="hs-identifier">walletStakingPK</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletPKHash"><span class="hs-identifier">walletPKHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletStakingPKHash"><span class="hs-identifier">walletStakingPKHash</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletAddress"><span class="hs-identifier">walletAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletSK"><span class="hs-identifier">walletSK</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#walletStakingSK"><span class="hs-identifier">walletStakingSK</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#initialDistribution"><span class="hs-identifier">initialDistribution</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier">InitialDistribution</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier">Wallet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Cooked.Wallet.html#PrivateKey"><span class="hs-identifier">PrivateKey</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Cardano.Crypto.Wallet.html"><span class="hs-identifier">Cardano.Crypto.Wallet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cardano</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Default.html"><span class="hs-identifier">Data.Default</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Function.html"><span class="hs-identifier">Data.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Function.html#on"><span class="hs-identifier">on</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.Address.html"><span class="hs-identifier">Ledger.Address</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.CardanoWallet.html"><span class="hs-identifier">Ledger.CardanoWallet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Credential</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Ledger.Crypto.html"><span class="hs-identifier">Ledger.Crypto</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Plutus.Script.Utils.Ada.html"><span class="hs-identifier">Plutus.Script.Utils.Ada</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../Plutus.Script.Utils.Value.html"><span class="hs-identifier">Plutus.Script.Utils.Value</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../Unsafe.Coerce.html"><span class="hs-identifier">Unsafe.Coerce</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- * MockChain Wallets</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- $mockchainwallets</span><span>
</span><span id="line-46"></span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Because the mock wallets from the plutus-apps change somewhat often, we</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- provide our own wrapper on top of them to make sure that we can easily deal</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- changes from Plutus.</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="Wallet"><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-var">Wallet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../Ledger.CardanoWallet.html#MockWallet"><span class="hs-identifier hs-type">Pl.MockWallet</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span id="PrivateKey"><span class="annot"><a href="Cooked.Wallet.html#PrivateKey"><span class="hs-identifier hs-var">PrivateKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">Cardano.XPrv</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679638024"><span class="annot"><a href="../GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621679638022"><span class="annot"><span class="annottext">== :: Wallet -&gt; Wallet -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest Blake2b_160 -&gt; Digest Blake2b_160 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">(Digest Blake2b_160 -&gt; Digest Blake2b_160 -&gt; Bool)
-&gt; (Wallet -&gt; Digest Blake2b_160) -&gt; Wallet -&gt; Wallet -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../Data.Function.html#on"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Digest Blake2b_160
</span><a href="../Ledger.CardanoWallet.html#mwWalletId"><span class="hs-identifier hs-var hs-var">Pl.mwWalletId</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679638007"><span id="local-6989586621679638009"><span id="local-6989586621679638011"><span id="local-6989586621679638013"><span id="local-6989586621679638015"><span id="local-6989586621679638017"><span class="annot"><a href="../GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679638005"><span class="annot"><span class="annottext">compare :: Wallet -&gt; Wallet -&gt; Ordering
</span><a href="../GHC.Classes.html#compare"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Digest Blake2b_160 -&gt; Digest Blake2b_160 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">(Digest Blake2b_160 -&gt; Digest Blake2b_160 -&gt; Ordering)
-&gt; (Wallet -&gt; Digest Blake2b_160) -&gt; Wallet -&gt; Wallet -&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../Data.Function.html#on"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Digest Blake2b_160
</span><a href="../Ledger.CardanoWallet.html#mwWalletId"><span class="hs-identifier hs-var hs-var">Pl.mwWalletId</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | All the wallets corresponding to known Plutus mock wallets. This is a list</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- of 10 wallets which will</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- - receive funds in the standard initial distribution of cooked-validators,</span><span>
</span><span id="line-65"></span><span class="hs-comment">--   and</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- - be pretty-printed as part the final state after running a few</span><span>
</span><span id="line-68"></span><span class="hs-comment">--   transactions.</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Cooked.Wallet.html#knownWallets"><span class="hs-identifier hs-type">knownWallets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span id="knownWallets"><span class="annot"><span class="annottext">knownWallets :: [Wallet]
</span><a href="Cooked.Wallet.html#knownWallets"><span class="hs-identifier hs-var hs-var">knownWallets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Wallet]
</span><a href="../Ledger.CardanoWallet.html#knownMockWallets"><span class="hs-identifier hs-var">Pl.knownMockWallets</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Wallet corresponding to a given wallet number (or wallet ID)</span><span>
</span><span id="line-73"></span><span class="annot"><a href="Cooked.Wallet.html#wallet"><span class="hs-identifier hs-type">wallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-74"></span><span id="wallet"><span class="annot"><span class="annottext">wallet :: Int -&gt; Wallet
</span><a href="Cooked.Wallet.html#wallet"><span class="hs-identifier hs-var hs-var">wallet</span></a></span></span><span> </span><span id="local-6989586621679638002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638002"><span class="hs-identifier hs-var">j</span></a></span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679637998"><span class="annot"><span class="annottext">i :: Int
</span><a href="#local-6989586621679637998"><span class="hs-identifier hs-var hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638002"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Wallet]
</span><a href="Cooked.Wallet.html#knownWallets"><span class="hs-identifier hs-var">knownWallets</span></a></span><span> </span><span class="annot"><span class="annottext">[Wallet] -&gt; Int -&gt; Wallet
forall a. [a] -&gt; Int -&gt; a
</span><a href="../GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679637998"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WalletNumber -&gt; Wallet
</span><a href="../Ledger.CardanoWallet.html#fromWalletNumber"><span class="hs-identifier hs-var">Pl.fromWalletNumber</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; WalletNumber
</span><a href="../Ledger.CardanoWallet.html#WalletNumber"><span class="hs-identifier hs-var">Pl.WalletNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; WalletNumber) -&gt; Integer -&gt; WalletNumber
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679638002"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Retrieves the id of the known wallet that corresponds to a public key</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- hash, if any.</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- @walletPKHashToId (walletPKHash (wallet 3)) == Just 3@</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Cooked.Wallet.html#walletPKHashToId"><span class="hs-identifier hs-type">walletPKHashToId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Crypto.html#PubKeyHash"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-83"></span><span id="walletPKHashToId"><span class="annot"><span class="annottext">walletPKHashToId :: PubKeyHash -&gt; Maybe Int
</span><a href="Cooked.Wallet.html#walletPKHashToId"><span class="hs-identifier hs-var hs-var">walletPKHashToId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; Map PubKeyHash Int -&gt; Maybe Int)
-&gt; Map PubKeyHash Int -&gt; PubKeyHash -&gt; Maybe Int
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Map PubKeyHash Int -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Map PubKeyHash Int
</span><a href="#local-6989586621679637992"><span class="hs-identifier hs-var">walletPKHashToIdMap</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679637992"><span class="annot"><span class="annottext">walletPKHashToIdMap :: Map PubKeyHash Int
</span><a href="#local-6989586621679637992"><span class="hs-identifier hs-var hs-var">walletPKHashToIdMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>      </span><span class="annot"><span class="annottext">[(PubKeyHash, Int)] -&gt; Map PubKeyHash Int
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(PubKeyHash, Int)] -&gt; Map PubKeyHash Int)
-&gt; ([Wallet] -&gt; [(PubKeyHash, Int)])
-&gt; [Wallet]
-&gt; Map PubKeyHash Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([PubKeyHash] -&gt; [Int] -&gt; [(PubKeyHash, Int)])
-&gt; [Int] -&gt; [PubKeyHash] -&gt; [(PubKeyHash, Int)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">[PubKeyHash] -&gt; [Int] -&gt; [(PubKeyHash, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([PubKeyHash] -&gt; [(PubKeyHash, Int)])
-&gt; ([Wallet] -&gt; [PubKeyHash]) -&gt; [Wallet] -&gt; [(PubKeyHash, Int)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Wallet -&gt; PubKeyHash) -&gt; [Wallet] -&gt; [PubKeyHash]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PubKeyHash
</span><a href="Cooked.Wallet.html#walletPKHash"><span class="hs-identifier hs-var">walletPKHash</span></a></span><span> </span><span class="annot"><span class="annottext">([Wallet] -&gt; Map PubKeyHash Int) -&gt; [Wallet] -&gt; Map PubKeyHash Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Wallet]
</span><a href="Cooked.Wallet.html#knownWallets"><span class="hs-identifier hs-var">knownWallets</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Retrieves a wallet public key (PK)</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Cooked.Wallet.html#walletPK"><span class="hs-identifier hs-type">walletPK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Ledger.Crypto.html#PubKey"><span class="hs-identifier hs-type">Pl.PubKey</span></a></span><span>
</span><span id="line-90"></span><span id="walletPK"><span class="annot"><span class="annottext">walletPK :: Wallet -&gt; PubKey
</span><a href="Cooked.Wallet.html#walletPK"><span class="hs-identifier hs-var hs-var">walletPK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentPubKey -&gt; PubKey
</span><a href="../Ledger.Address.html#unPaymentPubKey"><span class="hs-identifier hs-var hs-var">Pl.unPaymentPubKey</span></a></span><span> </span><span class="annot"><span class="annottext">(PaymentPubKey -&gt; PubKey)
-&gt; (Wallet -&gt; PaymentPubKey) -&gt; Wallet -&gt; PubKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PaymentPubKey
</span><a href="../Ledger.CardanoWallet.html#paymentPubKey"><span class="hs-identifier hs-var">Pl.paymentPubKey</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Retrieves a wallet's public staking key (PK), if any</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Cooked.Wallet.html#walletStakingPK"><span class="hs-identifier hs-type">walletStakingPK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../Ledger.Crypto.html#PubKey"><span class="hs-identifier hs-type">Pl.PubKey</span></a></span><span>
</span><span id="line-94"></span><span id="walletStakingPK"><span class="annot"><span class="annottext">walletStakingPK :: Wallet -&gt; Maybe PubKey
</span><a href="Cooked.Wallet.html#walletStakingPK"><span class="hs-identifier hs-var hs-var">walletStakingPK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; PubKey) -&gt; Maybe XPrv -&gt; Maybe PubKey
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv -&gt; PubKey
</span><a href="../Ledger.Crypto.html#toPublicKey"><span class="hs-identifier hs-var">Pl.toPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe XPrv -&gt; Maybe PubKey)
-&gt; (Wallet -&gt; Maybe XPrv) -&gt; Wallet -&gt; Maybe PubKey
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe XPrv
</span><a href="Cooked.Wallet.html#walletStakingSK"><span class="hs-identifier hs-var">walletStakingSK</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Retrieves a wallet's public key hash</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Cooked.Wallet.html#walletPKHash"><span class="hs-identifier hs-type">walletPKHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Crypto.html#PubKeyHash"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></a></span><span>
</span><span id="line-98"></span><span id="walletPKHash"><span class="annot"><span class="annottext">walletPKHash :: Wallet -&gt; PubKeyHash
</span><a href="Cooked.Wallet.html#walletPKHash"><span class="hs-identifier hs-var hs-var">walletPKHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PubKey -&gt; PubKeyHash
</span><a href="../Ledger.Crypto.html#pubKeyHash"><span class="hs-identifier hs-var">Pl.pubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">(PubKey -&gt; PubKeyHash)
-&gt; (Wallet -&gt; PubKey) -&gt; Wallet -&gt; PubKeyHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PubKey
</span><a href="Cooked.Wallet.html#walletPK"><span class="hs-identifier hs-var">walletPK</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | Retrieves a wallet's public staking key hash, if any</span><span>
</span><span id="line-101"></span><span class="annot"><a href="Cooked.Wallet.html#walletStakingPKHash"><span class="hs-identifier hs-type">walletStakingPKHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Crypto.html#PubKeyHash"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></a></span><span>
</span><span id="line-102"></span><span id="walletStakingPKHash"><span class="annot"><span class="annottext">walletStakingPKHash :: Wallet -&gt; Maybe PubKeyHash
</span><a href="Cooked.Wallet.html#walletStakingPKHash"><span class="hs-identifier hs-var hs-var">walletStakingPKHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PubKey -&gt; PubKeyHash) -&gt; Maybe PubKey -&gt; Maybe PubKeyHash
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">PubKey -&gt; PubKeyHash
</span><a href="../Ledger.Crypto.html#pubKeyHash"><span class="hs-identifier hs-var">Pl.pubKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe PubKey -&gt; Maybe PubKeyHash)
-&gt; (Wallet -&gt; Maybe PubKey) -&gt; Wallet -&gt; Maybe PubKeyHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe PubKey
</span><a href="Cooked.Wallet.html#walletStakingPK"><span class="hs-identifier hs-var">walletStakingPK</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Retrieves a wallet's address</span><span>
</span><span id="line-105"></span><span class="annot"><a href="Cooked.Wallet.html#walletAddress"><span class="hs-identifier hs-type">walletAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../Plutus.V1.Ledger.Address.html#Address"><span class="hs-identifier hs-type">Pl.Address</span></a></span><span>
</span><span id="line-106"></span><span id="walletAddress"><span class="annot"><span class="annottext">walletAddress :: Wallet -&gt; Address
</span><a href="Cooked.Wallet.html#walletAddress"><span class="hs-identifier hs-var hs-var">walletAddress</span></a></span></span><span> </span><span id="local-6989586621679637985"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679637985"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">Credential -&gt; Maybe StakingCredential -&gt; Address
</span><a href="../Plutus.V1.Ledger.Address.html#Address"><span class="hs-identifier hs-var">Pl.Address</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PubKeyHash -&gt; Credential
</span><a href="../Plutus.V1.Ledger.Credential.html#PubKeyCredential"><span class="hs-identifier hs-var">Pl.PubKeyCredential</span></a></span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; Credential) -&gt; PubKeyHash -&gt; Credential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PubKeyHash
</span><a href="Cooked.Wallet.html#walletPKHash"><span class="hs-identifier hs-var">walletPKHash</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679637985"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; StakingCredential
</span><a href="../Plutus.V1.Ledger.Credential.html#StakingHash"><span class="hs-identifier hs-var">Pl.StakingHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; StakingCredential)
-&gt; (PubKeyHash -&gt; Credential) -&gt; PubKeyHash -&gt; StakingCredential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Credential
</span><a href="../Plutus.V1.Ledger.Credential.html#PubKeyCredential"><span class="hs-identifier hs-var">Pl.PubKeyCredential</span></a></span><span> </span><span class="annot"><span class="annottext">(PubKeyHash -&gt; StakingCredential)
-&gt; Maybe PubKeyHash -&gt; Maybe StakingCredential
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe PubKeyHash
</span><a href="Cooked.Wallet.html#walletStakingPKHash"><span class="hs-identifier hs-var">walletStakingPKHash</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679637985"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Retrieves a wallet private key (secret key SK)</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Cooked.Wallet.html#walletSK"><span class="hs-identifier hs-type">walletSK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Ledger.CardanoWallet.html#MockWallet"><span class="hs-identifier hs-type">Pl.MockWallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#PrivateKey"><span class="hs-identifier hs-type">PrivateKey</span></a></span><span>
</span><span id="line-113"></span><span id="walletSK"><span class="annot"><span class="annottext">walletSK :: Wallet -&gt; XPrv
</span><a href="Cooked.Wallet.html#walletSK"><span class="hs-identifier hs-var hs-var">walletSK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentPrivateKey -&gt; XPrv
</span><a href="../Ledger.Address.html#unPaymentPrivateKey"><span class="hs-identifier hs-var hs-var">Pl.unPaymentPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">(PaymentPrivateKey -&gt; XPrv)
-&gt; (Wallet -&gt; PaymentPrivateKey) -&gt; Wallet -&gt; XPrv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; PaymentPrivateKey
</span><a href="../Ledger.CardanoWallet.html#paymentPrivateKey"><span class="hs-identifier hs-var">Pl.paymentPrivateKey</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- FIXME Massive hack to be able to open a 'MockPrivateKey'; this is needed</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- because the constructor and accessors to 'MockPrivateKey' are not exported.</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- Hence, we make an isomorphic datatype, 'unsafeCoerce' to this datatype then</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- extract whatever we need from it.</span><span>
</span><span id="line-119"></span><span class="hs-keyword">newtype</span><span> </span><span id="HACK"><span class="annot"><a href="Cooked.Wallet.html#HACK"><span class="hs-identifier hs-var">HACK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HACK"><span class="annot"><a href="Cooked.Wallet.html#HACK"><span class="hs-identifier hs-var">HACK</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#PrivateKey"><span class="hs-identifier hs-type">PrivateKey</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | Retrieves a wallet's private staking key (secret key SK), if any</span><span>
</span><span id="line-122"></span><span class="annot"><a href="Cooked.Wallet.html#walletStakingSK"><span class="hs-identifier hs-type">walletStakingSK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#PrivateKey"><span class="hs-identifier hs-type">PrivateKey</span></a></span><span>
</span><span id="line-123"></span><span id="walletStakingSK"><span class="annot"><span class="annottext">walletStakingSK :: Wallet -&gt; Maybe XPrv
</span><a href="Cooked.Wallet.html#walletStakingSK"><span class="hs-identifier hs-var hs-var">walletStakingSK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MockPrivateKey -&gt; XPrv) -&gt; Maybe MockPrivateKey -&gt; Maybe XPrv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">MockPrivateKey -&gt; XPrv
forall a. a -&gt; XPrv
</span><a href="#local-6989586621679637977"><span class="hs-identifier hs-var">hackUnMockPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe MockPrivateKey -&gt; Maybe XPrv)
-&gt; (Wallet -&gt; Maybe MockPrivateKey) -&gt; Wallet -&gt; Maybe XPrv
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; Maybe MockPrivateKey
</span><a href="../Ledger.CardanoWallet.html#mwStakeKey"><span class="hs-identifier hs-var hs-var">Pl.mwStakeKey</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">-- Make sure that you only apply it to @MockPrivateKey@; the function is</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- polymorphic because @MockPrivateKey@ is not exported either</span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679638063"><span class="annot"><a href="#local-6989586621679637977"><span class="hs-identifier hs-type">hackUnMockPrivateKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679638063"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#PrivateKey"><span class="hs-identifier hs-type">PrivateKey</span></a></span></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679637977"><span class="annot"><span class="annottext">hackUnMockPrivateKey :: a -&gt; XPrv
</span><a href="#local-6989586621679637977"><span class="hs-identifier hs-var hs-var">hackUnMockPrivateKey</span></a></span></span><span> </span><span id="local-6989586621679637975"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679637975"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#HACK"><span class="hs-identifier hs-type">HACK</span></a></span><span> </span><span id="local-6989586621679637974"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621679637974"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; HACK
forall a b. a -&gt; b
</span><a href="../Unsafe.Coerce.html#unsafeCoerce"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679637975"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621679637974"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- * Initial distribution of funds</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | Describes the initial distribution of UTxOs per wallet. This is important</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- since transaction validation must specify a /collateral/. Hence, wallets</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- must have more than one UTxO to begin with in order to execute a transaction</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- and have some collateral option. The @txCollateral@ is transferred to the</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- node operator in case the transaction fails to validate.</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">--  The following specifies a starting state where @wallet 1@ contains two</span><span>
</span><span id="line-139"></span><span class="hs-comment">--  UTxOs, one with 42 Ada and one with 2 Ada and one &quot;TOK&quot; token; @wallet 2@</span><span>
</span><span id="line-140"></span><span class="hs-comment">--  contains a single UTxO with 10 Ada and @wallet 3@ has 10 Ada and a</span><span>
</span><span id="line-141"></span><span class="hs-comment">--  permanent value. See &quot;Cooked.Currencies&quot; for more information on quick and</span><span>
</span><span id="line-142"></span><span class="hs-comment">--  permanent values.</span><span>
</span><span id="line-143"></span><span class="hs-comment">--</span><span>
</span><span id="line-144"></span><span class="hs-comment">--  &gt; i0 = InitialDistribution $ M.fromList</span><span>
</span><span id="line-145"></span><span class="hs-comment">--  &gt;        [ (wallet 1 , [ Pl.lovelaveValueOf 42000000</span><span>
</span><span id="line-146"></span><span class="hs-comment">--  &gt;                      , Pl.lovelaceValueOf 2000000 &lt;&gt; quickValue &quot;TOK&quot; 1</span><span>
</span><span id="line-147"></span><span class="hs-comment">--  &gt;                      ]</span><span>
</span><span id="line-148"></span><span class="hs-comment">--  &gt;        , (wallet 2 , [Pl.lovelaveValueOf 10000000])</span><span>
</span><span id="line-149"></span><span class="hs-comment">--  &gt;        , (wallet 3 , [Pl.lovelaceValueOf 10000000 &lt;&gt; permanentValue &quot;XYZ&quot; 10])</span><span>
</span><span id="line-150"></span><span class="hs-comment">--  &gt;        ]</span><span>
</span><span id="line-151"></span><span class="hs-keyword">newtype</span><span> </span><span id="InitialDistribution"><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-var">InitialDistribution</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InitialDistribution"><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-var">InitialDistribution</span></a></span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="unInitialDistribution"><span class="annot"><span class="annottext">InitialDistribution -&gt; Map Wallet [Value]
</span><a href="Cooked.Wallet.html#unInitialDistribution"><span class="hs-identifier hs-var hs-var">unInitialDistribution</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../Plutus.V1.Ledger.Value.html#Value"><span class="hs-identifier hs-type">Pl.Value</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679637967"><span id="local-6989586621679637969"><span class="annot"><span class="annottext">InitialDistribution -&gt; InitialDistribution -&gt; Bool
(InitialDistribution -&gt; InitialDistribution -&gt; Bool)
-&gt; (InitialDistribution -&gt; InitialDistribution -&gt; Bool)
-&gt; Eq InitialDistribution
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: InitialDistribution -&gt; InitialDistribution -&gt; Bool
$c/= :: InitialDistribution -&gt; InitialDistribution -&gt; Bool
== :: InitialDistribution -&gt; InitialDistribution -&gt; Bool
$c== :: InitialDistribution -&gt; InitialDistribution -&gt; Bool
</span><a href="../GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679637961"><span id="local-6989586621679637963"><span id="local-6989586621679637965"><span class="annot"><span class="annottext">Int -&gt; InitialDistribution -&gt; ShowS
[InitialDistribution] -&gt; ShowS
InitialDistribution -&gt; String
(Int -&gt; InitialDistribution -&gt; ShowS)
-&gt; (InitialDistribution -&gt; String)
-&gt; ([InitialDistribution] -&gt; ShowS)
-&gt; Show InitialDistribution
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [InitialDistribution] -&gt; ShowS
$cshowList :: [InitialDistribution] -&gt; ShowS
show :: InitialDistribution -&gt; String
$cshow :: InitialDistribution -&gt; String
showsPrec :: Int -&gt; InitialDistribution -&gt; ShowS
$cshowsPrec :: Int -&gt; InitialDistribution -&gt; ShowS
</span><a href="../GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679637955"><span id="local-6989586621679637957"><span class="annot"><a href="../GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span id="local-6989586621679637953"><span class="annot"><span class="annottext">Map Wallet [Value]
</span><a href="#local-6989586621679637953"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679637952"><span class="annot"><span class="annottext">&lt;&gt; :: InitialDistribution -&gt; InitialDistribution -&gt; InitialDistribution
</span><a href="../GHC.Base.html#%3C%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span id="local-6989586621679637951"><span class="annot"><span class="annottext">Map Wallet [Value]
</span><a href="#local-6989586621679637951"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="annottext">Map Wallet [Value] -&gt; InitialDistribution
</span><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-var">InitialDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Wallet [Value] -&gt; InitialDistribution)
-&gt; Map Wallet [Value] -&gt; InitialDistribution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; [Value] -&gt; [Value])
-&gt; Map Wallet [Value] -&gt; Map Wallet [Value] -&gt; Map Wallet [Value]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#unionWith"><span class="hs-identifier hs-var">Map.unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; [Value] -&gt; [Value]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet [Value]
</span><a href="#local-6989586621679637953"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet [Value]
</span><a href="#local-6989586621679637951"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679637944"><span id="local-6989586621679637946"><span class="annot"><a href="../GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679637942"><span class="annot"><span class="annottext">mempty :: InitialDistribution
</span><a href="../GHC.Base.html#mempty"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Wallet [Value] -&gt; InitialDistribution
</span><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-var">InitialDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">Map Wallet [Value]
forall k a. Map k a
</span><a href="../Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | 10 UTxOs with 100 Ada each, for each of the 'knownWallets'.</span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../Data.Default.Class.html#Default"><span class="hs-identifier hs-type">Default</span></a></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679637938"><span class="annot"><span class="annottext">def :: InitialDistribution
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">Map Wallet [Value] -&gt; InitialDistribution
</span><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-var">InitialDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Wallet [Value] -&gt; InitialDistribution)
-&gt; Map Wallet [Value] -&gt; InitialDistribution
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-167"></span><span>      </span><span class="annot"><span class="annottext">[(Wallet, [Value])] -&gt; Map Wallet [Value]
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Wallet, [Value])] -&gt; Map Wallet [Value])
-&gt; [(Wallet, [Value])] -&gt; Map Wallet [Value]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">[Wallet] -&gt; [[Value]] -&gt; [(Wallet, [Value])]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Wallet]
</span><a href="Cooked.Wallet.html#knownWallets"><span class="hs-identifier hs-var">knownWallets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Value] -&gt; [[Value]]
forall a. a -&gt; [a]
</span><a href="../GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; [[Value]]) -&gt; [Value] -&gt; [[Value]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value -&gt; [Value]
forall a. Int -&gt; a -&gt; [a]
</span><a href="../GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679637934"><span class="hs-identifier hs-var">defLovelace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>      </span><span id="local-6989586621679637934"><span class="annot"><span class="annottext">defLovelace :: Value
</span><a href="#local-6989586621679637934"><span class="hs-identifier hs-var hs-var">defLovelace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Value
</span><a href="../Plutus.Script.Utils.Ada.html#lovelaceValueOf"><span class="hs-identifier hs-var">Pl.lovelaceValueOf</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100_000_000</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><a href="Cooked.Wallet.html#distributionFromList"><span class="hs-identifier hs-type">distributionFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../Plutus.V1.Ledger.Value.html#Value"><span class="hs-identifier hs-type">Pl.Value</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span>
</span><span id="line-173"></span><span id="distributionFromList"><span class="annot"><span class="annottext">distributionFromList :: [(Wallet, [Value])] -&gt; InitialDistribution
</span><a href="Cooked.Wallet.html#distributionFromList"><span class="hs-identifier hs-var hs-var">distributionFromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Wallet [Value] -&gt; InitialDistribution
</span><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-var">InitialDistribution</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Wallet [Value] -&gt; InitialDistribution)
-&gt; ([(Wallet, [Value])] -&gt; Map Wallet [Value])
-&gt; [(Wallet, [Value])]
-&gt; InitialDistribution
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Wallet, [Value])] -&gt; Map Wallet [Value]
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><a href="Cooked.Wallet.html#initialDistribution"><span class="hs-identifier hs-type">initialDistribution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../Plutus.V1.Ledger.Value.html#Value"><span class="hs-identifier hs-type">Pl.Value</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span>
</span><span id="line-176"></span><span id="initialDistribution"><span class="annot"><span class="annottext">initialDistribution :: [(Wallet, [Value])] -&gt; InitialDistribution
</span><a href="Cooked.Wallet.html#initialDistribution"><span class="hs-identifier hs-var hs-var">initialDistribution</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><a href="../Data.Default.Class.html#def"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution -&gt; InitialDistribution -&gt; InitialDistribution
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InitialDistribution -&gt; InitialDistribution)
-&gt; ([(Wallet, [Value])] -&gt; InitialDistribution)
-&gt; [(Wallet, [Value])]
-&gt; InitialDistribution
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Wallet, [Value])] -&gt; InitialDistribution
</span><a href="Cooked.Wallet.html#distributionFromList"><span class="hs-identifier hs-var">distributionFromList</span></a></span><span>
</span><span id="line-177"></span></pre></body></html>
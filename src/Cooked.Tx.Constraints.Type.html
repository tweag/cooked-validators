<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_LhpZ8Xdrhwy4H1etz1y15O"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Tx.Constraints.Type</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unspentOutputs</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Credential</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Typed.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DatumType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RedeemerType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TypedValidator</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Eq</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Type.Reflection</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | A 'SpendableOut' is an outref that is ready to be spend; with its</span><span>
</span><span id="line-21"></span><span class="hs-comment">--  underlying 'Pl.ChainIndexTxOut'.</span><span>
</span><span id="line-22"></span><span class="hs-keyword">type</span><span> </span><span id="SpendableOut"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-var">SpendableOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ChainIndexTxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- | Accesses the 'Pl.Value' within a 'SpendableOut'</span><span>
</span><span id="line-25"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#sOutValue"><span class="hs-identifier hs-type">sOutValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-26"></span><span id="sOutValue"><span class="annot"><span class="annottext">sOutValue :: SpendableOut -&gt; Value
</span><a href="Cooked.Tx.Constraints.Type.html#sOutValue"><span class="hs-identifier hs-var hs-var">sOutValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><span class="hs-identifier hs-var hs-var">Pl.txOutValue</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value)
-&gt; (SpendableOut -&gt; TxOut) -&gt; SpendableOut -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; TxOut
</span><span class="hs-identifier hs-var">Pl.toTxOut</span></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTxOut -&gt; TxOut)
-&gt; (SpendableOut -&gt; ChainIndexTxOut) -&gt; SpendableOut -&gt; TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SpendableOut -&gt; ChainIndexTxOut
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">-- | Accesses the 'Pl.Address' within a 'SpendableOut'</span><span>
</span><span id="line-29"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#sOutAddress"><span class="hs-identifier hs-type">sOutAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span>
</span><span id="line-30"></span><span id="sOutAddress"><span class="annot"><span class="annottext">sOutAddress :: SpendableOut -&gt; Address
</span><a href="Cooked.Tx.Constraints.Type.html#sOutAddress"><span class="hs-identifier hs-var hs-var">sOutAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Address
</span><span class="hs-identifier hs-var hs-var">Pl.txOutAddress</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Address)
-&gt; (SpendableOut -&gt; TxOut) -&gt; SpendableOut -&gt; Address
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; TxOut
</span><span class="hs-identifier hs-var">Pl.toTxOut</span></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTxOut -&gt; TxOut)
-&gt; (SpendableOut -&gt; ChainIndexTxOut) -&gt; SpendableOut -&gt; TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SpendableOut -&gt; ChainIndexTxOut
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- | Accesses a potential 'Pl.DatumHash' within a 'SpendableOut'; note that</span><span>
</span><span id="line-33"></span><span class="hs-comment">--  the existence (or not) of a datum hash /DOES NOT/ indicate the 'SpendableOut'</span><span>
</span><span id="line-34"></span><span class="hs-comment">--  belongs to a script or a public key; you must pattern match on the result of</span><span>
</span><span id="line-35"></span><span class="hs-comment">--  'sOutAddress' or use one of 'sBelongsToPubKey' or 'sBelongsToScript' to distinguish that.</span><span>
</span><span id="line-36"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#sOutDatumHash"><span class="hs-identifier hs-type">sOutDatumHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumHash</span></span><span>
</span><span id="line-37"></span><span id="sOutDatumHash"><span class="annot"><span class="annottext">sOutDatumHash :: SpendableOut -&gt; Maybe DatumHash
</span><a href="Cooked.Tx.Constraints.Type.html#sOutDatumHash"><span class="hs-identifier hs-var hs-var">sOutDatumHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Maybe DatumHash
</span><span class="hs-identifier hs-var">Pl.txOutDatum</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Maybe DatumHash)
-&gt; (SpendableOut -&gt; TxOut) -&gt; SpendableOut -&gt; Maybe DatumHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; TxOut
</span><span class="hs-identifier hs-var">Pl.toTxOut</span></span><span> </span><span class="annot"><span class="annottext">(ChainIndexTxOut -&gt; TxOut)
-&gt; (SpendableOut -&gt; ChainIndexTxOut) -&gt; SpendableOut -&gt; TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SpendableOut -&gt; ChainIndexTxOut
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | If a 'SpendableOut' belongs to a public key, return its hash.</span><span>
</span><span id="line-40"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#sBelongsToPubKey"><span class="hs-identifier hs-type">sBelongsToPubKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span>
</span><span id="line-41"></span><span id="sBelongsToPubKey"><span class="annot"><span class="annottext">sBelongsToPubKey :: SpendableOut -&gt; Maybe PubKeyHash
</span><a href="Cooked.Tx.Constraints.Type.html#sBelongsToPubKey"><span class="hs-identifier hs-var hs-var">sBelongsToPubKey</span></a></span></span><span> </span><span id="local-6989586621679515859"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515859"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Credential
</span><span class="hs-identifier hs-var hs-var">Pl.addressCredential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpendableOut -&gt; Address
</span><a href="Cooked.Tx.Constraints.Type.html#sOutAddress"><span class="hs-identifier hs-var">sOutAddress</span></a></span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515859"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyCredential</span></span><span> </span><span id="local-6989586621679515856"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515856"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Maybe PubKeyHash
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515856"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><span class="annottext">Credential
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PubKeyHash
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | If a 'SpendableOut' belongs to a validator, return its hash.</span><span>
</span><span id="line-46"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#sBelongsToScript"><span class="hs-identifier hs-type">sBelongsToScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></span><span>
</span><span id="line-47"></span><span id="sBelongsToScript"><span class="annot"><span class="annottext">sBelongsToScript :: SpendableOut -&gt; Maybe ValidatorHash
</span><a href="Cooked.Tx.Constraints.Type.html#sBelongsToScript"><span class="hs-identifier hs-var hs-var">sBelongsToScript</span></a></span></span><span> </span><span id="local-6989586621679515854"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515854"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Credential
</span><span class="hs-identifier hs-var hs-var">Pl.addressCredential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpendableOut -&gt; Address
</span><a href="Cooked.Tx.Constraints.Type.html#sOutAddress"><span class="hs-identifier hs-var">sOutAddress</span></a></span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515854"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptCredential</span></span><span> </span><span id="local-6989586621679515852"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679515852"><span class="hs-identifier hs-var">sh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; Maybe ValidatorHash
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679515852"><span class="hs-identifier hs-var">sh</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">Credential
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ValidatorHash
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="SpendsConstrs"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsConstrs"><span class="hs-identifier hs-var">SpendsConstrs</span></a></span></span><span> </span><span id="local-6989586621679515850"><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515850"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">type</span><span> </span><span id="PaysScriptConstrs"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysScriptConstrs"><span class="hs-identifier hs-var">PaysScriptConstrs</span></a></span></span><span> </span><span id="local-6989586621679515848"><span class="annot"><a href="#local-6989586621679515848"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515848"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">type</span><span> </span><span id="MintsConstrs"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MintsConstrs"><span class="hs-identifier hs-var">MintsConstrs</span></a></span></span><span> </span><span id="local-6989586621679515847"><span class="annot"><a href="#local-6989586621679515847"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="annot"><a href="#local-6989586621679515847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679515847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679515847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515847"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Our own first-class constraint types. The advantage over the regular plutus constraint</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- type is that we get to add whatever we need and we hide away the type variables in existentials.</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | The main constraints datatype. It combines output constraints</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- ('OutConstraint') in a specific order that is respected by the generated</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- transaction, and miscellaneous constraints 'MiscConstraint' including input</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- constraints, time constraints, or signature requirements.</span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="Constraints"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-var">Constraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span class="hs-special">]</span><span> </span><span id="%3A%3D%3E%3A"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-var">:=&gt;:</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679515842"><span id="local-6989586621679515844"><span class="annot"><span class="annottext">Constraints -&gt; Constraints -&gt; Bool
(Constraints -&gt; Constraints -&gt; Bool)
-&gt; (Constraints -&gt; Constraints -&gt; Bool) -&gt; Eq Constraints
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Constraints -&gt; Constraints -&gt; Bool
$c/= :: Constraints -&gt; Constraints -&gt; Bool
== :: Constraints -&gt; Constraints -&gt; Bool
$c== :: Constraints -&gt; Constraints -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679515836"><span id="local-6989586621679515838"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679515834"><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679515834"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-type">:=&gt;:</span></a></span><span> </span><span id="local-6989586621679515833"><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679515833"><span class="hs-identifier hs-var">oc1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679515832"><span class="annot"><span class="annottext">&lt;&gt; :: Constraints -&gt; Constraints -&gt; Constraints
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679515831"><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679515831"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-type">:=&gt;:</span></a></span><span> </span><span id="local-6989586621679515830"><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679515830"><span class="hs-identifier hs-var">oc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679515834"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">[MiscConstraint] -&gt; [MiscConstraint] -&gt; [MiscConstraint]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679515831"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MiscConstraint] -&gt; [OutConstraint] -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-var">:=&gt;:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679515833"><span class="hs-identifier hs-var">oc1</span></a></span><span> </span><span class="annot"><span class="annottext">[OutConstraint] -&gt; [OutConstraint] -&gt; [OutConstraint]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679515830"><span class="hs-identifier hs-var">oc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679515824"><span id="local-6989586621679515826"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679515822"><span class="annot"><span class="annottext">mempty :: Constraints
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MiscConstraint] -&gt; [OutConstraint] -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-var">:=&gt;:</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Constraints which do not specify new transaction outputs</span><span>
</span><span id="line-92"></span><span class="hs-keyword">data</span><span> </span><span id="MiscConstraint"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-var">MiscConstraint</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- | Ensure that the given 'Pl.TypedValidator' spends a specific UTxO (which</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">-- must belong to the validator). That is: Unlock the UTxO described by the</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">-- given pair of 'SpendableOut' and 'Pl.DatumType', passing the given redeemer</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">-- to the validator script.</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679515821"><span id="SpendsScript"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsScript"><span class="hs-identifier hs-var">SpendsScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsConstrs"><span class="hs-identifier hs-type">SpendsConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515821"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679515821"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515821"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515821"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">-- | Ensure that a 'Pl.PubKeyHash' spends a specific UTxO. The hash is not an</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">-- argument since it can be read off the given 'SpendableOut'.</span><span>
</span><span id="line-105"></span><span>  </span><span id="SpendsPK"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsPK"><span class="hs-identifier hs-var">SpendsPK</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">-- | Ensure that the transaction mints the given 'Pl.Value'. For each</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- 'Pl.CurrencySymbol' in the value that is to be minted, the given list of</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- 'Pl.MintingPolicy's has to include the policy governing that currency</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">-- symbol. The @Maybe a@-argument is the optional redeemer passed to the</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">-- policies: If you pass @Nothing@, the constraint is translated using</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">-- 'Pl.mustMintValue', which uses no redeemer; if you pass @Just r@,</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-comment">-- 'Pl.mustMintValueWithRedeemer' is used to pass @r@ as a redeemer to the</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- policies.</span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621679515818"><span id="Mints"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Mints"><span class="hs-identifier hs-var">Mints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MintsConstrs"><span class="hs-identifier hs-type">MintsConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515818"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679515818"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">-- | Ensure that the transaction happens before the given time.</span><span>
</span><span id="line-121"></span><span>  </span><span id="Before"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Before"><span class="hs-identifier hs-var">Before</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-comment">-- | Ensure that the transaction happens after the given time.</span><span>
</span><span id="line-123"></span><span>  </span><span id="After"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#After"><span class="hs-identifier hs-var">After</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">-- | Ensure that the transaction happens in the given time range.</span><span>
</span><span id="line-125"></span><span>  </span><span id="ValidateIn"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ValidateIn"><span class="hs-identifier hs-var">ValidateIn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTimeRange</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">-- | Ensure that the transaction is signed by the given 'Pl.PubKeyHash'es.</span><span>
</span><span id="line-127"></span><span>  </span><span id="SignedBy"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SignedBy"><span class="hs-identifier hs-var">SignedBy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- NB don't forget to update the Eq instance when adding new constructors</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#~%2A~%3F"><span class="hs-operator hs-type">(~*~?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679515913"><span class="annot"><a href="#local-6989586621679515913"><span class="hs-identifier hs-type">ty</span></a></span></span><span> </span><span id="local-6989586621679515915"><span class="annot"><a href="#local-6989586621679515915"><span class="hs-identifier hs-type">a1</span></a></span></span><span> </span><span id="local-6989586621679515914"><span class="annot"><a href="#local-6989586621679515914"><span class="hs-identifier hs-type">a2</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515915"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515914"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515913"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515915"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515913"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515914"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679515915"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:~~:</span></span><span> </span><span class="annot"><a href="#local-6989586621679515914"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="annot"><span class="annottext">ty a1
</span><span class="hs-identifier">_</span></span><span> </span><span id="~%2A~%3F"><span class="annot"><span class="annottext">~*~? :: ty a1 -&gt; ty a2 -&gt; Maybe (a1 :~~: a2)
</span><a href="Cooked.Tx.Constraints.Type.html#~%2A~%3F"><span class="hs-operator hs-var hs-var">~*~?</span></a></span></span><span> </span><span class="annot"><span class="annottext">ty a2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Typeable a1 =&gt; TypeRep a1
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679515915"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep a1 -&gt; TypeRep a2 -&gt; Maybe (a1 :~~: a2)
forall k1 k2 (a :: k1) (b :: k2).
TypeRep a -&gt; TypeRep b -&gt; Maybe (a :~~: b)
</span><span class="hs-operator hs-var">`eqTypeRep`</span></span><span> </span><span class="annot"><span class="annottext">Typeable a2 =&gt; TypeRep a2
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679515914"><span class="hs-identifier hs-type">a2</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679515807"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsScript"><span class="hs-identifier hs-type">SpendsScript</span></a></span><span> </span><span id="local-6989586621679515806"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515806"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679515805"><span class="annot"><span class="annottext">RedeemerType a
</span><a href="#local-6989586621679515805"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679515804"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515804"><span class="hs-identifier hs-var">so1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679515803"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679515803"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679515802"><span class="annot"><span class="annottext">== :: MiscConstraint -&gt; MiscConstraint -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsScript"><span class="hs-identifier hs-type">SpendsScript</span></a></span><span> </span><span id="local-6989586621679515801"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515801"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span id="local-6989586621679515800"><span class="annot"><span class="annottext">RedeemerType a
</span><a href="#local-6989586621679515800"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679515799"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515799"><span class="hs-identifier hs-var">so2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679515798"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679515798"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515806"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; TypedValidator a -&gt; Maybe (a :~~: a)
forall (ty :: * -&gt; *) a1 a2.
(Typeable a1, Typeable a2) =&gt;
ty a1 -&gt; ty a2 -&gt; Maybe (a1 :~~: a2)
</span><a href="Cooked.Tx.Constraints.Type.html#~%2A~%3F"><span class="hs-operator hs-var">~*~?</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515801"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~~: a
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515806"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515804"><span class="hs-identifier hs-var">so1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TypedValidator a, SpendableOut)
-&gt; (TypedValidator a, SpendableOut) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator a
TypedValidator a
</span><a href="#local-6989586621679515801"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515799"><span class="hs-identifier hs-var">so2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RedeemerType a
</span><a href="#local-6989586621679515805"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679515803"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RedeemerType a, DatumType a)
-&gt; (RedeemerType a, DatumType a) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">Pl.==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RedeemerType a
RedeemerType a
</span><a href="#local-6989586621679515800"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DatumType a
DatumType a
</span><a href="#local-6989586621679515798"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">Maybe (a :~~: a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsPK"><span class="hs-identifier hs-type">SpendsPK</span></a></span><span> </span><span id="local-6989586621679515794"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515794"><span class="hs-identifier hs-var">so1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendsPK"><span class="hs-identifier hs-type">SpendsPK</span></a></span><span> </span><span id="local-6989586621679515793"><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515793"><span class="hs-identifier hs-var">so2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515794"><span class="hs-identifier hs-var">so1</span></a></span><span> </span><span class="annot"><span class="annottext">SpendableOut -&gt; SpendableOut -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">SpendableOut
</span><a href="#local-6989586621679515793"><span class="hs-identifier hs-var">so2</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Mints"><span class="hs-identifier hs-type">Mints</span></a></span><span> </span><span id="local-6989586621679515792"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515792"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679515791"><span class="annot"><span class="annottext">[MintingPolicy]
</span><a href="#local-6989586621679515791"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679515790"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515790"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Mints"><span class="hs-identifier hs-type">Mints</span></a></span><span> </span><span id="local-6989586621679515789"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515789"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span id="local-6989586621679515788"><span class="annot"><span class="annottext">[MintingPolicy]
</span><a href="#local-6989586621679515788"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679515787"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515787"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515792"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe (a :~~: a)
forall (ty :: * -&gt; *) a1 a2.
(Typeable a1, Typeable a2) =&gt;
ty a1 -&gt; ty a2 -&gt; Maybe (a1 :~~: a2)
</span><a href="Cooked.Tx.Constraints.Type.html#~%2A~%3F"><span class="hs-operator hs-var">~*~?</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515789"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~~: a
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MintingPolicy]
</span><a href="#local-6989586621679515791"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515790"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([MintingPolicy], Value) -&gt; ([MintingPolicy], Value) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MintingPolicy]
</span><a href="#local-6989586621679515788"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515787"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515792"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">Pl.==</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
Maybe a
</span><a href="#local-6989586621679515789"><span class="hs-identifier hs-var">d2</span></a></span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">Maybe (a :~~: a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Before"><span class="hs-identifier hs-type">Before</span></a></span><span> </span><span id="local-6989586621679515786"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515786"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Before"><span class="hs-identifier hs-type">Before</span></a></span><span> </span><span id="local-6989586621679515785"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515785"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515786"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515785"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#After"><span class="hs-identifier hs-type">After</span></a></span><span> </span><span id="local-6989586621679515784"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515784"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#After"><span class="hs-identifier hs-type">After</span></a></span><span> </span><span id="local-6989586621679515783"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515783"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515784"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679515783"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ValidateIn"><span class="hs-identifier hs-type">ValidateIn</span></a></span><span> </span><span id="local-6989586621679515782"><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621679515782"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ValidateIn"><span class="hs-identifier hs-type">ValidateIn</span></a></span><span> </span><span id="local-6989586621679515781"><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621679515781"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621679515782"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange -&gt; POSIXTimeRange -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange
</span><a href="#local-6989586621679515781"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SignedBy"><span class="hs-identifier hs-type">SignedBy</span></a></span><span> </span><span id="local-6989586621679515780"><span class="annot"><span class="annottext">[PubKeyHash]
</span><a href="#local-6989586621679515780"><span class="hs-identifier hs-var">hs1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SignedBy"><span class="hs-identifier hs-type">SignedBy</span></a></span><span> </span><span id="local-6989586621679515779"><span class="annot"><span class="annottext">[PubKeyHash]
</span><a href="#local-6989586621679515779"><span class="hs-identifier hs-var">hs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PubKeyHash]
</span><a href="#local-6989586621679515780"><span class="hs-identifier hs-var">hs1</span></a></span><span> </span><span class="annot"><span class="annottext">[PubKeyHash] -&gt; [PubKeyHash] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[PubKeyHash]
</span><a href="#local-6989586621679515779"><span class="hs-identifier hs-var">hs2</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">MiscConstraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">MiscConstraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Constraints which specify new transaction outputs</span><span>
</span><span id="line-151"></span><span class="hs-keyword">data</span><span> </span><span id="OutConstraint"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-var">OutConstraint</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- | Creates an UTxO to the given validator, with the given datum</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- and the given value. That is, lets the scirpt lock the given</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- value.</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679515778"><span id="PaysScript"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysScript"><span class="hs-identifier hs-var">PaysScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysScriptConstrs"><span class="hs-identifier hs-type">PaysScriptConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515778"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679515778"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679515778"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">-- | Creates a UTxO to a specific 'Pl.PubKeyHash' with a potential 'Pl.StakePubKeyHash'.</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- and datum. If the stake pk is present, it will call 'Ledger.Constraints.OffChain.ownStakePubKeyHash'</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- to update the script lookups, hence, generating a transaction with /two/ 'PaysPKWithDatum' with</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-comment">-- two different staking keys will cause the first staking key to be overriden by calling @ownStakePubKeyHash@</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- a second time. If this is an issue for you, please do submit an issue with an explanation on GitHub.</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679515776"><span id="PaysPKWithDatum"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysPKWithDatum"><span class="hs-identifier hs-var">PaysPKWithDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="annot"><a href="#local-6989586621679515776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679515776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679515776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515776"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.StakePubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679515776"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- NB don't forget to update the Eq instance when adding new constructors</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679515772"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysScript"><span class="hs-identifier hs-type">PaysScript</span></a></span><span> </span><span id="local-6989586621679515771"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515771"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679515770"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679515770"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679515769"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515769"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679515768"><span class="annot"><span class="annottext">== :: OutConstraint -&gt; OutConstraint -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysScript"><span class="hs-identifier hs-type">PaysScript</span></a></span><span> </span><span id="local-6989586621679515767"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515767"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span id="local-6989586621679515766"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679515766"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span id="local-6989586621679515765"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515765"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515771"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; TypedValidator a -&gt; Maybe (a :~~: a)
forall (ty :: * -&gt; *) a1 a2.
(Typeable a1, Typeable a2) =&gt;
ty a1 -&gt; ty a2 -&gt; Maybe (a1 :~~: a2)
</span><a href="Cooked.Tx.Constraints.Type.html#~%2A~%3F"><span class="hs-operator hs-var">~*~?</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515767"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~~: a
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679515771"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515769"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TypedValidator a, Value) -&gt; (TypedValidator a, Value) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator a
TypedValidator a
</span><a href="#local-6989586621679515767"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515765"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679515770"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">DatumType a -&gt; DatumType a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">Pl.==</span></span><span> </span><span class="annot"><span class="annottext">DatumType a
DatumType a
</span><a href="#local-6989586621679515766"><span class="hs-identifier hs-var">d2</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">Maybe (a :~~: a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysPKWithDatum"><span class="hs-identifier hs-type">PaysPKWithDatum</span></a></span><span> </span><span id="local-6989586621679515764"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515764"><span class="hs-identifier hs-var">pk1</span></a></span></span><span> </span><span id="local-6989586621679515763"><span class="annot"><span class="annottext">Maybe StakePubKeyHash
</span><a href="#local-6989586621679515763"><span class="hs-identifier hs-var">stake1</span></a></span></span><span> </span><span id="local-6989586621679515762"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515762"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679515761"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515761"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#PaysPKWithDatum"><span class="hs-identifier hs-type">PaysPKWithDatum</span></a></span><span> </span><span id="local-6989586621679515760"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515760"><span class="hs-identifier hs-var">pk2</span></a></span></span><span> </span><span id="local-6989586621679515759"><span class="annot"><span class="annottext">Maybe StakePubKeyHash
</span><a href="#local-6989586621679515759"><span class="hs-identifier hs-var">stake2</span></a></span></span><span> </span><span id="local-6989586621679515758"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515758"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span id="local-6989586621679515757"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515757"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515762"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe (a :~~: a)
forall (ty :: * -&gt; *) a1 a2.
(Typeable a1, Typeable a2) =&gt;
ty a1 -&gt; ty a2 -&gt; Maybe (a1 :~~: a2)
</span><a href="Cooked.Tx.Constraints.Type.html#~%2A~%3F"><span class="hs-operator hs-var">~*~?</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515758"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~~: a
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515764"><span class="hs-identifier hs-var">pk1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe StakePubKeyHash
</span><a href="#local-6989586621679515763"><span class="hs-identifier hs-var">stake1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515761"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PubKeyHash, Maybe StakePubKeyHash, Value)
-&gt; (PubKeyHash, Maybe StakePubKeyHash, Value) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515760"><span class="hs-identifier hs-var">pk2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe StakePubKeyHash
</span><a href="#local-6989586621679515759"><span class="hs-identifier hs-var">stake2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679515757"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679515762"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">Pl.==</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
Maybe a
</span><a href="#local-6989586621679515758"><span class="hs-identifier hs-var">d2</span></a></span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">Maybe (a :~~: a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="annottext">OutConstraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OutConstraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | This typeclass provides user-friendly convenience to overload the</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- 'txConstraints' field of 'TxSkel'. For instance, this enables us to ommit the '(:=&gt;:)'</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- constructor whenever we're using only one kind of constraints.</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- It also opens up future alternative of constraint specification.</span><span>
</span><span id="line-191"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679515899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515899"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ConstraintsSpec"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-var">ConstraintsSpec</span></a></span></span><span> </span><span id="local-6989586621679515899"><span class="annot"><a href="#local-6989586621679515899"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span id="toConstraints"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#toConstraints"><span class="hs-identifier hs-type">toConstraints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679515899"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679515751"><span class="annot"><span class="annottext">toConstraints :: Constraints -&gt; Constraints
</span><a href="#local-6989586621679515751"><span class="hs-identifier hs-var hs-var hs-var hs-var">toConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; Constraints
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679515746"><span class="annot"><span class="annottext">toConstraints :: [MiscConstraint] -&gt; Constraints
</span><a href="#local-6989586621679515746"><span class="hs-identifier hs-var hs-var hs-var hs-var">toConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MiscConstraint] -&gt; [OutConstraint] -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-var">:=&gt;:</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679515742"><span class="annot"><span class="annottext">toConstraints :: MiscConstraint -&gt; Constraints
</span><a href="#local-6989586621679515742"><span class="hs-identifier hs-var hs-var hs-var hs-var">toConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MiscConstraint] -&gt; Constraints
forall a. ConstraintsSpec a =&gt; a -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#toConstraints"><span class="hs-identifier hs-var">toConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">([MiscConstraint] -&gt; Constraints)
-&gt; (MiscConstraint -&gt; [MiscConstraint])
-&gt; MiscConstraint
-&gt; Constraints
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MiscConstraint -&gt; [MiscConstraint] -&gt; [MiscConstraint]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679515738"><span class="annot"><span class="annottext">toConstraints :: [OutConstraint] -&gt; Constraints
</span><a href="#local-6989586621679515738"><span class="hs-identifier hs-var hs-var hs-var hs-var">toConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MiscConstraint] -&gt; [OutConstraint] -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-var">:=&gt;:</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679515734"><span class="annot"><span class="annottext">toConstraints :: OutConstraint -&gt; Constraints
</span><a href="#local-6989586621679515734"><span class="hs-identifier hs-var hs-var hs-var hs-var">toConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OutConstraint] -&gt; Constraints
forall a. ConstraintsSpec a =&gt; a -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#toConstraints"><span class="hs-identifier hs-var">toConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">([OutConstraint] -&gt; Constraints)
-&gt; (OutConstraint -&gt; [OutConstraint])
-&gt; OutConstraint
-&gt; Constraints
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OutConstraint -&gt; [OutConstraint] -&gt; [OutConstraint]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#paysPK"><span class="hs-identifier hs-type">paysPK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#OutConstraint"><span class="hs-identifier hs-type">OutConstraint</span></a></span><span>
</span><span id="line-210"></span><span id="paysPK"><span class="annot"><span class="annottext">paysPK :: PubKeyHash -&gt; Value -&gt; OutConstraint
</span><a href="Cooked.Tx.Constraints.Type.html#paysPK"><span class="hs-identifier hs-var hs-var">paysPK</span></a></span></span><span> </span><span id="local-6989586621679515732"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515732"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PubKeyHash
-&gt; Maybe StakePubKeyHash -&gt; Maybe () -&gt; Value -&gt; OutConstraint
forall a.
(ToData a, Eq a, Show a, Typeable a) =&gt;
PubKeyHash
-&gt; Maybe StakePubKeyHash -&gt; Maybe a -&gt; Value -&gt; OutConstraint
</span><a href="Cooked.Tx.Constraints.Type.html#PaysPKWithDatum"><span class="hs-identifier hs-var">PaysPKWithDatum</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679515732"><span class="hs-identifier hs-var">pkh</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakePubKeyHash
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#mints"><span class="hs-identifier hs-type">mints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#MiscConstraint"><span class="hs-identifier hs-type">MiscConstraint</span></a></span><span>
</span><span id="line-213"></span><span id="mints"><span class="annot"><span class="annottext">mints :: [MintingPolicy] -&gt; Value -&gt; MiscConstraint
</span><a href="Cooked.Tx.Constraints.Type.html#mints"><span class="hs-identifier hs-var hs-var">mints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; [MintingPolicy] -&gt; Value -&gt; MiscConstraint
forall a.
MintsConstrs a =&gt;
Maybe a -&gt; [MintingPolicy] -&gt; Value -&gt; MiscConstraint
</span><a href="Cooked.Tx.Constraints.Type.html#Mints"><span class="hs-identifier hs-var">Mints</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">type</span><span> </span><span id="LabelConstrs"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#LabelConstrs"><span class="hs-identifier hs-var">LabelConstrs</span></a></span></span><span> </span><span id="local-6989586621679515730"><span class="annot"><a href="#local-6989586621679515730"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679515730"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679515730"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679515730"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | A Transaction skeleton is a set of our constraints,</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- and an optional showable label, which is useful when displaying</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- traces. The label was encoded as an existential to enable us to</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- create ad-hoc datatypes and pass their values around, for instance:</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- &gt; data ProposePaymentLbl = ProposePayment Value deriving Show</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- &gt; f = ... (txSkelLbl (ProposePayment val) ...) ...</span><span>
</span><span id="line-224"></span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- This way we can (A) modify the show behavior if we want and (B)</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- not worry about constructing consistent strings when constructing transactions</span><span>
</span><span id="line-227"></span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- A TxSkel does /NOT/ include a Wallet since wallets only exist in mock mode.</span><span>
</span><span id="line-229"></span><span class="hs-keyword">data</span><span> </span><span id="TxSkel"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-var">TxSkel</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679515729"><span id="TxSkel"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-var">TxSkel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#LabelConstrs"><span class="hs-identifier hs-type">LabelConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515729"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="txLabel"><span class="annot"><span class="annottext">()
</span><a href="Cooked.Tx.Constraints.Type.html#txLabel"><span class="hs-identifier hs-var hs-var">txLabel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679515729"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>      </span><span class="hs-comment">-- | Set of options to use when generating this transaction.</span><span>
</span><span id="line-234"></span><span>      </span><span id="txOpts"><span class="annot"><span class="annottext">TxSkel -&gt; TxOpts
</span><a href="Cooked.Tx.Constraints.Type.html#txOpts"><span class="hs-identifier hs-var hs-var">txOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>      </span><span id="txConstraints"><span class="annot"><span class="annottext">TxSkel -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#txConstraints"><span class="hs-identifier hs-var hs-var">txConstraints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679515722"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span id="local-6989586621679515721"><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679515721"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679515720"><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515720"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621679515719"><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679515719"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span id="local-6989586621679515718"><span class="annot"><span class="annottext">== :: TxSkel -&gt; TxSkel -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span id="local-6989586621679515717"><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679515717"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span id="local-6989586621679515716"><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515716"><span class="hs-identifier hs-var">o2</span></a></span></span><span> </span><span id="local-6989586621679515715"><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679515715"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679515721"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe x -&gt; Maybe (x :~~: x)
forall (ty :: * -&gt; *) a1 a2.
(Typeable a1, Typeable a2) =&gt;
ty a1 -&gt; ty a2 -&gt; Maybe (a1 :~~: a2)
</span><a href="Cooked.Tx.Constraints.Type.html#~%2A~%3F"><span class="hs-operator hs-var">~*~?</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679515717"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">x :~~: x
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679515721"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515720"><span class="hs-identifier hs-var">o1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679515719"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe x, TxOpts, Constraints)
-&gt; (Maybe x, TxOpts, Constraints) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe x
Maybe x
</span><a href="#local-6989586621679515717"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515716"><span class="hs-identifier hs-var">o2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679515715"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">Maybe (x :~~: x)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Constructs a skeleton without a default label and with default 'TxOpts'</span><span>
</span><span id="line-246"></span><span id="local-6989586621679515714"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#txSkel"><span class="hs-identifier hs-type">txSkel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515714"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515714"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span></span><span>
</span><span id="line-247"></span><span id="txSkel"><span class="annot"><span class="annottext">txSkel :: constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkel"><span class="hs-identifier hs-var hs-var">txSkel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; constraints -&gt; TxSkel
forall constraints.
ConstraintsSpec constraints =&gt;
TxOpts -&gt; constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkelOpts"><span class="hs-identifier hs-var">txSkelOpts</span></a></span><span> </span><span class="annot"><span class="annottext">TxOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | Constructs a skeleton without a default label, but with custom options</span><span>
</span><span id="line-250"></span><span id="local-6989586621679515888"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#txSkelOpts"><span class="hs-identifier hs-type">txSkelOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515888"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515888"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span></span><span>
</span><span id="line-251"></span><span id="txSkelOpts"><span class="annot"><span class="annottext">txSkelOpts :: TxOpts -&gt; constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkelOpts"><span class="hs-identifier hs-var hs-var">txSkelOpts</span></a></span></span><span> </span><span id="local-6989586621679515710"><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515710"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679515709"><span class="annot"><span class="annottext">constraints
</span><a href="#local-6989586621679515709"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; TxOpts -&gt; Constraints -&gt; TxSkel
forall x.
LabelConstrs x =&gt;
Maybe x -&gt; TxOpts -&gt; Constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-var">TxSkel</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515710"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">constraints -&gt; Constraints
forall a. ConstraintsSpec a =&gt; a -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#toConstraints"><span class="hs-identifier hs-var">toConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">constraints
</span><a href="#local-6989586621679515709"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Constructs a skeleton with a label</span><span>
</span><span id="line-254"></span><span id="local-6989586621679515707"><span id="local-6989586621679515708"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#txSkelLbl"><span class="hs-identifier hs-type">txSkelLbl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#LabelConstrs"><span class="hs-identifier hs-type">LabelConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515708"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515707"><span class="hs-identifier hs-type">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515708"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515707"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span></span></span><span>
</span><span id="line-255"></span><span id="txSkelLbl"><span class="annot"><span class="annottext">txSkelLbl :: x -&gt; constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkelLbl"><span class="hs-identifier hs-var hs-var">txSkelLbl</span></a></span></span><span> </span><span id="local-6989586621679515705"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679515705"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; TxOpts -&gt; Constraints -&gt; TxSkel
forall x.
LabelConstrs x =&gt;
Maybe x -&gt; TxOpts -&gt; Constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-var">TxSkel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Maybe x
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679515705"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">(Constraints -&gt; TxSkel)
-&gt; (constraints -&gt; Constraints) -&gt; constraints -&gt; TxSkel
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">constraints -&gt; Constraints
forall a. ConstraintsSpec a =&gt; a -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#toConstraints"><span class="hs-identifier hs-var">toConstraints</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | Constructs a skeleton with the given labtl, options, and constraints</span><span>
</span><span id="line-258"></span><span id="local-6989586621679515703"><span id="local-6989586621679515704"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#txSkelLblOpts"><span class="hs-identifier hs-type">txSkelLblOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#LabelConstrs"><span class="hs-identifier hs-type">LabelConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515704"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679515703"><span class="hs-identifier hs-type">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515704"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679515703"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span></span></span><span>
</span><span id="line-259"></span><span id="txSkelLblOpts"><span class="annot"><span class="annottext">txSkelLblOpts :: x -&gt; TxOpts -&gt; constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkelLblOpts"><span class="hs-identifier hs-var hs-var">txSkelLblOpts</span></a></span></span><span> </span><span id="local-6989586621679515701"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679515701"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679515700"><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515700"><span class="hs-identifier hs-var">os</span></a></span></span><span> </span><span id="local-6989586621679515699"><span class="annot"><span class="annottext">constraints
</span><a href="#local-6989586621679515699"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; TxOpts -&gt; Constraints -&gt; TxSkel
forall x.
LabelConstrs x =&gt;
Maybe x -&gt; TxOpts -&gt; Constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-var">TxSkel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Maybe x
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679515701"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679515700"><span class="hs-identifier hs-var">os</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">constraints -&gt; Constraints
forall a. ConstraintsSpec a =&gt; a -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#toConstraints"><span class="hs-identifier hs-var">toConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">constraints
</span><a href="#local-6989586621679515699"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Set of options to modify the behavior of generating and validating some transaction. Some of these</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- options only have an effect when running in the 'Plutus.Contract.Contract', some only have an effect when</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- running in 'MockChainT'. If nothing is explicitely stated, the option has an effect independently of the</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- running context.</span><span>
</span><span id="line-265"></span><span class="hs-keyword">data</span><span> </span><span id="TxOpts"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-var">TxOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxOpts"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-var">TxOpts</span></a></span></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Performs an adjustment to unbalanced txs, making sure every UTxO that is produced</span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-comment">--  has the necessary minimum amount of Ada.</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- By default, this is set to @False@, given this is the default behavior in Plutus:</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- https://github.com/input-output-hk/plutus-apps/issues/143#issuecomment-1013012744</span><span>
</span><span id="line-271"></span><span>    </span><span id="adjustUnbalTx"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#adjustUnbalTx"><span class="hs-identifier hs-var hs-var">adjustUnbalTx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- | When submitting a transaction for real (i.e., running in the 'Plutus.Contract.Contract' monad),</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-comment">--  it is common to call 'Plutus.Contract.Request.awaitTxConfirmed' after 'Plutus.Contract.Request.submitTxConstraints'.</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-comment">--  If you /do NOT/ wish to do so, please set this to @False@.</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">--  /This has NO effect when running outside of 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">--  By default, this is set to @True@.</span><span>
</span><span id="line-278"></span><span>    </span><span id="awaitTxConfirmed"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#awaitTxConfirmed"><span class="hs-identifier hs-var hs-var">awaitTxConfirmed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- | Whether to increase the slot counter automatically on this submission.</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- This is useful for modelling transactions that could be submitted in parallel in reality, so there</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-comment">-- should be no explicit ordering of what comes first. One good example is in the Crowdfunding use case contract.</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-comment">--  By default, this is set to @True@.</span><span>
</span><span id="line-285"></span><span>    </span><span id="autoSlotIncrease"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#autoSlotIncrease"><span class="hs-identifier hs-var hs-var">autoSlotIncrease</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-comment">-- | Reorders the transaction outputs to fit the ordering of output</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-comment">-- constraints. Those outputs are put at the very beginning of the list.</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-comment">--  By default, this is set to @True@.</span><span>
</span><span id="line-290"></span><span>    </span><span id="forceOutputOrdering"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#forceOutputOrdering"><span class="hs-identifier hs-var hs-var">forceOutputOrdering</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- | Applies an arbitrary modification to a transaction after it has been pottentially adjusted ('adjustUnbalTx')</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-comment">-- and balanced. This is prefixed with /unsafe/ to draw attention that modifying a transaction at</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-comment">-- that stage might make it invalid. Still, this offers a hook for being able to alter a transaction</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-comment">-- in unforeseen ways. It is mostly used to test contracts that have been written for custom PABs.</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-comment">-- One interesting use of this function is to observe a transaction just before it is being</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-comment">-- sent for validation, with @unsafeModTx = RawModTx Debug.Trace.traceShowId@.</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-comment">-- By default, this is set to 'Id'.</span><span>
</span><span id="line-301"></span><span>    </span><span id="unsafeModTx"><span class="annot"><span class="annottext">TxOpts -&gt; RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#unsafeModTx"><span class="hs-identifier hs-var hs-var">unsafeModTx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-comment">-- | Whether to balance the transaction or not. Balancing is the process of ensuring that</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-comment">--  @input + mint = output + fees@, if you decide to set @balance = false@ you will have trouble</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-comment">-- satisfying that equation by hand because @fees@ are variable. You will likely see a @ValueNotPreserved@ error</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-comment">-- and should adjust the fees accordingly. For now, there is no option to skip the fee computation because</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-comment">-- without it, validation through &quot;Ledger.Validation&quot; would fail with @InsufficientFees@.</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-comment">-- By default, this is set to @True@.</span><span>
</span><span id="line-310"></span><span>    </span><span id="balance"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#balance"><span class="hs-identifier hs-var hs-var">balance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-comment">-- | Which collateral utxo to use for this transaction. A collateral UTxO must be an Ada-only utxo</span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-comment">-- and can be specified manually, or it can be chosen automatically, if any is available.</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-comment">-- By default, this is set to @CollateralAuto@.</span><span>
</span><span id="line-316"></span><span>    </span><span id="collateral"><span class="annot"><span class="annottext">TxOpts -&gt; Collateral
</span><a href="Cooked.Tx.Constraints.Type.html#collateral"><span class="hs-identifier hs-var hs-var">collateral</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Collateral"><span class="hs-identifier hs-type">Collateral</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-comment">-- | The 'BalanceOutputPolicy' to apply when balancing the transaction.</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-comment">-- By default, this is set to @AdjustExistingOutput@.</span><span>
</span><span id="line-321"></span><span>    </span><span id="balanceOutputPolicy"><span class="annot"><span class="annottext">TxOpts -&gt; BalanceOutputPolicy
</span><a href="Cooked.Tx.Constraints.Type.html#balanceOutputPolicy"><span class="hs-identifier hs-var hs-var">balanceOutputPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#BalanceOutputPolicy"><span class="hs-identifier hs-type">BalanceOutputPolicy</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679515686"><span id="local-6989586621679515688"><span class="annot"><span class="annottext">TxOpts -&gt; TxOpts -&gt; Bool
(TxOpts -&gt; TxOpts -&gt; Bool)
-&gt; (TxOpts -&gt; TxOpts -&gt; Bool) -&gt; Eq TxOpts
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TxOpts -&gt; TxOpts -&gt; Bool
$c/= :: TxOpts -&gt; TxOpts -&gt; Bool
== :: TxOpts -&gt; TxOpts -&gt; Bool
$c== :: TxOpts -&gt; TxOpts -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679515680"><span id="local-6989586621679515682"><span id="local-6989586621679515684"><span class="annot"><span class="annottext">Int -&gt; TxOpts -&gt; ShowS
[TxOpts] -&gt; ShowS
TxOpts -&gt; String
(Int -&gt; TxOpts -&gt; ShowS)
-&gt; (TxOpts -&gt; String) -&gt; ([TxOpts] -&gt; ShowS) -&gt; Show TxOpts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TxOpts] -&gt; ShowS
$cshowList :: [TxOpts] -&gt; ShowS
show :: TxOpts -&gt; String
$cshow :: TxOpts -&gt; String
showsPrec :: Int -&gt; TxOpts -&gt; ShowS
$cshowsPrec :: Int -&gt; TxOpts -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | Whether to adjust existing public key outputs during</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- transaction balancing.</span><span>
</span><span id="line-327"></span><span class="hs-keyword">data</span><span> </span><span id="BalanceOutputPolicy"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#BalanceOutputPolicy"><span class="hs-identifier hs-var">BalanceOutputPolicy</span></a></span></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Try to adjust an existing public key output with the change. If no</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-comment">--   suitable output can be found, create a new change output.</span><span>
</span><span id="line-330"></span><span>    </span><span id="AdjustExistingOutput"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#AdjustExistingOutput"><span class="hs-identifier hs-var">AdjustExistingOutput</span></a></span></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Do not change the existing outputs, always create a new change</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-comment">--   output.</span><span>
</span><span id="line-333"></span><span>    </span><span id="DontAdjustExistingOutput"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#DontAdjustExistingOutput"><span class="hs-identifier hs-var">DontAdjustExistingOutput</span></a></span></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679515673"><span id="local-6989586621679515675"><span class="annot"><span class="annottext">BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
(BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; Eq BalanceOutputPolicy
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c/= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
== :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c== :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679515658"><span id="local-6989586621679515660"><span id="local-6989586621679515662"><span id="local-6989586621679515664"><span id="local-6989586621679515666"><span id="local-6989586621679515668"><span id="local-6989586621679515670"><span class="annot"><span class="annottext">Eq BalanceOutputPolicy
Eq BalanceOutputPolicy
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy
    -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy)
-&gt; (BalanceOutputPolicy
    -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy)
-&gt; Ord BalanceOutputPolicy
BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering
BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
$cmin :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
max :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
$cmax :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
&gt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&gt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
&gt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&gt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
&lt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&lt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
&lt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&lt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
compare :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering
$ccompare :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering
$cp1Ord :: Eq BalanceOutputPolicy
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679515651"><span id="local-6989586621679515653"><span id="local-6989586621679515655"><span class="annot"><span class="annottext">Int -&gt; BalanceOutputPolicy -&gt; ShowS
[BalanceOutputPolicy] -&gt; ShowS
BalanceOutputPolicy -&gt; String
(Int -&gt; BalanceOutputPolicy -&gt; ShowS)
-&gt; (BalanceOutputPolicy -&gt; String)
-&gt; ([BalanceOutputPolicy] -&gt; ShowS)
-&gt; Show BalanceOutputPolicy
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BalanceOutputPolicy] -&gt; ShowS
$cshowList :: [BalanceOutputPolicy] -&gt; ShowS
show :: BalanceOutputPolicy -&gt; String
$cshow :: BalanceOutputPolicy -&gt; String
showsPrec :: Int -&gt; BalanceOutputPolicy -&gt; ShowS
$cshowsPrec :: Int -&gt; BalanceOutputPolicy -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- IMPORTANT INTERNAL: If you add or remove fields from 'TxOpts', make sure</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- to update the internal @fields@ value from 'Cooked.Tx.Constraints.Pretty'</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- | Wraps a function that can be applied to a transaction right before submitting it.</span><span>
</span><span id="line-340"></span><span class="hs-comment">--  We have a distinguished datatype to be able to provide a little more info on</span><span>
</span><span id="line-341"></span><span class="hs-comment">--  the show instance.</span><span>
</span><span id="line-342"></span><span class="hs-keyword">data</span><span> </span><span id="RawModTx"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-var">RawModTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Id"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Id"><span class="hs-identifier hs-var">Id</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="RawModTx"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-var">RawModTx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Tx</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#applyRawModTx"><span class="hs-identifier hs-type">applyRawModTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Tx</span></span><span>
</span><span id="line-345"></span><span id="applyRawModTx"><span class="annot"><span class="annottext">applyRawModTx :: RawModTx -&gt; Tx -&gt; Tx
</span><a href="Cooked.Tx.Constraints.Type.html#applyRawModTx"><span class="hs-identifier hs-var hs-var">applyRawModTx</span></a></span></span><span> </span><span class="annot"><span class="annottext">RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span id="local-6989586621679515647"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679515647"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679515647"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-346"></span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#applyRawModTx"><span class="hs-identifier hs-var">applyRawModTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span><span> </span><span id="local-6989586621679515646"><span class="annot"><span class="annottext">Tx -&gt; Tx
</span><a href="#local-6989586621679515646"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679515645"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679515645"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx -&gt; Tx
</span><a href="#local-6989586621679515646"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679515645"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679515642"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="annottext">RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span id="local-6989586621679515641"><span class="annot"><span class="annottext">== :: RawModTx -&gt; RawModTx -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><span class="annottext">RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><span class="annottext">RawModTx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RawModTx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679515636"><span id="local-6989586621679515639"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679515635"><span class="annot"><span class="annottext">show :: RawModTx -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="annot"><span class="annottext">RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Id&quot;</span></span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; Tx
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RawModTx&quot;</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Specifies how to select the collateral input</span><span>
</span><span id="line-357"></span><span class="hs-keyword">data</span><span> </span><span id="Collateral"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Collateral"><span class="hs-identifier hs-var">Collateral</span></a></span></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Will select the first Ada-only UTxO we find belonging to 'ownPaymentPubKeyHash'</span><span>
</span><span id="line-359"></span><span>    </span><span id="CollateralAuto"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#CollateralAuto"><span class="hs-identifier hs-var">CollateralAuto</span></a></span></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Will use the 'Pl.TxOutRef's given in the list. This list can be empty, in which case</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-comment">--  no collateral will be used whatsoever.</span><span>
</span><span id="line-362"></span><span>    </span><span id="CollateralUtxos"><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#CollateralUtxos"><span class="hs-identifier hs-var">CollateralUtxos</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679515628"><span id="local-6989586621679515630"><span class="annot"><span class="annottext">Collateral -&gt; Collateral -&gt; Bool
(Collateral -&gt; Collateral -&gt; Bool)
-&gt; (Collateral -&gt; Collateral -&gt; Bool) -&gt; Eq Collateral
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Collateral -&gt; Collateral -&gt; Bool
$c/= :: Collateral -&gt; Collateral -&gt; Bool
== :: Collateral -&gt; Collateral -&gt; Bool
$c== :: Collateral -&gt; Collateral -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679515622"><span id="local-6989586621679515624"><span id="local-6989586621679515626"><span class="annot"><span class="annottext">Int -&gt; Collateral -&gt; ShowS
[Collateral] -&gt; ShowS
Collateral -&gt; String
(Int -&gt; Collateral -&gt; ShowS)
-&gt; (Collateral -&gt; String)
-&gt; ([Collateral] -&gt; ShowS)
-&gt; Show Collateral
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Collateral] -&gt; ShowS
$cshowList :: [Collateral] -&gt; ShowS
show :: Collateral -&gt; String
$cshow :: Collateral -&gt; String
showsPrec :: Int -&gt; Collateral -&gt; ShowS
$cshowsPrec :: Int -&gt; Collateral -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679515619"><span class="annot"><span class="annottext">def :: TxOpts
</span><a href="#local-6989586621679515619"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">TxOpts :: Bool
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; RawModTx
-&gt; Bool
-&gt; Collateral
-&gt; BalanceOutputPolicy
-&gt; TxOpts
</span><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">adjustUnbalTx :: Bool
</span><a href="Cooked.Tx.Constraints.Type.html#adjustUnbalTx"><span class="hs-identifier hs-var">adjustUnbalTx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">awaitTxConfirmed :: Bool
</span><a href="Cooked.Tx.Constraints.Type.html#awaitTxConfirmed"><span class="hs-identifier hs-var">awaitTxConfirmed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><span class="annottext">autoSlotIncrease :: Bool
</span><a href="Cooked.Tx.Constraints.Type.html#autoSlotIncrease"><span class="hs-identifier hs-var">autoSlotIncrease</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">forceOutputOrdering :: Bool
</span><a href="Cooked.Tx.Constraints.Type.html#forceOutputOrdering"><span class="hs-identifier hs-var">forceOutputOrdering</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><span class="annottext">unsafeModTx :: RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#unsafeModTx"><span class="hs-identifier hs-var">unsafeModTx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawModTx
</span><a href="Cooked.Tx.Constraints.Type.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><span class="annottext">balance :: Bool
</span><a href="Cooked.Tx.Constraints.Type.html#balance"><span class="hs-identifier hs-var">balance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><span class="annottext">collateral :: Collateral
</span><a href="Cooked.Tx.Constraints.Type.html#collateral"><span class="hs-identifier hs-var">collateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collateral
</span><a href="Cooked.Tx.Constraints.Type.html#CollateralAuto"><span class="hs-identifier hs-var">CollateralAuto</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">balanceOutputPolicy :: BalanceOutputPolicy
</span><a href="Cooked.Tx.Constraints.Type.html#balanceOutputPolicy"><span class="hs-identifier hs-var">balanceOutputPolicy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BalanceOutputPolicy
</span><a href="Cooked.Tx.Constraints.Type.html#AdjustExistingOutput"><span class="hs-identifier hs-var">AdjustExistingOutput</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.UtxoState</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Currencies.html"><span class="hs-identifier">Cooked.Currencies</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html"><span class="hs-identifier">Cooked.MockChain.Wallet</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">H</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intersperse</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Ada</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ada</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Credential</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Numeric</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Doc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PP</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- | A 'UtxoState' provides us with the mental picture of the state of the UTxO graph:</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- Each address has a set of UTxOs that consist in a value and some potential datum.</span><span>
</span><span id="line-25"></span><span class="hs-keyword">newtype</span><span> </span><span id="UtxoState"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-var">UtxoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UtxoState"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-var">UtxoState</span></a></span></span><span> </span><span class="hs-special">{</span><span id="utxoState"><span class="annot"><span class="annottext">UtxoState -&gt; Map Address UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#utxoState"><span class="hs-identifier hs-var hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565729"><span id="local-6989586621679565731"><span class="annot"><span class="annottext">UtxoState -&gt; UtxoState -&gt; Bool
(UtxoState -&gt; UtxoState -&gt; Bool)
-&gt; (UtxoState -&gt; UtxoState -&gt; Bool) -&gt; Eq UtxoState
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: UtxoState -&gt; UtxoState -&gt; Bool
$c/= :: UtxoState -&gt; UtxoState -&gt; Bool
== :: UtxoState -&gt; UtxoState -&gt; Bool
$c== :: UtxoState -&gt; UtxoState -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679565723"><span id="local-6989586621679565725"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span id="local-6989586621679565721"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565721"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679565720"><span class="annot"><span class="annottext">&lt;&gt; :: UtxoState -&gt; UtxoState -&gt; UtxoState
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span id="local-6989586621679565719"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565719"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet -&gt; UtxoState
</span><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-var">UtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet -&gt; UtxoState)
-&gt; Map Address UtxoValueSet -&gt; UtxoState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(UtxoValueSet -&gt; UtxoValueSet -&gt; UtxoValueSet)
-&gt; Map Address UtxoValueSet
-&gt; Map Address UtxoValueSet
-&gt; Map Address UtxoValueSet
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unionWith</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; UtxoValueSet -&gt; UtxoValueSet
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565721"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565719"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | Represents a /set/ of values, yet, we use a list instead of a set because 'Pl.Value'</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- doesn't implement 'Ord' and because it is possible that we want to distinguish between utxo states</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- that have additional utxos, even if these could have been merged together.</span><span>
</span><span id="line-34"></span><span class="hs-keyword">newtype</span><span> </span><span id="UtxoValueSet"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-var">UtxoValueSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UtxoValueSet"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-var">UtxoValueSet</span></a></span></span><span> </span><span class="hs-special">{</span><span id="utxoValueSet"><span class="annot"><span class="annottext">UtxoValueSet -&gt; [(Value, Maybe UtxoDatum)]
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSet"><span class="hs-identifier hs-var hs-var">utxoValueSet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoDatum"><span class="hs-identifier hs-type">UtxoDatum</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565710"><span id="local-6989586621679565712"><span id="local-6989586621679565714"><span class="annot"><span class="annottext">Int -&gt; UtxoValueSet -&gt; ShowS
[UtxoValueSet] -&gt; ShowS
UtxoValueSet -&gt; String
(Int -&gt; UtxoValueSet -&gt; ShowS)
-&gt; (UtxoValueSet -&gt; String)
-&gt; ([UtxoValueSet] -&gt; ShowS)
-&gt; Show UtxoValueSet
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [UtxoValueSet] -&gt; ShowS
$cshowList :: [UtxoValueSet] -&gt; ShowS
show :: UtxoValueSet -&gt; String
$cshow :: UtxoValueSet -&gt; String
showsPrec :: Int -&gt; UtxoValueSet -&gt; ShowS
$cshowsPrec :: Int -&gt; UtxoValueSet -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679565706"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span id="local-6989586621679565705"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565705"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679565704"><span class="annot"><span class="annottext">== :: UtxoValueSet -&gt; UtxoValueSet -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span id="local-6989586621679565703"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565703"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565702"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565701"><span class="hs-identifier hs-var">ys'</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>      </span><span id="local-6989586621679565700"><span class="annot"><span class="annottext">k :: (Value, b) -&gt; ([(CurrencySymbol, TokenName, Integer)], b)
</span><a href="#local-6989586621679565700"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565699"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679565699"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565698"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; [(CurrencySymbol, TokenName, Integer)]
</span><span class="hs-identifier hs-var">Pl.flattenValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679565699"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679565698"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>      </span><span id="local-6989586621679565702"><span class="annot"><span class="annottext">xs' :: [(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565702"><span class="hs-identifier hs-var hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Value, Maybe UtxoDatum) -&gt; (Value, Maybe UtxoDatum) -&gt; Ordering)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
-&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
-&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
 -&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
 -&gt; Ordering)
-&gt; ((Value, Maybe UtxoDatum)
    -&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum))
-&gt; (Value, Maybe UtxoDatum)
-&gt; (Value, Maybe UtxoDatum)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">(Value, Maybe UtxoDatum)
-&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
forall b. (Value, b) -&gt; ([(CurrencySymbol, TokenName, Integer)], b)
</span><a href="#local-6989586621679565700"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565705"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-42"></span><span>      </span><span id="local-6989586621679565701"><span class="annot"><span class="annottext">ys' :: [(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565701"><span class="hs-identifier hs-var hs-var">ys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Value, Maybe UtxoDatum) -&gt; (Value, Maybe UtxoDatum) -&gt; Ordering)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
-&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
-&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
 -&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
 -&gt; Ordering)
-&gt; ((Value, Maybe UtxoDatum)
    -&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum))
-&gt; (Value, Maybe UtxoDatum)
-&gt; (Value, Maybe UtxoDatum)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">(Value, Maybe UtxoDatum)
-&gt; ([(CurrencySymbol, TokenName, Integer)], Maybe UtxoDatum)
forall b. (Value, b) -&gt; ([(CurrencySymbol, TokenName, Integer)], b)
</span><a href="#local-6989586621679565700"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565703"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679565690"><span id="local-6989586621679565692"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span id="local-6989586621679565689"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565689"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679565688"><span class="annot"><span class="annottext">&lt;&gt; :: UtxoValueSet -&gt; UtxoValueSet -&gt; UtxoValueSet
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span id="local-6989586621679565687"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565687"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-var">UtxoValueSet</span></a></span><span> </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565689"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565687"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679565681"><span id="local-6989586621679565683"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679565679"><span class="annot"><span class="annottext">mempty :: UtxoValueSet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-var">UtxoValueSet</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | Computes the total value in a set</span><span>
</span><span id="line-51"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-type">utxoValueSetTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-52"></span><span id="utxoValueSetTotal"><span class="annot"><span class="annottext">utxoValueSetTotal :: UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var hs-var">utxoValueSetTotal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value)
-&gt; (UtxoValueSet -&gt; [Value]) -&gt; UtxoValueSet -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Value, Maybe UtxoDatum) -&gt; Value)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [Value]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Value, Maybe UtxoDatum) -&gt; Value
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; [Value])
-&gt; (UtxoValueSet -&gt; [(Value, Maybe UtxoDatum)])
-&gt; UtxoValueSet
-&gt; [Value]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; [(Value, Maybe UtxoDatum)]
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSet"><span class="hs-identifier hs-var hs-var">utxoValueSet</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Computes the total value in the entire state</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoStateTotal"><span class="hs-identifier hs-type">utxoStateTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-56"></span><span id="utxoStateTotal"><span class="annot"><span class="annottext">utxoStateTotal :: UtxoState -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateTotal"><span class="hs-identifier hs-var hs-var">utxoStateTotal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; (UtxoState -&gt; [Value]) -&gt; UtxoState -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UtxoValueSet -&gt; Value) -&gt; [UtxoValueSet] -&gt; [Value]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var">utxoValueSetTotal</span></a></span><span> </span><span class="annot"><span class="annottext">([UtxoValueSet] -&gt; [Value])
-&gt; (UtxoState -&gt; [UtxoValueSet]) -&gt; UtxoState -&gt; [Value]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet -&gt; [UtxoValueSet]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet -&gt; [UtxoValueSet])
-&gt; (UtxoState -&gt; Map Address UtxoValueSet)
-&gt; UtxoState
-&gt; [UtxoValueSet]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; Map Address UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#utxoState"><span class="hs-identifier hs-var hs-var">utxoState</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | A 'UtxoDatum' contains a datum which is @Datum $ Pl.toBuiltinData x@ for some @x :: X@,</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- but we also include @show x@ to be able to print this value in a more user friendly fashion.</span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="UtxoDatum"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoDatum"><span class="hs-identifier hs-var">UtxoDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UtxoDatum"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoDatum"><span class="hs-identifier hs-var">UtxoDatum</span></a></span></span><span> </span><span class="hs-special">{</span><span id="utxoDatum"><span class="annot"><span class="annottext">UtxoDatum -&gt; Datum
</span><a href="Cooked.MockChain.UtxoState.html#utxoDatum"><span class="hs-identifier hs-var hs-var">utxoDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Datum</span></span><span class="hs-special">,</span><span> </span><span id="utxoShow"><span class="annot"><span class="annottext">UtxoDatum -&gt; String
</span><a href="Cooked.MockChain.UtxoState.html#utxoShow"><span class="hs-identifier hs-var hs-var">utxoShow</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">}</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565668"><span id="local-6989586621679565670"><span class="annot"><span class="annottext">UtxoDatum -&gt; UtxoDatum -&gt; Bool
(UtxoDatum -&gt; UtxoDatum -&gt; Bool)
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; Bool) -&gt; Eq UtxoDatum
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
$c/= :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
== :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
$c== :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565653"><span id="local-6989586621679565655"><span id="local-6989586621679565657"><span id="local-6989586621679565659"><span id="local-6989586621679565661"><span id="local-6989586621679565663"><span id="local-6989586621679565665"><span class="annot"><span class="annottext">Eq UtxoDatum
Eq UtxoDatum
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; Ordering)
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; Bool)
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; Bool)
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; Bool)
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; Bool)
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; UtxoDatum)
-&gt; (UtxoDatum -&gt; UtxoDatum -&gt; UtxoDatum)
-&gt; Ord UtxoDatum
UtxoDatum -&gt; UtxoDatum -&gt; Bool
UtxoDatum -&gt; UtxoDatum -&gt; Ordering
UtxoDatum -&gt; UtxoDatum -&gt; UtxoDatum
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: UtxoDatum -&gt; UtxoDatum -&gt; UtxoDatum
$cmin :: UtxoDatum -&gt; UtxoDatum -&gt; UtxoDatum
max :: UtxoDatum -&gt; UtxoDatum -&gt; UtxoDatum
$cmax :: UtxoDatum -&gt; UtxoDatum -&gt; UtxoDatum
&gt;= :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
$c&gt;= :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
&gt; :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
$c&gt; :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
&lt;= :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
$c&lt;= :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
&lt; :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
$c&lt; :: UtxoDatum -&gt; UtxoDatum -&gt; Bool
compare :: UtxoDatum -&gt; UtxoDatum -&gt; Ordering
$ccompare :: UtxoDatum -&gt; UtxoDatum -&gt; Ordering
$cp1Ord :: Eq UtxoDatum
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679565647"><span id="local-6989586621679565650"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoDatum"><span class="hs-identifier hs-type">UtxoDatum</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>  </span><span id="local-6989586621679565646"><span class="annot"><span class="annottext">show :: UtxoDatum -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UtxoDatum -&gt; String
</span><a href="Cooked.MockChain.UtxoState.html#utxoShow"><span class="hs-identifier hs-var hs-var">utxoShow</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679565640"><span id="local-6989586621679565643"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679565639"><span class="annot"><span class="annottext">show :: UtxoState -&gt; String
</span><a href="#local-6989586621679565639"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Doc Any -&gt; String)
-&gt; (UtxoState -&gt; Doc Any) -&gt; UtxoState -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; Doc Any
forall ann. UtxoState -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyUtxoState"><span class="hs-identifier hs-var">prettyUtxoState</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- * Differences between two 'UtxoState'</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | The differences between two states @a@ and @b@ is a map whose keys</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- are @M.keys a `union` M.keys b@ and values dictate what happened to that</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- particular value set with a 'UtxoValueSetDiff'</span><span>
</span><span id="line-74"></span><span class="hs-keyword">type</span><span> </span><span id="UtxoStateDiff"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoStateDiff"><span class="hs-identifier hs-var">UtxoStateDiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSetDiff"><span class="hs-identifier hs-type">UtxoValueSetDiff</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | A 'UtxoValueSet' can have been inserted, deleted or modified.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="UtxoValueSetDiff"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSetDiff"><span class="hs-identifier hs-var">UtxoValueSetDiff</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Inserted"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Deleted"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Deleted"><span class="hs-identifier hs-var">Deleted</span></a></span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | In case it has been modified, the order is irrelevant; hence we just need to keep the deltas around.</span><span>
</span><span id="line-81"></span><span>    </span><span id="Modified"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Modified"><span class="hs-identifier hs-var">Modified</span></a></span></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="modDeleted"><span class="annot"><span class="annottext">UtxoValueSetDiff -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#modDeleted"><span class="hs-identifier hs-var hs-var">modDeleted</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>        </span><span id="modInserted"><span class="annot"><span class="annottext">UtxoValueSetDiff -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#modInserted"><span class="hs-identifier hs-var hs-var">modInserted</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>        </span><span id="modUnchanged"><span class="annot"><span class="annottext">UtxoValueSetDiff -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#modUnchanged"><span class="hs-identifier hs-var hs-var">modUnchanged</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565626"><span id="local-6989586621679565628"><span id="local-6989586621679565630"><span class="annot"><span class="annottext">Int -&gt; UtxoValueSetDiff -&gt; ShowS
[UtxoValueSetDiff] -&gt; ShowS
UtxoValueSetDiff -&gt; String
(Int -&gt; UtxoValueSetDiff -&gt; ShowS)
-&gt; (UtxoValueSetDiff -&gt; String)
-&gt; ([UtxoValueSetDiff] -&gt; ShowS)
-&gt; Show UtxoValueSetDiff
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [UtxoValueSetDiff] -&gt; ShowS
$cshowList :: [UtxoValueSetDiff] -&gt; ShowS
show :: UtxoValueSetDiff -&gt; String
$cshow :: UtxoValueSetDiff -&gt; String
showsPrec :: Int -&gt; UtxoValueSetDiff -&gt; ShowS
$cshowsPrec :: Int -&gt; UtxoValueSetDiff -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Computes the numeric difference between the new total and the old total</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- of the source and destinations of this diff of set of values</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoValueSetDiffTotal"><span class="hs-identifier hs-type">utxoValueSetDiffTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSetDiff"><span class="hs-identifier hs-type">UtxoValueSetDiff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-91"></span><span id="utxoValueSetDiffTotal"><span class="annot"><span class="annottext">utxoValueSetDiffTotal :: UtxoValueSetDiff -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetDiffTotal"><span class="hs-identifier hs-var hs-var">utxoValueSetDiffTotal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Inserted"><span class="hs-identifier hs-type">Inserted</span></a></span><span> </span><span id="local-6989586621679565624"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565624"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var">utxoValueSetTotal</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565624"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoValueSetDiffTotal"><span class="hs-identifier hs-var">utxoValueSetDiffTotal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Deleted"><span class="hs-identifier hs-type">Deleted</span></a></span><span> </span><span id="local-6989586621679565623"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565623"><span class="hs-identifier hs-var">del</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. AdditiveGroup a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Pl.negate</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; Value -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var">utxoValueSetTotal</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565623"><span class="hs-identifier hs-var">del</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoValueSetDiffTotal"><span class="hs-identifier hs-var">utxoValueSetDiffTotal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Modified"><span class="hs-identifier hs-type">Modified</span></a></span><span> </span><span id="local-6989586621679565621"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565621"><span class="hs-identifier hs-var">del</span></a></span></span><span> </span><span id="local-6989586621679565620"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565620"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var">utxoValueSetTotal</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565620"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. AdditiveGroup a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Pl.negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var">utxoValueSetTotal</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565621"><span class="hs-identifier hs-var">del</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Computes the total difference in value between a new state and an old state:</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- @utxoStateDiff new old@. If this difference is positive for some token @t@,</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- it means some @t@ it was burnt. If it is negative, some @t@ was minted.</span><span>
</span><span id="line-98"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoStateDiffTotal"><span class="hs-identifier hs-type">utxoStateDiffTotal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoStateDiff"><span class="hs-identifier hs-type">UtxoStateDiff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-99"></span><span id="utxoStateDiffTotal"><span class="annot"><span class="annottext">utxoStateDiffTotal :: UtxoStateDiff -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateDiffTotal"><span class="hs-identifier hs-var hs-var">utxoStateDiffTotal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value)
-&gt; (UtxoStateDiff -&gt; [Value]) -&gt; UtxoStateDiff -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UtxoValueSetDiff -&gt; Value) -&gt; [UtxoValueSetDiff] -&gt; [Value]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSetDiff -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetDiffTotal"><span class="hs-identifier hs-var">utxoValueSetDiffTotal</span></a></span><span> </span><span class="annot"><span class="annottext">([UtxoValueSetDiff] -&gt; [Value])
-&gt; (UtxoStateDiff -&gt; [UtxoValueSetDiff])
-&gt; UtxoStateDiff
-&gt; [Value]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UtxoStateDiff -&gt; [UtxoValueSetDiff]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Computes the difference between two states.</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoStateDiff"><span class="hs-identifier hs-type">utxoStateDiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoStateDiff"><span class="hs-identifier hs-type">UtxoStateDiff</span></a></span><span>
</span><span id="line-103"></span><span id="utxoStateDiff"><span class="annot"><span class="annottext">utxoStateDiff :: UtxoState -&gt; UtxoState -&gt; UtxoStateDiff
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateDiff"><span class="hs-identifier hs-var hs-var">utxoStateDiff</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span id="local-6989586621679565617"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565617"><span class="hs-identifier hs-var">stA</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span id="local-6989586621679565616"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565616"><span class="hs-identifier hs-var">stB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">UtxoStateDiff -&gt; UtxoStateDiff -&gt; UtxoStateDiff
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address -&gt; UtxoValueSet -&gt; UtxoValueSetDiff)
-&gt; Map Address UtxoValueSet -&gt; UtxoStateDiff
forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; UtxoValueSet -&gt; UtxoValueSetDiff
</span><a href="#local-6989586621679565613"><span class="hs-identifier hs-var">deleteOrModify</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565617"><span class="hs-identifier hs-var">stA</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UtxoValueSet -&gt; UtxoValueSetDiff)
-&gt; Map Address UtxoValueSet -&gt; UtxoStateDiff
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; UtxoValueSetDiff
</span><a href="Cooked.MockChain.UtxoState.html#Inserted"><span class="hs-identifier hs-var">Inserted</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet -&gt; UtxoStateDiff)
-&gt; Map Address UtxoValueSet -&gt; UtxoStateDiff
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
-&gt; Map Address UtxoValueSet -&gt; Map Address UtxoValueSet
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><span class="hs-identifier hs-var">M.difference</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565616"><span class="hs-identifier hs-var">stB</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565617"><span class="hs-identifier hs-var">stA</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="#local-6989586621679565613"><span class="hs-identifier hs-type">deleteOrModify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSetDiff"><span class="hs-identifier hs-type">UtxoValueSetDiff</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679565613"><span class="annot"><span class="annottext">deleteOrModify :: Address -&gt; UtxoValueSet -&gt; UtxoValueSetDiff
</span><a href="#local-6989586621679565613"><span class="hs-identifier hs-var hs-var">deleteOrModify</span></a></span></span><span> </span><span id="local-6989586621679565610"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565610"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679565609"><span class="annot"><span class="annottext">valA :: UtxoValueSet
</span><a href="#local-6989586621679565609"><span class="hs-identifier hs-var">valA</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span id="local-6989586621679565608"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565608"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Map Address UtxoValueSet -&gt; Maybe UtxoValueSet
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565610"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565616"><span class="hs-identifier hs-var">stB</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><span class="annottext">Maybe UtxoValueSet
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; UtxoValueSetDiff
</span><a href="Cooked.MockChain.UtxoState.html#Deleted"><span class="hs-identifier hs-var">Deleted</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565609"><span class="hs-identifier hs-var">valA</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span id="local-6989586621679565606"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565606"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>          </span><span class="annot"><span class="annottext">Modified :: UtxoValueSet -&gt; UtxoValueSet -&gt; UtxoValueSet -&gt; UtxoValueSetDiff
</span><a href="Cooked.MockChain.UtxoState.html#Modified"><span class="hs-identifier hs-type">Modified</span></a></span><span>
</span><span id="line-112"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">modDeleted :: UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#modDeleted"><span class="hs-identifier hs-var">modDeleted</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-var">UtxoValueSet</span></a></span><span> </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565608"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">L.\\</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565606"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>              </span><span class="annot"><span class="annottext">modInserted :: UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#modInserted"><span class="hs-identifier hs-var">modInserted</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-var">UtxoValueSet</span></a></span><span> </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565606"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">L.\\</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565608"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>              </span><span class="annot"><span class="annottext">modUnchanged :: UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#modUnchanged"><span class="hs-identifier hs-var">modUnchanged</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-var">UtxoValueSet</span></a></span><span> </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; UtxoValueSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565608"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`L.intersect`</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565606"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-115"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | Returns the source of a difference. Satisfies: @utxoStateDiffSrc (utxoStateDiff a b) == a@</span><span>
</span><span id="line-118"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoStateDiffSrc"><span class="hs-identifier hs-type">utxoStateDiffSrc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoStateDiff"><span class="hs-identifier hs-type">UtxoStateDiff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span>
</span><span id="line-119"></span><span id="utxoStateDiffSrc"><span class="annot"><span class="annottext">utxoStateDiffSrc :: UtxoStateDiff -&gt; UtxoState
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateDiffSrc"><span class="hs-identifier hs-var hs-var">utxoStateDiffSrc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet -&gt; UtxoState
</span><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-var">UtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet -&gt; UtxoState)
-&gt; (UtxoStateDiff -&gt; Map Address UtxoValueSet)
-&gt; UtxoStateDiff
-&gt; UtxoState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet
 -&gt; Address -&gt; UtxoValueSetDiff -&gt; Map Address UtxoValueSet)
-&gt; Map Address UtxoValueSet
-&gt; UtxoStateDiff
-&gt; Map Address UtxoValueSet
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">M.foldlWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
-&gt; Address -&gt; UtxoValueSetDiff -&gt; Map Address UtxoValueSet
</span><a href="#local-6989586621679565601"><span class="hs-identifier hs-var">keepIfModOrDel</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="#local-6989586621679565601"><span class="hs-identifier hs-type">keepIfModOrDel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSetDiff"><span class="hs-identifier hs-type">UtxoValueSetDiff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679565601"><span class="annot"><span class="annottext">keepIfModOrDel :: Map Address UtxoValueSet
-&gt; Address -&gt; UtxoValueSetDiff -&gt; Map Address UtxoValueSet
</span><a href="#local-6989586621679565601"><span class="hs-identifier hs-var hs-var">keepIfModOrDel</span></a></span></span><span> </span><span id="local-6989586621679565599"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565599"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679565598"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565598"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Deleted"><span class="hs-identifier hs-type">Deleted</span></a></span><span> </span><span id="local-6989586621679565597"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565597"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address
-&gt; UtxoValueSet
-&gt; Map Address UtxoValueSet
-&gt; Map Address UtxoValueSet
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565598"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565597"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565599"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="#local-6989586621679565601"><span class="hs-identifier hs-var">keepIfModOrDel</span></a></span><span> </span><span id="local-6989586621679565595"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565595"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679565594"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565594"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Modified"><span class="hs-identifier hs-type">Modified</span></a></span><span> </span><span id="local-6989586621679565593"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565593"><span class="hs-identifier hs-var">del</span></a></span></span><span> </span><span id="local-6989586621679565592"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565592"><span class="hs-identifier hs-var">_ins</span></a></span></span><span> </span><span id="local-6989586621679565591"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565591"><span class="hs-identifier hs-var">unch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address
-&gt; UtxoValueSet
-&gt; Map Address UtxoValueSet
-&gt; Map Address UtxoValueSet
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565594"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565593"><span class="hs-identifier hs-var">del</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; UtxoValueSet -&gt; UtxoValueSet
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565591"><span class="hs-identifier hs-var">unch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565595"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="#local-6989586621679565601"><span class="hs-identifier hs-var">keepIfModOrDel</span></a></span><span> </span><span id="local-6989586621679565590"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565590"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSetDiff
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565590"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Returns the target of a difference. Satisfies: @utxoStateDiffTgt (utxoStateDiff a b) == b@</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#utxoStateDiffTgt"><span class="hs-identifier hs-type">utxoStateDiffTgt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoStateDiff"><span class="hs-identifier hs-type">UtxoStateDiff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span>
</span><span id="line-128"></span><span id="utxoStateDiffTgt"><span class="annot"><span class="annottext">utxoStateDiffTgt :: UtxoStateDiff -&gt; UtxoState
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateDiffTgt"><span class="hs-identifier hs-var hs-var">utxoStateDiffTgt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet -&gt; UtxoState
</span><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-var">UtxoState</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet -&gt; UtxoState)
-&gt; (UtxoStateDiff -&gt; Map Address UtxoValueSet)
-&gt; UtxoStateDiff
-&gt; UtxoState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet
 -&gt; Address -&gt; UtxoValueSetDiff -&gt; Map Address UtxoValueSet)
-&gt; Map Address UtxoValueSet
-&gt; UtxoStateDiff
-&gt; Map Address UtxoValueSet
forall a k b. (a -&gt; k -&gt; b -&gt; a) -&gt; a -&gt; Map k b -&gt; a
</span><span class="hs-identifier hs-var">M.foldlWithKey</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
-&gt; Address -&gt; UtxoValueSetDiff -&gt; Map Address UtxoValueSet
</span><a href="#local-6989586621679565588"><span class="hs-identifier hs-var">keepIfModOrIns</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="#local-6989586621679565588"><span class="hs-identifier hs-type">keepIfModOrIns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSetDiff"><span class="hs-identifier hs-type">UtxoValueSetDiff</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoValueSet"><span class="hs-identifier hs-type">UtxoValueSet</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679565588"><span class="annot"><span class="annottext">keepIfModOrIns :: Map Address UtxoValueSet
-&gt; Address -&gt; UtxoValueSetDiff -&gt; Map Address UtxoValueSet
</span><a href="#local-6989586621679565588"><span class="hs-identifier hs-var hs-var">keepIfModOrIns</span></a></span></span><span> </span><span id="local-6989586621679565587"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565587"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679565586"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565586"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Inserted"><span class="hs-identifier hs-type">Inserted</span></a></span><span> </span><span id="local-6989586621679565585"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565585"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address
-&gt; UtxoValueSet
-&gt; Map Address UtxoValueSet
-&gt; Map Address UtxoValueSet
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565586"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565585"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565587"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621679565588"><span class="hs-identifier hs-var">keepIfModOrIns</span></a></span><span> </span><span id="local-6989586621679565584"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565584"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679565583"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565583"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Modified"><span class="hs-identifier hs-type">Modified</span></a></span><span> </span><span id="local-6989586621679565582"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565582"><span class="hs-identifier hs-var">_del</span></a></span></span><span> </span><span id="local-6989586621679565581"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565581"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621679565580"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565580"><span class="hs-identifier hs-var">unch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address
-&gt; UtxoValueSet
-&gt; Map Address UtxoValueSet
-&gt; Map Address UtxoValueSet
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565583"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565581"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; UtxoValueSet -&gt; UtxoValueSet
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679565580"><span class="hs-identifier hs-var">unch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565584"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="#local-6989586621679565588"><span class="hs-identifier hs-var">keepIfModOrIns</span></a></span><span> </span><span id="local-6989586621679565579"><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565579"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSetDiff
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet
</span><a href="#local-6989586621679565579"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- * Pretty-printing</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Pretty prints a 'UtxoState'.</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- The entire point of producing a 'UtxoState' instead of a 'Pl.UtxoIndex' is to</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- provide the user a picture that is closer to their mental model of what is going</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- on. Hence, we must be able to display our 'UtxoState's in a human readable fashion.</span><span>
</span><span id="line-141"></span><span id="local-6989586621679565842"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#prettyUtxoState"><span class="hs-identifier hs-type">prettyUtxoState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565842"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-142"></span><span id="prettyUtxoState"><span class="annot"><span class="annottext">prettyUtxoState :: UtxoState -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyUtxoState"><span class="hs-identifier hs-var hs-var">prettyUtxoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann)
-&gt; (UtxoState -&gt; [Doc ann]) -&gt; UtxoState -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intersperse</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.emptyDoc</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann])
-&gt; (UtxoState -&gt; [Doc ann]) -&gt; UtxoState -&gt; [Doc ann]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Address, UtxoValueSet) -&gt; Doc ann)
-&gt; [(Address, UtxoValueSet)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address -&gt; [(Value, Maybe UtxoDatum)] -&gt; Doc ann)
-&gt; (Address, [(Value, Maybe UtxoDatum)]) -&gt; Doc ann
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; [(Value, Maybe UtxoDatum)] -&gt; Doc ann
forall ann. Address -&gt; [(Value, Maybe UtxoDatum)] -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyAddress"><span class="hs-identifier hs-var">prettyAddress</span></a></span><span> </span><span class="annot"><span class="annottext">((Address, [(Value, Maybe UtxoDatum)]) -&gt; Doc ann)
-&gt; ((Address, UtxoValueSet)
    -&gt; (Address, [(Value, Maybe UtxoDatum)]))
-&gt; (Address, UtxoValueSet)
-&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(UtxoValueSet -&gt; [(Value, Maybe UtxoDatum)])
-&gt; (Address, UtxoValueSet) -&gt; (Address, [(Value, Maybe UtxoDatum)])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; [(Value, Maybe UtxoDatum)]
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSet"><span class="hs-identifier hs-var hs-var">utxoValueSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">([(Address, UtxoValueSet)] -&gt; [Doc ann])
-&gt; (UtxoState -&gt; [(Address, UtxoValueSet)])
-&gt; UtxoState
-&gt; [Doc ann]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSet -&gt; [(Address, UtxoValueSet)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="annottext">(Map Address UtxoValueSet -&gt; [(Address, UtxoValueSet)])
-&gt; (UtxoState -&gt; Map Address UtxoValueSet)
-&gt; UtxoState
-&gt; [(Address, UtxoValueSet)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; Map Address UtxoValueSet
</span><a href="Cooked.MockChain.UtxoState.html#utxoState"><span class="hs-identifier hs-var hs-var">utxoState</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span id="local-6989586621679565809"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#prettyAddress"><span class="hs-identifier hs-type">prettyAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoDatum"><span class="hs-identifier hs-type">UtxoDatum</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565809"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-150"></span><span id="prettyAddress"><span class="annot"><span class="annottext">prettyAddress :: Address -&gt; [(Value, Maybe UtxoDatum)] -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyAddress"><span class="hs-identifier hs-var hs-var">prettyAddress</span></a></span></span><span> </span><span id="local-6989586621679565573"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565573"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span id="local-6989586621679565572"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565572"><span class="hs-identifier hs-var">payloads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Doc ann
forall ann. Address -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyAddressTypeAndHash"><span class="hs-identifier hs-var">prettyAddressTypeAndHash</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679565573"><span class="hs-identifier hs-var">address</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann)
-&gt; ([(Value, Maybe UtxoDatum)] -&gt; Doc ann)
-&gt; [(Value, Maybe UtxoDatum)]
-&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Doc ann)
-&gt; ([(Value, Maybe UtxoDatum)] -&gt; [Doc ann])
-&gt; [(Value, Maybe UtxoDatum)]
-&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; [Doc ann] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Doc ann -&gt; Doc ann) -&gt; Doc ann -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">([Doc ann] -&gt; [Doc ann])
-&gt; ([(Value, Maybe UtxoDatum)] -&gt; [Doc ann])
-&gt; [(Value, Maybe UtxoDatum)]
-&gt; [Doc ann]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; Maybe (Doc ann))
-&gt; [[(Value, Maybe UtxoDatum)]] -&gt; [Doc ann]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; Maybe (Doc ann)
forall ann. [(Value, Maybe UtxoDatum)] -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#prettyPayloadGroup"><span class="hs-identifier hs-var">prettyPayloadGroup</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="annottext">([[(Value, Maybe UtxoDatum)]] -&gt; [Doc ann])
-&gt; ([(Value, Maybe UtxoDatum)] -&gt; [[(Value, Maybe UtxoDatum)]])
-&gt; [(Value, Maybe UtxoDatum)]
-&gt; [Doc ann]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; [[(Value, Maybe UtxoDatum)]]
forall a. Eq a =&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">L.group</span></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; [[(Value, Maybe UtxoDatum)]])
-&gt; ([(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)])
-&gt; [(Value, Maybe UtxoDatum)]
-&gt; [[(Value, Maybe UtxoDatum)]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((Value, Maybe UtxoDatum) -&gt; (Value, Maybe UtxoDatum) -&gt; Ordering)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; [(Value, Maybe UtxoDatum)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">L.sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ada -&gt; Ada -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">(Ada -&gt; Ada -&gt; Ordering)
-&gt; ((Value, Maybe UtxoDatum) -&gt; Ada)
-&gt; (Value, Maybe UtxoDatum)
-&gt; (Value, Maybe UtxoDatum)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Ada
</span><span class="hs-identifier hs-var">Ada.fromValue</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Ada)
-&gt; ((Value, Maybe UtxoDatum) -&gt; Value)
-&gt; (Value, Maybe UtxoDatum)
-&gt; Ada
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Value, Maybe UtxoDatum) -&gt; Value
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">([(Value, Maybe UtxoDatum)] -&gt; Doc ann)
-&gt; [(Value, Maybe UtxoDatum)] -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565572"><span class="hs-identifier hs-var">payloads</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621679565796"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#prettyPayloadGroup"><span class="hs-identifier hs-type">prettyPayloadGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoDatum"><span class="hs-identifier hs-type">UtxoDatum</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565796"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-163"></span><span id="prettyPayloadGroup"><span class="annot"><span class="annottext">prettyPayloadGroup :: [(Value, Maybe UtxoDatum)] -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#prettyPayloadGroup"><span class="hs-identifier hs-var hs-var">prettyPayloadGroup</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Doc ann)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-164"></span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#prettyPayloadGroup"><span class="hs-identifier hs-var">prettyPayloadGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679565566"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679565566"><span class="hs-identifier hs-var">vl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565565"><span class="annot"><span class="annottext">Maybe UtxoDatum
</span><a href="#local-6989586621679565565"><span class="hs-identifier hs-var">mutxo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679565564"><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565564"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565563"><span class="annot"><span class="annottext">lenRest :: Int
</span><a href="#local-6989586621679565563"><span class="hs-identifier hs-var hs-var">lenRest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Value, Maybe UtxoDatum)]
</span><a href="#local-6989586621679565564"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-166"></span><span>      </span><span id="local-6989586621679565561"><span class="annot"><span class="annottext">lenInfo :: Doc ann -&gt; Doc ann
</span><a href="#local-6989586621679565561"><span class="hs-identifier hs-var hs-var">lenInfo</span></a></span></span><span> </span><span id="local-6989586621679565560"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565560"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679565563"><span class="hs-identifier hs-var">lenRest</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565560"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565560"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;x&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679565563"><span class="hs-identifier hs-var">lenRest</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><a href="#local-6989586621679565561"><span class="hs-identifier hs-var">lenInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; Maybe (Doc ann) -&gt; Maybe (Doc ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe UtxoDatum -&gt; Maybe (Doc ann)
forall ann. Value -&gt; Maybe UtxoDatum -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#prettyPayload"><span class="hs-identifier hs-var">prettyPayload</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679565566"><span class="hs-identifier hs-var">vl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UtxoDatum
</span><a href="#local-6989586621679565565"><span class="hs-identifier hs-var">mutxo</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- Returns `Nothing` if the value is empty to avoid having an empty document</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- whose height is 1 in the `prettyprinter` library and would generate empty</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- lines.</span><span>
</span><span id="line-174"></span><span id="local-6989586621679565780"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#prettyPayload"><span class="hs-identifier hs-type">prettyPayload</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoDatum"><span class="hs-identifier hs-type">UtxoDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565780"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-175"></span><span id="prettyPayload"><span class="annot"><span class="annottext">prettyPayload :: Value -&gt; Maybe UtxoDatum -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#prettyPayload"><span class="hs-identifier hs-var hs-var">prettyPayload</span></a></span></span><span> </span><span id="local-6989586621679565554"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679565554"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679565553"><span class="annot"><span class="annottext">Maybe UtxoDatum
</span><a href="#local-6989586621679565553"><span class="hs-identifier hs-var">mDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679565552"><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679565552"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679565552"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (Doc ann)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679565552"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Maybe (Doc ann))
-&gt; ([Maybe (Doc ann)] -&gt; [Doc ann])
-&gt; [Maybe (Doc ann)]
-&gt; Maybe (Doc ann)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Doc ann)] -&gt; [Doc ann]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">([Maybe (Doc ann)] -&gt; Maybe (Doc ann))
-&gt; [Maybe (Doc ann)] -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe (Doc ann)
forall ann. Value -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#mPrettyValue"><span class="hs-identifier hs-var">mPrettyValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679565554"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann)
-&gt; (UtxoDatum -&gt; Doc ann) -&gt; UtxoDatum -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann)
-&gt; (UtxoDatum -&gt; Doc ann) -&gt; UtxoDatum -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann)
-&gt; (UtxoDatum -&gt; String) -&gt; UtxoDatum -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UtxoDatum -&gt; String
</span><a href="Cooked.MockChain.UtxoState.html#utxoShow"><span class="hs-identifier hs-var hs-var">utxoShow</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxoDatum -&gt; Doc ann) -&gt; Maybe UtxoDatum -&gt; Maybe (Doc ann)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe UtxoDatum
</span><a href="#local-6989586621679565553"><span class="hs-identifier hs-var">mDatum</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- Returns `Nothing` if the value is empty to avoid having an empty document</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- whose height is 1, which would cause `prettyprinter` to generate empty</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- lines.</span><span>
</span><span id="line-185"></span><span id="local-6989586621679565776"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#mPrettyValue"><span class="hs-identifier hs-type">mPrettyValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565776"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-186"></span><span id="mPrettyValue"><span class="annot"><span class="annottext">mPrettyValue :: Value -&gt; Maybe (Doc ann)
</span><a href="Cooked.MockChain.UtxoState.html#mPrettyValue"><span class="hs-identifier hs-var hs-var">mPrettyValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679565549"><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679565549"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679565549"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Doc ann)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679565548"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565548"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565548"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">[Doc ann]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Maybe (Doc ann)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Maybe (Doc ann)) -&gt; Doc ann -&gt; Maybe (Doc ann)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.lbrace</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann -&gt; Doc ann
forall ann. Int -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.indent</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.vsep</span></span><span> </span><span class="annot"><span class="annottext">[Doc ann]
</span><a href="#local-6989586621679565549"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.space</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.rbrace</span></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">([Doc ann] -&gt; Maybe (Doc ann))
-&gt; (Value -&gt; [Doc ann]) -&gt; Value -&gt; Maybe (Doc ann)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((CurrencySymbol, TokenName, Integer) -&gt; Doc ann)
-&gt; [(CurrencySymbol, TokenName, Integer)] -&gt; [Doc ann]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(CurrencySymbol, TokenName, Integer) -&gt; Doc ann
forall ann. (CurrencySymbol, TokenName, Integer) -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyCurrencyAndAmount"><span class="hs-identifier hs-var">prettyCurrencyAndAmount</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)] -&gt; [Doc ann])
-&gt; (Value -&gt; [(CurrencySymbol, TokenName, Integer)])
-&gt; Value
-&gt; [Doc ann]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((CurrencySymbol, TokenName, Integer) -&gt; Bool)
-&gt; [(CurrencySymbol, TokenName, Integer)]
-&gt; [(CurrencySymbol, TokenName, Integer)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565543"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565543"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565543"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)]
 -&gt; [(CurrencySymbol, TokenName, Integer)])
-&gt; (Value -&gt; [(CurrencySymbol, TokenName, Integer)])
-&gt; Value
-&gt; [(CurrencySymbol, TokenName, Integer)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; [(CurrencySymbol, TokenName, Integer)]
</span><span class="hs-identifier hs-var">Pl.flattenValue</span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span id="local-6989586621679565774"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#prettyCurrencyAndAmount"><span class="hs-identifier hs-type">prettyCurrencyAndAmount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.CurrencySymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TokenName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565774"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-198"></span><span id="prettyCurrencyAndAmount"><span class="annot"><span class="annottext">prettyCurrencyAndAmount :: (CurrencySymbol, TokenName, Integer) -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyCurrencyAndAmount"><span class="hs-identifier hs-var hs-var">prettyCurrencyAndAmount</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679565541"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679565541"><span class="hs-identifier hs-var">symbol</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565540"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679565540"><span class="hs-identifier hs-var">tName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679565539"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565539"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; Integer -&gt; Doc ann
forall ann. TokenName -&gt; Integer -&gt; Doc ann
</span><a href="#local-6989586621679565538"><span class="hs-identifier hs-var">prettyToken</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679565540"><span class="hs-identifier hs-var">tName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565539"><span class="hs-identifier hs-var">amount</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679565759"><span class="annot"><a href="#local-6989586621679565537"><span class="hs-identifier hs-type">prettySymbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.CurrencySymbol</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565759"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679565537"><span class="annot"><span class="annottext">prettySymbol :: CurrencySymbol -&gt; Doc ann
</span><a href="#local-6989586621679565537"><span class="hs-identifier hs-var hs-var">prettySymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann)
-&gt; (CurrencySymbol -&gt; String) -&gt; CurrencySymbol -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (CurrencySymbol -&gt; String) -&gt; CurrencySymbol -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679565762"><span class="annot"><a href="#local-6989586621679565535"><span class="hs-identifier hs-type">prettySpacedNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565762"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621679565535"><span class="annot"><span class="annottext">prettySpacedNumber :: Integer -&gt; Doc ann
</span><a href="#local-6989586621679565535"><span class="hs-identifier hs-var hs-var">prettySpacedNumber</span></a></span></span><span> </span><span id="local-6989586621679565534"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="hs-comment">-- this case should never be reached under normal use through 'mPrettyValue'</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
forall ann. Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
</span><a href="#local-6989586621679565532"><span class="hs-identifier hs-var">psnTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
forall ann. Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
</span><a href="#local-6989586621679565532"><span class="hs-identifier hs-var">psnTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565534"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>        </span><span id="local-6989586621679565767"><span class="annot"><a href="#local-6989586621679565532"><span class="hs-identifier hs-type">psnTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565767"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565767"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621679565532"><span class="annot"><span class="annottext">psnTerm :: Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
</span><a href="#local-6989586621679565532"><span class="hs-identifier hs-var hs-var">psnTerm</span></a></span></span><span> </span><span id="local-6989586621679565531"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565531"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565531"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><a href="#local-6989586621679565532"><span class="hs-identifier hs-var">psnTerm</span></a></span><span> </span><span id="local-6989586621679565530"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565530"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span> </span><span id="local-6989586621679565529"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565529"><span class="hs-identifier hs-var">nb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
forall ann. Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
</span><a href="#local-6989586621679565532"><span class="hs-identifier hs-var">psnTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565529"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565530"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565529"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><a href="#local-6989586621679565532"><span class="hs-identifier hs-var">psnTerm</span></a></span><span> </span><span id="local-6989586621679565526"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565526"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679565525"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565525"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679565524"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565524"><span class="hs-identifier hs-var">nb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
forall ann. Doc ann -&gt; Integer -&gt; Integer -&gt; Doc ann
</span><a href="#local-6989586621679565532"><span class="hs-identifier hs-var">psnTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565524"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565526"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565525"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565524"><span class="hs-identifier hs-var">nb</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679565771"><span class="annot"><a href="#local-6989586621679565538"><span class="hs-identifier hs-type">prettyToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TokenName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565771"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679565538"><span class="annot"><span class="annottext">prettyToken :: TokenName -&gt; Integer -&gt; Doc ann
</span><a href="#local-6989586621679565538"><span class="hs-identifier hs-var hs-var">prettyToken</span></a></span></span><span> </span><span id="local-6989586621679565523"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679565523"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679565522"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565522"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679565521"><span class="annot"><span class="annottext">prettyAmount :: Doc ann
</span><a href="#local-6989586621679565521"><span class="hs-identifier hs-var hs-var">prettyAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Doc ann
forall ann. Integer -&gt; Doc ann
</span><a href="#local-6989586621679565535"><span class="hs-identifier hs-var">prettySpacedNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679565522"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-217"></span><span>          </span><span id="local-6989586621679565520"><span class="annot"><span class="annottext">prettyCurrency :: Doc ann
</span><a href="#local-6989586621679565520"><span class="hs-identifier hs-var hs-var">prettyCurrency</span></a></span></span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679565541"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; CurrencySymbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; CurrencySymbol
</span><span class="hs-identifier hs-var">Pl.CurrencySymbol</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Lovelace&quot;</span></span><span>
</span><span id="line-219"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679565541"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; CurrencySymbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="Cooked.Currencies.html#quickCurrencySymbol"><span class="hs-identifier hs-var">quickCurrencySymbol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><a href="#local-6989586621679565517"><span class="hs-identifier hs-var">withTok</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Quick&quot;</span></span><span>
</span><span id="line-220"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679565541"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; CurrencySymbol -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="Cooked.Currencies.html#permanentCurrencySymbol"><span class="hs-identifier hs-var">permanentCurrencySymbol</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><a href="#local-6989586621679565517"><span class="hs-identifier hs-var">withTok</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;Perm&quot;</span></span><span>
</span><span id="line-221"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><a href="#local-6989586621679565517"><span class="hs-identifier hs-var">withTok</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol -&gt; Doc ann
forall ann. CurrencySymbol -&gt; Doc ann
</span><a href="#local-6989586621679565537"><span class="hs-identifier hs-var">prettySymbol</span></a></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679565541"><span class="hs-identifier hs-var">symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>          </span><span id="local-6989586621679565515"><span class="annot"><a href="#local-6989586621679565517"><span class="hs-identifier hs-type">withTok</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565515"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565515"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-224"></span><span>          </span><span id="local-6989586621679565517"><span class="annot"><span class="annottext">withTok :: Doc ann -&gt; Doc ann
</span><a href="#local-6989586621679565517"><span class="hs-identifier hs-var hs-var">withTok</span></a></span></span><span> </span><span id="local-6989586621679565514"><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565514"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.parens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><a href="#local-6989586621679565514"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679565523"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679565520"><span class="hs-identifier hs-var">prettyCurrency</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><a href="#local-6989586621679565521"><span class="hs-identifier hs-var">prettyAmount</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span id="local-6989586621679565800"><span class="annot"><a href="Cooked.MockChain.UtxoState.html#prettyAddressTypeAndHash"><span class="hs-identifier hs-type">prettyAddressTypeAndHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565800"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-228"></span><span id="prettyAddressTypeAndHash"><span class="annot"><span class="annottext">prettyAddressTypeAndHash :: Address -&gt; Doc ann
</span><a href="Cooked.MockChain.UtxoState.html#prettyAddressTypeAndHash"><span class="hs-identifier hs-var hs-var">prettyAddressTypeAndHash</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span id="local-6989586621679565512"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679565512"><span class="hs-identifier hs-var">addrCr</span></a></span></span><span> </span><span id="local-6989586621679565511"><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679565511"><span class="hs-identifier hs-var">stakingCred</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679565512"><span class="hs-identifier hs-var">addrCr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptCredential</span></span><span> </span><span id="local-6989586621679565509"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679565509"><span class="hs-identifier hs-var">vh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; ValidatorHash -&gt; Doc ann
forall hash ann. Show hash =&gt; String -&gt; hash -&gt; Doc ann
</span><a href="#local-6989586621679565508"><span class="hs-identifier hs-var">prettyAux</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;script&quot;</span></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679565509"><span class="hs-identifier hs-var">vh</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential -&gt; Doc ann
forall ann. Maybe StakingCredential -&gt; Doc ann
</span><a href="#local-6989586621679565507"><span class="hs-identifier hs-var">prettyStakingCred</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679565511"><span class="hs-identifier hs-var">stakingCred</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.colon</span></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyCredential</span></span><span> </span><span id="local-6989586621679565504"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679565504"><span class="hs-identifier hs-var">pkh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; PubKeyHash -&gt; Doc ann
forall hash ann. Show hash =&gt; String -&gt; hash -&gt; Doc ann
</span><a href="#local-6989586621679565508"><span class="hs-identifier hs-var">prettyAux</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pubkey&quot;</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679565504"><span class="hs-identifier hs-var">pkh</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.space</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.semi</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.space</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Doc ann
forall ann. PubKeyHash -&gt; Doc ann
</span><a href="#local-6989586621679565502"><span class="hs-identifier hs-var">prettyPubKeyCred</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679565504"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; (Int -&gt; Doc ann) -&gt; Maybe Int -&gt; Doc ann
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.emptyDoc</span></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.space</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Int -&gt; Doc ann) -&gt; Int -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann
forall ann. Doc ann -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.parens</span></span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Int -&gt; Doc ann) -&gt; Int -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;wallet #&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Doc ann -&gt; Doc ann) -&gt; (Int -&gt; Doc ann) -&gt; Int -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PubKeyHash -&gt; Maybe Int
</span><a href="Cooked.MockChain.Wallet.html#walletPKHashToId"><span class="hs-identifier hs-var">walletPKHashToId</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679565504"><span class="hs-identifier hs-var">pkh</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.colon</span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621679565752"><span id="local-6989586621679565753"><span class="annot"><a href="#local-6989586621679565508"><span class="hs-identifier hs-type">prettyAux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679565753"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679565753"><span class="hs-identifier hs-type">hash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565752"><span class="hs-identifier hs-type">ann</span></a></span></span></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679565508"><span class="annot"><span class="annottext">prettyAux :: String -&gt; hash -&gt; Doc ann
</span><a href="#local-6989586621679565508"><span class="hs-identifier hs-var hs-var">prettyAux</span></a></span></span><span> </span><span id="local-6989586621679565499"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679565499"><span class="hs-identifier hs-var">addressType</span></a></span></span><span> </span><span id="local-6989586621679565498"><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679565498"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="annottext">[Doc ann] -&gt; Doc ann
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679565499"><span class="hs-identifier hs-var">addressType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-244"></span><span>          </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.space</span></span><span class="hs-special">,</span><span>
</span><span id="line-245"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; (hash -&gt; String) -&gt; hash -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (hash -&gt; String) -&gt; hash -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">hash -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(hash -&gt; Doc ann) -&gt; hash -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">hash
</span><a href="#local-6989586621679565498"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679565751"><span class="annot"><a href="#local-6989586621679565507"><span class="hs-identifier hs-type">prettyStakingCred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.StakingCredential</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565751"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679565507"><span class="annot"><span class="annottext">prettyStakingCred :: Maybe StakingCredential -&gt; Doc ann
</span><a href="#local-6989586621679565507"><span class="hs-identifier hs-var hs-var">prettyStakingCred</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.emptyDoc</span></span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="#local-6989586621679565507"><span class="hs-identifier hs-var">prettyStakingCred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679565497"><span class="annot"><span class="annottext">StakingCredential
</span><a href="#local-6989586621679565497"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.space</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.semi</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc ann
forall ann. Doc ann
</span><span class="hs-identifier hs-var">PP.space</span></span><span> </span><span class="annot"><span class="annottext">Doc ann -&gt; Doc ann -&gt; Doc ann
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann)
-&gt; (StakingCredential -&gt; String) -&gt; StakingCredential -&gt; Doc ann
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; (StakingCredential -&gt; String) -&gt; StakingCredential -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String)
-&gt; (StakingCredential -&gt; Int) -&gt; StakingCredential -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StakingCredential -&gt; Int
forall a. Hashable a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">H.hash</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StakingCredential
</span><a href="#local-6989586621679565497"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679565749"><span class="annot"><a href="#local-6989586621679565502"><span class="hs-identifier hs-type">prettyPubKeyCred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><a href="#local-6989586621679565749"><span class="hs-identifier hs-type">ann</span></a></span></span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679565502"><span class="annot"><span class="annottext">prettyPubKeyCred :: PubKeyHash -&gt; Doc ann
</span><a href="#local-6989586621679565502"><span class="hs-identifier hs-var hs-var">prettyPubKeyCred</span></a></span></span><span> </span><span id="local-6989586621679565495"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679565495"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc ann
forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><span class="hs-identifier hs-var">PP.pretty</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc ann) -&gt; String -&gt; Doc ann
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Int -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StakingCredential -&gt; Int
forall a. Hashable a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">H.hash</span></span><span> </span><span class="annot"><span class="annottext">(StakingCredential -&gt; Int) -&gt; StakingCredential -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Credential -&gt; StakingCredential
</span><span class="hs-identifier hs-var">Pl.StakingHash</span></span><span> </span><span class="annot"><span class="annottext">(Credential -&gt; StakingCredential)
-&gt; Credential -&gt; StakingCredential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Credential
</span><span class="hs-identifier hs-var">Pl.PubKeyCredential</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679565495"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-253"></span></pre></body></html>
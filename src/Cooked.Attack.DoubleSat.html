<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | This module provides an automated attack to try and perform double</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- satisfaction on a contract.</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Attack.DoubleSat</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier">DoubleSatDelta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier">DoubleSatLbl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#doubleSatAttack"><span class="hs-identifier">doubleSatAttack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html"><span class="hs-identifier">Cooked.MockChain.BlockChain</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Output.html"><span class="hs-identifier">Cooked.Output</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.html"><span class="hs-identifier">Cooked.Pretty</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html"><span class="hs-identifier">Cooked.Skeleton</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Tweak.html"><span class="hs-identifier">Cooked.Tweak</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Wallet.html"><span class="hs-identifier">Cooked.Wallet</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.Core</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Value</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusLedgerApi.V3</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Numeric</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">{- Note: What is a double satisfaction attack?

A double satisfaction attack consists in trying to satisfy the
requirements for what conceptually are two transactions in a single
transaction, and doing so incompletely. It succeeds whenever the
requirements of two validators ovelap, but the required outputs of the
transaction are not sufficiently unique, so that both validators see
them as satisfying &quot;their&quot; requirement.

The mechanism is explained very well in the following analogy from the
Plutus documentation: &quot;Suppose that two tax auditors from two
different departments come to visit you in turn to see if you&#8217;ve paid
your taxes. You come up with a clever scheme to confuse them. Your tax
liability to both departments is $10, so you make a single payment to
the tax office&#8217;s bank account for $10. When the auditors arrive, you
show them your books, containing the payment to the tax office. They
both leave satisfied.&quot;

The double satisfaction attack 'doubleSatAttack' provided by this
module works by going through the foci of some optic on the 'TxSkel'
representing the transaction from the left to the right, and adding
some extra inputs, outputs, and mints depending on each focus and the
current 'MockChainSt'ate. -}</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | A triple of transaction inputs, transaction outputs, and minted</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- value. This is what we can add to the transaction in order to try a</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- double satisfaction attack.</span><span>
</span><span id="line-52"></span><span class="hs-keyword">type</span><span> </span><span id="DoubleSatDelta"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-var">DoubleSatDelta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679702004"><span id="local-6989586621679702008"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-type">DoubleSatDelta</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679702019"><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702019"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702020"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702020"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702021"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702021"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679702022"><span class="annot"><span class="annottext">&lt;&gt; :: DoubleSatDelta -&gt; DoubleSatDelta -&gt; DoubleSatDelta
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679702023"><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702023"><span class="hs-identifier hs-var">i'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702024"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702024"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702025"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702025"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702019"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
-&gt; Map TxOutRef TxSkelRedeemer -&gt; Map TxOutRef TxSkelRedeemer
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702023"><span class="hs-identifier hs-var">i'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- this is left-biased union</span><span>
</span><span id="line-57"></span><span>      </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702020"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut] -&gt; [TxSkelOut] -&gt; [TxSkelOut]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702024"><span class="hs-identifier hs-var">o'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>      </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702021"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints -&gt; TxSkelMints -&gt; TxSkelMints
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702025"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-comment">-- see the 'Semigroup' instance of 'TxSkelMints'</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679702030"><span id="local-6989586621679702034"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-type">DoubleSatDelta</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679702039"><span class="annot"><span class="annottext">mempty :: DoubleSatDelta
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | Double satisfaction attack. See the comment above for what such an</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- attack is about conceptually.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- This attack consists in adding some extra constraints to a</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- transaction, and hoping that the additional minting policies or</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- validator scripts thereby involved are fooled by what's already</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- present on the transaction. Any extra value contained in new inputs</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- to the transaction is then paid to the attacker.</span><span>
</span><span id="line-72"></span><span id="local-6989586621679701867"><span id="local-6989586621679701869"><span id="local-6989586621679701870"><span id="local-6989586621679701875"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#doubleSatAttack"><span class="hs-identifier hs-type">doubleSatAttack</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tweak.Common.html#MonadTweak"><span class="hs-identifier hs-type">MonadTweak</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679701867"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679701869"><span class="hs-identifier hs-type">is</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Is</span></span><span> </span><span class="annot"><a href="#local-6989586621679701870"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A_Traversal</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- | how to combine modifications from caused by different foci. See</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">-- the comment at 'combineModsTweak', which uses the same logic.</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679701869"><span class="hs-identifier hs-type">is</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679701869"><span class="hs-identifier hs-type">is</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">-- | Each focus of this optic is a potential reason to add some</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">-- extra constraints.</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">-- As an example, one could go through the 'paysScript' outputs for</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-comment">-- validators of type @t@ with the following traversal:</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-comment">-- &gt; txSkelOutsL % itaversed % txSkelOutputToTypedValidatorP @t</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Optic'</span></span><span> </span><span class="annot"><a href="#local-6989586621679701870"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WithIx</span></span><span> </span><span class="annot"><a href="#local-6989586621679701869"><span class="hs-identifier hs-type">is</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679701875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- | How to change each focus, and which inputs, outputs, and mints</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">-- to add, for each of the foci. There might be different options</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- for each focus, that's why the return value is a list.</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">-- Continuing the example, for each of the focused 'paysScript'</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- outputs, you might want to try adding some 'spendsScript' inputs</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-comment">-- to the transaction. Since it might be interesting to try</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">-- different redeemers on these extra 'spendsScript' inputs, you can</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- just provide a list of all the options you want to try adding for</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">-- a given 'paysScript' that's already on the transaction.</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">-- ###################################</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">-- ATTENTION: If you modify the state while computing these lists,</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">-- the behaviour of the 'doubleSatAttack' might be strange: Any</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- modification of the state that happens on any call to this</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">-- function will be applied to all returned transactions. For</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- example, if you 'awaitTime' in any of these computations, the</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">-- 'doubleSatAttack' will wait for all returned transactions.</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">-- TODO: Make this interface safer, for example by using (some kind</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">-- of) an 'UtxoState' argument.</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">-- ###################################</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679701869"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679701875"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679701867"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679701875"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-type">DoubleSatDelta</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">-- | The wallet of the attacker, where any surplus is paid to.</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-comment">-- In the example, the extra value in the added 'spendsScript'</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- constraints will be paid to the attacker.</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="#local-6989586621679701867"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-116"></span><span id="doubleSatAttack"><span class="annot"><span class="annottext">doubleSatAttack :: forall (m :: * -&gt; *) is k a.
(MonadTweak m, Eq is, Is k A_Traversal) =&gt;
([is] -&gt; [[is]])
-&gt; Optic' k (WithIx is) TxSkel a
-&gt; (is -&gt; a -&gt; m [(a, DoubleSatDelta)])
-&gt; Wallet
-&gt; m ()
</span><a href="Cooked.Attack.DoubleSat.html#doubleSatAttack"><span class="hs-identifier hs-var hs-var">doubleSatAttack</span></a></span></span><span> </span><span id="local-6989586621679702077"><span class="annot"><span class="annottext">[is] -&gt; [[is]]
</span><a href="#local-6989586621679702077"><span class="hs-identifier hs-var">groupings</span></a></span></span><span> </span><span id="local-6989586621679702078"><span class="annot"><span class="annottext">Optic' k (WithIx is) TxSkel a
</span><a href="#local-6989586621679702078"><span class="hs-identifier hs-var">optic</span></a></span></span><span> </span><span id="local-6989586621679702079"><span class="annot"><span class="annottext">is -&gt; a -&gt; m [(a, DoubleSatDelta)]
</span><a href="#local-6989586621679702079"><span class="hs-identifier hs-var">change</span></a></span></span><span> </span><span id="local-6989586621679702080"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679702080"><span class="hs-identifier hs-var">attacker</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679702081"><span class="annot"><span class="annottext">[DoubleSatDelta]
</span><a href="#local-6989586621679702081"><span class="hs-identifier hs-var">deltas</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([is] -&gt; [[is]])
-&gt; Optic' k (WithIx is) TxSkel a
-&gt; (is -&gt; a -&gt; m [(a, DoubleSatDelta)])
-&gt; m [DoubleSatDelta]
forall is k (m :: * -&gt; *) x l.
(Eq is, Is k A_Traversal, MonadTweak m) =&gt;
([is] -&gt; [[is]])
-&gt; Optic' k (WithIx is) TxSkel x
-&gt; (is -&gt; x -&gt; m [(x, l)])
-&gt; m [l]
</span><a href="Cooked.Tweak.Common.html#combineModsTweak"><span class="hs-identifier hs-var">combineModsTweak</span></a></span><span> </span><span class="annot"><span class="annottext">[is] -&gt; [[is]]
</span><a href="#local-6989586621679702077"><span class="hs-identifier hs-var">groupings</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' k (WithIx is) TxSkel a
</span><a href="#local-6989586621679702078"><span class="hs-identifier hs-var">optic</span></a></span><span> </span><span class="annot"><span class="annottext">is -&gt; a -&gt; m [(a, DoubleSatDelta)]
</span><a href="#local-6989586621679702079"><span class="hs-identifier hs-var">change</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679702082"><span class="annot"><span class="annottext">delta :: DoubleSatDelta
</span><a href="#local-6989586621679702082"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DoubleSatDelta] -&gt; DoubleSatDelta
</span><a href="#local-6989586621679702083"><span class="hs-identifier hs-var">joinDoubleSatDeltas</span></a></span><span> </span><span class="annot"><span class="annottext">[DoubleSatDelta]
</span><a href="#local-6989586621679702081"><span class="hs-identifier hs-var">deltas</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><span class="annottext">DoubleSatDelta -&gt; m ()
forall (m :: * -&gt; *). MonadTweak m =&gt; DoubleSatDelta -&gt; m ()
</span><a href="#local-6989586621679702084"><span class="hs-identifier hs-var">addDoubleSatDeltaTweak</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleSatDelta
</span><a href="#local-6989586621679702082"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621679702085"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679702085"><span class="hs-identifier hs-var">addedValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DoubleSatDelta -&gt; m Value
forall (m :: * -&gt; *). MonadTweak m =&gt; DoubleSatDelta -&gt; m Value
</span><a href="#local-6989586621679702086"><span class="hs-identifier hs-var">deltaBalance</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleSatDelta
</span><a href="#local-6989586621679702082"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679702085"><span class="hs-identifier hs-var">addedValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
</span><span class="hs-operator hs-var">`Script.gt`</span></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; m ()
forall (m :: * -&gt; *). MonadTweak m =&gt; TxSkelOut -&gt; m ()
</span><a href="Cooked.Tweak.AddInputsAndOutputs.html#addOutputTweak"><span class="hs-identifier hs-var">addOutputTweak</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; m ()) -&gt; TxSkelOut -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Value -&gt; TxSkelOut
forall a. HasPubKeyHash a =&gt; a -&gt; Value -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#paysPK"><span class="hs-identifier hs-var">paysPK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; PubKeyHash
</span><a href="Cooked.Wallet.html#walletPKHash"><span class="hs-identifier hs-var">walletPKHash</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679702080"><span class="hs-identifier hs-var">attacker</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679702085"><span class="hs-identifier hs-var">addedValue</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">m ()
forall (m :: * -&gt; *) a. MonadTweak m =&gt; m a
</span><a href="Cooked.Tweak.Common.html#failingTweak"><span class="hs-identifier hs-var">failingTweak</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">DoubleSatLbl -&gt; m ()
forall (m :: * -&gt; *) x. (MonadTweak m, LabelConstrs x) =&gt; x -&gt; m ()
</span><a href="Cooked.Tweak.Labels.html#addLabelTweak"><span class="hs-identifier hs-var">addLabelTweak</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleSatLbl
</span><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier hs-var">DoubleSatLbl</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- for each triple of additional inputs, outputs, and mints,</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- calculate its balance</span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621679701900"><span class="annot"><a href="#local-6989586621679702086"><span class="hs-identifier hs-type">deltaBalance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tweak.Common.html#MonadTweak"><span class="hs-identifier hs-type">MonadTweak</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679701900"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-type">DoubleSatDelta</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679701900"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span></span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679702086"><span class="annot"><span class="annottext">deltaBalance :: forall (m :: * -&gt; *). MonadTweak m =&gt; DoubleSatDelta -&gt; m Value
</span><a href="#local-6989586621679702086"><span class="hs-identifier hs-var hs-var">deltaBalance</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679702136"><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702136"><span class="hs-identifier hs-var">inputs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702137"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702137"><span class="hs-identifier hs-var">outputs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702138"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702138"><span class="hs-identifier hs-var">mints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-130"></span><span>      </span><span id="local-6989586621679702139"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679702139"><span class="hs-identifier hs-var">inValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; Value) -&gt; [(TxOutRef, TxOut)] -&gt; Value
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Value
forall o. (IsAbstractOutput o, ToValue (ValueType o)) =&gt; o -&gt; Value
</span><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-var">outputValue</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value)
-&gt; ((TxOutRef, TxOut) -&gt; TxOut) -&gt; (TxOutRef, TxOut) -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; TxOut
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; Value)
-&gt; ([(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)])
-&gt; [(TxOutRef, TxOut)]
-&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; Bool)
-&gt; [(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; [TxOutRef] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702136"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; Bool)
-&gt; ((TxOutRef, TxOut) -&gt; TxOutRef) -&gt; (TxOutRef, TxOut) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; TxOutRef
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; Value) -&gt; m [(TxOutRef, TxOut)] -&gt; m Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-var">allUtxos</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; m Value) -&gt; Value -&gt; m Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679702139"><span class="hs-identifier hs-var">inValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. AdditiveGroup a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">PlutusTx.negate</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679702150"><span class="hs-identifier hs-var">outValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679702151"><span class="hs-identifier hs-var">mintValue</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>        </span><span id="local-6989586621679702150"><span class="annot"><span class="annottext">outValue :: Value
</span><a href="#local-6989586621679702150"><span class="hs-identifier hs-var hs-var">outValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic' A_Traversal NoIx [TxSkelOut] Value -&gt; [TxSkelOut] -&gt; Value
forall k a (is :: IxList) s.
(Is k A_Fold, Monoid a) =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">foldOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Traversal [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
forall (t :: * -&gt; *) a b.
Traversable t =&gt;
Traversal (t a) (t b) a b
</span><span class="hs-identifier hs-var">traversed</span></span><span> </span><span class="annot"><span class="annottext">Traversal [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
-&gt; Optic A_Lens NoIx TxSkelOut TxSkelOut Value Value
-&gt; Optic' A_Traversal NoIx [TxSkelOut] Value
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens NoIx TxSkelOut TxSkelOut Value Value
</span><a href="Cooked.Skeleton.html#txSkelOutValueL"><span class="hs-identifier hs-var">txSkelOutValueL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702137"><span class="hs-identifier hs-var">outputs</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span id="local-6989586621679702151"><span class="annot"><span class="annottext">mintValue :: Value
</span><a href="#local-6989586621679702151"><span class="hs-identifier hs-var hs-var">mintValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkelMints -&gt; Value
</span><a href="Cooked.Skeleton.html#txSkelMintsValue"><span class="hs-identifier hs-var">txSkelMintsValue</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702138"><span class="hs-identifier hs-var">mints</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- Helper tweak to add a 'DoubleSatDelta' to a transaction</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621679701899"><span class="annot"><a href="#local-6989586621679702084"><span class="hs-identifier hs-type">addDoubleSatDeltaTweak</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tweak.Common.html#MonadTweak"><span class="hs-identifier hs-type">MonadTweak</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679701899"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-type">DoubleSatDelta</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679701899"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621679702084"><span class="annot"><span class="annottext">addDoubleSatDeltaTweak :: forall (m :: * -&gt; *). MonadTweak m =&gt; DoubleSatDelta -&gt; m ()
</span><a href="#local-6989586621679702084"><span class="hs-identifier hs-var hs-var">addDoubleSatDeltaTweak</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679702171"><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702171"><span class="hs-identifier hs-var">ins</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702172"><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702172"><span class="hs-identifier hs-var">outs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702173"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702173"><span class="hs-identifier hs-var">mints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><span class="annottext">((TxOutRef, TxSkelRedeemer) -&gt; m ())
-&gt; [(TxOutRef, TxSkelRedeemer)] -&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOutRef -&gt; TxSkelRedeemer -&gt; m ())
-&gt; (TxOutRef, TxSkelRedeemer) -&gt; m ()
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; TxSkelRedeemer -&gt; m ()
forall (m :: * -&gt; *).
MonadTweak m =&gt;
TxOutRef -&gt; TxSkelRedeemer -&gt; m ()
</span><a href="Cooked.Tweak.AddInputsAndOutputs.html#addInputTweak"><span class="hs-identifier hs-var">addInputTweak</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [(TxOutRef, TxSkelRedeemer)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
</span><a href="#local-6989586621679702171"><span class="hs-identifier hs-var">ins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">m () -&gt; m () -&gt; m ()
forall a b. m a -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; m ()) -&gt; [TxSkelOut] -&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; m ()
forall (m :: * -&gt; *). MonadTweak m =&gt; TxSkelOut -&gt; m ()
</span><a href="Cooked.Tweak.AddInputsAndOutputs.html#addOutputTweak"><span class="hs-identifier hs-var">addOutputTweak</span></a></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut]
</span><a href="#local-6989586621679702172"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">m () -&gt; m () -&gt; m ()
forall a b. m a -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Versioned MintingPolicy, MintsRedeemer, TokenName, Integer)
 -&gt; m ())
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName, Integer)]
-&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">(Versioned MintingPolicy, MintsRedeemer, TokenName, Integer)
-&gt; m ()
forall (m :: * -&gt; *).
MonadTweak m =&gt;
(Versioned MintingPolicy, MintsRedeemer, TokenName, Integer)
-&gt; m ()
</span><a href="Cooked.Tweak.AddInputsAndOutputs.html#addMintTweak"><span class="hs-identifier hs-var">addMintTweak</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelMints
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName, Integer)]
</span><a href="Cooked.Skeleton.html#txSkelMintsToList"><span class="hs-identifier hs-var">txSkelMintsToList</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679702173"><span class="hs-identifier hs-var">mints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-comment">-- Join a list of 'DoubleSatDelta's into one 'DoubleSatDelta' that</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-comment">-- specifies eveything that is contained in the input.</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="#local-6989586621679702083"><span class="hs-identifier hs-type">joinDoubleSatDeltas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-type">DoubleSatDelta</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatDelta"><span class="hs-identifier hs-type">DoubleSatDelta</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679702083"><span class="annot"><span class="annottext">joinDoubleSatDeltas :: [DoubleSatDelta] -&gt; DoubleSatDelta
</span><a href="#local-6989586621679702083"><span class="hs-identifier hs-var hs-var">joinDoubleSatDeltas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DoubleSatDelta] -&gt; DoubleSatDelta
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="DoubleSatLbl"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier hs-var">DoubleSatLbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DoubleSatLbl"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier hs-var">DoubleSatLbl</span></a></span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679702181"><span id="local-6989586621679702183"><span class="annot"><span class="annottext">DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
(DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool) -&gt; Eq DoubleSatLbl
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
== :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
$c/= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
/= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702187"><span id="local-6989586621679702189"><span id="local-6989586621679702192"><span class="annot"><span class="annottext">Int -&gt; DoubleSatLbl -&gt; ShowS
[DoubleSatLbl] -&gt; ShowS
DoubleSatLbl -&gt; String
(Int -&gt; DoubleSatLbl -&gt; ShowS)
-&gt; (DoubleSatLbl -&gt; String)
-&gt; ([DoubleSatLbl] -&gt; ShowS)
-&gt; Show DoubleSatLbl
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DoubleSatLbl -&gt; ShowS
showsPrec :: Int -&gt; DoubleSatLbl -&gt; ShowS
$cshow :: DoubleSatLbl -&gt; String
show :: DoubleSatLbl -&gt; String
$cshowList :: [DoubleSatLbl] -&gt; ShowS
showList :: [DoubleSatLbl] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679702198"><span id="local-6989586621679702200"><span id="local-6989586621679702202"><span id="local-6989586621679702205"><span id="local-6989586621679702208"><span id="local-6989586621679702211"><span id="local-6989586621679702214"><span class="annot"><span class="annottext">Eq DoubleSatLbl
Eq DoubleSatLbl =&gt;
(DoubleSatLbl -&gt; DoubleSatLbl -&gt; Ordering)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; DoubleSatLbl)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; DoubleSatLbl)
-&gt; Ord DoubleSatLbl
DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
DoubleSatLbl -&gt; DoubleSatLbl -&gt; Ordering
DoubleSatLbl -&gt; DoubleSatLbl -&gt; DoubleSatLbl
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Ordering
compare :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Ordering
$c&lt; :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
&lt; :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
$c&lt;= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
&lt;= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
$c&gt; :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
&gt; :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
$c&gt;= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
&gt;= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
$cmax :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; DoubleSatLbl
max :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; DoubleSatLbl
$cmin :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; DoubleSatLbl
min :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; DoubleSatLbl
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679702219"><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier hs-type">DoubleSatLbl</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679702224"><span class="annot"><span class="annottext">prettyCooked :: DoubleSatLbl -&gt; DocCooked
</span><a href="#local-6989586621679702224"><span class="hs-identifier hs-var hs-var hs-var hs-var">prettyCooked</span></a></span></span><span> </span><span class="annot"><span class="annottext">DoubleSatLbl
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocCooked
</span><span class="hs-string">&quot;DoubleSat&quot;</span></span><span>
</span><span id="line-153"></span></pre></body></html>
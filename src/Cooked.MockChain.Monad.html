<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.Monad</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html"><span class="hs-identifier">Cooked.MockChain.UtxoPredicate</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html"><span class="hs-identifier">Cooked.MockChain.Wallet</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.html"><span class="hs-identifier">Cooked.Tx.Constraints</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Credential</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.TimeSlot</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Typed.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DatumType</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TypedValidator</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">validatorAddress</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromData</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- * BlockChain Monad</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | Base methods for interacting with a UTxO graph through &quot;Cooked.Tx.Constraints&quot;.</span><span>
</span><span id="line-35"></span><span class="hs-comment">--  The operations within 'MonadBlockChain' have an implementation over the 'Plutus.Contract.Contract'</span><span>
</span><span id="line-36"></span><span class="hs-comment">--  monad and can be used to build the first layer of off-chain code that</span><span>
</span><span id="line-37"></span><span class="hs-comment">--  needs to interact with code in the @Contract@ monad.</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- It is strongly recomended that you write your code polymorphic for some monad @m@:</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- &gt; f :: (MonadBlockChain m) =&gt; m ()</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- This enables you to choose different interpretations at run time. The two immediately interesting</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- interpretations are running your code within the</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- 'Plutus.Contract.Contract' monad to generate and submit transactions and to</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- test the code by running it in the 'Cooked.MockChain.Monad.Direct.MockChain' monad, provided in this library.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBlockChain"><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-var">MonadBlockChain</span></a></span></span><span> </span><span id="local-6989586621679517324"><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-comment">-- | Generates and balances a transaction from a skeleton, then attemps to validate such</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-comment">--  transaction. A balanced transaction is such that @inputs + mints == outputs + fees@.</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-comment">--  To balance a transaction, we need access to the current UTxO state to choose</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">--  which inputs to add in case the output-side of the balancing equation is bigger.</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-comment">--  The 'TxSkel' receives a 'TxOpts' record with a number of options to customize how validation works.</span><span>
</span><span id="line-54"></span><span>  </span><span id="validateTxSkel"><span class="annot"><a href="Cooked.MockChain.Monad.html#validateTxSkel"><span class="hs-identifier hs-type">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxId</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-comment">-- | Returns a list of spendable outputs that belong to a given address and satisfy a given predicate;</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">--  Additionally, return the datum present in there if it happened to be a script output. It is important</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">--  to use @-XTypeApplications@ and pass a value for type variable @a@ below.</span><span>
</span><span id="line-59"></span><span>  </span><span id="local-6989586621679517294"><span id="utxosSuchThat"><span class="annot"><a href="Cooked.MockChain.Monad.html#utxosSuchThat"><span class="hs-identifier hs-type">utxosSuchThat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="annot"><a href="#local-6989586621679517294"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517294"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679517294"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">-- | Returns an output given a reference to it</span><span>
</span><span id="line-66"></span><span>  </span><span id="txOutByRef"><span class="annot"><a href="Cooked.MockChain.Monad.html#txOutByRef"><span class="hs-identifier hs-type">txOutByRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-comment">-- | Returns the hash of our own public key. When running in the &quot;Plutus.Contract.Contract&quot; monad,</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">--  this is a proxy to 'Pl.ownPubKey'; when running in mock mode, the return value can be</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">--  controlled with 'signingWith': the head of the non-empty list will be considered as the &quot;ownPubkey&quot;.</span><span>
</span><span id="line-71"></span><span>  </span><span id="ownPaymentPubKeyHash"><span class="annot"><a href="Cooked.MockChain.Monad.html#ownPaymentPubKeyHash"><span class="hs-identifier hs-type">ownPaymentPubKeyHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- | Returns the current slot number</span><span>
</span><span id="line-74"></span><span>  </span><span id="currentSlot"><span class="annot"><a href="Cooked.MockChain.Monad.html#currentSlot"><span class="hs-identifier hs-type">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Slot</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">-- | Returns the current time</span><span>
</span><span id="line-77"></span><span>  </span><span id="currentTime"><span class="annot"><a href="Cooked.MockChain.Monad.html#currentTime"><span class="hs-identifier hs-type">currentTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTime</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-comment">-- | Either waits until the given slot or returns the current slot.</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">--  Note that that it might not wait for anything if the current slot</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-comment">--  is larger than the argument.</span><span>
</span><span id="line-82"></span><span>  </span><span id="awaitSlot"><span class="annot"><a href="Cooked.MockChain.Monad.html#awaitSlot"><span class="hs-identifier hs-type">awaitSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Slot</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- | Wait until the slot where the given time falls into and return latest time</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- we know has passed.</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- Example: if starting time is 0 and slot length is 3s, then `awaitTime 4`</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- waits until slot 2 and returns the value `POSIXTime 5`.</span><span>
</span><span id="line-89"></span><span>  </span><span id="awaitTime"><span class="annot"><a href="Cooked.MockChain.Monad.html#awaitTime"><span class="hs-identifier hs-type">awaitTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517324"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTime</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Calls 'validateTxSkel' with a skeleton that is set with some specific options.</span><span>
</span><span id="line-92"></span><span id="local-6989586621679517106"><span id="local-6989586621679517107"><span class="annot"><a href="Cooked.MockChain.Monad.html#validateTxConstrOpts"><span class="hs-identifier hs-type">validateTxConstrOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517107"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517106"><span class="hs-identifier hs-type">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517106"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517107"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxId</span></span></span></span><span>
</span><span id="line-93"></span><span id="validateTxConstrOpts"><span class="annot"><span class="annottext">validateTxConstrOpts :: TxOpts -&gt; constraints -&gt; m TxId
</span><a href="Cooked.MockChain.Monad.html#validateTxConstrOpts"><span class="hs-identifier hs-var hs-var">validateTxConstrOpts</span></a></span></span><span> </span><span id="local-6989586621679517104"><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679517104"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m TxId
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m TxId
</span><a href="Cooked.MockChain.Monad.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkel -&gt; m TxId)
-&gt; (constraints -&gt; TxSkel) -&gt; constraints -&gt; m TxId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOpts -&gt; constraints -&gt; TxSkel
forall constraints.
ConstraintsSpec constraints =&gt;
TxOpts -&gt; constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkelOpts"><span class="hs-identifier hs-var">txSkelOpts</span></a></span><span> </span><span class="annot"><span class="annottext">TxOpts
</span><a href="#local-6989586621679517104"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Calls 'validateTx' with the default set of options and no label.</span><span>
</span><span id="line-96"></span><span id="local-6989586621679517100"><span id="local-6989586621679517101"><span class="annot"><a href="Cooked.MockChain.Monad.html#validateTxConstr"><span class="hs-identifier hs-type">validateTxConstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517101"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517100"><span class="hs-identifier hs-type">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517100"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517101"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxId</span></span></span></span><span>
</span><span id="line-97"></span><span id="validateTxConstr"><span class="annot"><span class="annottext">validateTxConstr :: constraints -&gt; m TxId
</span><a href="Cooked.MockChain.Monad.html#validateTxConstr"><span class="hs-identifier hs-var hs-var">validateTxConstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m TxId
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m TxId
</span><a href="Cooked.MockChain.Monad.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkel -&gt; m TxId)
-&gt; (constraints -&gt; TxSkel) -&gt; constraints -&gt; m TxId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">constraints -&gt; TxSkel
forall constraints.
ConstraintsSpec constraints =&gt;
constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkel"><span class="hs-identifier hs-var">txSkel</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Calls 'validateTxSkel' with the default set of options but passes an arbitrary showable label to it.</span><span>
</span><span id="line-100"></span><span id="local-6989586621679517095"><span id="local-6989586621679517096"><span id="local-6989586621679517097"><span class="annot"><a href="Cooked.MockChain.Monad.html#validateTxConstrLbl"><span class="hs-identifier hs-type">validateTxConstrLbl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#LabelConstrs"><span class="hs-identifier hs-type">LabelConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517097"><span class="hs-identifier hs-type">lbl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517096"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#ConstraintsSpec"><span class="hs-identifier hs-type">ConstraintsSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517095"><span class="hs-identifier hs-type">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517097"><span class="hs-identifier hs-type">lbl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517095"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517096"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxId</span></span></span></span></span><span>
</span><span id="line-101"></span><span id="validateTxConstrLbl"><span class="annot"><span class="annottext">validateTxConstrLbl :: lbl -&gt; constraints -&gt; m TxId
</span><a href="Cooked.MockChain.Monad.html#validateTxConstrLbl"><span class="hs-identifier hs-var hs-var">validateTxConstrLbl</span></a></span></span><span> </span><span id="local-6989586621679517093"><span class="annot"><span class="annottext">lbl
</span><a href="#local-6989586621679517093"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m TxId
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m TxId
</span><a href="Cooked.MockChain.Monad.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkel -&gt; m TxId)
-&gt; (constraints -&gt; TxSkel) -&gt; constraints -&gt; m TxId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">lbl -&gt; constraints -&gt; TxSkel
forall x constraints.
(LabelConstrs x, ConstraintsSpec constraints) =&gt;
x -&gt; constraints -&gt; TxSkel
</span><a href="Cooked.Tx.Constraints.Type.html#txSkelLbl"><span class="hs-identifier hs-var">txSkelLbl</span></a></span><span> </span><span class="annot"><span class="annottext">lbl
</span><a href="#local-6989586621679517093"><span class="hs-identifier hs-var">lbl</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span id="local-6989586621679517091"><span class="annot"><a href="Cooked.MockChain.Monad.html#spendableRef"><span class="hs-identifier hs-type">spendableRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517091"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517091"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span></span><span>
</span><span id="line-104"></span><span id="spendableRef"><span class="annot"><span class="annottext">spendableRef :: TxOutRef -&gt; m SpendableOut
</span><a href="Cooked.MockChain.Monad.html#spendableRef"><span class="hs-identifier hs-var hs-var">spendableRef</span></a></span></span><span> </span><span id="local-6989586621679517089"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679517089"><span class="hs-identifier hs-var">txORef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679517088"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679517088"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChain m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.Monad.html#txOutByRef"><span class="hs-identifier hs-var">txOutByRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679517089"><span class="hs-identifier hs-var">txORef</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">SpendableOut -&gt; m SpendableOut
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679517089"><span class="hs-identifier hs-var">txORef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe ChainIndexTxOut -&gt; ChainIndexTxOut
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Maybe ChainIndexTxOut
</span><span class="hs-identifier hs-var">Pl.fromTxOut</span></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679517088"><span class="hs-identifier hs-var">txOut</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Select public-key UTxOs that might contain some datum but no staking address.</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- This is just a simpler variant of 'utxosSuchThat'. If you care about staking credentials</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- you must use 'utxosSuchThat' directly.</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Cooked.MockChain.Monad.html#pkUtxosSuchThat"><span class="hs-identifier hs-type">pkUtxosSuchThat</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679517279"><span class="annot"><a href="#local-6989586621679517279"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679517280"><span class="annot"><a href="#local-6989586621679517280"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517280"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="annot"><a href="#local-6989586621679517279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#UtxoPredicate"><span class="hs-identifier hs-type">UtxoPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517279"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="#local-6989586621679517280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679517279"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span id="pkUtxosSuchThat"><span class="annot"><span class="annottext">pkUtxosSuchThat :: PubKeyHash -&gt; UtxoPredicate a -&gt; m [(SpendableOut, Maybe a)]
</span><a href="Cooked.MockChain.Monad.html#pkUtxosSuchThat"><span class="hs-identifier hs-var hs-var">pkUtxosSuchThat</span></a></span></span><span> </span><span id="local-6989586621679517085"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517085"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address -&gt; UtxoPredicate a -&gt; m [(SpendableOut, Maybe a)]
forall (m :: * -&gt; *) a.
(MonadBlockChain m, FromData a) =&gt;
Address -&gt; UtxoPredicate a -&gt; m [(SpendableOut, Maybe a)]
</span><a href="Cooked.MockChain.Monad.html#utxosSuchThat"><span class="hs-identifier hs-var">utxosSuchThat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; Maybe StakingCredential -&gt; Address
</span><span class="hs-identifier hs-var">Pl.Address</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PubKeyHash -&gt; Credential
</span><span class="hs-identifier hs-var">Pl.PubKeyCredential</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517085"><span class="hs-identifier hs-var">pkh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Select public-key UTxOs that do not contain some datum nor staking address.</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- This is just a simpler variant of 'pkUtxosSuchThat'.</span><span>
</span><span id="line-121"></span><span id="local-6989586621679517256"><span class="annot"><a href="Cooked.MockChain.Monad.html#pkUtxosSuchThatValue"><span class="hs-identifier hs-type">pkUtxosSuchThatValue</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517256"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><a href="#local-6989586621679517256"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-126"></span><span id="pkUtxosSuchThatValue"><span class="annot"><span class="annottext">pkUtxosSuchThatValue :: PubKeyHash -&gt; (Value -&gt; Bool) -&gt; m [SpendableOut]
</span><a href="Cooked.MockChain.Monad.html#pkUtxosSuchThatValue"><span class="hs-identifier hs-var hs-var">pkUtxosSuchThatValue</span></a></span></span><span> </span><span id="local-6989586621679517081"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517081"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span id="local-6989586621679517080"><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621679517080"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">((SpendableOut, Maybe ()) -&gt; SpendableOut)
-&gt; [(SpendableOut, Maybe ())] -&gt; [SpendableOut]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(SpendableOut, Maybe ()) -&gt; SpendableOut
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(SpendableOut, Maybe ())] -&gt; [SpendableOut])
-&gt; m [(SpendableOut, Maybe ())] -&gt; m [SpendableOut]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; UtxoPredicate () -&gt; m [(SpendableOut, Maybe ())]
forall a (m :: * -&gt; *).
(MonadBlockChain m, FromData a) =&gt;
PubKeyHash -&gt; UtxoPredicate a -&gt; m [(SpendableOut, Maybe a)]
</span><a href="Cooked.MockChain.Monad.html#pkUtxosSuchThat"><span class="hs-identifier hs-var">pkUtxosSuchThat</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517081"><span class="hs-identifier hs-var">pkh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Bool) -&gt; UtxoPredicate ()
forall a. (Value -&gt; Bool) -&gt; UtxoPredicate a
</span><a href="Cooked.MockChain.UtxoPredicate.html#valueSat"><span class="hs-identifier hs-var">valueSat</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="#local-6989586621679517080"><span class="hs-identifier hs-var">predi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Script UTxOs always have a datum, hence, can be selected easily with</span><span>
</span><span id="line-130"></span><span class="hs-comment">--  a simpler variant of 'utxosSuchThat'. It is important to pass a value for type variable @a@</span><span>
</span><span id="line-131"></span><span class="hs-comment">--  with an explicit type application to make sure the conversion to and from 'Pl.Datum' happens correctly.</span><span>
</span><span id="line-132"></span><span id="local-6989586621679517076"><span id="local-6989586621679517077"><span class="annot"><a href="Cooked.MockChain.Monad.html#scriptUtxosSuchThat"><span class="hs-identifier hs-type">scriptUtxosSuchThat</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517077"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679517076"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679517076"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">-- | Slightly different from 'UtxoPredicate': here we're guaranteed to have a datum present.</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679517076"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><a href="#local-6989586621679517077"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679517076"><span class="hs-identifier hs-type">tv</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-138"></span><span id="scriptUtxosSuchThat"><span class="annot"><span class="annottext">scriptUtxosSuchThat :: TypedValidator tv
-&gt; (DatumType tv -&gt; Value -&gt; Bool)
-&gt; m [(SpendableOut, DatumType tv)]
</span><a href="Cooked.MockChain.Monad.html#scriptUtxosSuchThat"><span class="hs-identifier hs-var hs-var">scriptUtxosSuchThat</span></a></span></span><span> </span><span id="local-6989586621679517074"><span class="annot"><span class="annottext">TypedValidator tv
</span><a href="#local-6989586621679517074"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679517073"><span class="annot"><span class="annottext">DatumType tv -&gt; Value -&gt; Bool
</span><a href="#local-6989586621679517073"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">((SpendableOut, Maybe (DatumType tv))
 -&gt; (SpendableOut, DatumType tv))
-&gt; [(SpendableOut, Maybe (DatumType tv))]
-&gt; [(SpendableOut, DatumType tv)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (DatumType tv) -&gt; DatumType tv)
-&gt; (SpendableOut, Maybe (DatumType tv))
-&gt; (SpendableOut, DatumType tv)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Maybe (DatumType tv) -&gt; DatumType tv
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">([(SpendableOut, Maybe (DatumType tv))]
 -&gt; [(SpendableOut, DatumType tv)])
-&gt; m [(SpendableOut, Maybe (DatumType tv))]
-&gt; m [(SpendableOut, DatumType tv)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Address
-&gt; UtxoPredicate (DatumType tv)
-&gt; m [(SpendableOut, Maybe (DatumType tv))]
forall (m :: * -&gt; *) a.
(MonadBlockChain m, FromData a) =&gt;
Address -&gt; UtxoPredicate a -&gt; m [(SpendableOut, Maybe a)]
</span><a href="Cooked.MockChain.Monad.html#utxosSuchThat"><span class="hs-identifier hs-var">utxosSuchThat</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator tv -&gt; Address
forall a. TypedValidator a -&gt; Address
</span><span class="hs-identifier hs-var">Pl.validatorAddress</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator tv
</span><a href="#local-6989586621679517074"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; Bool)
-&gt; (DatumType tv -&gt; Value -&gt; Bool) -&gt; UtxoPredicate (DatumType tv)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Value -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DatumType tv -&gt; Value -&gt; Bool
</span><a href="#local-6989586621679517073"><span class="hs-identifier hs-var">predicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Returns the output associated with a given reference</span><span>
</span><span id="line-145"></span><span id="local-6989586621679517070"><span class="annot"><a href="Cooked.MockChain.Monad.html#outFromOutRef"><span class="hs-identifier hs-type">outFromOutRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517070"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517070"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span></span><span>
</span><span id="line-146"></span><span id="outFromOutRef"><span class="annot"><span class="annottext">outFromOutRef :: TxOutRef -&gt; m TxOut
</span><a href="Cooked.MockChain.Monad.html#outFromOutRef"><span class="hs-identifier hs-var hs-var">outFromOutRef</span></a></span></span><span> </span><span id="local-6989586621679517068"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679517068"><span class="hs-identifier hs-var">outref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679517067"><span class="annot"><span class="annottext">Maybe TxOut
</span><a href="#local-6989586621679517067"><span class="hs-identifier hs-var">mo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChain m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.Monad.html#txOutByRef"><span class="hs-identifier hs-var">txOutByRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679517068"><span class="hs-identifier hs-var">outref</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe TxOut
</span><a href="#local-6989586621679517067"><span class="hs-identifier hs-var">mo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679517066"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679517066"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; m TxOut
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679517066"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Maybe TxOut
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m TxOut
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No output associated with: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679517068"><span class="hs-identifier hs-var">outref</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | Return all UTxOs belonging to a pubkey</span><span>
</span><span id="line-153"></span><span id="local-6989586621679517254"><span class="annot"><a href="Cooked.MockChain.Monad.html#pkUtxos"><span class="hs-identifier hs-type">pkUtxos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517254"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517254"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#SpendableOut"><span class="hs-identifier hs-type">SpendableOut</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-154"></span><span id="pkUtxos"><span class="annot"><span class="annottext">pkUtxos :: PubKeyHash -&gt; m [SpendableOut]
</span><a href="Cooked.MockChain.Monad.html#pkUtxos"><span class="hs-identifier hs-var hs-var">pkUtxos</span></a></span></span><span> </span><span id="local-6989586621679517063"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517063"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; (Value -&gt; Bool) -&gt; m [SpendableOut]
forall (m :: * -&gt; *).
MonadBlockChain m =&gt;
PubKeyHash -&gt; (Value -&gt; Bool) -&gt; m [SpendableOut]
</span><a href="Cooked.MockChain.Monad.html#pkUtxosSuchThatValue"><span class="hs-identifier hs-var">pkUtxosSuchThatValue</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517063"><span class="hs-identifier hs-var">pkh</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Value -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Return all UTxOs belonging to a pubkey, but keep them as 'Pl.TxOut'. This is</span><span>
</span><span id="line-157"></span><span class="hs-comment">--  for internal use.</span><span>
</span><span id="line-158"></span><span id="local-6989586621679517062"><span class="annot"><a href="Cooked.MockChain.Monad.html#pkUtxos%27"><span class="hs-identifier hs-type">pkUtxos'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517062"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517062"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-159"></span><span id="pkUtxos%27"><span class="annot"><span class="annottext">pkUtxos' :: PubKeyHash -&gt; m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.Monad.html#pkUtxos%27"><span class="hs-identifier hs-var hs-var">pkUtxos'</span></a></span></span><span> </span><span id="local-6989586621679517060"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517060"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SpendableOut -&gt; (TxOutRef, TxOut))
-&gt; [SpendableOut] -&gt; [(TxOutRef, TxOut)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ChainIndexTxOut -&gt; TxOut) -&gt; SpendableOut -&gt; (TxOutRef, TxOut)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut -&gt; TxOut
</span><a href="#local-6989586621679517059"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SpendableOut] -&gt; [(TxOutRef, TxOut)])
-&gt; m [SpendableOut] -&gt; m [(TxOutRef, TxOut)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; m [SpendableOut]
forall (m :: * -&gt; *).
MonadBlockChain m =&gt;
PubKeyHash -&gt; m [SpendableOut]
</span><a href="Cooked.MockChain.Monad.html#pkUtxos"><span class="hs-identifier hs-var">pkUtxos</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679517060"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621679517059"><span class="annot"><span class="annottext">go :: ChainIndexTxOut -&gt; TxOut
</span><a href="#local-6989586621679517059"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.PublicKeyChainIndexTxOut</span></span><span> </span><span id="local-6989586621679517057"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679517057"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679517056"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679517056"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Value -&gt; Maybe DatumHash -&gt; TxOut
</span><span class="hs-identifier hs-var">Pl.TxOut</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679517057"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679517056"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DatumHash
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="#local-6989586621679517059"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">ChainIndexTxOut
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TxOut
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pkUtxos must return only Pl.PublicKeyChainIndexTxOut's&quot;</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- ** Slot and Time Management</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- $slotandtime</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- #slotandtime#</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- Slots are integers that monotonically increase and model the passage of time. By looking</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- at the current slot, a validator gets to know that it is being executed within a certain</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- window of wall-clock time. Things can get annoying pretty fast when trying to mock traces</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- and trying to exercise certain branches of certain validators; make sure you also read</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- the docs on 'autoSlotIncrease' to be able to simulate sending transactions in parallel.</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679517053"><span class="annot"><a href="Cooked.MockChain.Monad.html#waitNSlots"><span class="hs-identifier hs-type">waitNSlots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Slot</span></span></span><span>
</span><span id="line-176"></span><span id="waitNSlots"><span class="annot"><span class="annottext">waitNSlots :: Integer -&gt; m Slot
</span><a href="Cooked.MockChain.Monad.html#waitNSlots"><span class="hs-identifier hs-var hs-var">waitNSlots</span></a></span></span><span> </span><span id="local-6989586621679517051"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679517051"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679517051"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;waitNSlots: negative argument&quot;</span></span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679517048"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679517048"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChain m =&gt; m Slot
</span><a href="Cooked.MockChain.Monad.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">Slot -&gt; m Slot
forall (m :: * -&gt; *). MonadBlockChain m =&gt; Slot -&gt; m Slot
</span><a href="Cooked.MockChain.Monad.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; m Slot) -&gt; Slot -&gt; m Slot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679517048"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679517051"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span id="local-6989586621679517046"><span class="annot"><a href="Cooked.MockChain.Monad.html#waitNMilliSeconds"><span class="hs-identifier hs-type">waitNMilliSeconds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517046"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DiffMilliSeconds</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517046"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTime</span></span></span><span>
</span><span id="line-182"></span><span id="waitNMilliSeconds"><span class="annot"><span class="annottext">waitNMilliSeconds :: DiffMilliSeconds -&gt; m POSIXTime
</span><a href="Cooked.MockChain.Monad.html#waitNMilliSeconds"><span class="hs-identifier hs-var hs-var">waitNMilliSeconds</span></a></span></span><span> </span><span id="local-6989586621679517044"><span class="annot"><span class="annottext">DiffMilliSeconds
</span><a href="#local-6989586621679517044"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679517043"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679517043"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m POSIXTime
forall (m :: * -&gt; *). MonadBlockChain m =&gt; m POSIXTime
</span><a href="Cooked.MockChain.Monad.html#currentTime"><span class="hs-identifier hs-var">currentTime</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">POSIXTime -&gt; m POSIXTime
forall (m :: * -&gt; *). MonadBlockChain m =&gt; POSIXTime -&gt; m POSIXTime
</span><a href="Cooked.MockChain.Monad.html#awaitTime"><span class="hs-identifier hs-var">awaitTime</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; m POSIXTime) -&gt; POSIXTime -&gt; m POSIXTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679517043"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">DiffMilliSeconds -&gt; POSIXTime
</span><span class="hs-identifier hs-var">Pl.fromMilliSeconds</span></span><span> </span><span class="annot"><span class="annottext">DiffMilliSeconds
</span><a href="#local-6989586621679517044"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- ** Monad /Mock/ Chain: multiple identities</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | The 'Plutus.Contract.Contract' monad has certain design decisions</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- that make it suboptimal for testing. Therefore, we divided the abstract</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- interface into those functions that have an interpretation in</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- 'Plutus.Contract.Contract' and those that do not.</span><span>
</span><span id="line-192"></span><span class="hs-comment">--</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- For example, a function returning a value of type @Contract@ can be thought</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- of as an interaction with a plutus contract from a /single user/ point of view.</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- When testing, however, we might want to interact with a contract from multiple different users.</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- Changing the set of wallets that sign a transaction has no interpretation</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- in 'Plutus.Contract.Contract' and can only be used with the testing monads.</span><span>
</span><span id="line-198"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517233"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadMockChain"><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-var">MonadMockChain</span></a></span></span><span> </span><span id="local-6989586621679517233"><span class="annot"><a href="#local-6989586621679517233"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">-- | Sets a list of wallets that will sign every transaction emitted</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">--  in the respective block</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679517231"><span id="signingWith"><span class="annot"><a href="Cooked.MockChain.Monad.html#signingWith"><span class="hs-identifier hs-type">signingWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517231"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517231"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-comment">-- | Returns the current set of signing wallets.</span><span>
</span><span id="line-204"></span><span>  </span><span id="askSigners"><span class="annot"><a href="Cooked.MockChain.Monad.html#askSigners"><span class="hs-identifier hs-type">askSigners</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679517233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- | Returns the slot configuration of the mock chain.</span><span>
</span><span id="line-207"></span><span>  </span><span id="slotConfig"><span class="annot"><a href="Cooked.MockChain.Monad.html#slotConfig"><span class="hs-identifier hs-type">slotConfig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679517233"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.SlotConfig</span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Runs a given block of computations signing transactions as @w@.</span><span>
</span><span id="line-210"></span><span id="local-6989586621679517223"><span id="local-6989586621679517224"><span class="annot"><a href="Cooked.MockChain.Monad.html#as"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517224"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517224"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517223"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517224"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517223"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-211"></span><span id="as"><span class="annot"><span class="annottext">as :: m a -&gt; Wallet -&gt; m a
</span><a href="Cooked.MockChain.Monad.html#as"><span class="hs-keyword hs-var hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679517037"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679517037"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679517036"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679517036"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Wallet -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadMockChain m =&gt;
NonEmpty Wallet -&gt; m a -&gt; m a
</span><a href="Cooked.MockChain.Monad.html#signingWith"><span class="hs-identifier hs-var">signingWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679517036"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; [Wallet] -&gt; NonEmpty Wallet
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NE.:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679517037"><span class="hs-identifier hs-var">ma</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Flipped version of 'as'</span><span>
</span><span id="line-214"></span><span id="local-6989586621679517033"><span id="local-6989586621679517034"><span class="annot"><a href="Cooked.MockChain.Monad.html#signs"><span class="hs-identifier hs-type">signs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517034"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517033"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517033"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-215"></span><span id="signs"><span class="annot"><span class="annottext">signs :: Wallet -&gt; m a -&gt; m a
</span><a href="Cooked.MockChain.Monad.html#signs"><span class="hs-identifier hs-var hs-var">signs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m a -&gt; Wallet -&gt; m a) -&gt; Wallet -&gt; m a -&gt; m a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">m a -&gt; Wallet -&gt; m a
forall (m :: * -&gt; *) a. MonadMockChain m =&gt; m a -&gt; Wallet -&gt; m a
</span><a href="Cooked.MockChain.Monad.html#as"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- ** Deriving further 'MonadBlockChain' instances</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | A newtype wrapper to be used with '-XDerivingVia' to derive instances of 'MonadBlockChain'</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- for any 'MonadTrans'.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- For example, to derive 'MonadBlockChain m =&gt; MonadBlockChain (ReaderT r m)', you'd write</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- &gt; deriving via (AsTrans (ReaderT r) m) instance MonadBlockChain m =&gt; MonadBlockChain (ReaderT r m)</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- and avoid the boilerplate of defining all the methods of the class yourself.</span><span>
</span><span id="line-227"></span><span class="hs-keyword">newtype</span><span> </span><span id="AsTrans"><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-var">AsTrans</span></a></span></span><span> </span><span id="local-6989586621679517145"><span class="annot"><a href="#local-6989586621679517145"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679517144"><span class="annot"><a href="#local-6989586621679517144"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679517143"><span class="annot"><a href="#local-6989586621679517143"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AsTrans"><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-var">AsTrans</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getTrans"><span class="annot"><span class="annottext">AsTrans t m a -&gt; t m a
</span><a href="Cooked.MockChain.Monad.html#getTrans"><span class="hs-identifier hs-var hs-var">getTrans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679517145"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679517025"><span id="local-6989586621679517027"><span class="annot"><span class="annottext">a -&gt; AsTrans t m b -&gt; AsTrans t m a
(a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
(forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b)
-&gt; (forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a)
-&gt; Functor (AsTrans t m)
forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
(a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
&lt;$ :: a -&gt; AsTrans t m b -&gt; AsTrans t m a
$c&lt;$ :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
a -&gt; AsTrans t m b -&gt; AsTrans t m a
fmap :: (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$cfmap :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
(a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679517013"><span id="local-6989586621679517015"><span id="local-6989586621679517017"><span id="local-6989586621679517019"><span id="local-6989586621679517021"><span class="annot"><span class="annottext">Functor (AsTrans t m)
a -&gt; AsTrans t m a
Functor (AsTrans t m)
-&gt; (forall a. a -&gt; AsTrans t m a)
-&gt; (forall a b.
    AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a)
-&gt; Applicative (AsTrans t m)
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
forall a. a -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall a b. AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Applicative (t m) =&gt;
Functor (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Applicative (t m) =&gt;
a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b c.
Applicative (t m) =&gt;
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
&lt;* :: AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
$c&lt;* :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
*&gt; :: AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
$c*&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
liftA2 :: (a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
$cliftA2 :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b c.
Applicative (t m) =&gt;
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
&lt;*&gt; :: AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$c&lt;*&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
pure :: a -&gt; AsTrans t m a
$cpure :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Applicative (t m) =&gt;
a -&gt; AsTrans t m a
$cp1Applicative :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Applicative (t m) =&gt;
Functor (AsTrans t m)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679517005"><span id="local-6989586621679517007"><span id="local-6989586621679517009"><span class="annot"><span class="annottext">Applicative (AsTrans t m)
a -&gt; AsTrans t m a
Applicative (AsTrans t m)
-&gt; (forall a b.
    AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b)
-&gt; (forall a. a -&gt; AsTrans t m a)
-&gt; Monad (AsTrans t m)
AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall a. a -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall a b. AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Monad (t m) =&gt;
Applicative (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Monad (t m) =&gt;
a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
return :: a -&gt; AsTrans t m a
$creturn :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Monad (t m) =&gt;
a -&gt; AsTrans t m a
&gt;&gt; :: AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
$c&gt;&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
&gt;&gt;= :: AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
$c&gt;&gt;= :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
$cp1Monad :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Monad (t m) =&gt;
Applicative (AsTrans t m)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679517001"><span class="annot"><span class="annottext">Monad (AsTrans t m)
Monad (AsTrans t m)
-&gt; (forall a. String -&gt; AsTrans t m a) -&gt; MonadFail (AsTrans t m)
String -&gt; AsTrans t m a
forall a. String -&gt; AsTrans t m a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. String -&gt; m a) -&gt; MonadFail m
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
MonadFail (t m) =&gt;
Monad (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
MonadFail (t m) =&gt;
String -&gt; AsTrans t m a
fail :: String -&gt; AsTrans t m a
$cfail :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
MonadFail (t m) =&gt;
String -&gt; AsTrans t m a
$cp1MonadFail :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
MonadFail (t m) =&gt;
Monad (AsTrans t m)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadFail</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679516998"><span class="annot"><span class="annottext">m a -&gt; AsTrans t m a
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a)
-&gt; MonadTrans (AsTrans t)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a) -&gt; MonadTrans t
lift :: m a -&gt; AsTrans t m a
$clift :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">MonadTrans</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span id="local-6989586621679516995"><span id="local-6989586621679516996"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679516996"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516995"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679516996"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516995"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516996"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516995"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679516984"><span class="annot"><span class="annottext">validateTxSkel :: TxSkel -&gt; AsTrans t m TxId
</span><a href="#local-6989586621679516984"><span class="hs-identifier hs-var hs-var hs-var hs-var">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m TxId -&gt; AsTrans t m TxId
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m TxId -&gt; AsTrans t m TxId)
-&gt; (TxSkel -&gt; m TxId) -&gt; TxSkel -&gt; AsTrans t m TxId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m TxId
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m TxId
</span><a href="Cooked.MockChain.Monad.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621679516982"><span class="annot"><span class="annottext">utxosSuchThat :: Address -&gt; UtxoPredicate a -&gt; AsTrans t m [(SpendableOut, Maybe a)]
</span><a href="#local-6989586621679516982"><span class="hs-identifier hs-var hs-var hs-var hs-var">utxosSuchThat</span></a></span></span><span> </span><span id="local-6989586621679516981"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679516981"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679516980"><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679516980"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(SpendableOut, Maybe a)]
-&gt; AsTrans t m [(SpendableOut, Maybe a)]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [(SpendableOut, Maybe a)]
 -&gt; AsTrans t m [(SpendableOut, Maybe a)])
-&gt; m [(SpendableOut, Maybe a)]
-&gt; AsTrans t m [(SpendableOut, Maybe a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; UtxoPredicate a -&gt; m [(SpendableOut, Maybe a)]
forall (m :: * -&gt; *) a.
(MonadBlockChain m, FromData a) =&gt;
Address -&gt; UtxoPredicate a -&gt; m [(SpendableOut, Maybe a)]
</span><a href="Cooked.MockChain.Monad.html#utxosSuchThat"><span class="hs-identifier hs-var">utxosSuchThat</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679516981"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoPredicate a
</span><a href="#local-6989586621679516980"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679516979"><span class="annot"><span class="annottext">ownPaymentPubKeyHash :: AsTrans t m PubKeyHash
</span><a href="#local-6989586621679516979"><span class="hs-identifier hs-var hs-var hs-var hs-var">ownPaymentPubKeyHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m PubKeyHash -&gt; AsTrans t m PubKeyHash
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m PubKeyHash
forall (m :: * -&gt; *). MonadBlockChain m =&gt; m PubKeyHash
</span><a href="Cooked.MockChain.Monad.html#ownPaymentPubKeyHash"><span class="hs-identifier hs-var">ownPaymentPubKeyHash</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621679516978"><span class="annot"><span class="annottext">txOutByRef :: TxOutRef -&gt; AsTrans t m (Maybe TxOut)
</span><a href="#local-6989586621679516978"><span class="hs-identifier hs-var hs-var hs-var hs-var">txOutByRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe TxOut) -&gt; AsTrans t m (Maybe TxOut)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe TxOut) -&gt; AsTrans t m (Maybe TxOut))
-&gt; (TxOutRef -&gt; m (Maybe TxOut))
-&gt; TxOutRef
-&gt; AsTrans t m (Maybe TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChain m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.Monad.html#txOutByRef"><span class="hs-identifier hs-var">txOutByRef</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621679516977"><span class="annot"><span class="annottext">currentSlot :: AsTrans t m Slot
</span><a href="#local-6989586621679516977"><span class="hs-identifier hs-var hs-var hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; AsTrans t m Slot
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChain m =&gt; m Slot
</span><a href="Cooked.MockChain.Monad.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679516976"><span class="annot"><span class="annottext">currentTime :: AsTrans t m POSIXTime
</span><a href="#local-6989586621679516976"><span class="hs-identifier hs-var hs-var hs-var hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m POSIXTime -&gt; AsTrans t m POSIXTime
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m POSIXTime
forall (m :: * -&gt; *). MonadBlockChain m =&gt; m POSIXTime
</span><a href="Cooked.MockChain.Monad.html#currentTime"><span class="hs-identifier hs-var">currentTime</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679516975"><span class="annot"><span class="annottext">awaitSlot :: Slot -&gt; AsTrans t m Slot
</span><a href="#local-6989586621679516975"><span class="hs-identifier hs-var hs-var hs-var hs-var">awaitSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; AsTrans t m Slot
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m Slot -&gt; AsTrans t m Slot)
-&gt; (Slot -&gt; m Slot) -&gt; Slot -&gt; AsTrans t m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m Slot
forall (m :: * -&gt; *). MonadBlockChain m =&gt; Slot -&gt; m Slot
</span><a href="Cooked.MockChain.Monad.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679516974"><span class="annot"><span class="annottext">awaitTime :: POSIXTime -&gt; AsTrans t m POSIXTime
</span><a href="#local-6989586621679516974"><span class="hs-identifier hs-var hs-var hs-var hs-var">awaitTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m POSIXTime -&gt; AsTrans t m POSIXTime
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m POSIXTime -&gt; AsTrans t m POSIXTime)
-&gt; (POSIXTime -&gt; m POSIXTime) -&gt; POSIXTime -&gt; AsTrans t m POSIXTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m POSIXTime
forall (m :: * -&gt; *). MonadBlockChain m =&gt; POSIXTime -&gt; m POSIXTime
</span><a href="Cooked.MockChain.Monad.html#awaitTime"><span class="hs-identifier hs-var">awaitTime</span></a></span></span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- This might be assigned a more general type,</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- but this type is more inference-friendly, and it also seems to communicate the idea better.</span><span>
</span><span id="line-242"></span><span id="local-6989586621679517140"><span id="local-6989586621679517141"><span id="local-6989586621679517142"><span class="annot"><a href="Cooked.MockChain.Monad.html#unliftOn"><span class="hs-identifier hs-type">unliftOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTransControl</span></span><span> </span><span class="annot"><a href="#local-6989586621679517142"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679517141"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679517142"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517141"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679517141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StT</span></span><span> </span><span class="annot"><a href="#local-6989586621679517142"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517140"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StT</span></span><span> </span><span class="annot"><a href="#local-6989586621679517142"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517140"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517142"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517140"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679517142"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679517140"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-243"></span><span id="local-6989586621679516972"><span class="annot"><span class="annottext">m (StT t a) -&gt; m (StT t a)
</span><a href="#local-6989586621679516972"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="unliftOn"><span class="annot"><span class="annottext">unliftOn :: (m (StT t a) -&gt; m (StT t a)) -&gt; t m a -&gt; t m a
</span><a href="Cooked.MockChain.Monad.html#unliftOn"><span class="hs-operator hs-var hs-var">`unliftOn`</span></a></span></span><span> </span><span id="local-6989586621679516971"><span class="annot"><span class="annottext">t m a
</span><a href="#local-6989586621679516971"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Run t -&gt; m (StT t a)) -&gt; t m (StT t a)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><span class="hs-identifier hs-var">liftWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679516969"><span class="annot"><span class="annottext">Run t
</span><a href="#local-6989586621679516969"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; m (StT t a)
</span><a href="#local-6989586621679516972"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t m a -&gt; m (StT t a)
Run t
</span><a href="#local-6989586621679516969"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">t m a
</span><a href="#local-6989586621679516971"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t m (StT t a) -&gt; (StT t a -&gt; t m a) -&gt; t m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><span class="hs-identifier hs-var">restoreT</span></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; t m a)
-&gt; (StT t a -&gt; m (StT t a)) -&gt; StT t a -&gt; t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StT t a -&gt; m (StT t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="local-6989586621679516966"><span id="local-6989586621679516967"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTransControl</span></span><span> </span><span class="annot"><a href="#local-6989586621679516967"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679516967"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516967"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679516960"><span class="annot"><span class="annottext">signingWith :: NonEmpty Wallet -&gt; AsTrans t m a -&gt; AsTrans t m a
</span><a href="#local-6989586621679516960"><span class="hs-identifier hs-var hs-var hs-var hs-var">signingWith</span></a></span></span><span> </span><span id="local-6989586621679516959"><span class="annot"><span class="annottext">NonEmpty Wallet
</span><a href="#local-6989586621679516959"><span class="hs-identifier hs-var">wallets</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span id="local-6989586621679516958"><span class="annot"><span class="annottext">t m a
</span><a href="#local-6989586621679516958"><span class="hs-identifier hs-var">act</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
t m a -&gt; AsTrans t m a
</span><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-var">AsTrans</span></a></span><span> </span><span class="annot"><span class="annottext">(t m a -&gt; AsTrans t m a) -&gt; t m a -&gt; AsTrans t m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Wallet -&gt; m (StT t a) -&gt; m (StT t a)
forall (m :: * -&gt; *) a.
MonadMockChain m =&gt;
NonEmpty Wallet -&gt; m a -&gt; m a
</span><a href="Cooked.MockChain.Monad.html#signingWith"><span class="hs-identifier hs-var">signingWith</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Wallet
</span><a href="#local-6989586621679516959"><span class="hs-identifier hs-var">wallets</span></a></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; m (StT t a)) -&gt; t m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m, Monad (t m)) =&gt;
(m (StT t a) -&gt; m (StT t a)) -&gt; t m a -&gt; t m a
</span><a href="Cooked.MockChain.Monad.html#unliftOn"><span class="hs-operator hs-var">`unliftOn`</span></a></span><span> </span><span class="annot"><span class="annottext">t m a
</span><a href="#local-6989586621679516958"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679516957"><span class="annot"><span class="annottext">askSigners :: AsTrans t m (NonEmpty Wallet)
</span><a href="#local-6989586621679516957"><span class="hs-identifier hs-var hs-var hs-var hs-var">askSigners</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (NonEmpty Wallet) -&gt; AsTrans t m (NonEmpty Wallet)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m (NonEmpty Wallet)
forall (m :: * -&gt; *). MonadMockChain m =&gt; m (NonEmpty Wallet)
</span><a href="Cooked.MockChain.Monad.html#askSigners"><span class="hs-identifier hs-var">askSigners</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679516956"><span class="annot"><span class="annottext">slotConfig :: AsTrans t m SlotConfig
</span><a href="#local-6989586621679516956"><span class="hs-identifier hs-var hs-var hs-var hs-var">slotConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m SlotConfig -&gt; AsTrans t m SlotConfig
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m SlotConfig
forall (m :: * -&gt; *). MonadMockChain m =&gt; m SlotConfig
</span><a href="Cooked.MockChain.Monad.html#slotConfig"><span class="hs-identifier hs-var">slotConfig</span></a></span></span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span id="local-6989586621679516939"><span id="local-6989586621679516941"><span id="local-6989586621679516943"><span id="local-6989586621679516945"><span id="local-6989586621679516947"><span id="local-6989586621679516949"><span id="local-6989586621679516951"><span id="local-6989586621679516953"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679516937"><span id="local-6989586621679516938"><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516938"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679516937"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679516938"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516937"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516938"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516937"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span id="local-6989586621679516930"><span id="local-6989586621679516932"><span id="local-6989586621679516934"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679516928"><span id="local-6989586621679516929"><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516929"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679516928"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679516929"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516928"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516929"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516928"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621679516911"><span id="local-6989586621679516913"><span id="local-6989586621679516915"><span id="local-6989586621679516917"><span id="local-6989586621679516919"><span id="local-6989586621679516921"><span id="local-6989586621679516923"><span id="local-6989586621679516925"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679516909"><span id="local-6989586621679516910"><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516910"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679516909"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516909"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516910"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516909"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621679516902"><span id="local-6989586621679516904"><span id="local-6989586621679516906"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679516900"><span id="local-6989586621679516901"><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516901"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679516900"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516900"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516901"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516900"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span id="local-6989586621679516883"><span id="local-6989586621679516885"><span id="local-6989586621679516887"><span id="local-6989586621679516889"><span id="local-6989586621679516891"><span id="local-6989586621679516893"><span id="local-6989586621679516895"><span id="local-6989586621679516897"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679516881"><span id="local-6989586621679516882"><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516882"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679516881"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516881"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516881"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621679516874"><span id="local-6989586621679516876"><span id="local-6989586621679516878"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679516872"><span id="local-6989586621679516873"><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516873"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679516872"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516872"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.html#MonadMockChain"><span class="hs-identifier hs-type">MonadMockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679516873"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679516872"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-261"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.UtxoState.Testing</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html"><span class="hs-identifier">Cooked.MockChain.Testing</span></a></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html"><span class="hs-identifier">Cooked.MockChain.UtxoPredicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoPredicate.html#hasOnlyAda"><span class="hs-identifier">hasOnlyAda</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html"><span class="hs-identifier">Cooked.MockChain.UtxoState</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Numeric</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">-- * Relations between states</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- | Returns whether two states are equal except for arbitrary differences in Ada.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--  This implies that the set of addresses in each state is the same, hence, the &quot;equal&quot; prefix.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--  If you don't care about that, check 'equivModuloAtMost'.</span><span>
</span><span id="line-18"></span><span id="local-6989586621679519481"><span class="annot"><a href="Cooked.MockChain.UtxoState.Testing.html#equalModuloAda"><span class="hs-identifier hs-type">equalModuloAda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679519481"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679519481"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-19"></span><span id="equalModuloAda"><span class="annot"><span class="annottext">equalModuloAda :: UtxoState -&gt; UtxoState -&gt; prop
</span><a href="Cooked.MockChain.UtxoState.Testing.html#equalModuloAda"><span class="hs-identifier hs-var hs-var">equalModuloAda</span></a></span></span><span> </span><span id="local-6989586621679519479"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519479"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679519478"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519478"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Address, UtxoValueSetDiff) -&gt; prop)
-&gt; [(Address, UtxoValueSetDiff)] -&gt; prop
forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var">testAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoValueSetDiff -&gt; prop
forall p. IsProp p =&gt; UtxoValueSetDiff -&gt; p
</span><a href="#local-6989586621679519476"><span class="hs-identifier hs-var">eqModAda</span></a></span><span> </span><span class="annot"><span class="annottext">(UtxoValueSetDiff -&gt; prop)
-&gt; ((Address, UtxoValueSetDiff) -&gt; UtxoValueSetDiff)
-&gt; (Address, UtxoValueSetDiff)
-&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Address, UtxoValueSetDiff) -&gt; UtxoValueSetDiff
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Address, UtxoValueSetDiff)] -&gt; prop)
-&gt; [(Address, UtxoValueSetDiff)] -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSetDiff -&gt; [(Address, UtxoValueSetDiff)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSetDiff -&gt; [(Address, UtxoValueSetDiff)])
-&gt; Map Address UtxoValueSetDiff -&gt; [(Address, UtxoValueSetDiff)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; UtxoState -&gt; Map Address UtxoValueSetDiff
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateDiff"><span class="hs-identifier hs-var">utxoStateDiff</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519479"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519478"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-comment">-- If the address was modified, the states are equal modulo Ada if the modifications</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-comment">-- contain only ada</span><span>
</span><span id="line-23"></span><span>    </span><span id="local-6989586621679519476"><span class="annot"><span class="annottext">eqModAda :: UtxoValueSetDiff -&gt; p
</span><a href="#local-6989586621679519476"><span class="hs-identifier hs-var hs-var">eqModAda</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#Modified"><span class="hs-identifier hs-type">Modified</span></a></span><span> </span><span id="local-6989586621679519471"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679519471"><span class="hs-identifier hs-var">del</span></a></span></span><span> </span><span id="local-6989586621679519470"><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679519470"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-24"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679519469"><span class="annot"><span class="annottext">valDiff :: Value
</span><a href="#local-6989586621679519469"><span class="hs-identifier hs-var hs-var">valDiff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var">utxoValueSetTotal</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679519470"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. AdditiveGroup a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Pl.negate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UtxoValueSet -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoValueSetTotal"><span class="hs-identifier hs-var">utxoValueSetTotal</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSet
</span><a href="#local-6989586621679519471"><span class="hs-identifier hs-var">del</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Value -&gt; p
forall prop. IsProp prop =&gt; Value -&gt; prop
</span><a href="#local-6989586621679519466"><span class="hs-identifier hs-var">hasOnlyAdaWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679519469"><span class="hs-identifier hs-var">valDiff</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-comment">-- If the address was deleted or inserted, the states are different in other ways</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-comment">-- other than just ada.</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="#local-6989586621679519476"><span class="hs-identifier hs-var">eqModAda</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoValueSetDiff
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span id="local-6989586621679519466"><span class="annot"><span class="annottext">hasOnlyAdaWithMsg :: Value -&gt; prop
</span><a href="#local-6989586621679519466"><span class="hs-identifier hs-var hs-var">hasOnlyAdaWithMsg</span></a></span></span><span> </span><span id="local-6989586621679519464"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679519464"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Has more than just Ada: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679519464"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(prop -&gt; prop) -&gt; prop -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; prop
forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; prop) -&gt; Bool -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><a href="Cooked.MockChain.UtxoPredicate.html#hasOnlyAda"><span class="hs-identifier hs-var">hasOnlyAda</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679519464"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | Returns whether the difference in value between two states is at most</span><span>
</span><span id="line-34"></span><span class="hs-comment">--  a given bound. Note that the difference in value between states can be negative,</span><span>
</span><span id="line-35"></span><span class="hs-comment">--  hence, the order of parameters matters here. See 'utxoStateDiffTotal' for more.</span><span>
</span><span id="line-36"></span><span id="local-6989586621679519460"><span class="annot"><a href="Cooked.MockChain.UtxoState.Testing.html#equivModuloAtMost"><span class="hs-identifier hs-type">equivModuloAtMost</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679519460"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679519460"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-37"></span><span id="equivModuloAtMost"><span class="annot"><span class="annottext">equivModuloAtMost :: Value -&gt; UtxoState -&gt; UtxoState -&gt; prop
</span><a href="Cooked.MockChain.UtxoState.Testing.html#equivModuloAtMost"><span class="hs-identifier hs-var hs-var">equivModuloAtMost</span></a></span></span><span> </span><span id="local-6989586621679519458"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679519458"><span class="hs-identifier hs-var">maxV</span></a></span></span><span> </span><span id="local-6989586621679519457"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519457"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679519456"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519456"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="annottext">Value -&gt; prop
forall prop. IsProp prop =&gt; Value -&gt; prop
</span><a href="#local-6989586621679519455"><span class="hs-identifier hs-var">noNegativeToken</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; prop) -&gt; (Value -&gt; Value) -&gt; Value -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679519458"><span class="hs-identifier hs-var">maxV</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; (Value -&gt; Value) -&gt; Value -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. AdditiveGroup a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Pl.negate</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; prop) -&gt; Value -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map Address UtxoValueSetDiff -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateDiffTotal"><span class="hs-identifier hs-var">utxoStateDiffTotal</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Address UtxoValueSetDiff -&gt; Value)
-&gt; Map Address UtxoValueSetDiff -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; UtxoState -&gt; Map Address UtxoValueSetDiff
</span><a href="Cooked.MockChain.UtxoState.html#utxoStateDiff"><span class="hs-identifier hs-var">utxoStateDiff</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519457"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679519456"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621679519453"><span class="annot"><a href="#local-6989586621679519455"><span class="hs-identifier hs-type">noNegativeToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679519453"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679519453"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679519455"><span class="annot"><span class="annottext">noNegativeToken :: Value -&gt; prop
</span><a href="#local-6989586621679519455"><span class="hs-identifier hs-var hs-var">noNegativeToken</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((CurrencySymbol, TokenName, Integer) -&gt; prop)
-&gt; [(CurrencySymbol, TokenName, Integer)] -&gt; prop
forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var">testAll</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679519452"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679519452"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; prop
forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; prop) -&gt; Bool -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679519452"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)] -&gt; prop)
-&gt; (Value -&gt; [(CurrencySymbol, TokenName, Integer)])
-&gt; Value
-&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; [(CurrencySymbol, TokenName, Integer)]
</span><span class="hs-identifier hs-var">Pl.flattenValue</span></span><span>
</span><span id="line-42"></span></pre></body></html>
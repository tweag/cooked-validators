<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | This modules provides a specification for our blockchain monads, in three</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- layers:</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- 1. MonadBlockChainBalancing provides what's needing for balancing purposes</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- 2. MonadBlockChainWithoutValidation adds up remaining primitives without</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- transaction validation</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- 3. MonadBlockChain concludes with the addition of transaction validation,</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- thus modifying the internal index of outputs</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- In addition, you will find here many helpers functions which can be derived</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- from the core definition of our blockchain.</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.BlockChain</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier">MockChainLogEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#currentMSRange"><span class="hs-identifier">currentMSRange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier">utxosFromCardanoTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier">currentSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier">awaitSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier">getEnclosingSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier">awaitEnclosingSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#waitNMSFromSlotLowerBound"><span class="hs-identifier">waitNMSFromSlotLowerBound</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#waitNMSFromSlotUpperBound"><span class="hs-identifier">waitNMSFromSlotUpperBound</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeBefore"><span class="hs-identifier">slotRangeBefore</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeAfter"><span class="hs-identifier">slotRangeAfter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotToMSRange"><span class="hs-identifier">slotToMSRange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValidators"><span class="hs-identifier">txSkelInputValidators</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValue"><span class="hs-identifier">txSkelInputValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier">lookupUtxos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel%27"><span class="hs-identifier">validateTxSkel'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel_"><span class="hs-identifier">validateTxSkel_</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelProposalsDeposit"><span class="hs-identifier">txSkelProposalsDeposit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier">govActionDeposit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#defineM"><span class="hs-identifier">defineM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelAllScripts"><span class="hs-identifier">txSkelAllScripts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#previewByRef"><span class="hs-identifier">previewByRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#viewByRef"><span class="hs-identifier">viewByRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Ledger</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cardano</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Conway.PParams</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Conway</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lens</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.Hashable.html"><span class="hs-identifier">Cooked.Pretty.Hashable</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.Plutus.html"><span class="hs-identifier">Cooked.Pretty.Plutus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html"><span class="hs-identifier">Cooked.Skeleton</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Wallet.html"><span class="hs-identifier">Cooked.Wallet</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Index</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Slot</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ListT</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.Core</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Address</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusLedgerApi.V3</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- * Mockchain errors</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="annot"><span class="hs-comment">-- | Errors that can be produced by the blockchain</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="MockChainError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-var">MockChainError</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | Validation errors, either in Phase 1 or Phase 2</span></span><span>
</span><span id="line-83"></span><span>    </span><span id="MCEValidationError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-var">MCEValidationError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ValidationPhase</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ValidationError</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | The balancing wallet does not have enough funds</span></span><span>
</span><span id="line-85"></span><span>    </span><span id="MCEUnbalanceable"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEUnbalanceable"><span class="hs-identifier hs-var">MCEUnbalanceable</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | The balancing wallet is required but missing</span></span><span>
</span><span id="line-87"></span><span>    </span><span id="MCEMissingBalancingWallet"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEMissingBalancingWallet"><span class="hs-identifier hs-var">MCEMissingBalancingWallet</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | No suitable collateral could be associated with a skeleton</span></span><span>
</span><span id="line-89"></span><span>    </span><span id="MCENoSuitableCollateral"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCENoSuitableCollateral"><span class="hs-identifier hs-var">MCENoSuitableCollateral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Translating a skeleton element to its Cardano counterpart failed</span></span><span>
</span><span id="line-91"></span><span>    </span><span id="MCEToCardanoError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEToCardanoError"><span class="hs-identifier hs-var">MCEToCardanoError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ToCardanoError</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | The required reference script is missing from a witness utxo</span></span><span>
</span><span id="line-93"></span><span>    </span><span id="MCEWrongReferenceScriptError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEWrongReferenceScriptError"><span class="hs-identifier hs-var">MCEWrongReferenceScriptError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.ScriptHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.ScriptHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | A UTxO is missing from the mockchain state</span></span><span>
</span><span id="line-95"></span><span>    </span><span id="MCEUnknownOutRef"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEUnknownOutRef"><span class="hs-identifier hs-var">MCEUnknownOutRef</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | A jump in time would result in a past slot</span></span><span>
</span><span id="line-97"></span><span>    </span><span id="MCEPastSlot"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEPastSlot"><span class="hs-identifier hs-var">MCEPastSlot</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | An attempt to invoke an unsupported feature has been made</span></span><span>
</span><span id="line-99"></span><span>    </span><span id="MCEUnsupportedFeature"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEUnsupportedFeature"><span class="hs-identifier hs-var">MCEUnsupportedFeature</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Used to provide 'MonadFail' instances.</span></span><span>
</span><span id="line-101"></span><span>    </span><span id="FailWith"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#FailWith"><span class="hs-identifier hs-var">FailWith</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679812030"><span id="local-6989586621679812073"><span id="local-6989586621679812077"><span class="annot"><span class="annottext">Int -&gt; MockChainError -&gt; ShowS
[MockChainError] -&gt; ShowS
MockChainError -&gt; String
(Int -&gt; MockChainError -&gt; ShowS)
-&gt; (MockChainError -&gt; String)
-&gt; ([MockChainError] -&gt; ShowS)
-&gt; Show MockChainError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; MockChainError -&gt; ShowS
showsPrec :: Int -&gt; MockChainError -&gt; ShowS
$cshow :: MockChainError -&gt; String
show :: MockChainError -&gt; String
$cshowList :: [MockChainError] -&gt; ShowS
showList :: [MockChainError] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679812082"><span id="local-6989586621679812114"><span class="annot"><span class="annottext">MockChainError -&gt; MockChainError -&gt; Bool
(MockChainError -&gt; MockChainError -&gt; Bool)
-&gt; (MockChainError -&gt; MockChainError -&gt; Bool) -&gt; Eq MockChainError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: MockChainError -&gt; MockChainError -&gt; Bool
== :: MockChainError -&gt; MockChainError -&gt; Bool
$c/= :: MockChainError -&gt; MockChainError -&gt; Bool
/= :: MockChainError -&gt; MockChainError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><span class="hs-comment">-- * Mockchain logs</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | This represents the specific events that should be logged when processing</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- transactions. If a new kind of event arises, then a new constructor should be</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- provided here.</span><span>
</span><span id="line-109"></span><span class="hs-keyword">data</span><span> </span><span id="MockChainLogEntry"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-var">MockChainLogEntry</span></a></span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | Logging a Skeleton as it is submitted by the user.</span></span><span>
</span><span id="line-111"></span><span>    </span><span id="MCLogSubmittedTxSkel"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogSubmittedTxSkel"><span class="hs-identifier hs-var">MCLogSubmittedTxSkel</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging a Skeleton as it has been adjusted by the balancing mechanism,</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- alongside fee, and possible collateral utxos and return collateral wallet.</span><span>
</span><span id="line-114"></span><span>    </span><span id="MCLogAdjustedTxSkel"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogAdjustedTxSkel"><span class="hs-identifier hs-var">MCLogAdjustedTxSkel</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging the successful validation of a new transaction, with its id and</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- number of produced outputs.</span><span>
</span><span id="line-117"></span><span>    </span><span id="MCLogNewTx"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogNewTx"><span class="hs-identifier hs-var">MCLogNewTx</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxId</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging the fact that utxos provided by the user for balancing have to be</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- discarded for a specific reason.</span><span>
</span><span id="line-120"></span><span>    </span><span id="MCLogDiscardedUtxos"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogDiscardedUtxos"><span class="hs-identifier hs-var">MCLogDiscardedUtxos</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging the fact that utxos provided as collaterals will not be used</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">-- because the transaction does not involve scripts. There are 2 cases,</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- depending on whether the user has provided an explicit wallet or a set of</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">-- utxos to be used as collaterals.</span><span>
</span><span id="line-125"></span><span>    </span><span id="MCLogUnusedCollaterals"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogUnusedCollaterals"><span class="hs-identifier hs-var">MCLogUnusedCollaterals</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Logging the automatic addition of a reference script</span></span><span>
</span><span id="line-127"></span><span>    </span><span id="MCLogAddedReferenceScript"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogAddedReferenceScript"><span class="hs-identifier hs-var">MCLogAddedReferenceScript</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.Redeemer.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.ScriptHash</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Logging the automatic adjusment of a min ada amount</span></span><span>
</span><span id="line-129"></span><span>    </span><span id="MCLogAdjustedTxSkelOut"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogAdjustedTxSkelOut"><span class="hs-identifier hs-var">MCLogAdjustedTxSkelOut</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Lovelace</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679812127"><span id="local-6989586621679812161"><span id="local-6989586621679812165"><span class="annot"><span class="annottext">Int -&gt; MockChainLogEntry -&gt; ShowS
[MockChainLogEntry] -&gt; ShowS
MockChainLogEntry -&gt; String
(Int -&gt; MockChainLogEntry -&gt; ShowS)
-&gt; (MockChainLogEntry -&gt; String)
-&gt; ([MockChainLogEntry] -&gt; ShowS)
-&gt; Show MockChainLogEntry
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; MockChainLogEntry -&gt; ShowS
showsPrec :: Int -&gt; MockChainLogEntry -&gt; ShowS
$cshow :: MockChainLogEntry -&gt; String
show :: MockChainLogEntry -&gt; String
$cshowList :: [MockChainLogEntry] -&gt; ShowS
showList :: [MockChainLogEntry] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="annot"><span class="hs-comment">-- * Mockchain layers</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | This is the first layer of our blockchain, which provides the minimal</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- subset of primitives required to perform balancing.</span><span>
</span><span id="line-136"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679811575"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811575"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBlockChainBalancing"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-var">MonadBlockChainBalancing</span></a></span></span><span> </span><span id="local-6989586621679811575"><span class="annot"><a href="#local-6989586621679811575"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-comment">-- | Returns the emulator parameters, including protocol parameters</span><span>
</span><span id="line-138"></span><span>  </span><span id="getParams"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-type">getParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679811575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Emulator.Params</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-comment">-- | Returns a list of all UTxOs at a certain address.</span><span>
</span><span id="line-141"></span><span>  </span><span id="utxosAt"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier hs-type">utxosAt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679811864"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.ToAddress</span></span><span> </span><span class="annot"><a href="#local-6989586621679811864"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811864"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-comment">-- | Returns an output given a reference to it. If the output does not exist,</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-comment">-- throws a 'MCEUnknownOutRef' error.</span><span>
</span><span id="line-145"></span><span>  </span><span id="txSkelOutByRef"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-type">txSkelOutByRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- | Logs an event that occured during a BlockChain run</span><span>
</span><span id="line-148"></span><span>  </span><span id="logEvent"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-type">logEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | This is the second layer of our blockchain, which provides all the other</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- blockchain primitives not needed for balancing, except transaction</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- validation. This layers is the one where</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- 'Cooked.MockChain.Tweak.Common.Tweak's are plugged to.</span><span>
</span><span id="line-154"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBlockChainWithoutValidation"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-var">MonadBlockChainWithoutValidation</span></a></span></span><span> </span><span id="local-6989586621679811578"><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- | Returns a list of all currently known outputs.</span><span>
</span><span id="line-156"></span><span>  </span><span id="allUtxos"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-type">allUtxos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">-- | Updates parameters</span><span>
</span><span id="line-159"></span><span>  </span><span id="setParams"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-type">setParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Emulator.Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">-- | Wait a certain amount of slot. Throws 'MCEPastSlot' if the input integer</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- is negative. Returns the slot after jumping in time.</span><span>
</span><span id="line-163"></span><span>  </span><span id="waitNSlots"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-type">waitNSlots</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679811721"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679811721"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811721"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- | Binds a hashable quantity of type @a@ to a variable in the mockchain,</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-comment">-- while registering its alias for printing purposes.</span><span>
</span><span id="line-167"></span><span>  </span><span id="define"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#define"><span class="hs-identifier hs-type">define</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679811649"><span class="hs-special">(</span><span class="annot"><a href="Cooked.Pretty.Hashable.html#ToHash"><span class="hs-identifier hs-type">ToHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811649"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811649"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811649"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">-- | Sets the current script to act as the official constitution script</span><span>
</span><span id="line-170"></span><span>  </span><span id="setConstitutionScript"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#setConstitutionScript"><span class="hs-identifier hs-type">setConstitutionScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679811871"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.ToVersioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span> </span><span class="annot"><a href="#local-6989586621679811871"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811871"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-comment">-- | Gets the current official constitution script</span><span>
</span><span id="line-173"></span><span>  </span><span id="getConstitutionScript"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#getConstitutionScript"><span class="hs-identifier hs-type">getConstitutionScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-comment">-- | Registers a staking credential with a given reward and deposit</span><span>
</span><span id="line-176"></span><span>  </span><span id="registerStakingCred"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#registerStakingCred"><span class="hs-identifier hs-type">registerStakingCred</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679811872"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.ToCredential</span></span><span> </span><span class="annot"><a href="#local-6989586621679811872"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811872"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811578"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | The final layer of our blockchain, adding transaction validation to the</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- mix. This is the only primitive that actually modifies the ledger state.</span><span>
</span><span id="line-180"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811580"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBlockChain"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-var">MonadBlockChain</span></a></span></span><span> </span><span id="local-6989586621679811580"><span class="annot"><a href="#local-6989586621679811580"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- | Generates, balances and validates a transaction from a skeleton. It</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- returns the validated transaction and updates the state of the</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- blockchain.</span><span>
</span><span id="line-184"></span><span>  </span><span id="validateTxSkel"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-type">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811580"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.CardanoTx</span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- | Forces the generation of utxos corresponding to certain 'TxSkelOut'</span><span>
</span><span id="line-187"></span><span>  </span><span id="forceOutputs"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#forceOutputs"><span class="hs-identifier hs-type">forceOutputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811580"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">]</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><span class="hs-comment">-- * Mockchain helpers</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><span class="hs-comment">-- | Retrieves an output and views a specific element out of it</span></span><span>
</span><span id="line-192"></span><span id="local-6989586621679811583"><span id="local-6989586621679811584"><span id="local-6989586621679811587"><span id="local-6989586621679811588"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#viewByRef"><span class="hs-identifier hs-type">viewByRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811583"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Is</span></span><span> </span><span class="annot"><a href="#local-6989586621679811584"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A_Getter</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Optic'</span></span><span> </span><span class="annot"><a href="#local-6989586621679811584"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811587"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811588"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811583"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811588"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-193"></span><span id="viewByRef"><span class="annot"><span class="annottext">viewByRef :: forall (m :: * -&gt; *) g (is :: IxList) c.
(MonadBlockChainBalancing m, Is g A_Getter) =&gt;
Optic' g is TxSkelOut c -&gt; TxOutRef -&gt; m c
</span><a href="Cooked.MockChain.BlockChain.html#viewByRef"><span class="hs-identifier hs-var hs-var">viewByRef</span></a></span></span><span> </span><span id="local-6989586621679812198"><span class="annot"><span class="annottext">Optic' g is TxSkelOut c
</span><a href="#local-6989586621679812198"><span class="hs-identifier hs-var">optic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic' g is TxSkelOut c -&gt; TxSkelOut -&gt; c
forall k (is :: IxList) s a.
Is k A_Getter =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Optic' g is TxSkelOut c
</span><a href="#local-6989586621679812198"><span class="hs-identifier hs-var">optic</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; c) -&gt; m TxSkelOut -&gt; m c
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m TxSkelOut -&gt; m c)
-&gt; (TxOutRef -&gt; m TxSkelOut) -&gt; TxOutRef -&gt; m c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m TxSkelOut
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var">txSkelOutByRef</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><span class="hs-comment">-- | Retrieves an output and previews a specific element out of it</span></span><span>
</span><span id="line-196"></span><span id="local-6989586621679811607"><span id="local-6989586621679811608"><span id="local-6989586621679811610"><span id="local-6989586621679811611"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#previewByRef"><span class="hs-identifier hs-type">previewByRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811607"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Is</span></span><span> </span><span class="annot"><a href="#local-6989586621679811608"><span class="hs-identifier hs-type">af</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">An_AffineFold</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Optic'</span></span><span> </span><span class="annot"><a href="#local-6989586621679811608"><span class="hs-identifier hs-type">af</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811610"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811611"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811607"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679811611"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-197"></span><span id="previewByRef"><span class="annot"><span class="annottext">previewByRef :: forall (m :: * -&gt; *) af (is :: IxList) c.
(MonadBlockChainBalancing m, Is af An_AffineFold) =&gt;
Optic' af is TxSkelOut c -&gt; TxOutRef -&gt; m (Maybe c)
</span><a href="Cooked.MockChain.BlockChain.html#previewByRef"><span class="hs-identifier hs-var hs-var">previewByRef</span></a></span></span><span> </span><span id="local-6989586621679812211"><span class="annot"><span class="annottext">Optic' af is TxSkelOut c
</span><a href="#local-6989586621679812211"><span class="hs-identifier hs-var">optic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic' af is TxSkelOut c -&gt; TxSkelOut -&gt; Maybe c
forall k (is :: IxList) s a.
Is k An_AffineFold =&gt;
Optic' k is s a -&gt; s -&gt; Maybe a
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Optic' af is TxSkelOut c
</span><a href="#local-6989586621679812211"><span class="hs-identifier hs-var">optic</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Maybe c) -&gt; m TxSkelOut -&gt; m (Maybe c)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m TxSkelOut -&gt; m (Maybe c))
-&gt; (TxOutRef -&gt; m TxSkelOut) -&gt; TxOutRef -&gt; m (Maybe c)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m TxSkelOut
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var">txSkelOutByRef</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Validates a skeleton, and retuns the ordered list of produced output</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- references</span><span>
</span><span id="line-201"></span><span id="local-6989586621679811620"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel%27"><span class="hs-identifier hs-type">validateTxSkel'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811620"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811620"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-202"></span><span id="validateTxSkel%27"><span class="annot"><span class="annottext">validateTxSkel' :: forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m [TxOutRef]
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel%27"><span class="hs-identifier hs-var hs-var">validateTxSkel'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">((TxOutRef, TxSkelOut) -&gt; TxOutRef)
-&gt; [(TxOutRef, TxSkelOut)] -&gt; [TxOutRef]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxSkelOut) -&gt; TxOutRef
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxSkelOut)] -&gt; [TxOutRef])
-&gt; m [(TxOutRef, TxSkelOut)] -&gt; m [TxOutRef]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m [(TxOutRef, TxSkelOut)] -&gt; m [TxOutRef])
-&gt; (CardanoTx -&gt; m [(TxOutRef, TxSkelOut)])
-&gt; CardanoTx
-&gt; m [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
CardanoTx -&gt; m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier hs-var">utxosFromCardanoTx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; m [TxOutRef])
-&gt; (TxSkel -&gt; m CardanoTx) -&gt; TxSkel -&gt; m [TxOutRef]
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m CardanoTx
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><span class="hs-comment">-- | Validates a skeleton, and erases the outputs</span></span><span>
</span><span id="line-205"></span><span id="local-6989586621679811633"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel_"><span class="hs-identifier hs-type">validateTxSkel_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811633"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811633"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-206"></span><span id="validateTxSkel_"><span class="annot"><span class="annottext">validateTxSkel_ :: forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel_"><span class="hs-identifier hs-var hs-var">validateTxSkel_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m CardanoTx -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m CardanoTx -&gt; m ()) -&gt; (TxSkel -&gt; m CardanoTx) -&gt; TxSkel -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m CardanoTx
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Retrieves the ordered list of outputs of the given &quot;CardanoTx&quot;.</span><span>
</span><span id="line-209"></span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- This is useful when writing endpoints and/or traces to fetch utxos of</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- interest right from the start and avoid querying the chain for them</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- afterwards using 'allUtxos' or similar functions.</span><span>
</span><span id="line-213"></span><span id="local-6989586621679811628"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier hs-type">utxosFromCardanoTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811628"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.CardanoTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811628"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-214"></span><span id="utxosFromCardanoTx"><span class="annot"><span class="annottext">utxosFromCardanoTx :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
CardanoTx -&gt; m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier hs-var hs-var">utxosFromCardanoTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="annottext">((TxOut, TxIn) -&gt; m (TxOutRef, TxSkelOut))
-&gt; [(TxOut, TxIn)] -&gt; m [(TxOutRef, TxSkelOut)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679812249"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679812249"><span class="hs-identifier hs-var">txIn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679812250"><span class="annot"><span class="annottext">txOutRef :: TxOutRef
</span><a href="#local-6989586621679812250"><span class="hs-identifier hs-var hs-var">txOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxIn -&gt; TxOutRef
</span><span class="hs-identifier hs-var">Ledger.fromCardanoTxIn</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679812249"><span class="hs-identifier hs-var">txIn</span></a></span><span>
</span><span id="line-218"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679812250"><span class="hs-identifier hs-var">txOutRef</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; (TxOutRef, TxSkelOut))
-&gt; m TxSkelOut -&gt; m (TxOutRef, TxSkelOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m TxSkelOut
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var">txSkelOutByRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679812250"><span class="hs-identifier hs-var">txOutRef</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">([(TxOut, TxIn)] -&gt; m [(TxOutRef, TxSkelOut)])
-&gt; (CardanoTx -&gt; [(TxOut, TxIn)])
-&gt; CardanoTx
-&gt; m [(TxOutRef, TxSkelOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; [(TxOut, TxIn)]
</span><span class="hs-identifier hs-var">Ledger.getCardanoTxOutRefs</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><span class="hs-comment">-- | Like 'define', but binds the result of a monadic computation instead</span></span><span>
</span><span id="line-223"></span><span id="local-6989586621679811644"><span id="local-6989586621679811645"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#defineM"><span class="hs-identifier hs-type">defineM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811644"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Pretty.Hashable.html#ToHash"><span class="hs-identifier hs-type">ToHash</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811645"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811644"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811645"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811644"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811645"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-224"></span><span id="defineM"><span class="annot"><span class="annottext">defineM :: forall (m :: * -&gt; *) a.
(MonadBlockChainWithoutValidation m, ToHash a) =&gt;
String -&gt; m a -&gt; m a
</span><a href="Cooked.MockChain.BlockChain.html#defineM"><span class="hs-identifier hs-var hs-var">defineM</span></a></span></span><span> </span><span id="local-6989586621679812261"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679812261"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; a -&gt; m a
forall a. ToHash a =&gt; String -&gt; a -&gt; m a
forall (m :: * -&gt; *) a.
(MonadBlockChainWithoutValidation m, ToHash a) =&gt;
String -&gt; a -&gt; m a
</span><a href="Cooked.MockChain.BlockChain.html#define"><span class="hs-identifier hs-var">define</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679812261"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; m a) -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><span class="hs-comment">-- | Retrieves the required deposit amount for issuing governance actions.</span></span><span>
</span><span id="line-227"></span><span id="local-6989586621679811653"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier hs-type">govActionDeposit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811653"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811653"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Lovelace</span></span></span><span>
</span><span id="line-228"></span><span id="govActionDeposit"><span class="annot"><span class="annottext">govActionDeposit :: forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Lovelace
</span><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier hs-var hs-var">govActionDeposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><span class="hs-identifier hs-var">Api.Lovelace</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Lovelace) -&gt; (Params -&gt; Integer) -&gt; Params -&gt; Lovelace
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><span class="hs-identifier hs-var">Cardano.unCoin</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Integer) -&gt; (Params -&gt; Coin) -&gt; Params -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting Coin (PParams EmulatorEra) Coin
-&gt; PParams EmulatorEra -&gt; Coin
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">Lens.view</span></span><span> </span><span class="annot"><span class="annottext">Getting Coin (PParams EmulatorEra) Coin
forall era. ConwayEraPParams era =&gt; Lens' (PParams era) Coin
Lens' (PParams EmulatorEra) Coin
</span><span class="hs-identifier hs-var">Conway.ppGovActionDepositL</span></span><span> </span><span class="annot"><span class="annottext">(PParams EmulatorEra -&gt; Coin)
-&gt; (Params -&gt; PParams EmulatorEra) -&gt; Params -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; PParams EmulatorEra
</span><span class="hs-identifier hs-var">Emulator.emulatorPParams</span></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Lovelace) -&gt; m Params -&gt; m Lovelace
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Retrieves the total amount of lovelace deposited in proposals in this</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- skeleton (equal to `govActionDeposit` times the number of proposals).</span><span>
</span><span id="line-232"></span><span id="local-6989586621679811670"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelProposalsDeposit"><span class="hs-identifier hs-type">txSkelProposalsDeposit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811670"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811670"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Lovelace</span></span></span><span>
</span><span id="line-233"></span><span id="txSkelProposalsDeposit"><span class="annot"><span class="annottext">txSkelProposalsDeposit :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m Lovelace
</span><a href="Cooked.MockChain.BlockChain.html#txSkelProposalsDeposit"><span class="hs-identifier hs-var hs-var">txSkelProposalsDeposit</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679812295"><span id="local-6989586621679812296"><span id="local-6989586621679812297"><span id="local-6989586621679812298"><span id="local-6989586621679812299"><span id="local-6989586621679812300"><span id="local-6989586621679812301"><span id="local-6989586621679812302"><span id="local-6989586621679812303"><span id="local-6989586621679812304"><span class="annot"><span class="annottext">[Wallet]
[TxSkelProposal]
[TxSkelOut]
Set TxOutRef
Set TxSkelLabel
TxSkelWithdrawals
Map TxOutRef TxSkelRedeemer
TxSkelMints
SlotRange
TxSkelOpts
txSkelLabel :: Set TxSkelLabel
txSkelOpts :: TxSkelOpts
txSkelMints :: TxSkelMints
txSkelSigners :: [Wallet]
txSkelValidityRange :: SlotRange
txSkelIns :: Map TxOutRef TxSkelRedeemer
txSkelInsReference :: Set TxOutRef
txSkelOuts :: [TxSkelOut]
txSkelProposals :: [TxSkelProposal]
txSkelWithdrawals :: TxSkelWithdrawals
txSkelLabel :: TxSkel -&gt; Set TxSkelLabel
txSkelOpts :: TxSkel -&gt; TxSkelOpts
txSkelMints :: TxSkel -&gt; TxSkelMints
txSkelSigners :: TxSkel -&gt; [Wallet]
txSkelValidityRange :: TxSkel -&gt; SlotRange
txSkelIns :: TxSkel -&gt; Map TxOutRef TxSkelRedeemer
txSkelInsReference :: TxSkel -&gt; Set TxOutRef
txSkelOuts :: TxSkel -&gt; [TxSkelOut]
txSkelProposals :: TxSkel -&gt; [TxSkelProposal]
txSkelWithdrawals :: TxSkel -&gt; TxSkelWithdrawals
</span><a href="#local-6989586621679812295"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><span class="hs-identifier hs-var">Api.Lovelace</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Lovelace)
-&gt; (Lovelace -&gt; Integer) -&gt; Lovelace -&gt; Lovelace
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxSkelProposal] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelProposal]
</span><a href="#local-6989586621679812303"><span class="hs-identifier hs-var">txSkelProposals</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer)
-&gt; (Lovelace -&gt; Integer) -&gt; Lovelace -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Integer
</span><span class="hs-identifier hs-var">Api.getLovelace</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Lovelace) -&gt; m Lovelace -&gt; m Lovelace
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Lovelace
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Lovelace
</span><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier hs-var">govActionDeposit</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><span class="hs-comment">-- | Returns all validators which guard transaction inputs</span></span><span>
</span><span id="line-236"></span><span id="local-6989586621679811683"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValidators"><span class="hs-identifier hs-type">txSkelInputValidators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811683"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811683"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Validator</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-237"></span><span id="txSkelInputValidators"><span class="annot"><span class="annottext">txSkelInputValidators :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m [Versioned Validator]
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputValidators"><span class="hs-identifier hs-var hs-var">txSkelInputValidators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TxSkelOut] -&gt; [Versioned Validator])
-&gt; m [TxSkelOut] -&gt; m [Versioned Validator]
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Maybe (Versioned Validator))
-&gt; [TxSkelOut] -&gt; [Versioned Validator]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic' An_AffineTraversal NoIx TxSkelOut (Versioned Validator)
-&gt; TxSkelOut -&gt; Maybe (Versioned Validator)
forall k (is :: IxList) s a.
Is k An_AffineFold =&gt;
Optic' k is s a -&gt; s -&gt; Maybe a
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Optic' An_AffineTraversal NoIx TxSkelOut (Versioned Validator)
</span><a href="Cooked.Skeleton.Output.html#txSkelOutValidatorAT"><span class="hs-identifier hs-var">txSkelOutValidatorAT</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m [TxSkelOut] -&gt; m [Versioned Validator])
-&gt; (TxSkel -&gt; m [TxSkelOut]) -&gt; TxSkel -&gt; m [Versioned Validator]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; m TxSkelOut) -&gt; [TxOutRef] -&gt; m [TxSkelOut]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m TxSkelOut
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var">txSkelOutByRef</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOutRef] -&gt; m [TxSkelOut])
-&gt; (TxSkel -&gt; [TxOutRef]) -&gt; TxSkel -&gt; m [TxSkelOut]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef])
-&gt; (TxSkel -&gt; Map TxOutRef TxSkelRedeemer) -&gt; TxSkel -&gt; [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Map TxOutRef TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-identifier hs-var">txSkelIns</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><span class="hs-comment">-- | Returns all scripts involved in this 'TxSkel'</span></span><span>
</span><span id="line-240"></span><span id="local-6989586621679811693"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelAllScripts"><span class="hs-identifier hs-type">txSkelAllScripts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811693"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811693"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-241"></span><span id="txSkelAllScripts"><span class="annot"><span class="annottext">txSkelAllScripts :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m [Versioned Script]
</span><a href="Cooked.MockChain.BlockChain.html#txSkelAllScripts"><span class="hs-identifier hs-var hs-var">txSkelAllScripts</span></a></span></span><span> </span><span id="local-6989586621679812348"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679812348"><span class="hs-identifier hs-var">txSkel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679812349"><span class="annot"><span class="annottext">[Versioned Script]
</span><a href="#local-6989586621679812349"><span class="hs-identifier hs-var">txSkelSpendingScripts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Versioned Validator -&gt; Versioned Script)
-&gt; [Versioned Validator] -&gt; [Versioned Script]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Versioned Validator -&gt; Versioned Script
forall s a. ToVersioned s a =&gt; a -&gt; Versioned s
</span><span class="hs-identifier hs-var">Script.toVersioned</span></span><span> </span><span class="annot"><span class="annottext">([Versioned Validator] -&gt; [Versioned Script])
-&gt; m [Versioned Validator] -&gt; m [Versioned Script]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m [Versioned Validator]
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m [Versioned Validator]
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputValidators"><span class="hs-identifier hs-var">txSkelInputValidators</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679812348"><span class="hs-identifier hs-var">txSkel</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">[Versioned Script] -&gt; m [Versioned Script]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkel -&gt; [Versioned Script]
</span><a href="Cooked.Skeleton.html#txSkelMintingScripts"><span class="hs-identifier hs-var">txSkelMintingScripts</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679812348"><span class="hs-identifier hs-var">txSkel</span></a></span><span> </span><span class="annot"><span class="annottext">[Versioned Script] -&gt; [Versioned Script] -&gt; [Versioned Script]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; [Versioned Script]
</span><a href="Cooked.Skeleton.html#txSkelWithdrawingScripts"><span class="hs-identifier hs-var">txSkelWithdrawingScripts</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679812348"><span class="hs-identifier hs-var">txSkel</span></a></span><span> </span><span class="annot"><span class="annottext">[Versioned Script] -&gt; [Versioned Script] -&gt; [Versioned Script]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; [Versioned Script]
</span><a href="Cooked.Skeleton.html#txSkelProposingScripts"><span class="hs-identifier hs-var">txSkelProposingScripts</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679812348"><span class="hs-identifier hs-var">txSkel</span></a></span><span> </span><span class="annot"><span class="annottext">[Versioned Script] -&gt; [Versioned Script] -&gt; [Versioned Script]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Versioned Script]
</span><a href="#local-6989586621679812349"><span class="hs-identifier hs-var">txSkelSpendingScripts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Go through all of the 'Api.TxOutRef's in the list and look them up in the</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- state of the blockchain, throwing an error if one of them cannot be resolved.</span><span>
</span><span id="line-247"></span><span id="local-6989586621679811702"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-type">lookupUtxos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811702"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811702"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.Output.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-248"></span><span id="lookupUtxos"><span class="annot"><span class="annottext">lookupUtxos :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxSkelOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-var hs-var">lookupUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxSkelOut -&gt; TxOutRef -&gt; m (Map TxOutRef TxSkelOut))
-&gt; Map TxOutRef TxSkelOut
-&gt; [TxOutRef]
-&gt; m (Map TxOutRef TxSkelOut)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679812367"><span class="annot"><span class="annottext">Map TxOutRef TxSkelOut
</span><a href="#local-6989586621679812367"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679812368"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679812368"><span class="hs-identifier hs-var">oRef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Map TxOutRef TxSkelOut -&gt; Map TxOutRef TxSkelOut)
-&gt; Map TxOutRef TxSkelOut -&gt; TxSkelOut -&gt; Map TxOutRef TxSkelOut
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef
-&gt; TxSkelOut -&gt; Map TxOutRef TxSkelOut -&gt; Map TxOutRef TxSkelOut
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679812368"><span class="hs-identifier hs-var">oRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelOut
</span><a href="#local-6989586621679812367"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Map TxOutRef TxSkelOut)
-&gt; m TxSkelOut -&gt; m (Map TxOutRef TxSkelOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m TxSkelOut
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var">txSkelOutByRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679812368"><span class="hs-identifier hs-var">oRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelOut
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><span class="hs-comment">-- | look up the UTxOs the transaction consumes, and sum their values.</span></span><span>
</span><span id="line-251"></span><span id="local-6989586621679811715"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValue"><span class="hs-identifier hs-type">txSkelInputValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811715"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811715"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span></span><span>
</span><span id="line-252"></span><span id="txSkelInputValue"><span class="annot"><span class="annottext">txSkelInputValue :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m Value
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputValue"><span class="hs-identifier hs-var hs-var">txSkelInputValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; m [Value] -&gt; m Value
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">(m [Value] -&gt; m Value)
-&gt; (TxSkel -&gt; m [Value]) -&gt; TxSkel -&gt; m Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; m Value) -&gt; [TxOutRef] -&gt; m [Value]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxSkelOut Value -&gt; TxOutRef -&gt; m Value
forall (m :: * -&gt; *) g (is :: IxList) c.
(MonadBlockChainBalancing m, Is g A_Getter) =&gt;
Optic' g is TxSkelOut c -&gt; TxOutRef -&gt; m c
</span><a href="Cooked.MockChain.BlockChain.html#viewByRef"><span class="hs-identifier hs-var">viewByRef</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxSkelOut Value
</span><a href="Cooked.Skeleton.Output.html#txSkelOutValueL"><span class="hs-identifier hs-var">txSkelOutValueL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([TxOutRef] -&gt; m [Value])
-&gt; (TxSkel -&gt; [TxOutRef]) -&gt; TxSkel -&gt; m [Value]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef])
-&gt; (TxSkel -&gt; Map TxOutRef TxSkelRedeemer) -&gt; TxSkel -&gt; [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Map TxOutRef TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-identifier hs-var">txSkelIns</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><span class="hs-comment">-- * Slot and Time Management</span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- $slotandtime</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- #slotandtime#</span><span>
</span><span id="line-258"></span><span class="hs-comment">--</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- Slots are integers that monotonically increase and model the passage of</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- time. By looking at the current slot, a validator gets to know that it is</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- being executed within a certain window of wall-clock time. Things can get</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- annoying pretty fast when trying to mock traces and trying to exercise</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- certain branches of certain validators; make sure you also read the docs on</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- 'autoSlotIncrease' to be able to simulate sending transactions in parallel.</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><span class="hs-comment">-- | Returns the current slot number</span></span><span>
</span><span id="line-267"></span><span id="local-6989586621679811719"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-type">currentSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811719"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811719"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span><span>
</span><span id="line-268"></span><span id="currentSlot"><span class="annot"><span class="annottext">currentSlot :: forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-var">waitNSlots</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><span class="hs-comment">-- | Wait for a certain slot, or throws an error if the slot is already past</span></span><span>
</span><span id="line-271"></span><span id="local-6989586621679811722"><span id="local-6989586621679811723"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-type">awaitSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811722"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679811723"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811723"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811722"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span></span><span>
</span><span id="line-272"></span><span id="awaitSlot"><span class="annot"><span class="annottext">awaitSlot :: forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var hs-var">awaitSlot</span></a></span></span><span> </span><span id="local-6989586621679812406"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679812406"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; (Slot -&gt; m Slot) -&gt; m Slot
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; m Slot
forall i. Integral i =&gt; i -&gt; m Slot
forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-var">waitNSlots</span></a></span><span> </span><span class="annot"><span class="annottext">(i -&gt; m Slot) -&gt; (Slot -&gt; i) -&gt; Slot -&gt; m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679812406"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="annot"><span class="annottext">i -&gt; i -&gt; i
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(i -&gt; i) -&gt; (Slot -&gt; i) -&gt; Slot -&gt; i
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; i
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><span class="hs-comment">-- | Returns the closed ms interval corresponding to the current slot</span></span><span>
</span><span id="line-275"></span><span id="local-6989586621679811731"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#currentMSRange"><span class="hs-identifier hs-type">currentMSRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811731"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811731"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-276"></span><span id="currentMSRange"><span class="annot"><span class="annottext">currentMSRange :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#currentMSRange"><span class="hs-identifier hs-var hs-var">currentMSRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToMSRange"><span class="hs-identifier hs-var">slotToMSRange</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; m (POSIXTime, POSIXTime))
-&gt; m Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Returns the closed ms interval corresponding to the slot with the given</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- number. It holds that</span><span>
</span><span id="line-280"></span><span class="hs-comment">--</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- &gt; slotToMSRange (getEnclosingSlot t) == (a, b)    ==&gt;   a &lt;= t &lt;= b</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-284"></span><span class="hs-comment">--</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- &gt; slotToMSRange n == (a, b)   ==&gt;   getEnclosingSlot a == n &amp;&amp; getEnclosingSlot b == n</span><span>
</span><span id="line-286"></span><span class="hs-comment">--</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-288"></span><span class="hs-comment">--</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- &gt; slotToMSRange n == (a, b)   ==&gt;   getEnclosingSlot (a-1) == n-1 &amp;&amp; getEnclosingSlot (b+1) == n+1</span><span>
</span><span id="line-290"></span><span id="local-6989586621679811734"><span id="local-6989586621679811735"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotToMSRange"><span class="hs-identifier hs-type">slotToMSRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811734"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679811735"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811735"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811734"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-291"></span><span id="slotToMSRange"><span class="annot"><span class="annottext">slotToMSRange :: forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToMSRange"><span class="hs-identifier hs-var hs-var">slotToMSRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Slot
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679812435"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812435"><span class="hs-identifier hs-var">slot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679812436"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679812436"><span class="hs-identifier hs-var">slotConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Params -&gt; SlotConfig
</span><span class="hs-identifier hs-var">Emulator.pSlotConfig</span></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; SlotConfig) -&gt; m Params -&gt; m SlotConfig
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; Slot -&gt; POSIXTimeRange
</span><span class="hs-identifier hs-var">Emulator.slotToPOSIXTimeRange</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679812436"><span class="hs-identifier hs-var">slotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812435"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.Interval</span></span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.LowerBound</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.Finite</span></span><span> </span><span id="local-6989586621679812442"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812442"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679812443"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679812443"><span class="hs-identifier hs-var">leftclosed</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.UpperBound</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.Finite</span></span><span> </span><span id="local-6989586621679812445"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812445"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679812446"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679812446"><span class="hs-identifier hs-var">rightclosed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="annottext">(POSIXTime, POSIXTime) -&gt; m (POSIXTime, POSIXTime)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679812443"><span class="hs-identifier hs-var">leftclosed</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812442"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812442"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-299"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679812446"><span class="hs-identifier hs-var">rightclosed</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812445"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812445"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-number">1</span></span><span>
</span><span id="line-300"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">POSIXTimeRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m (POSIXTime, POSIXTime)
forall a. String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected unbounded slot: please report a bug at https://github.com/tweag/cooked-validators/issues&quot;</span></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Return the slot that contains the given time. See 'slotToMSRange' for</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- some satisfied equational properties.</span><span>
</span><span id="line-305"></span><span id="local-6989586621679811744"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-type">getEnclosingSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811744"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811744"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span><span>
</span><span id="line-306"></span><span id="getEnclosingSlot"><span class="annot"><span class="annottext">getEnclosingSlot :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var hs-var">getEnclosingSlot</span></a></span></span><span> </span><span id="local-6989586621679812456"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812456"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotConfig -&gt; POSIXTime -&gt; Slot
</span><span class="hs-operator hs-var">`Emulator.posixTimeToEnclosingSlot`</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812456"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SlotConfig -&gt; Slot) -&gt; (Params -&gt; SlotConfig) -&gt; Params -&gt; Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; SlotConfig
</span><span class="hs-identifier hs-var">Emulator.pSlotConfig</span></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Slot) -&gt; m Params -&gt; m Slot
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- | Waits until the current slot becomes greater or equal to the slot</span><span>
</span><span id="line-309"></span><span class="hs-comment">--  containing the given POSIX time.  Note that that it might not wait for</span><span>
</span><span id="line-310"></span><span class="hs-comment">--  anything if the current slot is large enough.</span><span>
</span><span id="line-311"></span><span id="local-6989586621679812458"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier hs-type">awaitEnclosingSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679812458"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679812458"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span><span>
</span><span id="line-312"></span><span id="awaitEnclosingSlot"><span class="annot"><span class="annottext">awaitEnclosingSlot :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier hs-var hs-var">awaitEnclosingSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m Slot
forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; m Slot) -&gt; (POSIXTime -&gt; m Slot) -&gt; POSIXTime -&gt; m Slot
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var">getEnclosingSlot</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Wait a given number of ms from the lower bound of the current slot and</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- returns the current slot after waiting.</span><span>
</span><span id="line-316"></span><span id="local-6989586621679812467"><span id="local-6989586621679812468"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#waitNMSFromSlotLowerBound"><span class="hs-identifier hs-type">waitNMSFromSlotLowerBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679812467"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679812468"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679812468"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679812467"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span></span><span>
</span><span id="line-317"></span><span id="waitNMSFromSlotLowerBound"><span class="annot"><span class="annottext">waitNMSFromSlotLowerBound :: forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNMSFromSlotLowerBound"><span class="hs-identifier hs-var hs-var">waitNMSFromSlotLowerBound</span></a></span></span><span> </span><span id="local-6989586621679812480"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679812480"><span class="hs-identifier hs-var">duration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#currentMSRange"><span class="hs-identifier hs-var">currentMSRange</span></a></span><span> </span><span class="annot"><span class="annottext">m (POSIXTime, POSIXTime)
-&gt; ((POSIXTime, POSIXTime) -&gt; m Slot) -&gt; m Slot
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier hs-var">awaitEnclosingSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; m Slot)
-&gt; ((POSIXTime, POSIXTime) -&gt; POSIXTime)
-&gt; (POSIXTime, POSIXTime)
-&gt; m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; POSIXTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679812480"><span class="hs-identifier hs-var">duration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; POSIXTime)
-&gt; ((POSIXTime, POSIXTime) -&gt; POSIXTime)
-&gt; (POSIXTime, POSIXTime)
-&gt; POSIXTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(POSIXTime, POSIXTime) -&gt; POSIXTime
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Wait a given number of ms from the upper bound of the current slot and</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- returns the current slot after waiting.</span><span>
</span><span id="line-321"></span><span id="local-6989586621679812481"><span id="local-6989586621679812482"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#waitNMSFromSlotUpperBound"><span class="hs-identifier hs-type">waitNMSFromSlotUpperBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679812481"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679812482"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679812482"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679812481"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span></span><span>
</span><span id="line-322"></span><span id="waitNMSFromSlotUpperBound"><span class="annot"><span class="annottext">waitNMSFromSlotUpperBound :: forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNMSFromSlotUpperBound"><span class="hs-identifier hs-var hs-var">waitNMSFromSlotUpperBound</span></a></span></span><span> </span><span id="local-6989586621679812494"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679812494"><span class="hs-identifier hs-var">duration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#currentMSRange"><span class="hs-identifier hs-var">currentMSRange</span></a></span><span> </span><span class="annot"><span class="annottext">m (POSIXTime, POSIXTime)
-&gt; ((POSIXTime, POSIXTime) -&gt; m Slot) -&gt; m Slot
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier hs-var">awaitEnclosingSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; m Slot)
-&gt; ((POSIXTime, POSIXTime) -&gt; POSIXTime)
-&gt; (POSIXTime, POSIXTime)
-&gt; m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; POSIXTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679812494"><span class="hs-identifier hs-var">duration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; POSIXTime)
-&gt; ((POSIXTime, POSIXTime) -&gt; POSIXTime)
-&gt; (POSIXTime, POSIXTime)
-&gt; POSIXTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(POSIXTime, POSIXTime) -&gt; POSIXTime
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="annot"><span class="hs-comment">-- | The infinite range of slots ending before or at the given time</span></span><span>
</span><span id="line-325"></span><span id="local-6989586621679811753"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeBefore"><span class="hs-identifier hs-type">slotRangeBefore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811753"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679811753"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.SlotRange</span></span></span><span>
</span><span id="line-326"></span><span id="slotRangeBefore"><span class="annot"><span class="annottext">slotRangeBefore :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m SlotRange
</span><a href="Cooked.MockChain.BlockChain.html#slotRangeBefore"><span class="hs-identifier hs-var hs-var">slotRangeBefore</span></a></span></span><span> </span><span id="local-6989586621679812510"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812510"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679812511"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812511"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var">getEnclosingSlot</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812510"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679812512"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812512"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToMSRange"><span class="hs-identifier hs-var">slotToMSRange</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812511"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-comment">-- If the given time @t@ happens to be the last ms of its slot, we can include</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-comment">-- the whole slot. Otherwise, the only way to be sure that the returned slot</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-comment">-- range contains no time after @t@ is to go to the preceding slot.</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><span class="annottext">SlotRange -&gt; m SlotRange
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SlotRange -&gt; m SlotRange) -&gt; SlotRange -&gt; m SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotRange
forall a. a -&gt; Interval a
</span><span class="hs-identifier hs-var">Api.to</span></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; SlotRange) -&gt; Slot -&gt; SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812510"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812512"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812511"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812511"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><span class="hs-comment">-- | The infinite range of slots starting after or at the given time</span></span><span>
</span><span id="line-335"></span><span id="local-6989586621679812514"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeAfter"><span class="hs-identifier hs-type">slotRangeAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679812514"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679812514"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.SlotRange</span></span></span><span>
</span><span id="line-336"></span><span id="slotRangeAfter"><span class="annot"><span class="annottext">slotRangeAfter :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m SlotRange
</span><a href="Cooked.MockChain.BlockChain.html#slotRangeAfter"><span class="hs-identifier hs-var hs-var">slotRangeAfter</span></a></span></span><span> </span><span id="local-6989586621679812528"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812528"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679812529"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812529"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var">getEnclosingSlot</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812528"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679812530"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812530"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToMSRange"><span class="hs-identifier hs-var">slotToMSRange</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812529"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">SlotRange -&gt; m SlotRange
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SlotRange -&gt; m SlotRange) -&gt; SlotRange -&gt; m SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotRange
forall a. a -&gt; Interval a
</span><span class="hs-identifier hs-var">Api.from</span></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; SlotRange) -&gt; Slot -&gt; SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812528"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679812530"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812529"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679812529"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="annot"><span class="hs-comment">-- * Deriving further 'MonadBlockChain' instances</span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- | A newtype wrapper to be used with '-XDerivingVia' to derive instances of</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- 'MonadBlockChain' for any 'MonadTransControl'.</span><span>
</span><span id="line-345"></span><span class="hs-comment">--</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- For example, to derive 'MonadBlockChain m =&gt; MonadBlockChain (ReaderT r m)',</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- you'd write</span><span>
</span><span id="line-348"></span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- &gt; deriving via (AsTrans (ReaderT r) m) instance MonadBlockChain m =&gt; MonadBlockChain (ReaderT r m)</span><span>
</span><span id="line-350"></span><span class="hs-comment">--</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- and avoid the trouble of defining all the class methods yourself.</span><span>
</span><span id="line-352"></span><span class="hs-keyword">newtype</span><span> </span><span id="AsTrans"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-var">AsTrans</span></a></span></span><span> </span><span id="local-6989586621679811762"><span class="annot"><a href="#local-6989586621679811762"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679811763"><span class="annot"><a href="#local-6989586621679811763"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679811764"><span class="annot"><a href="#local-6989586621679811764"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AsTrans"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-var">AsTrans</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getTrans"><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; *) (m :: * -&gt; *) (a :: k).
AsTrans t m a -&gt; t m a
</span><a href="Cooked.MockChain.BlockChain.html#getTrans"><span class="hs-identifier hs-var hs-var">getTrans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679811762"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811763"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811764"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679812536"><span id="local-6989586621679812540"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b)
-&gt; (forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a)
-&gt; Functor (AsTrans t m)
forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
(a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$cfmap :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
(a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
fmap :: forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$c&lt;$ :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
a -&gt; AsTrans t m b -&gt; AsTrans t m a
&lt;$ :: forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679812550"><span id="local-6989586621679812554"><span id="local-6989586621679812558"><span id="local-6989586621679812562"><span id="local-6989586621679812566"><span class="annot"><span class="annottext">Functor (AsTrans t m)
Functor (AsTrans t m) =&gt;
(forall a. a -&gt; AsTrans t m a)
-&gt; (forall a b.
    AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a)
-&gt; Applicative (AsTrans t m)
forall a. a -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall a b. AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Applicative (t m) =&gt;
Functor (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Applicative (t m) =&gt;
a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b c.
Applicative (t m) =&gt;
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
$cpure :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Applicative (t m) =&gt;
a -&gt; AsTrans t m a
pure :: forall a. a -&gt; AsTrans t m a
$c&lt;*&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
&lt;*&gt; :: forall a b. AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$cliftA2 :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b c.
Applicative (t m) =&gt;
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
$c*&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
*&gt; :: forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
$c&lt;* :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
&lt;* :: forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679812576"><span id="local-6989586621679812580"><span id="local-6989586621679812584"><span class="annot"><span class="annottext">Applicative (AsTrans t m)
Applicative (AsTrans t m) =&gt;
(forall a b.
 AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b)
-&gt; (forall a. a -&gt; AsTrans t m a)
-&gt; Monad (AsTrans t m)
forall a. a -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall a b. AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Monad (t m) =&gt;
Applicative (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Monad (t m) =&gt;
a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
$c&gt;&gt;= :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
&gt;&gt;= :: forall a b. AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
$c&gt;&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
&gt;&gt; :: forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
$creturn :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Monad (t m) =&gt;
a -&gt; AsTrans t m a
return :: forall a. a -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679812595"><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). Monad m =&gt; Monad (AsTrans t m)) =&gt;
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a)
-&gt; MonadTrans (AsTrans t)
forall (m :: * -&gt; *). Monad m =&gt; Monad (AsTrans t m)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
(MonadTrans t, Monad m) =&gt;
Monad (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
(forall (m :: * -&gt; *). Monad m =&gt; Monad (t m)) =&gt;
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a) -&gt; MonadTrans t
$clift :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; AsTrans t m a
lift :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadTrans</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679812613"><span id="local-6989586621679812622"><span class="annot"><span class="annottext">MonadTrans (AsTrans t)
MonadTrans (AsTrans t) =&gt;
(forall (m :: * -&gt; *) a.
 Monad m =&gt;
 (Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a)
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    m (StT (AsTrans t) a) -&gt; AsTrans t m a)
-&gt; MonadTransControl (AsTrans t)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
MonadTrans t =&gt;
(forall (m :: * -&gt; *) a. Monad m =&gt; (Run t -&gt; m a) -&gt; t m a)
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; m (StT t a) -&gt; t m a)
-&gt; MonadTransControl t
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
MonadTransControl t =&gt;
MonadTrans (AsTrans t)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
$cliftWith :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
$crestoreT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadTransControl</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811849"><span id="local-6989586621679811850"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679811849"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679811850"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679811849"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811850"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811849"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811850"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>  </span><span id="local-6989586621679812643"><span class="annot"><span class="annottext">fail :: forall a. String -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; AsTrans t m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; AsTrans t m a)
-&gt; (String -&gt; m a) -&gt; String -&gt; AsTrans t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall a. String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811858"><span id="local-6989586621679811859"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTransControl</span></span><span> </span><span class="annot"><a href="#local-6989586621679811858"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811859"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679811858"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811859"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811858"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811859"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621679812660"><span class="annot"><span class="annottext">throwError :: forall a. MockChainError -&gt; AsTrans t m a
</span><a href="#local-6989586621679812660"><span class="hs-identifier hs-var hs-var hs-var hs-var">throwError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; AsTrans t m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; AsTrans t m a)
-&gt; (MockChainError -&gt; m a) -&gt; MockChainError -&gt; AsTrans t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; m a
forall a. MockChainError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679812671"><span class="annot"><span class="annottext">catchError :: forall a.
AsTrans t m a -&gt; (MockChainError -&gt; AsTrans t m a) -&gt; AsTrans t m a
</span><a href="#local-6989586621679812671"><span class="hs-identifier hs-var hs-var hs-var hs-var">catchError</span></a></span></span><span> </span><span id="local-6989586621679812673"><span class="annot"><span class="annottext">AsTrans t m a
</span><a href="#local-6989586621679812673"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679812674"><span class="annot"><span class="annottext">MockChainError -&gt; AsTrans t m a
</span><a href="#local-6989586621679812674"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Run (AsTrans t) -&gt; m (StT t a)) -&gt; AsTrans t m (StT t a)
forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><span class="hs-identifier hs-var">liftWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679812676"><span class="annot"><span class="annottext">Run (AsTrans t)
</span><a href="#local-6989586621679812676"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; (MockChainError -&gt; m (StT t a)) -&gt; m (StT t a)
forall a. m a -&gt; (MockChainError -&gt; m a) -&gt; m a
forall e (m :: * -&gt; *) a.
MonadError e m =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">catchError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsTrans t m a -&gt; m (StT (AsTrans t) a)
Run (AsTrans t)
</span><a href="#local-6989586621679812676"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">AsTrans t m a
</span><a href="#local-6989586621679812673"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsTrans t m a -&gt; m (StT t a)
AsTrans t m a -&gt; m (StT (AsTrans t) a)
Run (AsTrans t)
</span><a href="#local-6989586621679812676"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(AsTrans t m a -&gt; m (StT t a))
-&gt; (MockChainError -&gt; AsTrans t m a)
-&gt; MockChainError
-&gt; m (StT t a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; AsTrans t m a
</span><a href="#local-6989586621679812674"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AsTrans t m (StT t a)
-&gt; (StT t a -&gt; AsTrans t m a) -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; AsTrans t m a
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><span class="hs-identifier hs-var">restoreT</span></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; AsTrans t m a)
-&gt; (StT t a -&gt; m (StT t a)) -&gt; StT t a -&gt; AsTrans t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StT t a -&gt; m (StT t a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811866"><span id="local-6989586621679811867"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679811866"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811867"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679811866"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811867"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811866"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811867"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811866"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811867"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679812697"><span class="annot"><span class="annottext">getParams :: AsTrans t m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">getParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Params -&gt; AsTrans t m Params
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621679812703"><span class="annot"><span class="annottext">utxosAt :: forall a. ToAddress a =&gt; a -&gt; AsTrans t m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier hs-var hs-var hs-var hs-var">utxosAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxSkelOut)] -&gt; AsTrans t m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [(TxOutRef, TxSkelOut)] -&gt; AsTrans t m [(TxOutRef, TxSkelOut)])
-&gt; (a -&gt; m [(TxOutRef, TxSkelOut)])
-&gt; a
-&gt; AsTrans t m [(TxOutRef, TxSkelOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m [(TxOutRef, TxSkelOut)]
forall a. ToAddress a =&gt; a -&gt; m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *) a.
(MonadBlockChainBalancing m, ToAddress a) =&gt;
a -&gt; m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679812707"><span class="annot"><span class="annottext">txSkelOutByRef :: TxOutRef -&gt; AsTrans t m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var hs-var hs-var hs-var">txSkelOutByRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m TxSkelOut -&gt; AsTrans t m TxSkelOut
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m TxSkelOut -&gt; AsTrans t m TxSkelOut)
-&gt; (TxOutRef -&gt; m TxSkelOut) -&gt; TxOutRef -&gt; AsTrans t m TxSkelOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m TxSkelOut
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var">txSkelOutByRef</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679812711"><span class="annot"><span class="annottext">logEvent :: MockChainLogEntry -&gt; AsTrans t m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var hs-var hs-var hs-var">logEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; AsTrans t m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; AsTrans t m ())
-&gt; (MockChainLogEntry -&gt; m ())
-&gt; MockChainLogEntry
-&gt; AsTrans t m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainLogEntry -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
MockChainLogEntry -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var">logEvent</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811874"><span id="local-6989586621679811875"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679811874"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811875"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679811874"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811875"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811874"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811875"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811874"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811875"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679812733"><span class="annot"><span class="annottext">allUtxos :: AsTrans t m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-var hs-var hs-var hs-var">allUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxSkelOut)] -&gt; AsTrans t m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-var">allUtxos</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621679812737"><span class="annot"><span class="annottext">setParams :: Params -&gt; AsTrans t m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">setParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; AsTrans t m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; AsTrans t m ())
-&gt; (Params -&gt; m ()) -&gt; Params -&gt; AsTrans t m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Params -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var">setParams</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679812743"><span class="annot"><span class="annottext">waitNSlots :: forall i. Integral i =&gt; i -&gt; AsTrans t m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-var hs-var hs-var hs-var">waitNSlots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; AsTrans t m Slot
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m Slot -&gt; AsTrans t m Slot)
-&gt; (i -&gt; m Slot) -&gt; i -&gt; AsTrans t m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; m Slot
forall i. Integral i =&gt; i -&gt; m Slot
forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-var">waitNSlots</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621679812749"><span class="annot"><span class="annottext">define :: forall a. ToHash a =&gt; String -&gt; a -&gt; AsTrans t m a
</span><a href="Cooked.MockChain.BlockChain.html#define"><span class="hs-identifier hs-var hs-var hs-var hs-var">define</span></a></span></span><span> </span><span id="local-6989586621679812750"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679812750"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; AsTrans t m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; AsTrans t m a) -&gt; (a -&gt; m a) -&gt; a -&gt; AsTrans t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; m a
forall a. ToHash a =&gt; String -&gt; a -&gt; m a
forall (m :: * -&gt; *) a.
(MonadBlockChainWithoutValidation m, ToHash a) =&gt;
String -&gt; a -&gt; m a
</span><a href="Cooked.MockChain.BlockChain.html#define"><span class="hs-identifier hs-var">define</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679812750"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679812756"><span class="annot"><span class="annottext">setConstitutionScript :: forall s. ToVersioned Script s =&gt; s -&gt; AsTrans t m ()
</span><a href="Cooked.MockChain.BlockChain.html#setConstitutionScript"><span class="hs-identifier hs-var hs-var hs-var hs-var">setConstitutionScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; AsTrans t m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; AsTrans t m ()) -&gt; (s -&gt; m ()) -&gt; s -&gt; AsTrans t m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; m ()
forall s. ToVersioned Script s =&gt; s -&gt; m ()
forall (m :: * -&gt; *) s.
(MonadBlockChainWithoutValidation m, ToVersioned Script s) =&gt;
s -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#setConstitutionScript"><span class="hs-identifier hs-var">setConstitutionScript</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679812760"><span class="annot"><span class="annottext">getConstitutionScript :: AsTrans t m (Maybe (Versioned Script))
</span><a href="Cooked.MockChain.BlockChain.html#getConstitutionScript"><span class="hs-identifier hs-var hs-var hs-var hs-var">getConstitutionScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe (Versioned Script))
-&gt; AsTrans t m (Maybe (Versioned Script))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m (Maybe (Versioned Script))
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m (Maybe (Versioned Script))
</span><a href="Cooked.MockChain.BlockChain.html#getConstitutionScript"><span class="hs-identifier hs-var">getConstitutionScript</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679812766"><span class="annot"><span class="annottext">registerStakingCred :: forall c.
ToCredential c =&gt;
c -&gt; Integer -&gt; Integer -&gt; AsTrans t m ()
</span><a href="Cooked.MockChain.BlockChain.html#registerStakingCred"><span class="hs-identifier hs-var hs-var hs-var hs-var">registerStakingCred</span></a></span></span><span> </span><span id="local-6989586621679812767"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679812767"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621679812768"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679812768"><span class="hs-identifier hs-var">reward</span></a></span></span><span> </span><span id="local-6989586621679812769"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679812769"><span class="hs-identifier hs-var">deposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; AsTrans t m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; AsTrans t m ()) -&gt; m () -&gt; AsTrans t m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Integer -&gt; Integer -&gt; m ()
forall c. ToCredential c =&gt; c -&gt; Integer -&gt; Integer -&gt; m ()
forall (m :: * -&gt; *) c.
(MonadBlockChainWithoutValidation m, ToCredential c) =&gt;
c -&gt; Integer -&gt; Integer -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#registerStakingCred"><span class="hs-identifier hs-var">registerStakingCred</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679812767"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679812768"><span class="hs-identifier hs-var">reward</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679812769"><span class="hs-identifier hs-var">deposit</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811882"><span id="local-6989586621679811883"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679811882"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811883"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811882"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811883"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811882"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811883"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621679812786"><span class="annot"><span class="annottext">validateTxSkel :: TxSkel -&gt; AsTrans t m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var hs-var hs-var hs-var">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m CardanoTx -&gt; AsTrans t m CardanoTx
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m CardanoTx -&gt; AsTrans t m CardanoTx)
-&gt; (TxSkel -&gt; m CardanoTx) -&gt; TxSkel -&gt; AsTrans t m CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m CardanoTx
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621679812790"><span class="annot"><span class="annottext">forceOutputs :: [TxSkelOut] -&gt; AsTrans t m [TxOutRef]
</span><a href="Cooked.MockChain.BlockChain.html#forceOutputs"><span class="hs-identifier hs-var hs-var hs-var hs-var">forceOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [TxOutRef] -&gt; AsTrans t m [TxOutRef]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [TxOutRef] -&gt; AsTrans t m [TxOutRef])
-&gt; ([TxSkelOut] -&gt; m [TxOutRef])
-&gt; [TxSkelOut]
-&gt; AsTrans t m [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut] -&gt; m [TxOutRef]
forall (m :: * -&gt; *).
MonadBlockChain m =&gt;
[TxSkelOut] -&gt; m [TxOutRef]
</span><a href="Cooked.MockChain.BlockChain.html#forceOutputs"><span class="hs-identifier hs-var">forceOutputs</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span id="local-6989586621679812802"><span id="local-6989586621679812811"><span id="local-6989586621679812820"><span id="local-6989586621679812827"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811898"><span id="local-6989586621679811899"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811898"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811899"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679811898"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811899"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811898"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811899"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span id="local-6989586621679812848"><span id="local-6989586621679812855"><span id="local-6989586621679812864"><span id="local-6989586621679812875"><span id="local-6989586621679812886"><span id="local-6989586621679812895"><span id="local-6989586621679812904"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811910"><span id="local-6989586621679811911"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811910"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811911"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679811910"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811911"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811910"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811911"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span id="local-6989586621679812929"><span id="local-6989586621679812935"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811914"><span id="local-6989586621679811915"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811914"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811915"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679811914"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811915"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811914"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811915"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span id="local-6989586621679812961"><span id="local-6989586621679812970"><span id="local-6989586621679812979"><span id="local-6989586621679812986"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811930"><span id="local-6989586621679811931"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811931"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811930"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811930"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811931"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811930"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span id="local-6989586621679813006"><span id="local-6989586621679813013"><span id="local-6989586621679813022"><span id="local-6989586621679813033"><span id="local-6989586621679813044"><span id="local-6989586621679813053"><span id="local-6989586621679813062"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811942"><span id="local-6989586621679811943"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811943"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811942"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811942"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811943"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811942"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span id="local-6989586621679813086"><span id="local-6989586621679813092"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811946"><span id="local-6989586621679811947"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811947"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811946"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811946"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811947"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811946"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621679813118"><span id="local-6989586621679813127"><span id="local-6989586621679813136"><span id="local-6989586621679813143"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811962"><span id="local-6989586621679811963"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811963"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811962"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811962"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811963"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811962"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span id="local-6989586621679813163"><span id="local-6989586621679813170"><span id="local-6989586621679813179"><span id="local-6989586621679813190"><span id="local-6989586621679813201"><span id="local-6989586621679813210"><span id="local-6989586621679813219"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811974"><span id="local-6989586621679811975"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811975"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811974"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811974"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811975"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811974"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span id="local-6989586621679813243"><span id="local-6989586621679813249"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679811978"><span id="local-6989586621679811979"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811979"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679811978"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811978"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811979"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811978"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- 'ListT' has no 'MonadTransControl' instance, so the @deriving via ...@</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- machinery is unusable here. However, there is</span><span>
</span><span id="line-401"></span><span class="hs-comment">--</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- &gt; MonadError e m =&gt; MonadError e (ListT m)</span><span>
</span><span id="line-403"></span><span class="hs-comment">--</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- so I decided to go with a bit of code duplication to implement the</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- 'MonadBlockChainWithoutValidation' and 'MonadBlockChain' instances for</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- 'ListT', instead of more black magic...</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811985"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811985"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811985"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679813284"><span class="annot"><span class="annottext">getParams :: ListT m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">getParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Params -&gt; ListT m Params
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621679813290"><span class="annot"><span class="annottext">utxosAt :: forall a. ToAddress a =&gt; a -&gt; ListT m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier hs-var hs-var hs-var hs-var">utxosAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxSkelOut)] -&gt; ListT m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [(TxOutRef, TxSkelOut)] -&gt; ListT m [(TxOutRef, TxSkelOut)])
-&gt; (a -&gt; m [(TxOutRef, TxSkelOut)])
-&gt; a
-&gt; ListT m [(TxOutRef, TxSkelOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m [(TxOutRef, TxSkelOut)]
forall a. ToAddress a =&gt; a -&gt; m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *) a.
(MonadBlockChainBalancing m, ToAddress a) =&gt;
a -&gt; m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier hs-var">utxosAt</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span id="local-6989586621679813294"><span class="annot"><span class="annottext">txSkelOutByRef :: TxOutRef -&gt; ListT m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var hs-var hs-var hs-var">txSkelOutByRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m TxSkelOut -&gt; ListT m TxSkelOut
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m TxSkelOut -&gt; ListT m TxSkelOut)
-&gt; (TxOutRef -&gt; m TxSkelOut) -&gt; TxOutRef -&gt; ListT m TxSkelOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m TxSkelOut
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m TxSkelOut
</span><a href="Cooked.MockChain.BlockChain.html#txSkelOutByRef"><span class="hs-identifier hs-var">txSkelOutByRef</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621679813298"><span class="annot"><span class="annottext">logEvent :: MockChainLogEntry -&gt; ListT m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var hs-var hs-var hs-var">logEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ListT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ListT m ())
-&gt; (MockChainLogEntry -&gt; m ()) -&gt; MockChainLogEntry -&gt; ListT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainLogEntry -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
MockChainLogEntry -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var">logEvent</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811988"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811988"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811988"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621679813316"><span class="annot"><span class="annottext">allUtxos :: ListT m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-var hs-var hs-var hs-var">allUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxSkelOut)] -&gt; ListT m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxSkelOut)]
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxSkelOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-var">allUtxos</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621679813320"><span class="annot"><span class="annottext">setParams :: Params -&gt; ListT m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">setParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ListT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ListT m ()) -&gt; (Params -&gt; m ()) -&gt; Params -&gt; ListT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Params -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var">setParams</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span id="local-6989586621679813326"><span class="annot"><span class="annottext">waitNSlots :: forall i. Integral i =&gt; i -&gt; ListT m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-var hs-var hs-var hs-var">waitNSlots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; ListT m Slot
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m Slot -&gt; ListT m Slot) -&gt; (i -&gt; m Slot) -&gt; i -&gt; ListT m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">i -&gt; m Slot
forall i. Integral i =&gt; i -&gt; m Slot
forall (m :: * -&gt; *) i.
(MonadBlockChainWithoutValidation m, Integral i) =&gt;
i -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-var">waitNSlots</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span id="local-6989586621679813332"><span class="annot"><span class="annottext">define :: forall a. ToHash a =&gt; String -&gt; a -&gt; ListT m a
</span><a href="Cooked.MockChain.BlockChain.html#define"><span class="hs-identifier hs-var hs-var hs-var hs-var">define</span></a></span></span><span> </span><span id="local-6989586621679813333"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679813333"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; ListT m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; ListT m a) -&gt; (a -&gt; m a) -&gt; a -&gt; ListT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; a -&gt; m a
forall a. ToHash a =&gt; String -&gt; a -&gt; m a
forall (m :: * -&gt; *) a.
(MonadBlockChainWithoutValidation m, ToHash a) =&gt;
String -&gt; a -&gt; m a
</span><a href="Cooked.MockChain.BlockChain.html#define"><span class="hs-identifier hs-var">define</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679813333"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621679813339"><span class="annot"><span class="annottext">setConstitutionScript :: forall s. ToVersioned Script s =&gt; s -&gt; ListT m ()
</span><a href="Cooked.MockChain.BlockChain.html#setConstitutionScript"><span class="hs-identifier hs-var hs-var hs-var hs-var">setConstitutionScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ListT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ListT m ()) -&gt; (s -&gt; m ()) -&gt; s -&gt; ListT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; m ()
forall s. ToVersioned Script s =&gt; s -&gt; m ()
forall (m :: * -&gt; *) s.
(MonadBlockChainWithoutValidation m, ToVersioned Script s) =&gt;
s -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#setConstitutionScript"><span class="hs-identifier hs-var">setConstitutionScript</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621679813343"><span class="annot"><span class="annottext">getConstitutionScript :: ListT m (Maybe (Versioned Script))
</span><a href="Cooked.MockChain.BlockChain.html#getConstitutionScript"><span class="hs-identifier hs-var hs-var hs-var hs-var">getConstitutionScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe (Versioned Script)) -&gt; ListT m (Maybe (Versioned Script))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m (Maybe (Versioned Script))
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m (Maybe (Versioned Script))
</span><a href="Cooked.MockChain.BlockChain.html#getConstitutionScript"><span class="hs-identifier hs-var">getConstitutionScript</span></a></span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621679813349"><span class="annot"><span class="annottext">registerStakingCred :: forall c. ToCredential c =&gt; c -&gt; Integer -&gt; Integer -&gt; ListT m ()
</span><a href="Cooked.MockChain.BlockChain.html#registerStakingCred"><span class="hs-identifier hs-var hs-var hs-var hs-var">registerStakingCred</span></a></span></span><span> </span><span id="local-6989586621679813350"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679813350"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span id="local-6989586621679813351"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679813351"><span class="hs-identifier hs-var">reward</span></a></span></span><span> </span><span id="local-6989586621679813352"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679813352"><span class="hs-identifier hs-var">deposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ListT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ListT m ()) -&gt; m () -&gt; ListT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Integer -&gt; Integer -&gt; m ()
forall c. ToCredential c =&gt; c -&gt; Integer -&gt; Integer -&gt; m ()
forall (m :: * -&gt; *) c.
(MonadBlockChainWithoutValidation m, ToCredential c) =&gt;
c -&gt; Integer -&gt; Integer -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#registerStakingCred"><span class="hs-identifier hs-var">registerStakingCred</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679813350"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679813351"><span class="hs-identifier hs-var">reward</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679813352"><span class="hs-identifier hs-var">deposit</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679811994"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679811994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679811994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-424"></span><span>  </span><span id="local-6989586621679813366"><span class="annot"><span class="annottext">validateTxSkel :: TxSkel -&gt; ListT m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var hs-var hs-var hs-var">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m CardanoTx -&gt; ListT m CardanoTx
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m CardanoTx -&gt; ListT m CardanoTx)
-&gt; (TxSkel -&gt; m CardanoTx) -&gt; TxSkel -&gt; ListT m CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m CardanoTx
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679813370"><span class="annot"><span class="annottext">forceOutputs :: [TxSkelOut] -&gt; ListT m [TxOutRef]
</span><a href="Cooked.MockChain.BlockChain.html#forceOutputs"><span class="hs-identifier hs-var hs-var hs-var hs-var">forceOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [TxOutRef] -&gt; ListT m [TxOutRef]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [TxOutRef] -&gt; ListT m [TxOutRef])
-&gt; ([TxSkelOut] -&gt; m [TxOutRef])
-&gt; [TxSkelOut]
-&gt; ListT m [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelOut] -&gt; m [TxOutRef]
forall (m :: * -&gt; *).
MonadBlockChain m =&gt;
[TxSkelOut] -&gt; m [TxOutRef]
</span><a href="Cooked.MockChain.BlockChain.html#forceOutputs"><span class="hs-identifier hs-var">forceOutputs</span></a></span><span>
</span><span id="line-426"></span></pre></body></html>
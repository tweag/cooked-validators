<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | This modules provides a specification for our blockchain monads, in three</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- layers:</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- 1. MonadBlockChainBalancing provides what's needing for balancing purposes</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- 2. MonadBlockChainWithoutValidation adds up remaining primitives without</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- transaction validation</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- 3. MonadBlockChain concludes with the addition of transaction validation,</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- thus modifying the internal index of outputs</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- In addition, you will find here many helpers functions which can be derived</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- from the core definition of our blockchain.</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.BlockChain</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier">MockChainLogEntry</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier">allUtxos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#currentTime"><span class="hs-identifier">currentTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier">waitNSlots</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier">utxosAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txOutByRef"><span class="hs-identifier">txOutByRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier">utxosFromCardanoTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier">txOutV2FromLedger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#typedDatumFromTxOutRef"><span class="hs-identifier">typedDatumFromTxOutRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#valueFromTxOutRef"><span class="hs-identifier">valueFromTxOutRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#outputDatumFromTxOutRef"><span class="hs-identifier">outputDatumFromTxOutRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#datumFromTxOutRef"><span class="hs-identifier">datumFromTxOutRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveDatum"><span class="hs-identifier">resolveDatum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveTypedDatum"><span class="hs-identifier">resolveTypedDatum</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveValidator"><span class="hs-identifier">resolveValidator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveReferenceScript"><span class="hs-identifier">resolveReferenceScript</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier">getEnclosingSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier">awaitEnclosingSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeBefore"><span class="hs-identifier">slotRangeBefore</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeAfter"><span class="hs-identifier">slotRangeAfter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotToTimeInterval"><span class="hs-identifier">slotToTimeInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxosPl"><span class="hs-identifier">txSkelInputUtxosPl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxos"><span class="hs-identifier">txSkelInputUtxos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelReferenceInputUtxosPl"><span class="hs-identifier">txSkelReferenceInputUtxosPl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelReferenceInputUtxos"><span class="hs-identifier">txSkelReferenceInputUtxos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValidators"><span class="hs-identifier">txSkelInputValidators</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValue"><span class="hs-identifier">txSkelInputValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputData"><span class="hs-identifier">txSkelInputData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier">lookupUtxos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#lookupUtxosPl"><span class="hs-identifier">lookupUtxosPl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel%27"><span class="hs-identifier">validateTxSkel'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelProposalsDeposit"><span class="hs-identifier">txSkelProposalsDeposit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier">govActionDeposit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.Ledger</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cardano</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Conway.PParams</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Conway</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Node.Emulator.Internal.Node</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Emulator</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lens</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Conversion.ToCredential.html"><span class="hs-identifier">Cooked.Conversion.ToCredential</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Conversion.ToOutputDatum.html"><span class="hs-identifier">Cooked.Conversion.ToOutputDatum</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Conversion.ToScriptHash.html"><span class="hs-identifier">Cooked.Conversion.ToScriptHash</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.html"><span class="hs-identifier">Cooked.MockChain.GenerateTx</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Output.html"><span class="hs-identifier">Cooked.Output</span></a></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html"><span class="hs-identifier">Cooked.Skeleton</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Wallet.html"><span class="hs-identifier">Cooked.Wallet</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Index</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Slot</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">ListT</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.Core</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusLedgerApi.V3</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><span class="hs-comment">-- * MockChain errors</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><span class="hs-comment">-- | The errors that can be produced by the 'MockChainT' monad</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">data</span><span> </span><span id="MockChainError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-var">MockChainError</span></a></span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | Validation errors, either in Phase 1 or Phase 2</span></span><span>
</span><span id="line-96"></span><span>    </span><span id="MCEValidationError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-var">MCEValidationError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ValidationPhase</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ValidationError</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Thrown when the balancing wallet does not have enough funds</span></span><span>
</span><span id="line-98"></span><span>    </span><span id="MCEUnbalanceable"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEUnbalanceable"><span class="hs-identifier hs-var">MCEUnbalanceable</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Thrown when not enough collateral are provided. Built upon the fee, the</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- percentage and the expected minimal collateral value.</span><span>
</span><span id="line-101"></span><span>    </span><span id="MCENoSuitableCollateral"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCENoSuitableCollateral"><span class="hs-identifier hs-var">MCENoSuitableCollateral</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Thrown when an error occured during transaction generation</span></span><span>
</span><span id="line-103"></span><span>    </span><span id="MCEGenerationError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEGenerationError"><span class="hs-identifier hs-var">MCEGenerationError</span></a></span></span><span> </span><span class="annot"><a href="Cooked.MockChain.GenerateTx.Common.html#GenerateTxError"><span class="hs-identifier hs-type">GenerateTxError</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Thrown when an output reference is missing from the mockchain state</span></span><span>
</span><span id="line-105"></span><span>    </span><span id="MCEUnknownOutRefError"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEUnknownOutRefError"><span class="hs-identifier hs-var">MCEUnknownOutRefError</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Same as 'MCEUnknownOutRefError' for validators.</span></span><span>
</span><span id="line-107"></span><span>    </span><span id="MCEUnknownValidator"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEUnknownValidator"><span class="hs-identifier hs-var">MCEUnknownValidator</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.ValidatorHash</span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Same as 'MCEUnknownOutRefError' for datums.</span></span><span>
</span><span id="line-109"></span><span>    </span><span id="MCEUnknownDatum"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEUnknownDatum"><span class="hs-identifier hs-var">MCEUnknownDatum</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.DatumHash</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Used to provide 'MonadFail' instances.</span></span><span>
</span><span id="line-111"></span><span>    </span><span id="FailWith"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#FailWith"><span class="hs-identifier hs-var">FailWith</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679779783"><span id="local-6989586621679779822"><span id="local-6989586621679779826"><span class="annot"><span class="annottext">Int -&gt; MockChainError -&gt; ShowS
[MockChainError] -&gt; ShowS
MockChainError -&gt; String
(Int -&gt; MockChainError -&gt; ShowS)
-&gt; (MockChainError -&gt; String)
-&gt; ([MockChainError] -&gt; ShowS)
-&gt; Show MockChainError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; MockChainError -&gt; ShowS
showsPrec :: Int -&gt; MockChainError -&gt; ShowS
$cshow :: MockChainError -&gt; String
show :: MockChainError -&gt; String
$cshowList :: [MockChainError] -&gt; ShowS
showList :: [MockChainError] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679779831"><span id="local-6989586621679779861"><span class="annot"><span class="annottext">MockChainError -&gt; MockChainError -&gt; Bool
(MockChainError -&gt; MockChainError -&gt; Bool)
-&gt; (MockChainError -&gt; MockChainError -&gt; Bool) -&gt; Eq MockChainError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: MockChainError -&gt; MockChainError -&gt; Bool
== :: MockChainError -&gt; MockChainError -&gt; Bool
$c/= :: MockChainError -&gt; MockChainError -&gt; Bool
/= :: MockChainError -&gt; MockChainError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><span class="hs-comment">-- * MockChain logs</span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | This represents the specific events that should be logged when processing</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- transactions. If a new kind of event arises, then a new constructor should be</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- provided here.</span><span>
</span><span id="line-119"></span><span class="hs-keyword">data</span><span> </span><span id="MockChainLogEntry"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-var">MockChainLogEntry</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | Logging a Skeleton as it is submitted by the user.</span></span><span>
</span><span id="line-121"></span><span>    </span><span id="MCLogSubmittedTxSkel"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogSubmittedTxSkel"><span class="hs-identifier hs-var">MCLogSubmittedTxSkel</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#SkelContext"><span class="hs-identifier hs-type">SkelContext</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging a Skeleton as it has been adjusted by the balancing mechanism,</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- alongside fee, and possible collateral utxos and return collateral wallet.</span><span>
</span><span id="line-124"></span><span>    </span><span id="MCLogAdjustedTxSkel"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogAdjustedTxSkel"><span class="hs-identifier hs-var">MCLogAdjustedTxSkel</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#SkelContext"><span class="hs-identifier hs-type">SkelContext</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging the appearance of a new transaction, after a skeleton has been</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- successfully sent for validation.</span><span>
</span><span id="line-127"></span><span>    </span><span id="MCLogNewTx"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogNewTx"><span class="hs-identifier hs-var">MCLogNewTx</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxId</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging the fact that utxos provided by the user for balancing have to be</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- discarded for a specific reason.</span><span>
</span><span id="line-130"></span><span>    </span><span id="MCLogDiscardedUtxos"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogDiscardedUtxos"><span class="hs-identifier hs-var">MCLogDiscardedUtxos</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Logging the fact that utxos provided as collaterals will not be used</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">-- because the transaction does not involve scripts. There are 2 cases,</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-comment">-- depending on whether the user has provided an explicit wallet or a set of</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-comment">-- utxos to be used as collaterals.</span><span>
</span><span id="line-135"></span><span>    </span><span id="MCLogUnusedCollaterals"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCLogUnusedCollaterals"><span class="hs-identifier hs-var">MCLogUnusedCollaterals</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | Contains methods needed for balancing.</span></span><span>
</span><span id="line-138"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBlockChainBalancing"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-var">MonadBlockChainBalancing</span></a></span></span><span> </span><span id="local-6989586621679779308"><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-comment">-- | Returns the emulator parameters, including protocol parameters</span><span>
</span><span id="line-140"></span><span>  </span><span id="getParams"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-type">getParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Emulator.Params</span></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-comment">-- | Returns a list of all UTxOs at a certain address.</span><span>
</span><span id="line-143"></span><span>  </span><span id="utxosAtLedger"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosAtLedger"><span class="hs-identifier hs-type">utxosAtLedger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- | Returns the datum with the given hash if present.</span><span>
</span><span id="line-146"></span><span>  </span><span id="datumFromHash"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-type">datumFromHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.DatumHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Datum</span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-comment">-- | Returns the full validator corresponding to hash, if that validator owns</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-comment">-- something or if it is stored in the reference script field of some UTxO.</span><span>
</span><span id="line-150"></span><span>  </span><span id="validatorFromHash"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-type">validatorFromHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.ValidatorHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Validator</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-comment">-- | Returns an output given a reference to it</span><span>
</span><span id="line-153"></span><span>  </span><span id="txOutByRefLedger"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-type">txOutByRefLedger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- | Logs an event that occured during a BlockChain run</span><span>
</span><span id="line-156"></span><span>  </span><span id="logEvent"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-type">logEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779308"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779311"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBlockChainWithoutValidation"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-var">MonadBlockChainWithoutValidation</span></a></span></span><span> </span><span id="local-6989586621679779311"><span class="annot"><a href="#local-6989586621679779311"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-comment">-- | Returns a list of all currently known outputs.</span><span>
</span><span id="line-160"></span><span>  </span><span id="allUtxosLedger"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#allUtxosLedger"><span class="hs-identifier hs-type">allUtxosLedger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679779311"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- | Updates parameters</span><span>
</span><span id="line-163"></span><span>  </span><span id="setParams"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-type">setParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Emulator.Params</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779311"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-comment">-- | Returns the current slot number</span><span>
</span><span id="line-166"></span><span>  </span><span id="currentSlot"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-type">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679779311"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">-- | Waits until the current slot becomes greater or equal to the given slot,</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-comment">-- and returns the current slot after waiting.</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-comment">-- Note that it might not wait for anything if the current slot is large</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-comment">-- enough.</span><span>
</span><span id="line-173"></span><span>  </span><span id="awaitSlot"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-type">awaitSlot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779311"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="annot"><span class="hs-comment">-- | The main abstraction of the blockchain.</span></span><span>
</span><span id="line-176"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779313"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadBlockChain"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-var">MonadBlockChain</span></a></span></span><span> </span><span id="local-6989586621679779313"><span class="annot"><a href="#local-6989586621679779313"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">-- | Generates, balances and validates a transaction from a skeleton. It</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">-- returns the validated transaction and updates the state of the</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">-- blockchain. In 'MockChainT', this means:</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- - deletes the consumed outputs from 'mcstIndex'</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">-- - adds the produced outputs to 'msctIndex'</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- - deletes the consumed datums from 'mcstDatums'</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- - adds the produced datums to 'mcstDatums'</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- - adds the validators on outputs to the 'mcstValidators'.</span><span>
</span><span id="line-186"></span><span>  </span><span id="validateTxSkel"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-type">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779313"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.CardanoTx</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Validates a skeleton, and retuns the ordered list of produced output</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- references</span><span>
</span><span id="line-190"></span><span id="local-6989586621679779315"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#validateTxSkel%27"><span class="hs-identifier hs-type">validateTxSkel'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779315"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779315"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-191"></span><span id="validateTxSkel%27"><span class="annot"><span class="annottext">validateTxSkel' :: forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m [TxOutRef]
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel%27"><span class="hs-identifier hs-var hs-var">validateTxSkel'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; TxOutRef)
-&gt; [(TxOutRef, TxOut)] -&gt; [TxOutRef]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; TxOutRef
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; [TxOutRef])
-&gt; (CardanoTx -&gt; [(TxOutRef, TxOut)]) -&gt; CardanoTx -&gt; [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier hs-var">utxosFromCardanoTx</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; [TxOutRef]) -&gt; m CardanoTx -&gt; m [TxOutRef]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m CardanoTx -&gt; m [TxOutRef])
-&gt; (TxSkel -&gt; m CardanoTx) -&gt; TxSkel -&gt; m [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m CardanoTx
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span id="local-6989586621679779332"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-type">allUtxos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779332"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779332"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-194"></span><span id="allUtxos"><span class="annot"><span class="annottext">allUtxos :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxos"><span class="hs-identifier hs-var hs-var">allUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; (TxOutRef, TxOut))
-&gt; [(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut) -&gt; (TxOutRef, TxOut) -&gt; (TxOutRef, TxOut)
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)])
-&gt; m [(TxOutRef, TxOut)] -&gt; m [(TxOutRef, TxOut)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxosLedger"><span class="hs-identifier hs-var">allUtxosLedger</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679779343"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier hs-type">utxosAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779343"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Address</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779343"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-197"></span><span id="utxosAt"><span class="annot"><span class="annottext">utxosAt :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
Address -&gt; m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAt"><span class="hs-identifier hs-var hs-var">utxosAt</span></a></span></span><span> </span><span id="local-6989586621679779925"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679779925"><span class="hs-identifier hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; (TxOutRef, TxOut))
-&gt; [(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut) -&gt; (TxOutRef, TxOut) -&gt; (TxOutRef, TxOut)
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)])
-&gt; m [(TxOutRef, TxOut)] -&gt; m [(TxOutRef, TxOut)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
Address -&gt; m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAtLedger"><span class="hs-identifier hs-var">utxosAtLedger</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679779925"><span class="hs-identifier hs-var">address</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621679779346"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txOutByRef"><span class="hs-identifier hs-type">txOutByRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779346"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779346"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-200"></span><span id="txOutByRef"><span class="annot"><span class="annottext">txOutByRef :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRef"><span class="hs-identifier hs-var hs-var">txOutByRef</span></a></span></span><span> </span><span id="local-6989586621679779935"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679779935"><span class="hs-identifier hs-var">oref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut) -&gt; Maybe TxOut -&gt; Maybe TxOut
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe TxOut -&gt; Maybe TxOut) -&gt; m (Maybe TxOut) -&gt; m (Maybe TxOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-var">txOutByRefLedger</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679779935"><span class="hs-identifier hs-var">oref</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Retrieve the ordered list of outputs of the given &quot;CardanoTx&quot;.</span><span>
</span><span id="line-203"></span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- This is useful when writing endpoints and/or traces to fetch utxos of</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- interest right from the start and avoid querying the chain for them</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- afterwards using 'allUtxos' or similar functions.</span><span>
</span><span id="line-207"></span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier hs-type">utxosFromCardanoTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.CardanoTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span id="utxosFromCardanoTx"><span class="annot"><span class="annottext">utxosFromCardanoTx :: CardanoTx -&gt; [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosFromCardanoTx"><span class="hs-identifier hs-var hs-var">utxosFromCardanoTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="annottext">((TxOut, TxIn) -&gt; (TxOutRef, TxOut))
-&gt; [(TxOut, TxIn)] -&gt; [(TxOutRef, TxOut)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679779936"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679779936"><span class="hs-identifier hs-var">txOut</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679779937"><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679779937"><span class="hs-identifier hs-var">txOutRef</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; TxOutRef
</span><span class="hs-identifier hs-var">Ledger.fromCardanoTxIn</span></span><span> </span><span class="annot"><span class="annottext">TxIn
</span><a href="#local-6989586621679779937"><span class="hs-identifier hs-var">txOutRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679779936"><span class="hs-identifier hs-var">txOut</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(TxOut, TxIn)] -&gt; [(TxOutRef, TxOut)])
-&gt; (CardanoTx -&gt; [(TxOut, TxIn)])
-&gt; CardanoTx
-&gt; [(TxOutRef, TxOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; [(TxOut, TxIn)]
</span><span class="hs-identifier hs-var">Ledger.getCardanoTxOutRefs</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-type">txOutV2FromLedger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span>
</span><span id="line-212"></span><span id="txOutV2FromLedger"><span class="annot"><span class="annottext">txOutV2FromLedger :: TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var hs-var">txOutV2FromLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut CtxTx ConwayEra -&gt; TxOut
forall era. TxOut CtxTx era -&gt; TxOut
</span><span class="hs-identifier hs-var">Ledger.fromCardanoTxOutToPV2TxInfoTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut CtxTx ConwayEra -&gt; TxOut)
-&gt; (TxOut -&gt; TxOut CtxTx ConwayEra) -&gt; TxOut -&gt; TxOut
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut CtxTx ConwayEra
</span><span class="hs-identifier hs-var">Ledger.getTxOut</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Try to resolve the datum on the output: If there's an inline datum, take</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- that; if there's a datum hash, look the corresponding datum up (with</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- 'datumFromHash'), returning @Nothing@ if it can't be found; if there's no</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- datum or hash at all, return @Nothing@.</span><span>
</span><span id="line-218"></span><span id="local-6989586621679779353"><span id="local-6989586621679779357"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveDatum"><span class="hs-identifier hs-type">resolveDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779353"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="Cooked.Conversion.ToOutputDatum.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779353"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779357"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="#local-6989586621679779353"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="#local-6989586621679779357"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779353"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Datum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779353"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779353"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-225"></span><span id="resolveDatum"><span class="annot"><span class="annottext">resolveDatum :: forall out (m :: * -&gt; *).
(IsAbstractOutput out, ToOutputDatum (DatumType out),
 MonadBlockChainBalancing m) =&gt;
out
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
</span><a href="Cooked.MockChain.BlockChain.html#resolveDatum"><span class="hs-identifier hs-var hs-var">resolveDatum</span></a></span></span><span> </span><span id="local-6989586621679779964"><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679779964"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679779965"><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679779965"><span class="hs-identifier hs-var">mDatum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">out -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679779964"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.OutputDatumHash</span></span><span> </span><span id="local-6989586621679779968"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679779968"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; m (Maybe Datum)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
DatumHash -&gt; m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var">datumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679779968"><span class="hs-identifier hs-var">datumHash</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.OutputDatum</span></span><span> </span><span id="local-6989586621679779970"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679779970"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; m (Maybe Datum)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Datum -&gt; m (Maybe Datum)) -&gt; Maybe Datum -&gt; m (Maybe Datum)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Maybe Datum
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679779970"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier hs-var">Api.NoOutputDatum</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; m (Maybe Datum)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   (ConcreteOutput
      (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
 -&gt; m (Maybe
         (ConcreteOutput
            (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))))
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679779972"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679779972"><span class="hs-identifier hs-var">mDat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">OwnerType out
-&gt; Maybe StakingCredential
-&gt; Datum
-&gt; ValueType out
-&gt; Maybe (ReferenceScriptType out)
-&gt; ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
forall ownerType datumType valueType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; datumType
-&gt; valueType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679779964"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (OwnerType out) -&gt; OwnerType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (OwnerType out)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679779964"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out
-&gt; Optic' A_Lens NoIx out (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679779972"><span class="hs-identifier hs-var">mDat</span></a></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679779964"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (ValueType out) -&gt; ValueType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (ValueType out)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679779964"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out
-&gt; Optic' A_Lens NoIx out (Maybe (ReferenceScriptType out))
-&gt; Maybe (ReferenceScriptType out)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (Maybe (ReferenceScriptType out))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><span class="annottext">(Datum
 -&gt; ConcreteOutput
      (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
-&gt; Maybe Datum
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679779965"><span class="hs-identifier hs-var">mDatum</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Like 'resolveDatum', but also tries to use 'fromBuiltinData' to extract a</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- datum of the suitable type.</span><span>
</span><span id="line-243"></span><span id="local-6989586621679779389"><span id="local-6989586621679779390"><span id="local-6989586621679779391"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveTypedDatum"><span class="hs-identifier hs-type">resolveTypedDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779389"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="Cooked.Conversion.ToOutputDatum.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779389"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779390"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.FromData</span></span><span> </span><span class="annot"><a href="#local-6989586621679779391"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><a href="#local-6989586621679779389"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><a href="#local-6989586621679779390"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779389"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779391"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779389"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779389"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-251"></span><span id="resolveTypedDatum"><span class="annot"><span class="annottext">resolveTypedDatum :: forall out (m :: * -&gt; *) a.
(IsAbstractOutput out, ToOutputDatum (DatumType out),
 MonadBlockChainBalancing m, FromData a) =&gt;
out
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) a (ValueType out) (ReferenceScriptType out)))
</span><a href="Cooked.MockChain.BlockChain.html#resolveTypedDatum"><span class="hs-identifier hs-var hs-var">resolveTypedDatum</span></a></span></span><span> </span><span id="local-6989586621679780006"><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780006"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679780007"><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
</span><a href="#local-6989586621679780007"><span class="hs-identifier hs-var">mOut</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">out
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
forall out (m :: * -&gt; *).
(IsAbstractOutput out, ToOutputDatum (DatumType out),
 MonadBlockChainBalancing m) =&gt;
out
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
</span><a href="Cooked.MockChain.BlockChain.html#resolveDatum"><span class="hs-identifier hs-var">resolveDatum</span></a></span><span> </span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780006"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType out) a (ValueType out) (ReferenceScriptType out))
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) a (ValueType out) (ReferenceScriptType out)))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   (ConcreteOutput
      (OwnerType out) a (ValueType out) (ReferenceScriptType out))
 -&gt; m (Maybe
         (ConcreteOutput
            (OwnerType out) a (ValueType out) (ReferenceScriptType out))))
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out) a (ValueType out) (ReferenceScriptType out))
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out) a (ValueType out) (ReferenceScriptType out)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679780008"><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
</span><a href="#local-6989586621679780008"><span class="hs-identifier hs-var">out'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Datum</span></span><span> </span><span id="local-6989586621679780010"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679780010"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
</span><a href="#local-6989586621679780008"><span class="hs-identifier hs-var">out'</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
-&gt; Optic'
     A_Lens
     NoIx
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
     Datum
-&gt; Datum
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  NoIx
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  Datum
Lens'
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (DatumType
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679780012"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679780012"><span class="hs-identifier hs-var">dat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Maybe a
forall a. FromData a =&gt; BuiltinData -&gt; Maybe a
</span><span class="hs-identifier hs-var">Api.fromBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679780010"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) a (ValueType out) (ReferenceScriptType out)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out) a (ValueType out) (ReferenceScriptType out))
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (OwnerType out) a (ValueType out) (ReferenceScriptType out)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType out) a (ValueType out) (ReferenceScriptType out)))
-&gt; ConcreteOutput
     (OwnerType out) a (ValueType out) (ReferenceScriptType out)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out) a (ValueType out) (ReferenceScriptType out))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-258"></span><span>          </span><span class="annot"><span class="annottext">OwnerType out
-&gt; Maybe StakingCredential
-&gt; a
-&gt; ValueType out
-&gt; Maybe (ReferenceScriptType out)
-&gt; ConcreteOutput
     (OwnerType out) a (ValueType out) (ReferenceScriptType out)
forall ownerType datumType valueType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; datumType
-&gt; valueType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-259"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
</span><a href="#local-6989586621679780008"><span class="hs-identifier hs-var">out'</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
-&gt; Optic'
     A_Lens
     NoIx
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
     (OwnerType out)
-&gt; OwnerType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  NoIx
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (OwnerType out)
Lens'
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (OwnerType
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
</span><a href="#local-6989586621679780008"><span class="hs-identifier hs-var">out'</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
-&gt; Optic'
     A_Lens
     NoIx
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
     (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  NoIx
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>            </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679780012"><span class="hs-identifier hs-var">dat</span></a></span><span>
</span><span id="line-262"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
</span><a href="#local-6989586621679780008"><span class="hs-identifier hs-var">out'</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
-&gt; Optic'
     A_Lens
     NoIx
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
     (ValueType out)
-&gt; ValueType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  NoIx
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (ValueType out)
Lens'
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (ValueType
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)))
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
</span><a href="#local-6989586621679780008"><span class="hs-identifier hs-var">out'</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
-&gt; Optic'
     A_Lens
     NoIx
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
     (Maybe (ReferenceScriptType out))
-&gt; Maybe (ReferenceScriptType out)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  NoIx
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (Maybe (ReferenceScriptType out))
Lens'
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
  (Maybe
     (ReferenceScriptType
        (ConcreteOutput
           (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="annottext">(ConcreteOutput
   (OwnerType out) Datum (ValueType out) (ReferenceScriptType out)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType out) a (ValueType out) (ReferenceScriptType out)))
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out) a (ValueType out) (ReferenceScriptType out))
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType out) Datum (ValueType out) (ReferenceScriptType out))
</span><a href="#local-6989586621679780007"><span class="hs-identifier hs-var">mOut</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | Try to resolve the validator that owns an output: If the output is owned by</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- a public key, or if the validator's hash is not known (i.e. if</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- 'validatorFromHash' returns @Nothing@) return @Nothing@.</span><span>
</span><span id="line-270"></span><span id="local-6989586621679779405"><span id="local-6989586621679779407"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveValidator"><span class="hs-identifier hs-type">resolveValidator</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779405"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="Cooked.Conversion.ToCredential.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779405"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779407"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><a href="#local-6989586621679779405"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="#local-6989586621679779407"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Validator</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779405"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779405"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779405"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-277"></span><span id="resolveValidator"><span class="annot"><span class="annottext">resolveValidator :: forall out (m :: * -&gt; *).
(IsAbstractOutput out, ToCredential (OwnerType out),
 MonadBlockChainBalancing m) =&gt;
out
-&gt; m (Maybe
        (ConcreteOutput
           (Versioned Validator)
           (DatumType out)
           (ValueType out)
           (ReferenceScriptType out)))
</span><a href="Cooked.MockChain.BlockChain.html#resolveValidator"><span class="hs-identifier hs-var hs-var">resolveValidator</span></a></span></span><span> </span><span id="local-6989586621679780036"><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780036"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OwnerType out -&gt; Credential
forall a. ToCredential a =&gt; a -&gt; Credential
</span><a href="Cooked.Conversion.ToCredential.html#toCredential"><span class="hs-identifier hs-var">toCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780036"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (OwnerType out) -&gt; OwnerType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (OwnerType out)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.PubKeyCredential</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (Versioned Validator)
     (DatumType out)
     (ValueType out)
     (ReferenceScriptType out))
-&gt; m (Maybe
        (ConcreteOutput
           (Versioned Validator)
           (DatumType out)
           (ValueType out)
           (ReferenceScriptType out)))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (Versioned Validator)
     (DatumType out)
     (ValueType out)
     (ReferenceScriptType out))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.ScriptCredential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.ScriptHash</span></span><span> </span><span id="local-6989586621679780041"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679780041"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>      </span><span id="local-6989586621679780042"><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679780042"><span class="hs-identifier hs-var">mVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; m (Maybe (Versioned Validator))
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
ValidatorHash -&gt; m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var">validatorFromHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinByteString -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Script.ValidatorHash</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679780041"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (Versioned Validator)
     (DatumType out)
     (ValueType out)
     (ReferenceScriptType out))
-&gt; m (Maybe
        (ConcreteOutput
           (Versioned Validator)
           (DatumType out)
           (ValueType out)
           (ReferenceScriptType out)))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe
   (ConcreteOutput
      (Versioned Validator)
      (DatumType out)
      (ValueType out)
      (ReferenceScriptType out))
 -&gt; m (Maybe
         (ConcreteOutput
            (Versioned Validator)
            (DatumType out)
            (ValueType out)
            (ReferenceScriptType out))))
-&gt; Maybe
     (ConcreteOutput
        (Versioned Validator)
        (DatumType out)
        (ValueType out)
        (ReferenceScriptType out))
-&gt; m (Maybe
        (ConcreteOutput
           (Versioned Validator)
           (DatumType out)
           (ValueType out)
           (ReferenceScriptType out)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-283"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679780044"><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679780044"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="annottext">Versioned Validator
-&gt; Maybe StakingCredential
-&gt; DatumType out
-&gt; ValueType out
-&gt; Maybe (ReferenceScriptType out)
-&gt; ConcreteOutput
     (Versioned Validator)
     (DatumType out)
     (ValueType out)
     (ReferenceScriptType out)
forall ownerType datumType valueType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; datumType
-&gt; valueType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-285"></span><span>              </span><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679780044"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-286"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780036"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out
-&gt; Optic' A_Lens NoIx out (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780036"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (DatumType out) -&gt; DatumType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (DatumType out)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780036"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (ValueType out) -&gt; ValueType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (ValueType out)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780036"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out
-&gt; Optic' A_Lens NoIx out (Maybe (ReferenceScriptType out))
-&gt; Maybe (ReferenceScriptType out)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (Maybe (ReferenceScriptType out))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>          </span><span class="annot"><span class="annottext">(Versioned Validator
 -&gt; ConcreteOutput
      (Versioned Validator)
      (DatumType out)
      (ValueType out)
      (ReferenceScriptType out))
-&gt; Maybe (Versioned Validator)
-&gt; Maybe
     (ConcreteOutput
        (Versioned Validator)
        (DatumType out)
        (ValueType out)
        (ReferenceScriptType out))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679780042"><span class="hs-identifier hs-var">mVal</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Try to resolve the reference script on an output: If the output has no</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- reference script, or if the reference script's hash is not known (i.e. if</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- 'validatorFromHash' returns @Nothing@), this function will return @Nothing@.</span><span>
</span><span id="line-296"></span><span id="local-6989586621679779417"><span id="local-6989586621679779419"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#resolveReferenceScript"><span class="hs-identifier hs-type">resolveReferenceScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779417"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="Cooked.Conversion.ToScriptHash.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779417"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779419"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><a href="#local-6989586621679779417"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="#local-6989586621679779419"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779417"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779417"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779417"><span class="hs-identifier hs-type">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Validator</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-303"></span><span id="resolveReferenceScript"><span class="annot"><span class="annottext">resolveReferenceScript :: forall out (m :: * -&gt; *).
(IsAbstractOutput out, ToScriptHash (ReferenceScriptType out),
 MonadBlockChainBalancing m) =&gt;
out
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out)
           (DatumType out)
           (ValueType out)
           (Versioned Validator)))
</span><a href="Cooked.MockChain.BlockChain.html#resolveReferenceScript"><span class="hs-identifier hs-var hs-var">resolveReferenceScript</span></a></span></span><span> </span><span id="local-6989586621679780066"><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780066"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><span class="annottext">m (Maybe
     (ConcreteOutput
        (OwnerType out)
        (DatumType out)
        (ValueType out)
        (Versioned Validator)))
-&gt; (ScriptHash
    -&gt; m (Maybe
            (ConcreteOutput
               (OwnerType out)
               (DatumType out)
               (ValueType out)
               (Versioned Validator))))
-&gt; Maybe ScriptHash
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out)
           (DatumType out)
           (ValueType out)
           (Versioned Validator)))
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType out)
     (DatumType out)
     (ValueType out)
     (Versioned Validator))
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out)
           (DatumType out)
           (ValueType out)
           (Versioned Validator)))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType out)
     (DatumType out)
     (ValueType out)
     (Versioned Validator))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.ScriptHash</span></span><span> </span><span id="local-6989586621679780068"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679780068"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679780069"><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679780069"><span class="hs-identifier hs-var">mVal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">OwnerType out
-&gt; Maybe StakingCredential
-&gt; DatumType out
-&gt; ValueType out
-&gt; Maybe (Versioned Validator)
-&gt; ConcreteOutput
     (OwnerType out)
     (DatumType out)
     (ValueType out)
     (Versioned Validator)
forall ownerType datumType valueType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; datumType
-&gt; valueType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-309"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780066"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (OwnerType out) -&gt; OwnerType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (OwnerType out)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780066"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out
-&gt; Optic' A_Lens NoIx out (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780066"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (DatumType out) -&gt; DatumType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (DatumType out)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780066"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">out -&gt; Optic' A_Lens NoIx out (ValueType out) -&gt; ValueType out
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx out (ValueType out)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>              </span><span class="annot"><span class="annottext">(Maybe (Versioned Validator)
 -&gt; ConcreteOutput
      (OwnerType out)
      (DatumType out)
      (ValueType out)
      (Versioned Validator))
-&gt; (Versioned Validator -&gt; Maybe (Versioned Validator))
-&gt; Versioned Validator
-&gt; ConcreteOutput
     (OwnerType out)
     (DatumType out)
     (ValueType out)
     (Versioned Validator)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Versioned Validator -&gt; Maybe (Versioned Validator)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-314"></span><span>              </span><span class="annot"><span class="annottext">(Versioned Validator
 -&gt; ConcreteOutput
      (OwnerType out)
      (DatumType out)
      (ValueType out)
      (Versioned Validator))
-&gt; Maybe (Versioned Validator)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType out)
        (DatumType out)
        (ValueType out)
        (Versioned Validator))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Versioned Validator)
</span><a href="#local-6989586621679780069"><span class="hs-identifier hs-var">mVal</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>          </span><span class="annot"><span class="annottext">(Maybe (Versioned Validator)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType out)
         (DatumType out)
         (ValueType out)
         (Versioned Validator)))
-&gt; m (Maybe (Versioned Validator))
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out)
           (DatumType out)
           (ValueType out)
           (Versioned Validator)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; m (Maybe (Versioned Validator))
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
ValidatorHash -&gt; m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var">validatorFromHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinByteString -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Script.ValidatorHash</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679780068"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><span class="annottext">(Maybe ScriptHash
 -&gt; m (Maybe
         (ConcreteOutput
            (OwnerType out)
            (DatumType out)
            (ValueType out)
            (Versioned Validator))))
-&gt; Maybe ScriptHash
-&gt; m (Maybe
        (ConcreteOutput
           (OwnerType out)
           (DatumType out)
           (ValueType out)
           (Versioned Validator)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">out -&gt; Maybe ScriptHash
forall o.
(IsAbstractOutput o, ToScriptHash (ReferenceScriptType o)) =&gt;
o -&gt; Maybe ScriptHash
</span><a href="Cooked.Output.html#outputReferenceScriptHash"><span class="hs-identifier hs-var">outputReferenceScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">out
</span><a href="#local-6989586621679780066"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span id="local-6989586621679779425"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#outputDatumFromTxOutRef"><span class="hs-identifier hs-type">outputDatumFromTxOutRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779425"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.OutputDatum</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-321"></span><span id="outputDatumFromTxOutRef"><span class="annot"><span class="annottext">outputDatumFromTxOutRef :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
TxOutRef -&gt; m (Maybe OutputDatum)
</span><a href="Cooked.MockChain.BlockChain.html#outputDatumFromTxOutRef"><span class="hs-identifier hs-var hs-var">outputDatumFromTxOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; OutputDatum) -&gt; Maybe TxOut -&gt; Maybe OutputDatum
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe TxOut -&gt; Maybe OutputDatum)
-&gt; m (Maybe TxOut) -&gt; m (Maybe OutputDatum)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Maybe TxOut) -&gt; m (Maybe OutputDatum))
-&gt; (TxOutRef -&gt; m (Maybe TxOut))
-&gt; TxOutRef
-&gt; m (Maybe OutputDatum)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRef"><span class="hs-identifier hs-var">txOutByRef</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621679779427"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#datumFromTxOutRef"><span class="hs-identifier hs-type">datumFromTxOutRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779427"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779427"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Datum</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-324"></span><span id="datumFromTxOutRef"><span class="annot"><span class="annottext">datumFromTxOutRef :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
TxOutRef -&gt; m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromTxOutRef"><span class="hs-identifier hs-var hs-var">datumFromTxOutRef</span></a></span></span><span> </span><span id="local-6989586621679780095"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679780095"><span class="hs-identifier hs-var">oref</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679780096"><span class="annot"><span class="annottext">Maybe OutputDatum
</span><a href="#local-6989586621679780096"><span class="hs-identifier hs-var">mOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe OutputDatum)
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
TxOutRef -&gt; m (Maybe OutputDatum)
</span><a href="Cooked.MockChain.BlockChain.html#outputDatumFromTxOutRef"><span class="hs-identifier hs-var">outputDatumFromTxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679780095"><span class="hs-identifier hs-var">oref</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe OutputDatum
</span><a href="#local-6989586621679780096"><span class="hs-identifier hs-var">mOutputDatum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">Maybe OutputDatum
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; m (Maybe Datum)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier hs-var">Api.NoOutputDatum</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; m (Maybe Datum)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.OutputDatum</span></span><span> </span><span id="local-6989586621679780097"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679780097"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum -&gt; m (Maybe Datum)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Datum -&gt; m (Maybe Datum)) -&gt; Maybe Datum -&gt; m (Maybe Datum)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Maybe Datum
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679780097"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.OutputDatumHash</span></span><span> </span><span id="local-6989586621679780098"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780098"><span class="hs-identifier hs-var">datumHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; m (Maybe Datum)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
DatumHash -&gt; m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var">datumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780098"><span class="hs-identifier hs-var">datumHash</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span id="local-6989586621679779429"><span id="local-6989586621679779430"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#typedDatumFromTxOutRef"><span class="hs-identifier hs-type">typedDatumFromTxOutRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.FromData</span></span><span> </span><span class="annot"><a href="#local-6989586621679779429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779430"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779430"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679779429"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-333"></span><span id="typedDatumFromTxOutRef"><span class="annot"><span class="annottext">typedDatumFromTxOutRef :: forall a (m :: * -&gt; *).
(FromData a, MonadBlockChainWithoutValidation m) =&gt;
TxOutRef -&gt; m (Maybe a)
</span><a href="Cooked.MockChain.BlockChain.html#typedDatumFromTxOutRef"><span class="hs-identifier hs-var hs-var">typedDatumFromTxOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Datum -&gt; (Datum -&gt; Maybe a) -&gt; Maybe a
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.Datum</span></span><span> </span><span id="local-6989586621679780110"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679780110"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Maybe a
forall a. FromData a =&gt; BuiltinData -&gt; Maybe a
</span><span class="hs-identifier hs-var">Api.fromBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679780110"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Datum -&gt; Maybe a) -&gt; m (Maybe Datum) -&gt; m (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Maybe Datum) -&gt; m (Maybe a))
-&gt; (TxOutRef -&gt; m (Maybe Datum)) -&gt; TxOutRef -&gt; m (Maybe a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe Datum)
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
TxOutRef -&gt; m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromTxOutRef"><span class="hs-identifier hs-var">datumFromTxOutRef</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span id="local-6989586621679779435"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#valueFromTxOutRef"><span class="hs-identifier hs-type">valueFromTxOutRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779435"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779435"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-336"></span><span id="valueFromTxOutRef"><span class="annot"><span class="annottext">valueFromTxOutRef :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
TxOutRef -&gt; m (Maybe Value)
</span><a href="Cooked.MockChain.BlockChain.html#valueFromTxOutRef"><span class="hs-identifier hs-var hs-var">valueFromTxOutRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Value
forall o. (IsAbstractOutput o, ToValue (ValueType o)) =&gt; o -&gt; Value
</span><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-var">outputValue</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value) -&gt; Maybe TxOut -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe TxOut -&gt; Maybe Value) -&gt; m (Maybe TxOut) -&gt; m (Maybe Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Maybe TxOut) -&gt; m (Maybe Value))
-&gt; (TxOutRef -&gt; m (Maybe TxOut)) -&gt; TxOutRef -&gt; m (Maybe Value)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRef"><span class="hs-identifier hs-var">txOutByRef</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span id="local-6989586621679779439"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxosPl"><span class="hs-identifier hs-type">txSkelInputUtxosPl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779439"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779439"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-339"></span><span id="txSkelInputUtxosPl"><span class="annot"><span class="annottext">txSkelInputUtxosPl :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxosPl"><span class="hs-identifier hs-var hs-var">txSkelInputUtxosPl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOutRef] -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxosPl"><span class="hs-identifier hs-var">lookupUtxosPl</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOutRef] -&gt; m (Map TxOutRef TxOut))
-&gt; (TxSkel -&gt; [TxOutRef]) -&gt; TxSkel -&gt; m (Map TxOutRef TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef])
-&gt; (TxSkel -&gt; Map TxOutRef TxSkelRedeemer) -&gt; TxSkel -&gt; [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Map TxOutRef TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-identifier hs-var">txSkelIns</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span id="local-6989586621679779446"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxos"><span class="hs-identifier hs-type">txSkelInputUtxos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779446"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779446"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-342"></span><span id="txSkelInputUtxos"><span class="annot"><span class="annottext">txSkelInputUtxos :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxos"><span class="hs-identifier hs-var hs-var">txSkelInputUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOutRef] -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-var">lookupUtxos</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOutRef] -&gt; m (Map TxOutRef TxOut))
-&gt; (TxSkel -&gt; [TxOutRef]) -&gt; TxSkel -&gt; m (Map TxOutRef TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef])
-&gt; (TxSkel -&gt; Map TxOutRef TxSkelRedeemer) -&gt; TxSkel -&gt; [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Map TxOutRef TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-identifier hs-var">txSkelIns</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span id="local-6989586621679780131"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelReferenceInputUtxosPl"><span class="hs-identifier hs-type">txSkelReferenceInputUtxosPl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679780131"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679780131"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-345"></span><span id="txSkelReferenceInputUtxosPl"><span class="annot"><span class="annottext">txSkelReferenceInputUtxosPl :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelReferenceInputUtxosPl"><span class="hs-identifier hs-var hs-var">txSkelReferenceInputUtxosPl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut) -&gt; Map TxOutRef TxOut -&gt; Map TxOutRef TxOut
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxOut -&gt; Map TxOutRef TxOut)
-&gt; m (Map TxOutRef TxOut) -&gt; m (Map TxOutRef TxOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Map TxOutRef TxOut) -&gt; m (Map TxOutRef TxOut))
-&gt; (TxSkel -&gt; m (Map TxOutRef TxOut))
-&gt; TxSkel
-&gt; m (Map TxOutRef TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelReferenceInputUtxos"><span class="hs-identifier hs-var">txSkelReferenceInputUtxos</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span id="local-6989586621679780140"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelReferenceInputUtxos"><span class="hs-identifier hs-type">txSkelReferenceInputUtxos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679780140"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679780140"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-348"></span><span id="txSkelReferenceInputUtxos"><span class="annot"><span class="annottext">txSkelReferenceInputUtxos :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelReferenceInputUtxos"><span class="hs-identifier hs-var hs-var">txSkelReferenceInputUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxOutRef] -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-var">lookupUtxos</span></a></span><span> </span><span class="annot"><span class="annottext">([TxOutRef] -&gt; m (Map TxOutRef TxOut))
-&gt; (TxSkel -&gt; [TxOutRef]) -&gt; TxSkel -&gt; m (Map TxOutRef TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; [TxOutRef]
</span><a href="Cooked.Skeleton.html#txSkelReferenceTxOutRefs"><span class="hs-identifier hs-var">txSkelReferenceTxOutRefs</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><span class="hs-comment">-- | Retrieves the required deposit amount for issuing governance actions.</span></span><span>
</span><span id="line-351"></span><span id="local-6989586621679779454"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier hs-type">govActionDeposit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779454"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779454"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Lovelace</span></span></span><span>
</span><span id="line-352"></span><span id="govActionDeposit"><span class="annot"><span class="annottext">govActionDeposit :: forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Lovelace
</span><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier hs-var hs-var">govActionDeposit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><span class="hs-identifier hs-var">Api.Lovelace</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Lovelace) -&gt; (Params -&gt; Integer) -&gt; Params -&gt; Lovelace
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Integer
</span><span class="hs-identifier hs-var">Cardano.unCoin</span></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Integer) -&gt; (Params -&gt; Coin) -&gt; Params -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting Coin (PParams EmulatorEra) Coin
-&gt; PParams EmulatorEra -&gt; Coin
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">Lens.view</span></span><span> </span><span class="annot"><span class="annottext">Getting Coin (PParams EmulatorEra) Coin
forall era. ConwayEraPParams era =&gt; Lens' (PParams era) Coin
Lens' (PParams EmulatorEra) Coin
</span><span class="hs-identifier hs-var">Conway.ppGovActionDepositL</span></span><span> </span><span class="annot"><span class="annottext">(PParams EmulatorEra -&gt; Coin)
-&gt; (Params -&gt; PParams EmulatorEra) -&gt; Params -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; PParams EmulatorEra
</span><span class="hs-identifier hs-var">Emulator.emulatorPParams</span></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Lovelace) -&gt; m Params -&gt; m Lovelace
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | Retrieves the total amount of lovelace deposited in proposals in this</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- skeleton (equal to `govActionDeposit` times the number of proposals).</span><span>
</span><span id="line-356"></span><span id="local-6989586621679779476"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelProposalsDeposit"><span class="hs-identifier hs-type">txSkelProposalsDeposit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779476"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779476"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Lovelace</span></span></span><span>
</span><span id="line-357"></span><span id="txSkelProposalsDeposit"><span class="annot"><span class="annottext">txSkelProposalsDeposit :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m Lovelace
</span><a href="Cooked.MockChain.BlockChain.html#txSkelProposalsDeposit"><span class="hs-identifier hs-var hs-var">txSkelProposalsDeposit</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679780178"><span id="local-6989586621679780179"><span id="local-6989586621679780180"><span id="local-6989586621679780181"><span id="local-6989586621679780182"><span id="local-6989586621679780183"><span id="local-6989586621679780184"><span id="local-6989586621679780185"><span id="local-6989586621679780186"><span class="annot"><span class="annottext">[Wallet]
[TxSkelProposal]
[TxSkelOut]
Set TxOutRef
Set TxLabel
Map TxOutRef TxSkelRedeemer
TxSkelMints
SlotRange
TxOpts
txSkelIns :: TxSkel -&gt; Map TxOutRef TxSkelRedeemer
txSkelLabel :: Set TxLabel
txSkelOpts :: TxOpts
txSkelMints :: TxSkelMints
txSkelSigners :: [Wallet]
txSkelValidityRange :: SlotRange
txSkelIns :: Map TxOutRef TxSkelRedeemer
txSkelInsReference :: Set TxOutRef
txSkelOuts :: [TxSkelOut]
txSkelProposals :: [TxSkelProposal]
txSkelLabel :: TxSkel -&gt; Set TxLabel
txSkelOpts :: TxSkel -&gt; TxOpts
txSkelMints :: TxSkel -&gt; TxSkelMints
txSkelSigners :: TxSkel -&gt; [Wallet]
txSkelValidityRange :: TxSkel -&gt; SlotRange
txSkelInsReference :: TxSkel -&gt; Set TxOutRef
txSkelOuts :: TxSkel -&gt; [TxSkelOut]
txSkelProposals :: TxSkel -&gt; [TxSkelProposal]
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><span class="hs-identifier hs-var">Api.Lovelace</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Lovelace)
-&gt; (Lovelace -&gt; Integer) -&gt; Lovelace -&gt; Lovelace
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxSkelProposal] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TxSkelProposal]
</span><a href="#local-6989586621679780186"><span class="hs-identifier hs-var">txSkelProposals</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer)
-&gt; (Lovelace -&gt; Integer) -&gt; Lovelace -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Integer
</span><span class="hs-identifier hs-var">Api.getLovelace</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Lovelace) -&gt; m Lovelace -&gt; m Lovelace
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Lovelace
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Lovelace
</span><a href="Cooked.MockChain.BlockChain.html#govActionDeposit"><span class="hs-identifier hs-var">govActionDeposit</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><span class="hs-comment">-- | Helper to convert Nothing to an error</span></span><span>
</span><span id="line-360"></span><span id="local-6989586621679779489"><span id="local-6989586621679779490"><span id="local-6989586621679779491"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#maybeErrM"><span class="hs-identifier hs-type">maybeErrM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779489"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679779490"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779491"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779489"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679779490"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779489"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779491"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-361"></span><span id="maybeErrM"><span class="annot"><span class="annottext">maybeErrM :: forall (m :: * -&gt; *) a b.
MonadBlockChainBalancing m =&gt;
MockChainError -&gt; (a -&gt; b) -&gt; m (Maybe a) -&gt; m b
</span><a href="Cooked.MockChain.BlockChain.html#maybeErrM"><span class="hs-identifier hs-var hs-var">maybeErrM</span></a></span></span><span> </span><span id="local-6989586621679780206"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679780206"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679780207"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679780207"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m b -&gt; (a -&gt; m b) -&gt; Maybe a -&gt; m b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainError -&gt; m b
forall a. MockChainError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679780206"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; m b
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; m b) -&gt; (a -&gt; b) -&gt; a -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679780207"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; m b) -&gt; m (Maybe a) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="annot"><span class="hs-comment">-- | All validators which protect transaction inputs</span></span><span>
</span><span id="line-364"></span><span id="local-6989586621679779498"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValidators"><span class="hs-identifier hs-type">txSkelInputValidators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779498"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779498"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.ValidatorHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Validator</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-365"></span><span id="txSkelInputValidators"><span class="annot"><span class="annottext">txSkelInputValidators :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map ValidatorHash (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputValidators"><span class="hs-identifier hs-var hs-var">txSkelInputValidators</span></a></span></span><span> </span><span id="local-6989586621679780230"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679780230"><span class="hs-identifier hs-var">skel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679780231"><span class="annot"><span class="annottext">[(TxOutRef, TxOut)]
</span><a href="#local-6989586621679780231"><span class="hs-identifier hs-var">utxos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; [(TxOutRef, TxOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxOut -&gt; [(TxOutRef, TxOut)])
-&gt; m (Map TxOutRef TxOut) -&gt; m [(TxOutRef, TxOut)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxOutRef] -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxosPl"><span class="hs-identifier hs-var">lookupUtxosPl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxSkelRedeemer -&gt; [TxOutRef])
-&gt; (TxSkel -&gt; Map TxOutRef TxSkelRedeemer) -&gt; TxSkel -&gt; [TxOutRef]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; Map TxOutRef TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-identifier hs-var">txSkelIns</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkel -&gt; [TxOutRef]) -&gt; TxSkel -&gt; [TxOutRef]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679780230"><span class="hs-identifier hs-var">skel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">[(ValidatorHash, Versioned Validator)]
-&gt; Map ValidatorHash (Versioned Validator)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(ValidatorHash, Versioned Validator)]
 -&gt; Map ValidatorHash (Versioned Validator))
-&gt; ([Maybe (ValidatorHash, Versioned Validator)]
    -&gt; [(ValidatorHash, Versioned Validator)])
-&gt; [Maybe (ValidatorHash, Versioned Validator)]
-&gt; Map ValidatorHash (Versioned Validator)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (ValidatorHash, Versioned Validator)]
-&gt; [(ValidatorHash, Versioned Validator)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">([Maybe (ValidatorHash, Versioned Validator)]
 -&gt; Map ValidatorHash (Versioned Validator))
-&gt; m [Maybe (ValidatorHash, Versioned Validator)]
-&gt; m (Map ValidatorHash (Versioned Validator))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut)
 -&gt; m (Maybe (ValidatorHash, Versioned Validator)))
-&gt; [(TxOutRef, TxOut)]
-&gt; m [Maybe (ValidatorHash, Versioned Validator)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span>
</span><span id="line-369"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679780236"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679780236"><span class="hs-identifier hs-var">_oref</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679780237"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679780237"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Address
forall o.
(IsAbstractOutput o, ToCredential (OwnerType o)) =&gt;
o -&gt; Address
</span><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-var">outputAddress</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679780237"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-370"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Api.Address</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.ScriptCredential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.ScriptHash</span></span><span> </span><span id="local-6989586621679780240"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679780240"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679780241"><span class="annot"><span class="annottext">valHash :: ValidatorHash
</span><a href="#local-6989586621679780241"><span class="hs-identifier hs-var hs-var">valHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Script.ValidatorHash</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679780240"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-372"></span><span>            </span><span class="annot"><span class="annottext">MockChainError
-&gt; (Versioned Validator
    -&gt; Maybe (ValidatorHash, Versioned Validator))
-&gt; m (Maybe (Versioned Validator))
-&gt; m (Maybe (ValidatorHash, Versioned Validator))
forall (m :: * -&gt; *) a b.
MonadBlockChainBalancing m =&gt;
MockChainError -&gt; (a -&gt; b) -&gt; m (Maybe a) -&gt; m b
</span><a href="Cooked.MockChain.BlockChain.html#maybeErrM"><span class="hs-identifier hs-var">maybeErrM</span></a></span><span>
</span><span id="line-373"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String -&gt; ValidatorHash -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#MCEUnknownValidator"><span class="hs-identifier hs-var">MCEUnknownValidator</span></a></span><span>
</span><span id="line-374"></span><span>                  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;txSkelInputValidators: unknown validator hash on transaction input&quot;</span></span><span>
</span><span id="line-375"></span><span>                  </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679780241"><span class="hs-identifier hs-var">valHash</span></a></span><span>
</span><span id="line-376"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ValidatorHash, Versioned Validator)
-&gt; Maybe (ValidatorHash, Versioned Validator)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((ValidatorHash, Versioned Validator)
 -&gt; Maybe (ValidatorHash, Versioned Validator))
-&gt; (Versioned Validator -&gt; (ValidatorHash, Versioned Validator))
-&gt; Versioned Validator
-&gt; Maybe (ValidatorHash, Versioned Validator)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679780241"><span class="hs-identifier hs-var">valHash</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValidatorHash -&gt; m (Maybe (Versioned Validator))
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
ValidatorHash -&gt; m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var">validatorFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679780241"><span class="hs-identifier hs-var">valHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>          </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ValidatorHash, Versioned Validator)
-&gt; m (Maybe (ValidatorHash, Versioned Validator))
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ValidatorHash, Versioned Validator)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><span class="annottext">[(TxOutRef, TxOut)]
</span><a href="#local-6989586621679780231"><span class="hs-identifier hs-var">utxos</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | Go through all of the 'Api.TxOutRef's in the list and look them up in the</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- state of the blockchain, throwing an error if one of them cannot be resolved.</span><span>
</span><span id="line-385"></span><span id="local-6989586621679779442"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#lookupUtxosPl"><span class="hs-identifier hs-type">lookupUtxosPl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779442"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779442"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOut</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-386"></span><span id="lookupUtxosPl"><span class="annot"><span class="annottext">lookupUtxosPl :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxosPl"><span class="hs-identifier hs-var hs-var">lookupUtxosPl</span></a></span></span><span> </span><span id="local-6989586621679780250"><span class="annot"><span class="annottext">[TxOutRef]
</span><a href="#local-6989586621679780250"><span class="hs-identifier hs-var">outRefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut) -&gt; Map TxOutRef TxOut -&gt; Map TxOutRef TxOut
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxOut -&gt; Map TxOutRef TxOut)
-&gt; m (Map TxOutRef TxOut) -&gt; m (Map TxOutRef TxOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TxOutRef] -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-var">lookupUtxos</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOutRef]
</span><a href="#local-6989586621679780250"><span class="hs-identifier hs-var">outRefs</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span id="local-6989586621679779448"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-type">lookupUtxos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779448"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779448"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxOut</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-389"></span><span id="lookupUtxos"><span class="annot"><span class="annottext">lookupUtxos :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
[TxOutRef] -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#lookupUtxos"><span class="hs-identifier hs-var hs-var">lookupUtxos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TxOutRef, TxOut)] -&gt; Map TxOutRef TxOut
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; Map TxOutRef TxOut)
-&gt; m [(TxOutRef, TxOut)] -&gt; m (Map TxOutRef TxOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="annottext">(m [(TxOutRef, TxOut)] -&gt; m (Map TxOutRef TxOut))
-&gt; ([TxOutRef] -&gt; m [(TxOutRef, TxOut)])
-&gt; [TxOutRef]
-&gt; m (Map TxOutRef TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; m (TxOutRef, TxOut))
-&gt; [TxOutRef] -&gt; m [(TxOutRef, TxOut)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679780264"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679780264"><span class="hs-identifier hs-var">oRef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679780264"><span class="hs-identifier hs-var">oRef</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; (TxOutRef, TxOut)) -&gt; m TxOut -&gt; m (TxOutRef, TxOut)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; (TxOut -&gt; TxOut) -&gt; m (Maybe TxOut) -&gt; m TxOut
forall (m :: * -&gt; *) a b.
MonadBlockChainBalancing m =&gt;
MockChainError -&gt; (a -&gt; b) -&gt; m (Maybe a) -&gt; m b
</span><a href="Cooked.MockChain.BlockChain.html#maybeErrM"><span class="hs-identifier hs-var">maybeErrM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TxOutRef -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#MCEUnknownOutRefError"><span class="hs-identifier hs-var">MCEUnknownOutRefError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lookupUtxos: unknown TxOutRef&quot;</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679780264"><span class="hs-identifier hs-var">oRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-var">txOutByRefLedger</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679780264"><span class="hs-identifier hs-var">oRef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><span class="hs-comment">-- | look up the UTxOs the transaction consumes, and sum their values.</span></span><span>
</span><span id="line-394"></span><span id="local-6989586621679779513"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputValue"><span class="hs-identifier hs-type">txSkelInputValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779513"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779513"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span></span><span>
</span><span id="line-395"></span><span id="txSkelInputValue"><span class="annot"><span class="annottext">txSkelInputValue :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m Value
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputValue"><span class="hs-identifier hs-var hs-var">txSkelInputValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxOut -&gt; Value) -&gt; Map TxOutRef TxOut -&gt; Value
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Map TxOutRef a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><span class="hs-identifier hs-var">Api.txOutValue</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value) -&gt; (TxOut -&gt; TxOut) -&gt; TxOut -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut
</span><a href="Cooked.MockChain.BlockChain.html#txOutV2FromLedger"><span class="hs-identifier hs-var">txOutV2FromLedger</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Map TxOutRef TxOut -&gt; Value) -&gt; m (Map TxOutRef TxOut) -&gt; m Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (Map TxOutRef TxOut) -&gt; m Value)
-&gt; (TxSkel -&gt; m (Map TxOutRef TxOut)) -&gt; TxSkel -&gt; m Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxos"><span class="hs-identifier hs-var">txSkelInputUtxos</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><span class="hs-comment">-- | Look up the data on UTxOs the transaction consumes.</span></span><span>
</span><span id="line-398"></span><span id="local-6989586621679779518"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#txSkelInputData"><span class="hs-identifier hs-type">txSkelInputData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779518"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779518"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.DatumHash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Datum</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-399"></span><span id="txSkelInputData"><span class="annot"><span class="annottext">txSkelInputData :: forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map DatumHash Datum)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputData"><span class="hs-identifier hs-var hs-var">txSkelInputData</span></a></span></span><span> </span><span id="local-6989586621679780296"><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679780296"><span class="hs-identifier hs-var">skel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679780297"><span class="annot"><span class="annottext">[DatumHash]
</span><a href="#local-6989586621679780297"><span class="hs-identifier hs-var">mDatumHashes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">(TxOut -&gt; Maybe DatumHash) -&gt; [TxOut] -&gt; [DatumHash]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span>
</span><span id="line-402"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679780299"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679780299"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679780299"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Optic' A_Lens NoIx TxOut OutputDatum -&gt; OutputDatum
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxOut OutputDatum
Lens' TxOut (DatumType TxOut)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-404"></span><span>            </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier hs-var">Api.NoOutputDatum</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe DatumHash
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-405"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Api.OutputDatum</span></span><span> </span><span id="local-6989586621679780300"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679780300"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Maybe DatumHash
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(DatumHash -&gt; Maybe DatumHash) -&gt; DatumHash -&gt; Maybe DatumHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><span class="hs-identifier hs-var">Script.datumHash</span></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679780300"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-406"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Api.OutputDatumHash</span></span><span> </span><span id="local-6989586621679780302"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780302"><span class="hs-identifier hs-var">dHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; Maybe DatumHash
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780302"><span class="hs-identifier hs-var">dHash</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><span class="annottext">([TxOut] -&gt; [DatumHash])
-&gt; (Map TxOutRef TxOut -&gt; [TxOut])
-&gt; Map TxOutRef TxOut
-&gt; [DatumHash]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; [TxOut]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><span class="annottext">(Map TxOutRef TxOut -&gt; [DatumHash])
-&gt; m (Map TxOutRef TxOut) -&gt; m [DatumHash]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m (Map TxOutRef TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxSkel -&gt; m (Map TxOutRef TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txSkelInputUtxosPl"><span class="hs-identifier hs-var">txSkelInputUtxosPl</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679780296"><span class="hs-identifier hs-var">skel</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><span class="annottext">[(DatumHash, Datum)] -&gt; Map DatumHash Datum
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="annottext">([(DatumHash, Datum)] -&gt; Map DatumHash Datum)
-&gt; m [(DatumHash, Datum)] -&gt; m (Map DatumHash Datum)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DatumHash -&gt; m (DatumHash, Datum))
-&gt; [DatumHash] -&gt; m [(DatumHash, Datum)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span>
</span><span id="line-412"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679780304"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780304"><span class="hs-identifier hs-var">dHash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-413"></span><span>          </span><span class="annot"><span class="annottext">MockChainError
-&gt; (Datum -&gt; (DatumHash, Datum))
-&gt; m (Maybe Datum)
-&gt; m (DatumHash, Datum)
forall (m :: * -&gt; *) a b.
MonadBlockChainBalancing m =&gt;
MockChainError -&gt; (a -&gt; b) -&gt; m (Maybe a) -&gt; m b
</span><a href="Cooked.MockChain.BlockChain.html#maybeErrM"><span class="hs-identifier hs-var">maybeErrM</span></a></span><span>
</span><span id="line-414"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; DatumHash -&gt; MockChainError
</span><a href="Cooked.MockChain.BlockChain.html#MCEUnknownDatum"><span class="hs-identifier hs-var">MCEUnknownDatum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;txSkelInputData: Transaction input with un-resolvable datum hash&quot;</span></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780304"><span class="hs-identifier hs-var">dHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780304"><span class="hs-identifier hs-var">dHash</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumHash -&gt; m (Maybe Datum)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
DatumHash -&gt; m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var">datumFromHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679780304"><span class="hs-identifier hs-var">dHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="annottext">[DatumHash]
</span><a href="#local-6989586621679780297"><span class="hs-identifier hs-var">mDatumHashes</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><span class="hs-comment">-- ** Slot and Time Management</span></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- $slotandtime</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- #slotandtime#</span><span>
</span><span id="line-424"></span><span class="hs-comment">--</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- Slots are integers that monotonically increase and model the passage of</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- time. By looking at the current slot, a validator gets to know that it is</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- being executed within a certain window of wall-clock time. Things can get</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- annoying pretty fast when trying to mock traces and trying to exercise</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- certain branches of certain validators; make sure you also read the docs on</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- 'autoSlotIncrease' to be able to simulate sending transactions in parallel.</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="annot"><span class="hs-comment">-- | Moves n slots fowards</span></span><span>
</span><span id="line-433"></span><span id="local-6989586621679779524"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-type">waitNSlots</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779524"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779524"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span><span>
</span><span id="line-434"></span><span id="waitNSlots"><span class="annot"><span class="annottext">waitNSlots :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Integer -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#waitNSlots"><span class="hs-identifier hs-var hs-var">waitNSlots</span></a></span></span><span> </span><span id="local-6989586621679780321"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679780321"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679780321"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Slot
forall a. String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;waitNSlots: negative argument&quot;</span></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; (Slot -&gt; m Slot) -&gt; m Slot
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; m Slot) -&gt; (Slot -&gt; Slot) -&gt; Slot -&gt; m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679780321"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><span class="hs-comment">-- | Returns the closed ms interval corresponding to the current slot</span></span><span>
</span><span id="line-440"></span><span id="local-6989586621679779531"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#currentTime"><span class="hs-identifier hs-type">currentTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779531"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779531"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-441"></span><span id="currentTime"><span class="annot"><span class="annottext">currentTime :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#currentTime"><span class="hs-identifier hs-var hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToTimeInterval"><span class="hs-identifier hs-var">slotToTimeInterval</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; m (POSIXTime, POSIXTime))
-&gt; m Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-comment">-- | Returns the closed ms interval corresponding to the slot with the given</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- number. It holds that</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- &gt; slotToTimeInterval (getEnclosingSlot t) == (a, b)    ==&gt;   a &lt;= t &lt;= b</span><span>
</span><span id="line-447"></span><span class="hs-comment">--</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-449"></span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- &gt; slotToTimeInterval n == (a, b)   ==&gt;   getEnclosingSlot a == n &amp;&amp; getEnclosingSlot b == n</span><span>
</span><span id="line-451"></span><span class="hs-comment">--</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-453"></span><span class="hs-comment">--</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- &gt; slotToTimeInterval n == (a, b)   ==&gt;   getEnclosingSlot (a-1) == n-1 &amp;&amp; getEnclosingSlot (b+1) == n+1</span><span>
</span><span id="line-455"></span><span id="local-6989586621679779534"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotToTimeInterval"><span class="hs-identifier hs-type">slotToTimeInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779534"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779534"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-456"></span><span id="slotToTimeInterval"><span class="annot"><span class="annottext">slotToTimeInterval :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToTimeInterval"><span class="hs-identifier hs-var hs-var">slotToTimeInterval</span></a></span></span><span> </span><span id="local-6989586621679780348"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780348"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-457"></span><span>  </span><span id="local-6989586621679780349"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679780349"><span class="hs-identifier hs-var">slotConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Params -&gt; SlotConfig
</span><span class="hs-identifier hs-var">Emulator.pSlotConfig</span></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; SlotConfig) -&gt; m Params -&gt; m SlotConfig
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; Slot -&gt; POSIXTimeRange
</span><span class="hs-identifier hs-var">Emulator.slotToPOSIXTimeRange</span></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679780349"><span class="hs-identifier hs-var">slotConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780348"><span class="hs-identifier hs-var">slot</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-459"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.Interval</span></span><span>
</span><span id="line-460"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.LowerBound</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.Finite</span></span><span> </span><span id="local-6989586621679780355"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780355"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679780356"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679780356"><span class="hs-identifier hs-var">leftclosed</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.UpperBound</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.Finite</span></span><span> </span><span id="local-6989586621679780358"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780358"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679780359"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679780359"><span class="hs-identifier hs-var">rightclosed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-462"></span><span>        </span><span class="annot"><span class="annottext">(POSIXTime, POSIXTime) -&gt; m (POSIXTime, POSIXTime)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-463"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679780356"><span class="hs-identifier hs-var">leftclosed</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780355"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780355"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-464"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679780359"><span class="hs-identifier hs-var">rightclosed</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780358"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780358"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; POSIXTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-number">1</span></span><span>
</span><span id="line-465"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><span class="annottext">POSIXTimeRange
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m (POSIXTime, POSIXTime)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The time interval corresponding to a slot should be finite on both ends.&quot;</span></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">-- | Return the slot that contains the given time. See 'slotToTimeInterval' for</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- some satisfied equational properties.</span><span>
</span><span id="line-470"></span><span id="local-6989586621679779544"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-type">getEnclosingSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779544"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779544"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span><span>
</span><span id="line-471"></span><span id="getEnclosingSlot"><span class="annot"><span class="annottext">getEnclosingSlot :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var hs-var">getEnclosingSlot</span></a></span></span><span> </span><span id="local-6989586621679780369"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780369"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotConfig -&gt; POSIXTime -&gt; Slot
</span><span class="hs-operator hs-var">`Emulator.posixTimeToEnclosingSlot`</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780369"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SlotConfig -&gt; Slot) -&gt; (Params -&gt; SlotConfig) -&gt; Params -&gt; Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; SlotConfig
</span><span class="hs-identifier hs-var">Emulator.pSlotConfig</span></span><span> </span><span class="annot"><span class="annottext">(Params -&gt; Slot) -&gt; m Params -&gt; m Slot
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Waits until the current slot becomes greater or equal to the slot</span><span>
</span><span id="line-474"></span><span class="hs-comment">--  containing the given POSIX time.  Note that that it might not wait for</span><span>
</span><span id="line-475"></span><span class="hs-comment">--  anything if the current slot is large enough.</span><span>
</span><span id="line-476"></span><span id="local-6989586621679780371"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier hs-type">awaitEnclosingSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679780371"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679780371"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.Slot</span></span></span><span>
</span><span id="line-477"></span><span id="awaitEnclosingSlot"><span class="annot"><span class="annottext">awaitEnclosingSlot :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitEnclosingSlot"><span class="hs-identifier hs-var hs-var">awaitEnclosingSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; m Slot) -&gt; (POSIXTime -&gt; m Slot) -&gt; POSIXTime -&gt; m Slot
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var">getEnclosingSlot</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="annot"><span class="hs-comment">-- | The infinite range of slots ending before or at the given time</span></span><span>
</span><span id="line-480"></span><span id="local-6989586621679779551"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeBefore"><span class="hs-identifier hs-type">slotRangeBefore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779551"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679779551"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.SlotRange</span></span></span><span>
</span><span id="line-481"></span><span id="slotRangeBefore"><span class="annot"><span class="annottext">slotRangeBefore :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m SlotRange
</span><a href="Cooked.MockChain.BlockChain.html#slotRangeBefore"><span class="hs-identifier hs-var hs-var">slotRangeBefore</span></a></span></span><span> </span><span id="local-6989586621679780393"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780393"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span>  </span><span id="local-6989586621679780394"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780394"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var">getEnclosingSlot</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780393"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679780395"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780395"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToTimeInterval"><span class="hs-identifier hs-var">slotToTimeInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780394"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-comment">-- If the given time @t@ happens to be the last ms of its slot, we can include</span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-comment">-- the whole slot. Otherwise, the only way to be sure that the returned slot</span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-comment">-- range contains no time after @t@ is to go to the preceding slot.</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><span class="annottext">SlotRange -&gt; m SlotRange
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SlotRange -&gt; m SlotRange) -&gt; SlotRange -&gt; m SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotRange
forall a. a -&gt; Interval a
</span><span class="hs-identifier hs-var">Api.to</span></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; SlotRange) -&gt; Slot -&gt; SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780393"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780395"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780394"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780394"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="annot"><span class="hs-comment">-- | The infinite range of slots starting after or at the given time</span></span><span>
</span><span id="line-490"></span><span id="local-6989586621679780397"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#slotRangeAfter"><span class="hs-identifier hs-type">slotRangeAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679780397"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.POSIXTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679780397"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.SlotRange</span></span></span><span>
</span><span id="line-491"></span><span id="slotRangeAfter"><span class="annot"><span class="annottext">slotRangeAfter :: forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m SlotRange
</span><a href="Cooked.MockChain.BlockChain.html#slotRangeAfter"><span class="hs-identifier hs-var hs-var">slotRangeAfter</span></a></span></span><span> </span><span id="local-6989586621679780410"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780410"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-492"></span><span>  </span><span id="local-6989586621679780411"><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780411"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
POSIXTime -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#getEnclosingSlot"><span class="hs-identifier hs-var">getEnclosingSlot</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780410"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679780412"><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780412"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m (POSIXTime, POSIXTime)
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m (POSIXTime, POSIXTime)
</span><a href="Cooked.MockChain.BlockChain.html#slotToTimeInterval"><span class="hs-identifier hs-var">slotToTimeInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780411"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><span class="annottext">SlotRange -&gt; m SlotRange
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(SlotRange -&gt; m SlotRange) -&gt; SlotRange -&gt; m SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; SlotRange
forall a. a -&gt; Interval a
</span><span class="hs-identifier hs-var">Api.from</span></span><span> </span><span class="annot"><span class="annottext">(Slot -&gt; SlotRange) -&gt; Slot -&gt; SlotRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780410"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; POSIXTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">POSIXTime
</span><a href="#local-6989586621679780412"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780411"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Slot
</span><a href="#local-6989586621679780411"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; Slot -&gt; Slot
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="annot"><span class="hs-comment">-- ** Deriving further 'MonadBlockChain' instances</span></span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | A newtype wrapper to be used with '-XDerivingVia' to derive instances of</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- 'MonadBlockChain' for any 'MonadTransControl'.</span><span>
</span><span id="line-500"></span><span class="hs-comment">--</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- For example, to derive 'MonadBlockChain m =&gt; MonadBlockChain (ReaderT r m)',</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- you'd write</span><span>
</span><span id="line-503"></span><span class="hs-comment">--</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- &gt; deriving via (AsTrans (ReaderT r) m) instance MonadBlockChain m =&gt; MonadBlockChain (ReaderT r m)</span><span>
</span><span id="line-505"></span><span class="hs-comment">--</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- and avoid the trouble of defining all the class methods yourself.</span><span>
</span><span id="line-507"></span><span class="hs-keyword">newtype</span><span> </span><span id="AsTrans"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-var">AsTrans</span></a></span></span><span> </span><span id="local-6989586621679779556"><span class="annot"><a href="#local-6989586621679779556"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679779557"><span class="annot"><a href="#local-6989586621679779557"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679779558"><span class="annot"><a href="#local-6989586621679779558"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AsTrans"><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-var">AsTrans</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getTrans"><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
AsTrans t m a -&gt; t m a
</span><a href="Cooked.MockChain.BlockChain.html#getTrans"><span class="hs-identifier hs-var hs-var">getTrans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679779556"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779557"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779558"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679780418"><span id="local-6989586621679780422"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b)
-&gt; (forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a)
-&gt; Functor (AsTrans t m)
forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
(a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$cfmap :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
(a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
fmap :: forall a b. (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$c&lt;$ :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Functor (t m) =&gt;
a -&gt; AsTrans t m b -&gt; AsTrans t m a
&lt;$ :: forall a b. a -&gt; AsTrans t m b -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679780432"><span id="local-6989586621679780436"><span id="local-6989586621679780440"><span id="local-6989586621679780444"><span id="local-6989586621679780448"><span class="annot"><span class="annottext">Functor (AsTrans t m)
Functor (AsTrans t m) =&gt;
(forall a. a -&gt; AsTrans t m a)
-&gt; (forall a b.
    AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a)
-&gt; Applicative (AsTrans t m)
forall a. a -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall a b. AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall a b c.
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Applicative (t m) =&gt;
Functor (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Applicative (t m) =&gt;
a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b c.
Applicative (t m) =&gt;
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
$cpure :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Applicative (t m) =&gt;
a -&gt; AsTrans t m a
pure :: forall a. a -&gt; AsTrans t m a
$c&lt;*&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
&lt;*&gt; :: forall a b. AsTrans t m (a -&gt; b) -&gt; AsTrans t m a -&gt; AsTrans t m b
$cliftA2 :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b c.
Applicative (t m) =&gt;
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m c
$c*&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
*&gt; :: forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
$c&lt;* :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Applicative (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
&lt;* :: forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679780458"><span id="local-6989586621679780462"><span id="local-6989586621679780466"><span class="annot"><span class="annottext">Applicative (AsTrans t m)
Applicative (AsTrans t m) =&gt;
(forall a b.
 AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b)
-&gt; (forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b)
-&gt; (forall a. a -&gt; AsTrans t m a)
-&gt; Monad (AsTrans t m)
forall a. a -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall a b. AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
Monad (t m) =&gt;
Applicative (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Monad (t m) =&gt;
a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
$c&gt;&gt;= :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
&gt;&gt;= :: forall a b. AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
$c&gt;&gt; :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a b.
Monad (t m) =&gt;
AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
&gt;&gt; :: forall a b. AsTrans t m a -&gt; AsTrans t m b -&gt; AsTrans t m b
$creturn :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
Monad (t m) =&gt;
a -&gt; AsTrans t m a
return :: forall a. a -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679780477"><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). Monad m =&gt; Monad (AsTrans t m)) =&gt;
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a)
-&gt; MonadTrans (AsTrans t)
forall (m :: * -&gt; *). Monad m =&gt; Monad (AsTrans t m)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *).
(MonadTrans t, Monad m) =&gt;
Monad (AsTrans t m)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
(forall (m :: * -&gt; *). Monad m =&gt; Monad (t m)) =&gt;
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a) -&gt; MonadTrans t
$clift :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; AsTrans t m a
lift :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadTrans</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679780495"><span id="local-6989586621679780504"><span class="annot"><span class="annottext">MonadTrans (AsTrans t)
MonadTrans (AsTrans t) =&gt;
(forall (m :: * -&gt; *) a.
 Monad m =&gt;
 (Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a)
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    m (StT (AsTrans t) a) -&gt; AsTrans t m a)
-&gt; MonadTransControl (AsTrans t)
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
MonadTrans t =&gt;
(forall (m :: * -&gt; *) a. Monad m =&gt; (Run t -&gt; m a) -&gt; t m a)
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; m (StT t a) -&gt; t m a)
-&gt; MonadTransControl t
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
MonadTransControl t =&gt;
MonadTrans (AsTrans t)
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
$cliftWith :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
liftWith :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
$crestoreT :: forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
restoreT :: forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadTransControl</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779641"><span id="local-6989586621679779642"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679779641"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679779642"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679779641"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779642"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779641"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779642"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621679780525"><span class="annot"><span class="annottext">fail :: forall a. String -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; AsTrans t m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; AsTrans t m a)
-&gt; (String -&gt; m a) -&gt; String -&gt; AsTrans t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; m a
forall a. String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779647"><span id="local-6989586621679779648"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTransControl</span></span><span> </span><span class="annot"><a href="#local-6989586621679779647"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779648"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679779647"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779648"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779647"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779648"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-514"></span><span>  </span><span id="local-6989586621679780542"><span class="annot"><span class="annottext">throwError :: forall a. MockChainError -&gt; AsTrans t m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">throwError</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m a -&gt; AsTrans t m a
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m a -&gt; AsTrans t m a)
-&gt; (MockChainError -&gt; m a) -&gt; MockChainError -&gt; AsTrans t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; m a
forall a. MockChainError -&gt; m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span>
</span><span id="line-515"></span><span>  </span><span id="local-6989586621679780552"><span class="annot"><span class="annottext">catchError :: forall a.
AsTrans t m a -&gt; (MockChainError -&gt; AsTrans t m a) -&gt; AsTrans t m a
</span><a href="#local-6989586621679780552"><span class="hs-identifier hs-var hs-var hs-var hs-var">catchError</span></a></span></span><span> </span><span id="local-6989586621679780554"><span class="annot"><span class="annottext">AsTrans t m a
</span><a href="#local-6989586621679780554"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span id="local-6989586621679780555"><span class="annot"><span class="annottext">MockChainError -&gt; AsTrans t m a
</span><a href="#local-6989586621679780555"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Run (AsTrans t) -&gt; m (StT t a)) -&gt; AsTrans t m (StT t a)
forall (m :: * -&gt; *) a.
Monad m =&gt;
(Run (AsTrans t) -&gt; m a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
(Run t -&gt; m a) -&gt; t m a
</span><span class="hs-identifier hs-var">liftWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679780557"><span class="annot"><span class="annottext">Run (AsTrans t)
</span><a href="#local-6989586621679780557"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; (MockChainError -&gt; m (StT t a)) -&gt; m (StT t a)
forall a. m a -&gt; (MockChainError -&gt; m a) -&gt; m a
forall e (m :: * -&gt; *) a.
MonadError e m =&gt;
m a -&gt; (e -&gt; m a) -&gt; m a
</span><span class="hs-identifier hs-var">catchError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsTrans t m a -&gt; m (StT (AsTrans t) a)
Run (AsTrans t)
</span><a href="#local-6989586621679780557"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">AsTrans t m a
</span><a href="#local-6989586621679780554"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsTrans t m a -&gt; m (StT t a)
AsTrans t m a -&gt; m (StT (AsTrans t) a)
Run (AsTrans t)
</span><a href="#local-6989586621679780557"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">(AsTrans t m a -&gt; m (StT t a))
-&gt; (MockChainError -&gt; AsTrans t m a)
-&gt; MockChainError
-&gt; m (StT t a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; AsTrans t m a
</span><a href="#local-6989586621679780555"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AsTrans t m (StT t a)
-&gt; (StT t a -&gt; AsTrans t m a) -&gt; AsTrans t m a
forall a b. AsTrans t m a -&gt; (a -&gt; AsTrans t m b) -&gt; AsTrans t m b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">m (StT t a) -&gt; AsTrans t m a
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (m :: * -&gt; *) a.
Monad m =&gt;
m (StT (AsTrans t) a) -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTransControl t, Monad m) =&gt;
m (StT t a) -&gt; t m a
</span><span class="hs-identifier hs-var">restoreT</span></span><span> </span><span class="annot"><span class="annottext">(m (StT t a) -&gt; AsTrans t m a)
-&gt; (StT t a -&gt; m (StT t a)) -&gt; StT t a -&gt; AsTrans t m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StT t a -&gt; m (StT t a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779654"><span id="local-6989586621679779655"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679779654"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779655"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679779654"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779655"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779654"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779655"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779654"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779655"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-518"></span><span>  </span><span id="local-6989586621679780580"><span class="annot"><span class="annottext">getParams :: AsTrans t m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">getParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Params -&gt; AsTrans t m Params
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span id="local-6989586621679780584"><span class="annot"><span class="annottext">validatorFromHash :: ValidatorHash -&gt; AsTrans t m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatorFromHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe (Versioned Validator))
-&gt; AsTrans t m (Maybe (Versioned Validator))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe (Versioned Validator))
 -&gt; AsTrans t m (Maybe (Versioned Validator)))
-&gt; (ValidatorHash -&gt; m (Maybe (Versioned Validator)))
-&gt; ValidatorHash
-&gt; AsTrans t m (Maybe (Versioned Validator))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; m (Maybe (Versioned Validator))
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
ValidatorHash -&gt; m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var">validatorFromHash</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span id="local-6989586621679780588"><span class="annot"><span class="annottext">utxosAtLedger :: Address -&gt; AsTrans t m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAtLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">utxosAtLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)] -&gt; AsTrans t m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [(TxOutRef, TxOut)] -&gt; AsTrans t m [(TxOutRef, TxOut)])
-&gt; (Address -&gt; m [(TxOutRef, TxOut)])
-&gt; Address
-&gt; AsTrans t m [(TxOutRef, TxOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
Address -&gt; m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAtLedger"><span class="hs-identifier hs-var">utxosAtLedger</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span id="local-6989586621679780592"><span class="annot"><span class="annottext">txOutByRefLedger :: TxOutRef -&gt; AsTrans t m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">txOutByRefLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe TxOut) -&gt; AsTrans t m (Maybe TxOut)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe TxOut) -&gt; AsTrans t m (Maybe TxOut))
-&gt; (TxOutRef -&gt; m (Maybe TxOut))
-&gt; TxOutRef
-&gt; AsTrans t m (Maybe TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-var">txOutByRefLedger</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span id="local-6989586621679780596"><span class="annot"><span class="annottext">datumFromHash :: DatumHash -&gt; AsTrans t m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var hs-var hs-var hs-var">datumFromHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe Datum) -&gt; AsTrans t m (Maybe Datum)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe Datum) -&gt; AsTrans t m (Maybe Datum))
-&gt; (DatumHash -&gt; m (Maybe Datum))
-&gt; DatumHash
-&gt; AsTrans t m (Maybe Datum)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; m (Maybe Datum)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
DatumHash -&gt; m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var">datumFromHash</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span id="local-6989586621679780600"><span class="annot"><span class="annottext">logEvent :: MockChainLogEntry -&gt; AsTrans t m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var hs-var hs-var hs-var">logEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; AsTrans t m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; AsTrans t m ())
-&gt; (MockChainLogEntry -&gt; m ())
-&gt; MockChainLogEntry
-&gt; AsTrans t m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainLogEntry -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
MockChainLogEntry -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var">logEvent</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779658"><span id="local-6989586621679779659"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679779658"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779659"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679779658"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779659"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779658"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779659"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779658"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779659"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621679780619"><span class="annot"><span class="annottext">allUtxosLedger :: AsTrans t m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxosLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">allUtxosLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)] -&gt; AsTrans t m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxosLedger"><span class="hs-identifier hs-var">allUtxosLedger</span></a></span><span>
</span><span id="line-527"></span><span>  </span><span id="local-6989586621679780623"><span class="annot"><span class="annottext">setParams :: Params -&gt; AsTrans t m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">setParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; AsTrans t m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; AsTrans t m ())
-&gt; (Params -&gt; m ()) -&gt; Params -&gt; AsTrans t m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Params -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var">setParams</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span id="local-6989586621679780627"><span class="annot"><span class="annottext">currentSlot :: AsTrans t m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var hs-var hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; AsTrans t m Slot
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621679780631"><span class="annot"><span class="annottext">awaitSlot :: Slot -&gt; AsTrans t m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var hs-var hs-var hs-var">awaitSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; AsTrans t m Slot
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m Slot -&gt; AsTrans t m Slot)
-&gt; (Slot -&gt; m Slot) -&gt; Slot -&gt; AsTrans t m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779662"><span id="local-6989586621679779663"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621679779662"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779663"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779662"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779663"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779662"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779663"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>  </span><span id="local-6989586621679780647"><span class="annot"><span class="annottext">validateTxSkel :: TxSkel -&gt; AsTrans t m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var hs-var hs-var hs-var">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m CardanoTx -&gt; AsTrans t m CardanoTx
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; AsTrans t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m CardanoTx -&gt; AsTrans t m CardanoTx)
-&gt; (TxSkel -&gt; m CardanoTx) -&gt; TxSkel -&gt; AsTrans t m CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m CardanoTx
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span id="local-6989586621679780659"><span id="local-6989586621679780666"><span id="local-6989586621679780673"><span id="local-6989586621679780680"><span id="local-6989586621679780687"><span id="local-6989586621679780694"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779676"><span id="local-6989586621679779677"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779676"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679779676"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779676"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span id="local-6989586621679780717"><span id="local-6989586621679780724"><span id="local-6989586621679780731"><span id="local-6989586621679780738"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779680"><span id="local-6989586621679779681"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779680"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779681"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679779680"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779681"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779680"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779681"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span id="local-6989586621679780758"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779684"><span id="local-6989586621679779685"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779684"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779685"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679779684"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779685"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779684"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779685"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span id="local-6989586621679780781"><span id="local-6989586621679780788"><span id="local-6989586621679780795"><span id="local-6989586621679780802"><span id="local-6989586621679780809"><span id="local-6989586621679780816"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779698"><span id="local-6989586621679779699"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779698"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779698"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779699"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779698"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span id="local-6989586621679780838"><span id="local-6989586621679780845"><span id="local-6989586621679780852"><span id="local-6989586621679780859"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779702"><span id="local-6989586621679779703"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779703"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779702"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779702"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779703"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779702"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span id="local-6989586621679780878"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779706"><span id="local-6989586621679779707"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779707"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779706"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779706"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779707"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779706"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span id="local-6989586621679780901"><span id="local-6989586621679780908"><span id="local-6989586621679780915"><span id="local-6989586621679780922"><span id="local-6989586621679780929"><span id="local-6989586621679780936"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779720"><span id="local-6989586621679779721"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779721"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779720"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779720"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779721"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779720"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span id="local-6989586621679780958"><span id="local-6989586621679780965"><span id="local-6989586621679780972"><span id="local-6989586621679780979"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779724"><span id="local-6989586621679779725"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779725"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779724"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779724"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779725"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779724"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span id="local-6989586621679780998"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">via</span><span> </span><span id="local-6989586621679779728"><span id="local-6989586621679779729"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#AsTrans"><span class="hs-identifier hs-type">AsTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779729"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679779728"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779728"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779729"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779728"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="hs-comment">-- 'ListT' has no 'MonadTransControl' instance, so the @deriving via ...@</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- machinery is unusable here. However, there is</span><span>
</span><span id="line-554"></span><span class="hs-comment">--</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- &gt; MonadError e m =&gt; MonadError e (ListT m)</span><span>
</span><span id="line-556"></span><span class="hs-comment">--</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- so I decided to go with a bit of code duplication to implement the</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- 'MonadBlockChainWithoutValidation' and 'MonadBlockChain' instances for</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- 'ListT', instead of more black magic...</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779735"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779735"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainBalancing"><span class="hs-identifier hs-type">MonadBlockChainBalancing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779735"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-562"></span><span>  </span><span id="local-6989586621679781032"><span class="annot"><span class="annottext">getParams :: ListT m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">getParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Params -&gt; ListT m Params
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m Params
forall (m :: * -&gt; *). MonadBlockChainBalancing m =&gt; m Params
</span><a href="Cooked.MockChain.BlockChain.html#getParams"><span class="hs-identifier hs-var">getParams</span></a></span><span>
</span><span id="line-563"></span><span>  </span><span id="local-6989586621679781036"><span class="annot"><span class="annottext">validatorFromHash :: ValidatorHash -&gt; ListT m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatorFromHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe (Versioned Validator))
-&gt; ListT m (Maybe (Versioned Validator))
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe (Versioned Validator))
 -&gt; ListT m (Maybe (Versioned Validator)))
-&gt; (ValidatorHash -&gt; m (Maybe (Versioned Validator)))
-&gt; ValidatorHash
-&gt; ListT m (Maybe (Versioned Validator))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; m (Maybe (Versioned Validator))
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
ValidatorHash -&gt; m (Maybe (Versioned Validator))
</span><a href="Cooked.MockChain.BlockChain.html#validatorFromHash"><span class="hs-identifier hs-var">validatorFromHash</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span id="local-6989586621679781040"><span class="annot"><span class="annottext">utxosAtLedger :: Address -&gt; ListT m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAtLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">utxosAtLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)] -&gt; ListT m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [(TxOutRef, TxOut)] -&gt; ListT m [(TxOutRef, TxOut)])
-&gt; (Address -&gt; m [(TxOutRef, TxOut)])
-&gt; Address
-&gt; ListT m [(TxOutRef, TxOut)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
Address -&gt; m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#utxosAtLedger"><span class="hs-identifier hs-var">utxosAtLedger</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621679781044"><span class="annot"><span class="annottext">txOutByRefLedger :: TxOutRef -&gt; ListT m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">txOutByRefLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe TxOut) -&gt; ListT m (Maybe TxOut)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe TxOut) -&gt; ListT m (Maybe TxOut))
-&gt; (TxOutRef -&gt; m (Maybe TxOut))
-&gt; TxOutRef
-&gt; ListT m (Maybe TxOut)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; m (Maybe TxOut)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
TxOutRef -&gt; m (Maybe TxOut)
</span><a href="Cooked.MockChain.BlockChain.html#txOutByRefLedger"><span class="hs-identifier hs-var">txOutByRefLedger</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span id="local-6989586621679781048"><span class="annot"><span class="annottext">datumFromHash :: DatumHash -&gt; ListT m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var hs-var hs-var hs-var">datumFromHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Maybe Datum) -&gt; ListT m (Maybe Datum)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m (Maybe Datum) -&gt; ListT m (Maybe Datum))
-&gt; (DatumHash -&gt; m (Maybe Datum))
-&gt; DatumHash
-&gt; ListT m (Maybe Datum)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; m (Maybe Datum)
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
DatumHash -&gt; m (Maybe Datum)
</span><a href="Cooked.MockChain.BlockChain.html#datumFromHash"><span class="hs-identifier hs-var">datumFromHash</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span id="local-6989586621679781052"><span class="annot"><span class="annottext">logEvent :: MockChainLogEntry -&gt; ListT m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var hs-var hs-var hs-var">logEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ListT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ListT m ())
-&gt; (MockChainLogEntry -&gt; m ()) -&gt; MockChainLogEntry -&gt; ListT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainLogEntry -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainBalancing m =&gt;
MockChainLogEntry -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#logEvent"><span class="hs-identifier hs-var">logEvent</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779737"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779737"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChainWithoutValidation"><span class="hs-identifier hs-type">MonadBlockChainWithoutValidation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779737"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-570"></span><span>  </span><span id="local-6989586621679781067"><span class="annot"><span class="annottext">allUtxosLedger :: ListT m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxosLedger"><span class="hs-identifier hs-var hs-var hs-var hs-var">allUtxosLedger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)] -&gt; ListT m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [(TxOutRef, TxOut)]
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
m [(TxOutRef, TxOut)]
</span><a href="Cooked.MockChain.BlockChain.html#allUtxosLedger"><span class="hs-identifier hs-var">allUtxosLedger</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679781071"><span class="annot"><span class="annottext">setParams :: Params -&gt; ListT m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var hs-var hs-var hs-var">setParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ListT m ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ListT m ()) -&gt; (Params -&gt; m ()) -&gt; Params -&gt; ListT m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Params -&gt; m ()
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Params -&gt; m ()
</span><a href="Cooked.MockChain.BlockChain.html#setParams"><span class="hs-identifier hs-var">setParams</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span id="local-6989586621679781075"><span class="annot"><span class="annottext">currentSlot :: ListT m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var hs-var hs-var hs-var">currentSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; ListT m Slot
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadBlockChainWithoutValidation m =&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#currentSlot"><span class="hs-identifier hs-var">currentSlot</span></a></span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679781079"><span class="annot"><span class="annottext">awaitSlot :: Slot -&gt; ListT m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var hs-var hs-var hs-var">awaitSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; ListT m Slot
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m Slot -&gt; ListT m Slot)
-&gt; (Slot -&gt; m Slot) -&gt; Slot -&gt; ListT m Slot
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Slot -&gt; m Slot
forall (m :: * -&gt; *).
MonadBlockChainWithoutValidation m =&gt;
Slot -&gt; m Slot
</span><a href="Cooked.MockChain.BlockChain.html#awaitSlot"><span class="hs-identifier hs-var">awaitSlot</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679779739"><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679779739"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MonadBlockChain"><span class="hs-identifier hs-type">MonadBlockChain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="annot"><a href="#local-6989586621679779739"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-576"></span><span>  </span><span id="local-6989586621679781092"><span class="annot"><span class="annottext">validateTxSkel :: TxSkel -&gt; ListT m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var hs-var hs-var hs-var">validateTxSkel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m CardanoTx -&gt; ListT m CardanoTx
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ListT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m CardanoTx -&gt; ListT m CardanoTx)
-&gt; (TxSkel -&gt; m CardanoTx) -&gt; TxSkel -&gt; ListT m CardanoTx
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; m CardanoTx
forall (m :: * -&gt; *). MonadBlockChain m =&gt; TxSkel -&gt; m CardanoTx
</span><a href="Cooked.MockChain.BlockChain.html#validateTxSkel"><span class="hs-identifier hs-var">validateTxSkel</span></a></span><span>
</span><span id="line-577"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This module provides an automated attack to try and redirect outputs to a</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- certain target with a similar datum type.</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Attack.DatumHijacking</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#redirectScriptOutputTweak"><span class="hs-identifier">redirectScriptOutputTweak</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#datumHijackingAttack"><span class="hs-identifier">datumHijackingAttack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#DatumHijackingLbl"><span class="hs-identifier">DatumHijackingLbl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Output.html"><span class="hs-identifier">Cooked.Output</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.Class.html"><span class="hs-identifier">Cooked.Pretty.Class</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html"><span class="hs-identifier">Cooked.Skeleton</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Tweak.html"><span class="hs-identifier">Cooked.Tweak</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Validators.html"><span class="hs-identifier">Cooked.Validators</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.Core</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Typed</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusLedgerApi.V3</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;+&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Type.Reflection</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- | Redirect script outputs from one validator to another validator of the same</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- type. Returns the list of outputs it redirected (as they were before the</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- modification), in the order in which they occurred on the original</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- transaction.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- Something like @txSkelOutsL % traversed % txSkelOutOwnerTypeP</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- @(Script.TypedValidator a)@ might be useful to construct the optics used by</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- this tweak.</span><span>
</span><span id="line-31"></span><span id="local-6989586621679704392"><span id="local-6989586621679704394"><span id="local-6989586621679704397"><span id="local-6989586621679704400"><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#redirectScriptOutputTweak"><span class="hs-identifier hs-type">redirectScriptOutputTweak</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Tweak.Common.html#MonadTweak"><span class="hs-identifier hs-type">MonadTweak</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679704392"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Is</span></span><span> </span><span class="annot"><a href="#local-6989586621679704394"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A_Traversal</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Optic'</span></span><span> </span><span class="annot"><a href="#local-6989586621679704394"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679704400"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679704397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- | Return @Just@ the new validator, or @Nothing@ if you want to leave this</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- output unchanged.</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679704397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679704397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-comment">-- | The redirection described by the previous argument might apply to more</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-comment">-- than one of the script outputs of the transaction. Use this predicate to</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-comment">-- select which of the redirectable script outputs to actually redirect. We</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">-- count the redirectable script outputs from the left to the right, starting</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">-- with zero.</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="#local-6989586621679704392"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679704397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-48"></span><span id="redirectScriptOutputTweak"><span class="annot"><span class="annottext">redirectScriptOutputTweak :: forall (m :: * -&gt; *) k a (is :: IxList).
(MonadTweak m, Is k A_Traversal, Show (DatumType a),
 ToData (DatumType a)) =&gt;
Optic'
  k
  is
  TxSkel
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
-&gt; (ConcreteOutput
      (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
    -&gt; Maybe (TypedValidator a))
-&gt; (Integer -&gt; Bool)
-&gt; m [ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
</span><a href="Cooked.Attack.DatumHijacking.html#redirectScriptOutputTweak"><span class="hs-identifier hs-var hs-var">redirectScriptOutputTweak</span></a></span></span><span> </span><span id="local-6989586621679704529"><span class="annot"><span class="annottext">Optic'
  k
  is
  TxSkel
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
</span><a href="#local-6989586621679704529"><span class="hs-identifier hs-var">optic</span></a></span></span><span> </span><span id="local-6989586621679704530"><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; Maybe (TypedValidator a)
</span><a href="#local-6989586621679704530"><span class="hs-identifier hs-var">change</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">Optic'
  k
  is
  TxSkel
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
-&gt; (ConcreteOutput
      (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
    -&gt; Maybe
         (ConcreteOutput
            (TypedValidator a) TxSkelOutDatum Value (Versioned Script)))
-&gt; (Integer -&gt; Bool)
-&gt; m [ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
forall a (m :: * -&gt; *) k (is :: IxList).
(MonadTweak m, Is k A_Traversal) =&gt;
Optic' k is TxSkel a
-&gt; (a -&gt; Maybe a) -&gt; (Integer -&gt; Bool) -&gt; m [a]
</span><a href="Cooked.Tweak.Common.html#overMaybeSelectingTweak"><span class="hs-identifier hs-var">overMaybeSelectingTweak</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><span class="annottext">Optic'
  k
  is
  TxSkel
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
</span><a href="#local-6989586621679704529"><span class="hs-identifier hs-var">optic</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679704532"><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
</span><a href="#local-6989586621679704532"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; Maybe (TypedValidator a)
</span><a href="#local-6989586621679704530"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
</span><a href="#local-6989586621679704532"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="annottext">Maybe (TypedValidator a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679704533"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679704533"><span class="hs-identifier hs-var">newValidator</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
 -&gt; Maybe
      (ConcreteOutput
         (TypedValidator a) TxSkelOutDatum Value (Versioned Script)))
-&gt; ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
</span><a href="#local-6989586621679704532"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; (ConcreteOutput
      (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
    -&gt; ConcreteOutput
         (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
-&gt; ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
  (TypedValidator a)
  (TypedValidator a)
Lens'
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
  (OwnerType
     (ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script)))
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
  (TypedValidator a)
  (TypedValidator a)
-&gt; TypedValidator a
-&gt; ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679704533"><span class="hs-identifier hs-var">newValidator</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | A datum hijacking attack, simplified: This attack tries to substitute a</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- different recipient on 'PaysScript' constraints, but leaves the datum as it</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- is. That is, it tests for careless uses of something like 'txInfoOutputs' in</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- places where something like 'getContinuingOutputs' should be used. If this</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- attack goes through, however, a &quot;proper&quot; datum hijacking attack that modifies</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- the datum in a way that (the relevant part of) the</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- 'toBuiltinData'-translation stays the same will also work.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- A 'DatumHijackingLbl' with the hash of the &quot;thief&quot; validator is added to the</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- labels of the 'TxSkel' using 'addLabel'.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- This attack returns the list of outputs it redirected, in the order in which</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- they occurred on the original transaction. If no output is redirected, this</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- attack fails.</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#datumHijackingAttack"><span class="hs-identifier hs-type">datumHijackingAttack</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679704442"><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679704441"><span class="annot"><a href="#local-6989586621679704441"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Tweak.Common.html#MonadTweak"><span class="hs-identifier hs-type">MonadTweak</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679704441"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.UnsafeFromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Api.UnsafeFromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-comment">-- | Predicate to select outputs to steal, depending on the intended</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-comment">-- recipient, the datum, and the value.</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- | The selection predicate may match more than one output. Use this</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- predicate to restrict to the i-th of the outputs (counting from the left,</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">-- starting at zero) chosen by the selection predicate with this predicate.</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="#local-6989586621679704441"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Value</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script.Script</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span id="datumHijackingAttack"><span class="annot"><span class="annottext">datumHijackingAttack :: forall a (m :: * -&gt; *).
(MonadTweak m, Show (DatumType a), PrettyCooked (DatumType a),
 ToData (DatumType a), UnsafeFromData (DatumType a),
 UnsafeFromData (RedeemerType a), Typeable (DatumType a),
 Typeable a) =&gt;
(ConcreteOutput
   (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
 -&gt; Bool)
-&gt; (Integer -&gt; Bool)
-&gt; m [ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
</span><a href="Cooked.Attack.DatumHijacking.html#datumHijackingAttack"><span class="hs-identifier hs-var hs-var">datumHijackingAttack</span></a></span></span><span> </span><span id="local-6989586621679704598"><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; Bool
</span><a href="#local-6989586621679704598"><span class="hs-identifier hs-var">change</span></a></span></span><span> </span><span id="local-6989586621679704599"><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="#local-6989586621679704599"><span class="hs-identifier hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679704600"><span class="annot"><span class="annottext">[ConcreteOutput
   (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
</span><a href="#local-6989586621679704600"><span class="hs-identifier hs-var">redirected</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Optic'
  A_Traversal
  NoIx
  TxSkel
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
-&gt; (ConcreteOutput
      (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
    -&gt; Maybe (TypedValidator a))
-&gt; (Integer -&gt; Bool)
-&gt; m [ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
forall (m :: * -&gt; *) k a (is :: IxList).
(MonadTweak m, Is k A_Traversal, Show (DatumType a),
 ToData (DatumType a)) =&gt;
Optic'
  k
  is
  TxSkel
  (ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
-&gt; (ConcreteOutput
      (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
    -&gt; Maybe (TypedValidator a))
-&gt; (Integer -&gt; Bool)
-&gt; m [ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
</span><a href="Cooked.Attack.DatumHijacking.html#redirectScriptOutputTweak"><span class="hs-identifier hs-var">redirectScriptOutputTweak</span></a></span><span>
</span><span id="line-92"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' TxSkel [TxSkelOut]
</span><a href="Cooked.Skeleton.html#txSkelOutsL"><span class="hs-identifier hs-var">txSkelOutsL</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TxSkel [TxSkelOut]
-&gt; Optic
     A_Traversal NoIx [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
-&gt; Optic A_Traversal NoIx TxSkel TxSkel TxSkelOut TxSkelOut
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Traversal NoIx [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
forall (t :: * -&gt; *) a b.
Traversable t =&gt;
Traversal (t a) (t b) a b
</span><span class="hs-identifier hs-var">traversed</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Traversal NoIx TxSkel TxSkel TxSkelOut TxSkelOut
-&gt; Optic
     A_Prism
     NoIx
     TxSkelOut
     TxSkelOut
     (ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
     (ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
-&gt; Optic'
     A_Traversal
     NoIx
     TxSkel
     (ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall ownerType.
(ToCredential ownerType, Show ownerType,
 IsTxSkelOutAllowedOwner ownerType, Typeable ownerType) =&gt;
Prism'
  TxSkelOut
  (ConcreteOutput ownerType TxSkelOutDatum Value (Versioned Script))
</span><a href="Cooked.Skeleton.html#txSkelOutOwnerTypeP"><span class="hs-identifier hs-var">txSkelOutOwnerTypeP</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Script.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679704605"><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
</span><a href="#local-6989586621679704605"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
-&gt; Bool
</span><a href="#local-6989586621679704598"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (Versioned Script)
</span><a href="#local-6989586621679704605"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Maybe (TypedValidator a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679704606"><span class="hs-identifier hs-var">thief</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (TypedValidator a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>      </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="#local-6989586621679704599"><span class="hs-identifier hs-var">select</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m ()) -&gt; (Bool -&gt; Bool) -&gt; Bool -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m ()) -&gt; Bool -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ConcreteOutput
   (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
-&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ConcreteOutput
   (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
</span><a href="#local-6989586621679704600"><span class="hs-identifier hs-var">redirected</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">DatumHijackingLbl -&gt; m ()
forall (m :: * -&gt; *) x. (MonadTweak m, LabelConstrs x) =&gt; x -&gt; m ()
</span><a href="Cooked.Tweak.Labels.html#addLabelTweak"><span class="hs-identifier hs-var">addLabelTweak</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumHijackingLbl -&gt; m ()) -&gt; DatumHijackingLbl -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; DatumHijackingLbl
</span><a href="Cooked.Attack.DatumHijacking.html#DatumHijackingLbl"><span class="hs-identifier hs-var">DatumHijackingLbl</span></a></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; DatumHijackingLbl) -&gt; Address -&gt; DatumHijackingLbl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Address
forall a. TypedValidator a -&gt; Address
</span><span class="hs-identifier hs-var">Script.validatorAddress</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679704606"><span class="hs-identifier hs-var">thief</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">[ConcreteOutput
   (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
-&gt; m [ConcreteOutput
        (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[ConcreteOutput
   (TypedValidator a) TxSkelOutDatum Value (Versioned Script)]
</span><a href="#local-6989586621679704600"><span class="hs-identifier hs-var">redirected</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679704606"><span class="annot"><span class="annottext">thief :: TypedValidator a
</span><a href="#local-6989586621679704606"><span class="hs-identifier hs-var hs-var">thief</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. TypedValidator a
</span><a href="Cooked.Validators.html#alwaysTrueValidator"><span class="hs-identifier hs-var">alwaysTrueValidator</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679704442"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">newtype</span><span> </span><span id="DatumHijackingLbl"><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#DatumHijackingLbl"><span class="hs-identifier hs-var">DatumHijackingLbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DatumHijackingLbl"><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#DatumHijackingLbl"><span class="hs-identifier hs-var">DatumHijackingLbl</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.Address</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679704614"><span id="local-6989586621679704620"><span id="local-6989586621679704623"><span class="annot"><span class="annottext">Int -&gt; DatumHijackingLbl -&gt; ShowS
[DatumHijackingLbl] -&gt; ShowS
DatumHijackingLbl -&gt; String
(Int -&gt; DatumHijackingLbl -&gt; ShowS)
-&gt; (DatumHijackingLbl -&gt; String)
-&gt; ([DatumHijackingLbl] -&gt; ShowS)
-&gt; Show DatumHijackingLbl
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DatumHijackingLbl -&gt; ShowS
showsPrec :: Int -&gt; DatumHijackingLbl -&gt; ShowS
$cshow :: DatumHijackingLbl -&gt; String
show :: DatumHijackingLbl -&gt; String
$cshowList :: [DatumHijackingLbl] -&gt; ShowS
showList :: [DatumHijackingLbl] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679704627"><span id="local-6989586621679704632"><span class="annot"><span class="annottext">DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
(DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool)
-&gt; (DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool)
-&gt; Eq DatumHijackingLbl
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
== :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
$c/= :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
/= :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679704639"><span id="local-6989586621679704644"><span id="local-6989586621679704648"><span id="local-6989586621679704652"><span id="local-6989586621679704656"><span id="local-6989586621679704660"><span id="local-6989586621679704664"><span class="annot"><span class="annottext">Eq DatumHijackingLbl
Eq DatumHijackingLbl =&gt;
(DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Ordering)
-&gt; (DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool)
-&gt; (DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool)
-&gt; (DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool)
-&gt; (DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool)
-&gt; (DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; DatumHijackingLbl)
-&gt; (DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; DatumHijackingLbl)
-&gt; Ord DatumHijackingLbl
DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Ordering
DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; DatumHijackingLbl
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Ordering
compare :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Ordering
$c&lt; :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
&lt; :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
$c&lt;= :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
&lt;= :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
$c&gt; :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
&gt; :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
$c&gt;= :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
&gt;= :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; Bool
$cmax :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; DatumHijackingLbl
max :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; DatumHijackingLbl
$cmin :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; DatumHijackingLbl
min :: DatumHijackingLbl -&gt; DatumHijackingLbl -&gt; DatumHijackingLbl
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679704669"><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#DatumHijackingLbl"><span class="hs-identifier hs-type">DatumHijackingLbl</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679704677"><span class="annot"><span class="annottext">prettyCookedOpt :: PrettyCookedOpts -&gt; DatumHijackingLbl -&gt; DocCooked
</span><a href="#local-6989586621679704677"><span class="hs-identifier hs-var hs-var hs-var hs-var">prettyCookedOpt</span></a></span></span><span> </span><span id="local-6989586621679704679"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679704679"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Attack.DatumHijacking.html#DatumHijackingLbl"><span class="hs-identifier hs-type">DatumHijackingLbl</span></a></span><span> </span><span id="local-6989586621679704680"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679704680"><span class="hs-identifier hs-var">address</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DocCooked
</span><span class="hs-string">&quot;DatumHijacking&quot;</span></span><span> </span><span class="annot"><span class="annottext">DocCooked -&gt; DocCooked -&gt; DocCooked
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; Address -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679704679"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679704680"><span class="hs-identifier hs-var">address</span></a></span><span>
</span><span id="line-106"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This modules provides primitives to run tests over mockchain executions and</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- to provide requirements on the the number and results of these runs.</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.Testing</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html"><span class="hs-identifier">Cooked.InitialDistribution</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html"><span class="hs-identifier">Cooked.MockChain.BlockChain</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html"><span class="hs-identifier">Cooked.MockChain.Direct</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html"><span class="hs-identifier">Cooked.MockChain.Staged</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html"><span class="hs-identifier">Cooked.MockChain.UtxoState</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.html"><span class="hs-identifier">Cooked.Pretty</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Wallet.html"><span class="hs-identifier">Cooked.Wallet</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusLedgerApi.V1.Value</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QC</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HU</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.HUnit</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HU</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.QuickCheck</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QC</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="annot"><span class="hs-comment">-- * Common interface between HUnit and QuickCheck</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | 'IsProp' is a common interface for HUnit and QuickCheck tests. It abstracts</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- uses of 'HU.Assertion' and 'QC.Property' for @(IsProp prop) =&gt; prop@, then</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- provide instances for both @HU.Asserton@ and @QC.Property@.</span><span>
</span><span id="line-29"></span><span class="hs-keyword">class</span><span> </span><span id="IsProp"><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-var">IsProp</span></a></span></span><span> </span><span id="local-6989586621679838367"><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-comment">-- | Displays the string to the user in case of failure</span><span>
</span><span id="line-31"></span><span>  </span><span id="testCounterexample"><span class="annot"><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-type">testCounterexample</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-comment">-- | Conjunction of a number of results</span><span>
</span><span id="line-34"></span><span>  </span><span id="testConjoin"><span class="annot"><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-type">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-comment">-- | Disjunction of a number of results</span><span>
</span><span id="line-37"></span><span>  </span><span id="testDisjoin"><span class="annot"><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-type">testDisjoin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- | Flags a failure</span><span>
</span><span id="line-40"></span><span>  </span><span id="testFailure"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-type">testFailure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span id="local-6989586621679838616"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var">testFailure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-comment">-- | Flags a success</span><span>
</span><span id="line-44"></span><span>  </span><span id="testSuccess"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-type">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621679838619"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var">testSuccess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-comment">-- | Flags a failure with a message</span><span>
</span><span id="line-48"></span><span>  </span><span id="testFailureMsg"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-type">testFailureMsg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838367"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679838622"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var hs-var">testFailureMsg</span></a></span><span> </span><span id="local-6989586621679838625"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838625"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838625"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><span class="hs-comment">-- | Turns a boolean into a @prop@</span></span><span>
</span><span id="line-52"></span><span id="local-6989586621679838370"><span class="annot"><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-type">testBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838370"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838370"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-53"></span><span id="testBool"><span class="annot"><span class="annottext">testBool :: forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var hs-var">testBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><span class="hs-comment">-- | Ensures all elements of a list satisfy a given @prop@</span></span><span>
</span><span id="line-57"></span><span id="local-6989586621679838372"><span id="local-6989586621679838373"><span class="annot"><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-type">testAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838372"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679838373"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838372"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838373"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838372"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-58"></span><span id="testAll"><span class="annot"><span class="annottext">testAll :: forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var hs-var">testAll</span></a></span></span><span> </span><span id="local-6989586621679838633"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679838633"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="annot"><span class="annottext">([prop] -&gt; prop) -&gt; ([a] -&gt; [prop]) -&gt; [a] -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; prop) -&gt; [a] -&gt; [prop]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679838633"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><span class="hs-comment">-- | Ensures at least one element of a list satisfy a given @prop@</span></span><span>
</span><span id="line-61"></span><span id="local-6989586621679838635"><span id="local-6989586621679838636"><span class="annot"><a href="Cooked.MockChain.Testing.html#testAny"><span class="hs-identifier hs-type">testAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838635"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679838636"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838635"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838635"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-62"></span><span id="testAny"><span class="annot"><span class="annottext">testAny :: forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAny"><span class="hs-identifier hs-var hs-var">testAny</span></a></span></span><span> </span><span id="local-6989586621679838640"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679838640"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="annot"><span class="annottext">([prop] -&gt; prop) -&gt; ([a] -&gt; [prop]) -&gt; [a] -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; prop) -&gt; [a] -&gt; [prop]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679838640"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-type">.==.</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><span class="hs-comment">-- | Lifts an equality test to a @prop@</span></span><span>
</span><span id="line-67"></span><span id="local-6989586621679838383"><span id="local-6989586621679838384"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-type">(.==.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838383"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679838384"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838384"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838384"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838383"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-68"></span><span id="local-6989586621679838646"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838646"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%3D%3D."><span class="annot"><span class="annottext">.==. :: forall prop a. (IsProp prop, Eq a) =&gt; a -&gt; a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-var hs-var">.==.</span></a></span></span><span> </span><span id="local-6989586621679838647"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838647"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; prop
forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; prop) -&gt; Bool -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838646"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838647"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">3</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-type">.&amp;&amp;.</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">-- | Conjunction of two @prop@s</span></span><span>
</span><span id="line-73"></span><span id="local-6989586621679838391"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-type">(.&amp;&amp;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838391"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838391"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838391"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838391"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-74"></span><span id="local-6989586621679838651"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838651"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%26%26."><span class="annot"><span class="annottext">.&amp;&amp;. :: forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var hs-var">.&amp;&amp;.</span></a></span></span><span> </span><span id="local-6989586621679838652"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838652"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838651"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838652"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-type">.||.</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><span class="hs-comment">-- | Disjunction of two @prop@s</span></span><span>
</span><span id="line-79"></span><span id="local-6989586621679838654"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-type">(.||.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838654"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838654"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838654"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838654"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-80"></span><span id="local-6989586621679838657"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838657"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%7C%7C."><span class="annot"><span class="annottext">.||. :: forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-var hs-var">.||.</span></a></span></span><span> </span><span id="local-6989586621679838658"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838658"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838657"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679838658"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><span class="hs-comment">-- | Catches a HUnit test failure, if the test fails.</span></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-type">assertionToMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="assertionToMaybe"><span class="annot"><span class="annottext">assertionToMaybe :: Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var hs-var">assertionToMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IO (Maybe HUnitFailure)
 -&gt; [Handler (Maybe HUnitFailure)] -&gt; IO (Maybe HUnitFailure))
-&gt; [Handler (Maybe HUnitFailure)]
-&gt; IO (Maybe HUnitFailure)
-&gt; IO (Maybe HUnitFailure)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe HUnitFailure)
-&gt; [Handler (Maybe HUnitFailure)] -&gt; IO (Maybe HUnitFailure)
forall a. IO a -&gt; [Handler a] -&gt; IO a
</span><span class="hs-identifier hs-var">E.catches</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; Handler (Maybe HUnitFailure)
forall a e. Exception e =&gt; (e -&gt; IO a) -&gt; Handler a
</span><span class="hs-identifier hs-var">E.Handler</span></span><span> </span><span class="annot"><span class="annottext">((HUnitFailure -&gt; IO (Maybe HUnitFailure))
 -&gt; Handler (Maybe HUnitFailure))
-&gt; (HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; Handler (Maybe HUnitFailure)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; (HUnitFailure -&gt; Maybe HUnitFailure)
-&gt; HUnitFailure
-&gt; IO (Maybe HUnitFailure)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; Maybe HUnitFailure
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(IO (Maybe HUnitFailure) -&gt; IO (Maybe HUnitFailure))
-&gt; (Assertion -&gt; IO (Maybe HUnitFailure))
-&gt; Assertion
-&gt; IO (Maybe HUnitFailure)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure) -&gt; IO (Maybe HUnitFailure)
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><span class="hs-comment">-- | HUnit instance of 'IsProp'</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679838677"><span class="annot"><span class="annottext">testCounterexample :: String -&gt; Assertion -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var hs-var hs-var hs-var">testCounterexample</span></a></span></span><span> </span><span id="local-6989586621679838678"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838678"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion
-&gt; (HUnitFailure -&gt; Assertion) -&gt; Maybe HUnitFailure -&gt; Assertion
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Assertion
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HUnitFailure -&gt; Assertion
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">(HUnitFailure -&gt; Assertion)
-&gt; (HUnitFailure -&gt; HUnitFailure) -&gt; HUnitFailure -&gt; Assertion
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; HUnitFailure
</span><a href="#local-6989586621679838681"><span class="hs-identifier hs-var">adjustMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe HUnitFailure -&gt; Assertion)
-&gt; (Assertion -&gt; IO (Maybe HUnitFailure)) -&gt; Assertion -&gt; Assertion
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var">assertionToMaybe</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>      </span><span class="annot"><a href="#local-6989586621679838683"><span class="hs-identifier hs-type">joinMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-91"></span><span>      </span><span id="local-6989586621679838683"><span class="annot"><span class="annottext">joinMsg :: String -&gt; String
</span><a href="#local-6989586621679838683"><span class="hs-identifier hs-var hs-var">joinMsg</span></a></span></span><span> </span><span id="local-6989586621679838684"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838684"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838678"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838684"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><a href="#local-6989586621679838681"><span class="hs-identifier hs-type">adjustMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span>
</span><span id="line-94"></span><span>      </span><span id="local-6989586621679838681"><span class="annot"><span class="annottext">adjustMsg :: HUnitFailure -&gt; HUnitFailure
</span><a href="#local-6989586621679838681"><span class="hs-identifier hs-var hs-var">adjustMsg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span> </span><span id="local-6989586621679838686"><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679838686"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679838687"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838687"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">Maybe SrcLoc -&gt; String -&gt; HUnitFailure
</span><span class="hs-identifier hs-var">HU.HUnitFailure</span></span><span> </span><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679838686"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679838683"><span class="hs-identifier hs-var">joinMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838687"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679838690"><span class="annot"><span class="annottext">testFailure :: Assertion
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assertion
forall a. HasCallStack =&gt; String -&gt; IO a
</span><span class="hs-identifier hs-var">HU.assertFailure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679838694"><span class="annot"><span class="annottext">testFailureMsg :: String -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailureMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assertion
forall a. HasCallStack =&gt; String -&gt; IO a
</span><span class="hs-identifier hs-var">HU.assertFailure</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679838698"><span class="annot"><span class="annottext">testConjoin :: [Assertion] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679838704"><span class="annot"><span class="annottext">testDisjoin :: [Assertion] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testDisjoin</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679838705"><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679838705"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679838706"><span class="annot"><span class="annottext">[Assertion]
</span><a href="#local-6989586621679838706"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var">assertionToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679838705"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe HUnitFailure)
-&gt; (Maybe HUnitFailure -&gt; Assertion) -&gt; Assertion
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Assertion
-&gt; (HUnitFailure -&gt; Assertion) -&gt; Maybe HUnitFailure -&gt; Assertion
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="annot"><span class="annottext">[Assertion]
</span><a href="#local-6989586621679838706"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; Assertion
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679838708"><span class="annot"><span class="annottext">testSuccess :: Assertion
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var hs-var hs-var">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Assertion
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><span class="hs-comment">-- | QuickCheck instance of 'IsProp'</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679838715"><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679838720"><span class="annot"><span class="annottext">testCounterexample :: String -&gt; Property -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var hs-var hs-var hs-var">testCounterexample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.counterexample</span></span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679838724"><span class="annot"><span class="annottext">testFailure :: Property
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679838727"><span class="annot"><span class="annottext">testSuccess :: Property
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var hs-var hs-var">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679838729"><span class="annot"><span class="annottext">testConjoin :: [Property] -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">QC.conjoin</span></span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679838732"><span class="annot"><span class="annottext">testDisjoin :: [Property] -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testDisjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">QC.disjoin</span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Here we provide our own universsal quantifier instead of 'QC.forAll', so we</span><span>
</span><span id="line-116"></span><span class="hs-comment">--  can monomorphize it to returning a 'QC.Property'</span><span>
</span><span id="line-117"></span><span id="local-6989586621679838432"><span class="annot"><a href="Cooked.MockChain.Testing.html#forAll"><span class="hs-identifier hs-type">forAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679838432"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621679838432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679838432"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span></span><span>
</span><span id="line-118"></span><span id="forAll"><span class="annot"><span class="annottext">forAll :: forall a. Show a =&gt; Gen a -&gt; (a -&gt; Property) -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#forAll"><span class="hs-identifier hs-var hs-var">forAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; Property) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">QC.forAll</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><span class="hs-comment">-- * Extra HUnit assertions</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><span class="hs-comment">-- | Asserts whether a set is a subset of another one, both given as lists.</span></span><span>
</span><span id="line-123"></span><span id="local-6989586621679838437"><span class="annot"><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-type">assertSubset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679838437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679838437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span></span><span>
</span><span id="line-124"></span><span id="assertSubset"><span class="annot"><span class="annottext">assertSubset :: forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var hs-var">assertSubset</span></a></span></span><span> </span><span id="local-6989586621679838753"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838753"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679838754"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838754"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Assertion) -&gt; [a] -&gt; [Assertion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838755"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838755"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>            </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
String -&gt; Bool -&gt; Assertion
</span><span class="hs-identifier hs-var">HU.assertBool</span></span><span>
</span><span id="line-129"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not a subset:\n\n&quot;</span></span><span>
</span><span id="line-130"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838755"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-131"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nis not an element of\n\n&quot;</span></span><span>
</span><span id="line-132"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838754"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-133"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>              </span><span class="annot"><span class="annottext">(Bool -&gt; Assertion) -&gt; Bool -&gt; Assertion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838755"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838754"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838753"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><span class="hs-comment">-- | Asserts whether 2 sets are equal, both given as lists.</span></span><span>
</span><span id="line-140"></span><span id="local-6989586621679838759"><span class="annot"><a href="Cooked.MockChain.Testing.html#assertSameSets"><span class="hs-identifier hs-type">assertSameSets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679838759"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679838759"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838759"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679838759"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span></span><span>
</span><span id="line-141"></span><span id="assertSameSets"><span class="annot"><span class="annottext">assertSameSets :: forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSameSets"><span class="hs-identifier hs-var hs-var">assertSameSets</span></a></span></span><span> </span><span id="local-6989586621679838783"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838783"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679838784"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838784"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
String -&gt; Bool -&gt; Assertion
</span><span class="hs-identifier hs-var">HU.assertBool</span></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected lists of the same length, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838783"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838784"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838783"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838784"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">Assertion -&gt; Assertion -&gt; Assertion
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Assertion
forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var">assertSubset</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838783"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838784"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">Assertion -&gt; Assertion -&gt; Assertion
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Assertion
forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var">assertSubset</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838784"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679838783"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><span class="hs-comment">-- * Data structure to test mockchain traces</span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">{--
  Note on properties over the journal (or list of 'MockChainLogEntry'): our
  'Test' structure does not directly embed a predicate over the journal. Instead
  it is embedded in both the failure and success prediates. The reason is
  simple: the journal is generated and accessible in both cases and thus it is
  theoretically possible to define predicates that combine requirements over the
  journal and the error in case of failure, and the journal and the returning
  state and value in the case of success. If the journal predicate was a field
  in itself, this link would be broken and it would not be possible to epxress
  complex requirements that involve both the journal and other components of the
  returned elements in the mockchain run. Granted, this use cas is extremely
  rare, but it does not mean our API should not reflect this capability.
  However, we also provide 'JournalProp' as in most cases on predicating over
  the journal itself will be sufficient.
--}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><span class="hs-comment">-- | Type of properties over failures</span></span><span>
</span><span id="line-167"></span><span class="hs-keyword">type</span><span> </span><span id="FailureProp"><span class="annot"><a href="Cooked.MockChain.Testing.html#FailureProp"><span class="hs-identifier hs-var">FailureProp</span></a></span></span><span> </span><span id="local-6989586621679838786"><span class="annot"><a href="#local-6989586621679838786"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838786"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | Type of properties over successes</span></span><span>
</span><span id="line-170"></span><span class="hs-keyword">type</span><span> </span><span id="SuccessProp"><span class="annot"><a href="Cooked.MockChain.Testing.html#SuccessProp"><span class="hs-identifier hs-var">SuccessProp</span></a></span></span><span> </span><span id="local-6989586621679838787"><span class="annot"><a href="#local-6989586621679838787"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679838788"><span class="annot"><a href="#local-6989586621679838788"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838787"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838788"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- | Type of properties over the number of run outcomes. This does not</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- necessitate a 'PrettyCookedOpts' as parameter as an 'Integer' does not</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- contain anything significant that can be pretty printed.</span><span>
</span><span id="line-175"></span><span class="hs-keyword">type</span><span> </span><span id="SizeProp"><span class="annot"><a href="Cooked.MockChain.Testing.html#SizeProp"><span class="hs-identifier hs-var">SizeProp</span></a></span></span><span> </span><span id="local-6989586621679838790"><span class="annot"><a href="#local-6989586621679838790"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838790"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">-- | Type of properties over the mockchain journal</span></span><span>
</span><span id="line-178"></span><span class="hs-keyword">type</span><span> </span><span id="JournalProp"><span class="annot"><a href="Cooked.MockChain.Testing.html#JournalProp"><span class="hs-identifier hs-var">JournalProp</span></a></span></span><span> </span><span id="local-6989586621679838791"><span class="annot"><a href="#local-6989586621679838791"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838791"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Data structure to test a mockchain trace. @a@ is the return typed of the</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- tested trace, @prop@ is the domain in which the properties live. This is not</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- enforced here, but it will often be assumed that @prop@ satisfies 'IsProp'.</span><span>
</span><span id="line-183"></span><span class="hs-keyword">data</span><span> </span><span id="Test"><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-var">Test</span></a></span></span><span> </span><span id="local-6989586621679838445"><span class="annot"><a href="#local-6989586621679838445"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679838446"><span class="annot"><a href="#local-6989586621679838446"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Test"><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-var">Test</span></a></span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-comment">-- | The mockchain trace to test, which returns a result of type a</span></span><span>
</span><span id="line-185"></span><span>    </span><span id="testTrace"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; StagedMockChain a
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-identifier hs-var hs-var">testTrace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The initial distribution from which the trace should be run</span></span><span>
</span><span id="line-187"></span><span>    </span><span id="testInitDist"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; InitialDistribution
</span><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var hs-var">testInitDist</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- | The requirement on the number of results, as 'StagedMockChain' is a</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- 'Contro.Monad.MonadPlus'</span><span>
</span><span id="line-190"></span><span>    </span><span id="testSizeProp"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var hs-var">testSizeProp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SizeProp"><span class="hs-identifier hs-type">SizeProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838446"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- | The property that should hold in case of failure over the resulting</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- error and the logs emitted during the run</span><span>
</span><span id="line-193"></span><span>    </span><span id="testFailureProp"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#testFailureProp"><span class="hs-identifier hs-var hs-var">testFailureProp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#FailureProp"><span class="hs-identifier hs-type">FailureProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838446"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-comment">-- | The property that should hold in case of success over the returned</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- result and the final state of the trace, as well as the logs</span><span>
</span><span id="line-196"></span><span>    </span><span id="testSuccessProp"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#testSuccessProp"><span class="hs-identifier hs-var hs-var">testSuccessProp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SuccessProp"><span class="hs-identifier hs-type">SuccessProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838446"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The printing option that should be use to render test results</span></span><span>
</span><span id="line-198"></span><span>    </span><span id="testPrettyOpts"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var hs-var">testPrettyOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | This takes a 'Test' and transforms it into an actual test case in</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- prop. This is the main function justifying the existence of 'Test'. This runs</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- the traces, ensures there is the right number of outcomes and, depending on</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- the nature of these outcomes, either calls 'testFailureProp' or</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- 'testSuccessProp'. It also uses the aliases emitted during the mockchain run</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- to pretty print messages when applicable.</span><span>
</span><span id="line-207"></span><span id="local-6989586621679838466"><span id="local-6989586621679838467"><span class="annot"><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-type">testToProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838466"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838466"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838466"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-208"></span><span id="testToProp"><span class="annot"><span class="annottext">testToProp :: forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var hs-var">testToProp</span></a></span></span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679838809"><span id="local-6989586621679838810"><span id="local-6989586621679838811"><span id="local-6989586621679838812"><span id="local-6989586621679838813"><span id="local-6989586621679838814"><span class="annot"><span class="annottext">StagedMockChain a
PrettyCookedOpts
InitialDistribution
SizeProp prop
SuccessProp a prop
FailureProp prop
testTrace :: forall a prop. Test a prop -&gt; StagedMockChain a
testInitDist :: forall a prop. Test a prop -&gt; InitialDistribution
testSizeProp :: forall a prop. Test a prop -&gt; SizeProp prop
testFailureProp :: forall a prop. Test a prop -&gt; FailureProp prop
testSuccessProp :: forall a prop. Test a prop -&gt; SuccessProp a prop
testPrettyOpts :: forall a prop. Test a prop -&gt; PrettyCookedOpts
testTrace :: StagedMockChain a
testInitDist :: InitialDistribution
testSizeProp :: SizeProp prop
testFailureProp :: FailureProp prop
testSuccessProp :: SuccessProp a prop
testPrettyOpts :: PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679838815"><span class="annot"><span class="annottext">results :: [(Either MockChainError (a, UtxoState), MockChainBook)]
</span><a href="#local-6989586621679838815"><span class="hs-identifier hs-var hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *).
 Monad m =&gt;
 MockChainT m a
 -&gt; m (Either MockChainError (a, UtxoState), MockChainBook))
-&gt; StagedMockChain a
-&gt; [(Either MockChainError (a, UtxoState), MockChainBook)]
forall a res.
(forall (m :: * -&gt; *). Monad m =&gt; MockChainT m a -&gt; m res)
-&gt; StagedMockChain a -&gt; [res]
</span><a href="Cooked.MockChain.Staged.html#interpretAndRunWith"><span class="hs-identifier hs-var">interpretAndRunWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, UtxoState), MockChainBook)
forall (m :: * -&gt; *) a.
Monad m =&gt;
InitialDistribution
-&gt; MockChainT m a -&gt; m (MockChainReturn a UtxoState)
</span><a href="Cooked.MockChain.Direct.html#runMockChainTFrom"><span class="hs-identifier hs-var">runMockChainTFrom</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679838810"><span class="hs-identifier hs-var">testInitDist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679838809"><span class="hs-identifier hs-var">testTrace</span></a></span><span>
</span><span id="line-210"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SizeProp prop
</span><a href="#local-6989586621679838811"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainBook)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainBook)]
</span><a href="#local-6989586621679838815"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">((Either MockChainError (a, UtxoState), MockChainBook) -&gt; prop)
-&gt; [(Either MockChainError (a, UtxoState), MockChainBook)] -&gt; prop
forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var">testAll</span></a></span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679838820"><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679838820"><span class="hs-identifier hs-var">outcome</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainBook"><span class="hs-identifier hs-type">MockChainBook</span></a></span><span> </span><span id="local-6989586621679838822"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838822"><span class="hs-identifier hs-var">mcLog</span></a></span></span><span> </span><span id="local-6989586621679838823"><span class="annot"><span class="annottext">Map BuiltinByteString String
</span><a href="#local-6989586621679838823"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679838824"><span class="annot"><span class="annottext">pcOpts :: PrettyCookedOpts
</span><a href="#local-6989586621679838824"><span class="hs-identifier hs-var hs-var">pcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map BuiltinByteString String
-&gt; PrettyCookedOpts -&gt; PrettyCookedOpts
</span><a href="Cooked.Pretty.Options.html#addHashNames"><span class="hs-identifier hs-var">addHashNames</span></a></span><span> </span><span class="annot"><span class="annottext">Map BuiltinByteString String
</span><a href="#local-6989586621679838823"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838814"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span>
</span><span id="line-214"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span>
</span><span id="line-215"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([MockChainLogEntry] -&gt; DocCooked) -&gt; [MockChainLogEntry] -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; [MockChainLogEntry] -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838824"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838822"><span class="hs-identifier hs-var">mcLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>                    </span><span class="annot"><span class="annottext">(prop -&gt; prop) -&gt; prop -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679838820"><span class="hs-identifier hs-var">outcome</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679838828"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838828"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FailureProp prop
</span><a href="#local-6989586621679838812"><span class="hs-identifier hs-var">testFailureProp</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838824"><span class="hs-identifier hs-var">pcOpts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838822"><span class="hs-identifier hs-var">mcLog</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838828"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-218"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679838829"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838829"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679838830"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838830"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SuccessProp a prop
</span><a href="#local-6989586621679838813"><span class="hs-identifier hs-var">testSuccessProp</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838824"><span class="hs-identifier hs-var">pcOpts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838822"><span class="hs-identifier hs-var">mcLog</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838829"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838830"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-219"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>          </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainBook)]
</span><a href="#local-6989586621679838815"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | A convenience helper when using 'HU.Assertion' which allows to replace</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- 'HU.testCase' with 'testCooked' and thus avoid the use of 'testToProp'.</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- Sadly we cannot generalise it with type classes on @prop@ to work for</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- QuichCheck at GHC will never be able to instantiate @prop@.</span><span>
</span><span id="line-226"></span><span id="local-6989586621679838489"><span class="annot"><a href="Cooked.MockChain.Testing.html#testCooked"><span class="hs-identifier hs-type">testCooked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838489"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.TestTree</span></span></span><span>
</span><span id="line-227"></span><span id="testCooked"><span class="annot"><span class="annottext">testCooked :: forall a. String -&gt; Test a Assertion -&gt; TestTree
</span><a href="Cooked.MockChain.Testing.html#testCooked"><span class="hs-identifier hs-var hs-var">testCooked</span></a></span></span><span> </span><span id="local-6989586621679838834"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838834"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assertion -&gt; TestTree
</span><span class="hs-identifier hs-var">HU.testCase</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838834"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Assertion -&gt; TestTree)
-&gt; (Test a Assertion -&gt; Assertion) -&gt; Test a Assertion -&gt; TestTree
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Test a Assertion -&gt; Assertion
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><span class="hs-comment">-- | Same as 'testCooked', but for 'QC.Property'</span></span><span>
</span><span id="line-230"></span><span id="local-6989586621679838492"><span class="annot"><a href="Cooked.MockChain.Testing.html#testCookedQC"><span class="hs-identifier hs-type">testCookedQC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838492"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.TestTree</span></span></span><span>
</span><span id="line-231"></span><span id="testCookedQC"><span class="annot"><span class="annottext">testCookedQC :: forall a. String -&gt; Test a Property -&gt; TestTree
</span><a href="Cooked.MockChain.Testing.html#testCookedQC"><span class="hs-identifier hs-var hs-var">testCookedQC</span></a></span></span><span> </span><span id="local-6989586621679838838"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838838"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; TestTree
forall a. Testable a =&gt; String -&gt; a -&gt; TestTree
</span><span class="hs-identifier hs-var">QC.testProperty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838838"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; TestTree)
-&gt; (Test a Property -&gt; Property) -&gt; Test a Property -&gt; TestTree
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Test a Property -&gt; Property
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><span class="hs-comment">-- * Simple test templates</span></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a success from a trace</span></span><span>
</span><span id="line-236"></span><span id="local-6989586621679838495"><span id="local-6989586621679838496"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustSucceedTest"><span class="hs-identifier hs-type">mustSucceedTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838495"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838496"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838496"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838495"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-237"></span><span id="mustSucceedTest"><span class="annot"><span class="annottext">mustSucceedTest :: forall prop a. IsProp prop =&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustSucceedTest"><span class="hs-identifier hs-var hs-var">mustSucceedTest</span></a></span></span><span> </span><span id="local-6989586621679838855"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679838855"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testTrace :: StagedMockChain a
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-identifier hs-var">testTrace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679838855"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">testInitDist :: InitialDistribution
</span><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var">testInitDist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><span class="annottext">testSizeProp :: SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; SizeProp prop
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="annottext">testFailureProp :: FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#testFailureProp"><span class="hs-identifier hs-var">testFailureProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838858"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838858"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838859"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838859"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected success, but got:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838858"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838859"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">testSuccessProp :: SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#testSuccessProp"><span class="hs-identifier hs-var">testSuccessProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="annottext">testPrettyOpts :: PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a failure from a trace</span></span><span>
</span><span id="line-248"></span><span id="local-6989586621679838505"><span id="local-6989586621679838506"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-type">mustFailTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838505"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679838506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838505"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-249"></span><span id="mustFailTest"><span class="annot"><span class="annottext">mustFailTest :: forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var hs-var">mustFailTest</span></a></span></span><span> </span><span id="local-6989586621679838873"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679838873"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testTrace :: StagedMockChain a
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-identifier hs-var">testTrace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679838873"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="annottext">testInitDist :: InitialDistribution
</span><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var">testInitDist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">testSizeProp :: SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; SizeProp prop
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><span class="annottext">testFailureProp :: FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#testFailureProp"><span class="hs-identifier hs-var">testFailureProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><span class="annottext">testSuccessProp :: SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#testSuccessProp"><span class="hs-identifier hs-var">testSuccessProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838874"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838874"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838875"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838875"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679838876"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838876"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected failure, but got:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((a, UtxoState) -&gt; DocCooked) -&gt; (a, UtxoState) -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; (a, UtxoState) -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838874"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838875"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838876"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">testPrettyOpts :: PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="annot"><span class="hs-comment">-- * Appending elements (in particular requirements) to existing tests</span></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><span class="hs-comment">-- | Gives an initial distribution from which the trace will be run</span></span><span>
</span><span id="line-262"></span><span id="local-6989586621679838510"><span id="local-6989586621679838511"><span class="annot"><a href="Cooked.MockChain.Testing.html#withInitDist"><span class="hs-identifier hs-type">withInitDist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838510"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838511"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838510"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838511"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-263"></span><span id="withInitDist"><span class="annot"><span class="annottext">withInitDist :: forall a prop. Test a prop -&gt; InitialDistribution -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withInitDist"><span class="hs-identifier hs-var hs-var">withInitDist</span></a></span></span><span> </span><span id="local-6989586621679838878"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838878"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838879"><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679838879"><span class="hs-identifier hs-var">initDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838878"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var">testInitDist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679838879"><span class="hs-identifier hs-type">initDist</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="annot"><span class="hs-comment">-- | Gives some pretty options to render test messages</span></span><span>
</span><span id="line-266"></span><span id="local-6989586621679838514"><span id="local-6989586621679838515"><span class="annot"><a href="Cooked.MockChain.Testing.html#withPrettyOpts"><span class="hs-identifier hs-type">withPrettyOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838515"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838515"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-267"></span><span id="withPrettyOpts"><span class="annot"><span class="annottext">withPrettyOpts :: forall a prop. Test a prop -&gt; PrettyCookedOpts -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyOpts"><span class="hs-identifier hs-var hs-var">withPrettyOpts</span></a></span></span><span> </span><span id="local-6989586621679838881"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838881"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838882"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838882"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838881"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679838882"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Appends a requirements over the emitted log, which will need to be satisfied</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- both in case of success or failure of the run.</span><span>
</span><span id="line-271"></span><span id="local-6989586621679838518"><span id="local-6989586621679838519"><span class="annot"><a href="Cooked.MockChain.Testing.html#withJournalProp"><span class="hs-identifier hs-type">withJournalProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838518"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838518"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#JournalProp"><span class="hs-identifier hs-type">JournalProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838518"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838518"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-272"></span><span id="withJournalProp"><span class="annot"><span class="annottext">withJournalProp :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; JournalProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withJournalProp"><span class="hs-identifier hs-var hs-var">withJournalProp</span></a></span></span><span> </span><span id="local-6989586621679838887"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838887"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838888"><span class="annot"><span class="annottext">JournalProp prop
</span><a href="#local-6989586621679838888"><span class="hs-identifier hs-var">journalProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838887"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureProp"><span class="hs-identifier hs-var">testFailureProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838889"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838889"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679838890"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838890"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span id="local-6989586621679838891"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838891"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop
-&gt; PrettyCookedOpts
-&gt; [MockChainLogEntry]
-&gt; MockChainError
-&gt; prop
forall a prop. Test a prop -&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#testFailureProp"><span class="hs-identifier hs-var">testFailureProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838887"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838889"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838890"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838891"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">JournalProp prop
</span><a href="#local-6989586621679838888"><span class="hs-identifier hs-var">journalProp</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838889"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838890"><span class="hs-identifier hs-var">journal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccessProp"><span class="hs-identifier hs-var">testSuccessProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838892"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838892"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679838893"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838893"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span id="local-6989586621679838894"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838894"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679838895"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838895"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop
-&gt; PrettyCookedOpts
-&gt; [MockChainLogEntry]
-&gt; a
-&gt; UtxoState
-&gt; prop
forall a prop. Test a prop -&gt; SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#testSuccessProp"><span class="hs-identifier hs-var">testSuccessProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838887"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838892"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838893"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838894"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838895"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">JournalProp prop
</span><a href="#local-6989586621679838888"><span class="hs-identifier hs-var">journalProp</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838892"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838893"><span class="hs-identifier hs-var">journal</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Appends a requirement over the resulting value and state of the mockchain</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- run which will need to be satisfied if the run is successful</span><span>
</span><span id="line-280"></span><span id="local-6989586621679838523"><span id="local-6989586621679838524"><span class="annot"><a href="Cooked.MockChain.Testing.html#withSuccessProp"><span class="hs-identifier hs-type">withSuccessProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838523"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838523"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SuccessProp"><span class="hs-identifier hs-type">SuccessProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838523"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838523"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-281"></span><span id="withSuccessProp"><span class="annot"><span class="annottext">withSuccessProp :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; SuccessProp a prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withSuccessProp"><span class="hs-identifier hs-var hs-var">withSuccessProp</span></a></span></span><span> </span><span id="local-6989586621679838899"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838899"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838900"><span class="annot"><span class="annottext">SuccessProp a prop
</span><a href="#local-6989586621679838900"><span class="hs-identifier hs-var">successProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838899"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccessProp"><span class="hs-identifier hs-var">testSuccessProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838901"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838901"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679838902"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838902"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span id="local-6989586621679838903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838903"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679838904"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838904"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; SuccessProp a prop
forall a prop. Test a prop -&gt; SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#testSuccessProp"><span class="hs-identifier hs-var">testSuccessProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838899"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838901"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838902"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838903"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838904"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">SuccessProp a prop
</span><a href="#local-6989586621679838900"><span class="hs-identifier hs-var">successProp</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838901"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838902"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838903"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679838904"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="annot"><span class="hs-comment">-- | Same as 'withSuccessProp' but only considers the returning value of the run</span></span><span>
</span><span id="line-287"></span><span id="local-6989586621679838527"><span id="local-6989586621679838528"><span class="annot"><a href="Cooked.MockChain.Testing.html#withResultProp"><span class="hs-identifier hs-type">withResultProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838527"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838528"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838527"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679838528"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838527"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838528"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838527"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-288"></span><span id="withResultProp"><span class="annot"><span class="annottext">withResultProp :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (a -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withResultProp"><span class="hs-identifier hs-var hs-var">withResultProp</span></a></span></span><span> </span><span id="local-6989586621679838908"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838908"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838909"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679838909"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; SuccessProp a prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; SuccessProp a prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withSuccessProp"><span class="hs-identifier hs-var">withSuccessProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838908"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838910"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838910"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679838909"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679838910"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><span class="hs-comment">-- | Some as 'withSuccessProp' but only considers the returning state of the run</span></span><span>
</span><span id="line-291"></span><span id="local-6989586621679838531"><span id="local-6989586621679838532"><span class="annot"><a href="Cooked.MockChain.Testing.html#withStateProp"><span class="hs-identifier hs-type">withStateProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838531"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838532"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838531"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838531"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838532"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838531"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-292"></span><span id="withStateProp"><span class="annot"><span class="annottext">withStateProp :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (UtxoState -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withStateProp"><span class="hs-identifier hs-var hs-var">withStateProp</span></a></span></span><span> </span><span id="local-6989586621679838914"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838914"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838915"><span class="annot"><span class="annottext">UtxoState -&gt; prop
</span><a href="#local-6989586621679838915"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; SuccessProp a prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; SuccessProp a prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withSuccessProp"><span class="hs-identifier hs-var">withSuccessProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838914"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; prop
</span><a href="#local-6989586621679838915"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><span class="hs-comment">-- | Appends a requirement over the resulting number of outcomes of the run</span></span><span>
</span><span id="line-295"></span><span id="local-6989586621679838535"><span id="local-6989586621679838536"><span class="annot"><a href="Cooked.MockChain.Testing.html#withSizeProp"><span class="hs-identifier hs-type">withSizeProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838535"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838536"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838535"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SizeProp"><span class="hs-identifier hs-type">SizeProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838535"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838536"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838535"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-296"></span><span id="withSizeProp"><span class="annot"><span class="annottext">withSizeProp :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; SizeProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withSizeProp"><span class="hs-identifier hs-var hs-var">withSizeProp</span></a></span></span><span> </span><span id="local-6989586621679838919"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838919"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838920"><span class="annot"><span class="annottext">SizeProp prop
</span><a href="#local-6989586621679838920"><span class="hs-identifier hs-var">reqSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838919"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838921"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679838921"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; SizeProp prop
forall a prop. Test a prop -&gt; SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838919"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679838921"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">SizeProp prop
</span><a href="#local-6989586621679838920"><span class="hs-identifier hs-var">reqSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679838921"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-comment">-- | Appends a requirement over the resulting value and state of the mockchain</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- run which will need to be satisfied if the run is successful</span><span>
</span><span id="line-303"></span><span id="local-6989586621679838539"><span id="local-6989586621679838540"><span class="annot"><a href="Cooked.MockChain.Testing.html#withFailureProp"><span class="hs-identifier hs-type">withFailureProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838539"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838539"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#FailureProp"><span class="hs-identifier hs-type">FailureProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838539"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838539"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-304"></span><span id="withFailureProp"><span class="annot"><span class="annottext">withFailureProp :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; FailureProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withFailureProp"><span class="hs-identifier hs-var hs-var">withFailureProp</span></a></span></span><span> </span><span id="local-6989586621679838925"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838925"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838926"><span class="annot"><span class="annottext">FailureProp prop
</span><a href="#local-6989586621679838926"><span class="hs-identifier hs-var">failureProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838925"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureProp"><span class="hs-identifier hs-var">testFailureProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679838927"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838927"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679838928"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838928"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span id="local-6989586621679838929"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838929"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; FailureProp prop
forall a prop. Test a prop -&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#testFailureProp"><span class="hs-identifier hs-var">testFailureProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838925"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838927"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838928"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838929"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">FailureProp prop
</span><a href="#local-6989586621679838926"><span class="hs-identifier hs-var">failureProp</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838927"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679838928"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838929"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><span class="hs-comment">-- | Same as 'withFailureProp' but only considers the returning error of the run</span></span><span>
</span><span id="line-307"></span><span id="local-6989586621679838543"><span id="local-6989586621679838544"><span class="annot"><a href="Cooked.MockChain.Testing.html#withErrorProp"><span class="hs-identifier hs-type">withErrorProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838543"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838543"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679838543"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838543"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-308"></span><span id="withErrorProp"><span class="annot"><span class="annottext">withErrorProp :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withErrorProp"><span class="hs-identifier hs-var hs-var">withErrorProp</span></a></span></span><span> </span><span id="local-6989586621679838933"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838933"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679838934"><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679838934"><span class="hs-identifier hs-var">errorProp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; FailureProp prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; FailureProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withFailureProp"><span class="hs-identifier hs-var">withFailureProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679838933"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679838934"><span class="hs-identifier hs-var">errorProp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><span class="hs-comment">-- * Specific properties around failures</span></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><span class="hs-comment">-- | A property to ensure a phase 1 failure</span></span><span>
</span><span id="line-313"></span><span id="local-6989586621679838547"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-type">isPhase1Failure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838547"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#FailureProp"><span class="hs-identifier hs-type">FailureProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838547"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-314"></span><span id="isPhase1Failure"><span class="annot"><span class="annottext">isPhase1Failure :: forall prop. IsProp prop =&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-var hs-var">isPhase1Failure</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase1</span></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-var">isPhase1Failure</span></a></span><span> </span><span id="local-6989586621679838944"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838944"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838945"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838945"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 1 evaluation failure, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838944"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838945"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><span class="hs-comment">-- | A property to ensure a phase 2 failure</span></span><span>
</span><span id="line-318"></span><span id="local-6989586621679838946"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-type">isPhase2Failure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838946"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#FailureProp"><span class="hs-identifier hs-type">FailureProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838946"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-319"></span><span id="isPhase2Failure"><span class="annot"><span class="annottext">isPhase2Failure :: forall prop. IsProp prop =&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-var hs-var">isPhase2Failure</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase2</span></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-var">isPhase2Failure</span></a></span><span> </span><span id="local-6989586621679838955"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838955"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838956"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838956"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 2 evaluation failure, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838955"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838956"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><span class="hs-comment">-- | Same as 'isPhase1Failure' with an added predicate on the text error</span></span><span>
</span><span id="line-323"></span><span id="local-6989586621679838552"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-type">isPhase1FailureWithMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838552"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#FailureProp"><span class="hs-identifier hs-type">FailureProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838552"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-324"></span><span id="isPhase1FailureWithMsg"><span class="annot"><span class="annottext">isPhase1FailureWithMsg :: forall prop. IsProp prop =&gt; String -&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-var hs-var">isPhase1FailureWithMsg</span></a></span></span><span> </span><span id="local-6989586621679838966"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838966"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.CardanoLedgerValidationError</span></span><span> </span><span id="local-6989586621679838968"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679838968"><span class="hs-identifier hs-var">text</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838966"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679838968"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-var">isPhase1FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838970"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838970"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838971"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838971"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 1 evaluation failure with constrained messages, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838970"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838971"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="annot"><span class="hs-comment">-- | Same as 'isPhase2Failure' with an added predicate over the text error</span></span><span>
</span><span id="line-328"></span><span id="local-6989586621679838972"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-type">isPhase2FailureWithMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838972"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#FailureProp"><span class="hs-identifier hs-type">FailureProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838972"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-329"></span><span id="isPhase2FailureWithMsg"><span class="annot"><span class="annottext">isPhase2FailureWithMsg :: forall prop. IsProp prop =&gt; String -&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-var hs-var">isPhase2FailureWithMsg</span></a></span></span><span> </span><span id="local-6989586621679838982"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838982"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.ScriptFailure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.EvaluationError</span></span><span> </span><span id="local-6989586621679838985"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679838985"><span class="hs-identifier hs-var">texts</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679838982"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679838985"><span class="hs-identifier hs-var">texts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-var">isPhase2FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838986"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838986"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679838987"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838987"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 2 evaluation failure with constrained messages, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679838986"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679838987"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><span class="hs-comment">-- * Specific properties around number of outcomes</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><span class="hs-comment">-- | Ensures the run has an exact given number of outcomes</span></span><span>
</span><span id="line-335"></span><span id="local-6989586621679838557"><span class="annot"><a href="Cooked.MockChain.Testing.html#isOfSize"><span class="hs-identifier hs-type">isOfSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838557"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SizeProp"><span class="hs-identifier hs-type">SizeProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838557"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-336"></span><span id="isOfSize"><span class="annot"><span class="annottext">isOfSize :: forall prop. IsProp prop =&gt; Integer -&gt; SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#isOfSize"><span class="hs-identifier hs-var hs-var">isOfSize</span></a></span></span><span> </span><span id="local-6989586621679839005"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839005"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679839006"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839006"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839005"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839006"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isOfSize"><span class="hs-identifier hs-var">isOfSize</span></a></span><span> </span><span id="local-6989586621679839007"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839007"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679839008"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839008"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect number of results (expected: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839007"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; but got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839008"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><span class="hs-comment">-- | Ensures the run has a minimal number of outcomes</span></span><span>
</span><span id="line-340"></span><span id="local-6989586621679839009"><span class="annot"><a href="Cooked.MockChain.Testing.html#isAtLeastOfSize"><span class="hs-identifier hs-type">isAtLeastOfSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839009"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SizeProp"><span class="hs-identifier hs-type">SizeProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839009"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-341"></span><span id="isAtLeastOfSize"><span class="annot"><span class="annottext">isAtLeastOfSize :: forall prop. IsProp prop =&gt; Integer -&gt; SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#isAtLeastOfSize"><span class="hs-identifier hs-var hs-var">isAtLeastOfSize</span></a></span></span><span> </span><span id="local-6989586621679839026"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839026"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679839027"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839027"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839026"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839027"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isAtLeastOfSize"><span class="hs-identifier hs-var">isAtLeastOfSize</span></a></span><span> </span><span id="local-6989586621679839029"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839029"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679839030"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839030"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect number of results (expected at least: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839029"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; but got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839030"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><span class="hs-comment">-- | Ensures the run has a minimal number of outcomes</span></span><span>
</span><span id="line-345"></span><span id="local-6989586621679839031"><span class="annot"><a href="Cooked.MockChain.Testing.html#isAtMostOfSize"><span class="hs-identifier hs-type">isAtMostOfSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839031"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SizeProp"><span class="hs-identifier hs-type">SizeProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839031"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-346"></span><span id="isAtMostOfSize"><span class="annot"><span class="annottext">isAtMostOfSize :: forall prop. IsProp prop =&gt; Integer -&gt; SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#isAtMostOfSize"><span class="hs-identifier hs-var hs-var">isAtMostOfSize</span></a></span></span><span> </span><span id="local-6989586621679839047"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839047"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679839048"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839048"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839047"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839048"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-347"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isAtMostOfSize"><span class="hs-identifier hs-var">isAtMostOfSize</span></a></span><span> </span><span id="local-6989586621679839049"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839049"><span class="hs-identifier hs-var">n1</span></a></span></span><span> </span><span id="local-6989586621679839050"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839050"><span class="hs-identifier hs-var">n2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect number of results (expected at most: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839049"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; but got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839050"><span class="hs-identifier hs-var">n2</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><span class="hs-comment">-- * Specific properties over the journal</span></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Ensures a certain event has been emitted. This uses the constructor's name</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- of the 'MockChainLogEntry' by relying on 'show' being lazy.</span><span>
</span><span id="line-353"></span><span id="local-6989586621679838562"><span class="annot"><a href="Cooked.MockChain.Testing.html#happened"><span class="hs-identifier hs-type">happened</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838562"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#JournalProp"><span class="hs-identifier hs-type">JournalProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838562"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-354"></span><span id="happened"><span class="annot"><span class="annottext">happened :: forall prop. IsProp prop =&gt; String -&gt; JournalProp prop
</span><a href="Cooked.MockChain.Testing.html#happened"><span class="hs-identifier hs-var hs-var">happened</span></a></span></span><span> </span><span id="local-6989586621679839079"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839079"><span class="hs-identifier hs-var">eventName</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679839080"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679839080"><span class="hs-identifier hs-var">journal</span></a></span></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679839081"><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679839081"><span class="hs-identifier hs-var">allEventNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Set String
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (MockChainLogEntry -&gt; [String]) -&gt; MockChainLogEntry -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String])
-&gt; (MockChainLogEntry -&gt; String) -&gt; MockChainLogEntry -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainLogEntry -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(MockChainLogEntry -&gt; String) -&gt; [MockChainLogEntry] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679839080"><span class="hs-identifier hs-var">journal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839079"><span class="hs-identifier hs-var">eventName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679839081"><span class="hs-identifier hs-var">allEventNames</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The event &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839079"><span class="hs-identifier hs-var">eventName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; did not occur (but those did: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679839081"><span class="hs-identifier hs-var">allEventNames</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | Ensures a certain event has not been emitted. This uses the constructor's</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- name of the 'MockChainLogEntry' by relying on 'show' being lazy.</span><span>
</span><span id="line-362"></span><span id="local-6989586621679839087"><span class="annot"><a href="Cooked.MockChain.Testing.html#didNotHappen"><span class="hs-identifier hs-type">didNotHappen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839087"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#JournalProp"><span class="hs-identifier hs-type">JournalProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839087"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-363"></span><span id="didNotHappen"><span class="annot"><span class="annottext">didNotHappen :: forall prop. IsProp prop =&gt; String -&gt; JournalProp prop
</span><a href="Cooked.MockChain.Testing.html#didNotHappen"><span class="hs-identifier hs-var hs-var">didNotHappen</span></a></span></span><span> </span><span id="local-6989586621679839106"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839106"><span class="hs-identifier hs-var">eventName</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679839107"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679839107"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839106"><span class="hs-identifier hs-var">eventName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Set String -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Set String
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (MockChainLogEntry -&gt; [String]) -&gt; MockChainLogEntry -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String])
-&gt; (MockChainLogEntry -&gt; String) -&gt; MockChainLogEntry -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MockChainLogEntry -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(MockChainLogEntry -&gt; String) -&gt; [MockChainLogEntry] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679839107"><span class="hs-identifier hs-var">journal</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-364"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#didNotHappen"><span class="hs-identifier hs-var">didNotHappen</span></a></span><span> </span><span id="local-6989586621679839109"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839109"><span class="hs-identifier hs-var">eventName</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The event &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839109"><span class="hs-identifier hs-var">eventName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; was forbidden but occurred nonetheless&quot;</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="annot"><span class="hs-comment">-- * Specific properties over successes</span></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Ensures that the given wallets satisfy certain amount requirements over a</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- list of given asset classes in the end of the run</span><span>
</span><span id="line-370"></span><span id="local-6989586621679838574"><span id="local-6989586621679838577"><span class="annot"><a href="Cooked.MockChain.Testing.html#isInWallets"><span class="hs-identifier hs-type">isInWallets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838574"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Api.AssetClass</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SuccessProp"><span class="hs-identifier hs-type">SuccessProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838574"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-371"></span><span id="isInWallets"><span class="annot"><span class="annottext">isInWallets :: forall prop a.
IsProp prop =&gt;
[(Wallet, [(AssetClass, Integer -&gt; Bool)])] -&gt; SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#isInWallets"><span class="hs-identifier hs-var hs-var">isInWallets</span></a></span></span><span> </span><span id="local-6989586621679839128"><span class="annot"><span class="annottext">[(Wallet, [(AssetClass, Integer -&gt; Bool)])]
</span><a href="#local-6989586621679839128"><span class="hs-identifier hs-var">walletsReqs</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679839129"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679839129"><span class="hs-identifier hs-var">utxoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">((Wallet, [(AssetClass, Integer -&gt; Bool)]) -&gt; prop)
-&gt; [(Wallet, [(AssetClass, Integer -&gt; Bool)])] -&gt; prop
forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var">testAll</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679839130"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679839130"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679839131"><span class="annot"><span class="annottext">[(AssetClass, Integer -&gt; Bool)]
</span><a href="#local-6989586621679839131"><span class="hs-identifier hs-var">assetsReqs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-374"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679839132"><span class="annot"><span class="annottext">ownedValue :: Value
</span><a href="#local-6989586621679839132"><span class="hs-identifier hs-var hs-var">ownedValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; UtxoState -&gt; Value
forall a. ToAddress a =&gt; a -&gt; UtxoState -&gt; Value
</span><a href="Cooked.MockChain.UtxoState.html#holdsInState"><span class="hs-identifier hs-var">holdsInState</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679839130"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679839129"><span class="hs-identifier hs-var">utxoState</span></a></span><span>
</span><span id="line-375"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((AssetClass, Integer -&gt; Bool) -&gt; prop)
-&gt; [(AssetClass, Integer -&gt; Bool)] -&gt; prop
forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var">testAll</span></a></span><span>
</span><span id="line-376"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679839134"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679839134"><span class="hs-identifier hs-var">ac</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679839135"><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="#local-6989586621679839135"><span class="hs-identifier hs-var">nbReq</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-377"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679839136"><span class="annot"><span class="annottext">amount :: Integer
</span><a href="#local-6989586621679839136"><span class="hs-identifier hs-var hs-var">amount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; AssetClass -&gt; Integer
</span><span class="hs-identifier hs-var">Api.assetClassValueOf</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679839132"><span class="hs-identifier hs-var">ownedValue</span></a></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679839134"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-378"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Bool
</span><a href="#local-6989586621679839135"><span class="hs-identifier hs-var">nbReq</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839136"><span class="hs-identifier hs-var">amount</span></a></span><span>
</span><span id="line-379"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-380"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unsatisfied quantity requirement for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Wallet -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679839130"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; over asset class &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AssetClass -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679839134"><span class="hs-identifier hs-var">ac</span></a></span><span>
</span><span id="line-381"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>              </span><span class="annot"><span class="annottext">[(AssetClass, Integer -&gt; Bool)]
</span><a href="#local-6989586621679839131"><span class="hs-identifier hs-var">assetsReqs</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="annottext">[(Wallet, [(AssetClass, Integer -&gt; Bool)])]
</span><a href="#local-6989586621679839128"><span class="hs-identifier hs-var">walletsReqs</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Ensures that a given wallet possesses exactly a certain amount of a given</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- asset class in the end of the run</span><span>
</span><span id="line-388"></span><span id="local-6989586621679838583"><span id="local-6989586621679838584"><span class="annot"><a href="Cooked.MockChain.Testing.html#isInWallet"><span class="hs-identifier hs-type">isInWallet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838583"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Api.AssetClass</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#SuccessProp"><span class="hs-identifier hs-type">SuccessProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838584"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838583"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-389"></span><span id="isInWallet"><span class="annot"><span class="annottext">isInWallet :: forall prop a.
IsProp prop =&gt;
(Wallet, AssetClass, Integer) -&gt; SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#isInWallet"><span class="hs-identifier hs-var hs-var">isInWallet</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679839142"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679839142"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679839143"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679839143"><span class="hs-identifier hs-var">ac</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679839144"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839144"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Wallet, [(AssetClass, Integer -&gt; Bool)])] -&gt; SuccessProp a prop
forall prop a.
IsProp prop =&gt;
[(Wallet, [(AssetClass, Integer -&gt; Bool)])] -&gt; SuccessProp a prop
</span><a href="Cooked.MockChain.Testing.html#isInWallets"><span class="hs-identifier hs-var">isInWallets</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679839142"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679839143"><span class="hs-identifier hs-var">ac</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839144"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><span class="hs-comment">-- * Advanced test templates</span></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">{--
  Note on advanced templates:

  The idea here is definely not to have a huge number of combinations of
  predicates and bundle them into templates. This has been attempted in the past
  and is never a good idea. However, there are a few more advanced template that
  make sense because they will occur a lot when testing smart contracts. Only
  those should appear in the following list. For all the other templates, the
  pattern @testCaseCookedXX $ template testName trace `withXXX` myPropicate@
  should be advocated.

--}</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a Phase 2 failure</span></span><span>
</span><span id="line-407"></span><span id="local-6989586621679839145"><span id="local-6989586621679839146"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustFailInPhase2Test"><span class="hs-identifier hs-type">mustFailInPhase2Test</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839145"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679839146"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839145"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-408"></span><span id="mustFailInPhase2Test"><span class="annot"><span class="annottext">mustFailInPhase2Test :: forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailInPhase2Test"><span class="hs-identifier hs-var hs-var">mustFailInPhase2Test</span></a></span></span><span> </span><span id="local-6989586621679839154"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839154"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839154"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; FailureProp prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; FailureProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withFailureProp"><span class="hs-operator hs-var">`withFailureProp`</span></a></span><span> </span><span class="annot"><span class="annottext">FailureProp prop
forall prop. IsProp prop =&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-var">isPhase2Failure</span></a></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a specific phase 2 error message</span></span><span>
</span><span id="line-411"></span><span id="local-6989586621679838589"><span id="local-6989586621679838590"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustFailInPhase2WithMsgTest"><span class="hs-identifier hs-type">mustFailInPhase2WithMsgTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838589"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679838590"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838589"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-412"></span><span id="mustFailInPhase2WithMsgTest"><span class="annot"><span class="annottext">mustFailInPhase2WithMsgTest :: forall prop a.
(IsProp prop, Show a) =&gt;
String -&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailInPhase2WithMsgTest"><span class="hs-identifier hs-var hs-var">mustFailInPhase2WithMsgTest</span></a></span></span><span> </span><span id="local-6989586621679839162"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839162"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679839163"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839163"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839163"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; FailureProp prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; FailureProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withFailureProp"><span class="hs-operator hs-var">`withFailureProp`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; FailureProp prop
forall prop. IsProp prop =&gt; String -&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-var">isPhase2FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839162"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a Phase 1 failure</span></span><span>
</span><span id="line-415"></span><span id="local-6989586621679839164"><span id="local-6989586621679839165"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustFailInPhase1Test"><span class="hs-identifier hs-type">mustFailInPhase1Test</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839164"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679839165"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839165"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839165"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839164"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-416"></span><span id="mustFailInPhase1Test"><span class="annot"><span class="annottext">mustFailInPhase1Test :: forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailInPhase1Test"><span class="hs-identifier hs-var hs-var">mustFailInPhase1Test</span></a></span></span><span> </span><span id="local-6989586621679839173"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839173"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839173"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; FailureProp prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; FailureProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withFailureProp"><span class="hs-operator hs-var">`withFailureProp`</span></a></span><span> </span><span class="annot"><span class="annottext">FailureProp prop
forall prop. IsProp prop =&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-var">isPhase1Failure</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a specific phase 1 error message</span></span><span>
</span><span id="line-419"></span><span id="local-6989586621679839174"><span id="local-6989586621679839175"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustFailInPhase1WithMsgTest"><span class="hs-identifier hs-type">mustFailInPhase1WithMsgTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839174"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679839175"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839175"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839175"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679839174"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-420"></span><span id="mustFailInPhase1WithMsgTest"><span class="annot"><span class="annottext">mustFailInPhase1WithMsgTest :: forall prop a.
(IsProp prop, Show a) =&gt;
String -&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailInPhase1WithMsgTest"><span class="hs-identifier hs-var hs-var">mustFailInPhase1WithMsgTest</span></a></span></span><span> </span><span id="local-6989586621679839183"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839183"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679839184"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839184"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839184"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; FailureProp prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; FailureProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withFailureProp"><span class="hs-operator hs-var">`withFailureProp`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; FailureProp prop
forall prop. IsProp prop =&gt; String -&gt; FailureProp prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-var">isPhase1FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679839183"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a certain number of successful outcomes</span></span><span>
</span><span id="line-423"></span><span id="local-6989586621679838597"><span id="local-6989586621679838598"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustSucceedWithSizeTest"><span class="hs-identifier hs-type">mustSucceedWithSizeTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838597"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838597"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-424"></span><span id="mustSucceedWithSizeTest"><span class="annot"><span class="annottext">mustSucceedWithSizeTest :: forall prop a.
IsProp prop =&gt;
Integer -&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustSucceedWithSizeTest"><span class="hs-identifier hs-var hs-var">mustSucceedWithSizeTest</span></a></span></span><span> </span><span id="local-6989586621679839191"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839191"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679839192"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839192"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a. IsProp prop =&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustSucceedTest"><span class="hs-identifier hs-var">mustSucceedTest</span></a></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839192"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; SizeProp prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; SizeProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withSizeProp"><span class="hs-operator hs-var">`withSizeProp`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; prop
forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; prop) -&gt; (Integer -&gt; Bool) -&gt; SizeProp prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839191"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a certain number of unsuccessful outcomes</span></span><span>
</span><span id="line-427"></span><span id="local-6989586621679838601"><span id="local-6989586621679838602"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustFailWithSizeTest"><span class="hs-identifier hs-type">mustFailWithSizeTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838601"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679838602"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838602"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838602"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679838601"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-428"></span><span id="mustFailWithSizeTest"><span class="annot"><span class="annottext">mustFailWithSizeTest :: forall prop a.
(IsProp prop, Show a) =&gt;
Integer -&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailWithSizeTest"><span class="hs-identifier hs-var hs-var">mustFailWithSizeTest</span></a></span></span><span> </span><span id="local-6989586621679839200"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839200"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679839201"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839201"><span class="hs-identifier hs-var">run</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679839201"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; SizeProp prop -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; SizeProp prop -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withSizeProp"><span class="hs-operator hs-var">`withSizeProp`</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; SizeProp prop
forall prop. IsProp prop =&gt; Integer -&gt; SizeProp prop
</span><a href="Cooked.MockChain.Testing.html#isOfSize"><span class="hs-identifier hs-var">isOfSize</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679839200"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-429"></span></pre></body></html>
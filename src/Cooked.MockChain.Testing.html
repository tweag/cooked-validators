<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This modules provides primitives to run tests over mockchain executions and</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- to give expectation on the result of these runs.</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.Testing</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html"><span class="hs-identifier">Cooked.InitialDistribution</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html"><span class="hs-identifier">Cooked.MockChain.BlockChain</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html"><span class="hs-identifier">Cooked.MockChain.Direct</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html"><span class="hs-identifier">Cooked.MockChain.Staged</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html"><span class="hs-identifier">Cooked.MockChain.UtxoState</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.html"><span class="hs-identifier">Cooked.Pretty</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QC</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.HUnit</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HU</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | This module provides a common interface for HUnit and QuickCheck tests. We</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- do so by abstracting uses of 'HU.Assertion' and 'QC.Property' for @(IsProp</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- prop) =&gt; prop@, then provide instances for both @HU.Asserton@ and</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- @QC.Property@.</span><span>
</span><span id="line-24"></span><span class="hs-keyword">class</span><span> </span><span id="IsProp"><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-var">IsProp</span></a></span></span><span> </span><span id="local-6989586621679771018"><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-comment">-- | Displays the string to the user in case of failure</span><span>
</span><span id="line-26"></span><span>  </span><span id="testCounterexample"><span class="annot"><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-type">testCounterexample</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-comment">-- | Conjunction of a number of results</span><span>
</span><span id="line-29"></span><span>  </span><span id="testConjoin"><span class="annot"><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-type">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-comment">-- | Disjunction of a number of results</span><span>
</span><span id="line-32"></span><span>  </span><span id="testDisjoin"><span class="annot"><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-type">testDisjoin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-comment">-- | Flags a failure</span><span>
</span><span id="line-35"></span><span>  </span><span id="testFailure"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-type">testFailure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span id="local-6989586621679771181"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var">testFailure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- | Flags a success</span><span>
</span><span id="line-39"></span><span>  </span><span id="testSuccess"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-type">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679771184"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var">testSuccess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-comment">-- | Flags a failure with a message</span><span>
</span><span id="line-43"></span><span>  </span><span id="testFailureMsg"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-type">testFailureMsg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771018"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679771187"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var hs-var">testFailureMsg</span></a></span><span> </span><span id="local-6989586621679771190"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771190"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771190"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span id="local-6989586621679771021"><span class="annot"><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-type">testBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771021"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771021"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-47"></span><span id="testBool"><span class="annot"><span class="annottext">testBool :: forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var hs-var">testBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span id="local-6989586621679771023"><span id="local-6989586621679771024"><span class="annot"><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-type">testAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771023"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679771024"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771023"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679771024"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771023"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-51"></span><span id="testAll"><span class="annot"><span class="annottext">testAll :: forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var hs-var">testAll</span></a></span></span><span> </span><span id="local-6989586621679771198"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679771198"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="annot"><span class="annottext">([prop] -&gt; prop) -&gt; ([a] -&gt; [prop]) -&gt; [a] -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; prop) -&gt; [a] -&gt; [prop]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679771198"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-type">.==.</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span id="local-6989586621679771032"><span id="local-6989586621679771033"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-type">(.==.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771032"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679771033"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771033"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771033"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771032"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-56"></span><span id="local-6989586621679771205"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679771205"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%3D%3D."><span class="annot"><span class="annottext">.==. :: forall prop a. (IsProp prop, Eq a) =&gt; a -&gt; a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-var hs-var">.==.</span></a></span></span><span> </span><span id="local-6989586621679771206"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679771206"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; prop
forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; prop) -&gt; Bool -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679771205"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679771206"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">3</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-type">.&amp;&amp;.</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span id="local-6989586621679771040"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-type">(.&amp;&amp;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771040"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771040"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771040"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771040"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-61"></span><span id="local-6989586621679771210"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771210"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%26%26."><span class="annot"><span class="annottext">.&amp;&amp;. :: forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var hs-var">.&amp;&amp;.</span></a></span></span><span> </span><span id="local-6989586621679771211"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771211"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771210"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771211"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-type">.||.</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621679771213"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-type">(.||.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771213"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771213"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771213"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771213"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-66"></span><span id="local-6989586621679771216"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771216"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%7C%7C."><span class="annot"><span class="annottext">.||. :: forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-var hs-var">.||.</span></a></span></span><span> </span><span id="local-6989586621679771217"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771217"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771216"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679771217"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Ensure that all results produced by the staged mockchain /succeed/,</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- starting from the default initial distribution</span><span>
</span><span id="line-70"></span><span id="local-6989586621679771043"><span id="local-6989586621679771045"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSucceeds"><span class="hs-identifier hs-type">testSucceeds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771043"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771045"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771043"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-71"></span><span id="testSucceeds"><span class="annot"><span class="annottext">testSucceeds :: forall prop a.
IsProp prop =&gt;
PrettyCookedOpts -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSucceeds"><span class="hs-identifier hs-var hs-var">testSucceeds</span></a></span></span><span> </span><span id="local-6989586621679771223"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771223"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSucceedsFrom"><span class="hs-identifier hs-var">testSucceedsFrom</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771223"><span class="hs-identifier hs-var">pcOpts</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Ensure that all results produced by the staged mockchain /fail/ and that a</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- predicate holds over the error.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- To test that validation fails, use</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &gt; testFails def (isCekEvaluationFailure def) e</span><span>
</span><span id="line-78"></span><span id="local-6989586621679771054"><span id="local-6989586621679771055"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFails"><span class="hs-identifier hs-type">testFails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771054"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679771055"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771054"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771055"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771054"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-79"></span><span id="testFails"><span class="annot"><span class="annottext">testFails :: forall prop a.
(IsProp prop, Show a) =&gt;
PrettyCookedOpts
-&gt; (MockChainError -&gt; prop) -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFails"><span class="hs-identifier hs-var hs-var">testFails</span></a></span></span><span> </span><span id="local-6989586621679771232"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771232"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679771233"><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679771233"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
-&gt; (MockChainError -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
forall prop a.
(IsProp prop, Show a) =&gt;
PrettyCookedOpts
-&gt; (MockChainError -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailsFrom"><span class="hs-identifier hs-var">testFailsFrom</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771232"><span class="hs-identifier hs-var">pcOpts</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679771233"><span class="hs-identifier hs-var">predi</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Ensure that all results produced by the staged mockchain succeed starting</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- from some initial distribution but doesn't impose any additional condition on</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- success.  Use 'testSucceedsFrom'' for that.</span><span>
</span><span id="line-84"></span><span id="local-6989586621679771051"><span id="local-6989586621679771052"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSucceedsFrom"><span class="hs-identifier hs-type">testSucceedsFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771051"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771052"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><a href="#local-6989586621679771051"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-90"></span><span id="testSucceedsFrom"><span class="annot"><span class="annottext">testSucceedsFrom :: forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSucceedsFrom"><span class="hs-identifier hs-var hs-var">testSucceedsFrom</span></a></span></span><span> </span><span id="local-6989586621679771239"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771239"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
-&gt; (a -&gt; UtxoState -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; (a -&gt; UtxoState -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSucceedsFrom%27"><span class="hs-identifier hs-var">testSucceedsFrom'</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771239"><span class="hs-identifier hs-var">pcOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- | Ensure that all results produced by the staged mockchain succeed starting</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- from some initial distribution. Additionally impose a condition over the</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- resulting state and value.</span><span>
</span><span id="line-95"></span><span id="local-6989586621679771064"><span id="local-6989586621679771065"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSucceedsFrom%27"><span class="hs-identifier hs-type">testSucceedsFrom'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771064"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679771065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771064"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><a href="#local-6989586621679771064"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-102"></span><span id="testSucceedsFrom%27"><span class="annot"><span class="annottext">testSucceedsFrom' :: forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; (a -&gt; UtxoState -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSucceedsFrom%27"><span class="hs-identifier hs-var hs-var">testSucceedsFrom'</span></a></span></span><span> </span><span id="local-6989586621679771245"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771245"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679771246"><span class="annot"><span class="annottext">a -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679771246"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
-&gt; (Either MockChainError (a, UtxoState) -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; (Either MockChainError (a, UtxoState) -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAllSatisfiesFrom"><span class="hs-identifier hs-var">testAllSatisfiesFrom</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771245"><span class="hs-identifier hs-var">pcOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MockChainError -&gt; prop)
-&gt; ((a, UtxoState) -&gt; prop)
-&gt; Either MockChainError (a, UtxoState)
-&gt; prop
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop)
-&gt; (MockChainError -&gt; String) -&gt; MockChainError -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771245"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; UtxoState -&gt; prop) -&gt; (a, UtxoState) -&gt; prop
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679771246"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Ensure that all results produced by the staged mockchain /fail/ starting</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- from some initial distribution.</span><span>
</span><span id="line-106"></span><span id="local-6989586621679771059"><span id="local-6989586621679771060"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailsFrom"><span class="hs-identifier hs-type">testFailsFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771059"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679771060"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771059"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771060"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="#local-6989586621679771059"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-113"></span><span id="testFailsFrom"><span class="annot"><span class="annottext">testFailsFrom :: forall prop a.
(IsProp prop, Show a) =&gt;
PrettyCookedOpts
-&gt; (MockChainError -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailsFrom"><span class="hs-identifier hs-var hs-var">testFailsFrom</span></a></span></span><span> </span><span id="local-6989586621679771258"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771258"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679771259"><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679771259"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="annottext">PrettyCookedOpts
-&gt; (Either MockChainError (a, UtxoState) -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; (Either MockChainError (a, UtxoState) -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAllSatisfiesFrom"><span class="hs-identifier hs-var">testAllSatisfiesFrom</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771258"><span class="hs-identifier hs-var">pcOpts</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MockChainError -&gt; prop)
-&gt; ((a, UtxoState) -&gt; prop)
-&gt; Either MockChainError (a, UtxoState)
-&gt; prop
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679771259"><span class="hs-identifier hs-var">predi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop)
-&gt; ((a, UtxoState) -&gt; String) -&gt; (a, UtxoState) -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((a, UtxoState) -&gt; DocCooked) -&gt; (a, UtxoState) -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; (a, UtxoState) -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771258"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Is satisfied when the given 'MockChainError' is wrapping a</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- @CekEvaluationFailure@.  This is particularly important when writing negative</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- tests. For example, if we are simulating an attack and writing a test with</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- 'testFailsFrom', we might have made a mistake in the attack, yielding a test</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- that fails for reasons such as @ValueLessThanMinAda@ or @ValueNotPreserved@,</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- which does not rule out the attack being caught by the validator script. For</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- these scenarios it is paramount to rely on @testFailsFrom'</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- isCekEvaluationFailure@ instead.</span><span>
</span><span id="line-126"></span><span id="local-6989586621679771083"><span class="annot"><a href="Cooked.MockChain.Testing.html#isCekEvaluationFailure"><span class="hs-identifier hs-type">isCekEvaluationFailure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771083"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771083"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-127"></span><span id="isCekEvaluationFailure"><span class="annot"><span class="annottext">isCekEvaluationFailure :: forall prop.
IsProp prop =&gt;
PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isCekEvaluationFailure"><span class="hs-identifier hs-var hs-var">isCekEvaluationFailure</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.ScriptFailure</span></span><span> </span><span class="annot"><span class="annottext">ScriptError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isCekEvaluationFailure"><span class="hs-identifier hs-var">isCekEvaluationFailure</span></a></span><span> </span><span id="local-6989586621679771270"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771270"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679771271"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771271"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected 'CekEvaluationFailure', got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771270"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771271"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Similar to 'isCekEvaluationFailure', but enables us to check for a specific</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- error message in the error.</span><span>
</span><span id="line-132"></span><span id="local-6989586621679771092"><span class="annot"><a href="Cooked.MockChain.Testing.html#isCekEvaluationFailureWithMsg"><span class="hs-identifier hs-type">isCekEvaluationFailureWithMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771092"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771092"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-133"></span><span id="isCekEvaluationFailureWithMsg"><span class="annot"><span class="annottext">isCekEvaluationFailureWithMsg :: forall prop.
IsProp prop =&gt;
PrettyCookedOpts -&gt; (String -&gt; Bool) -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isCekEvaluationFailureWithMsg"><span class="hs-identifier hs-var hs-var">isCekEvaluationFailureWithMsg</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679771281"><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679771281"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.ScriptFailure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.EvaluationError</span></span><span> </span><span id="local-6989586621679771283"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679771283"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679771281"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; (Text -&gt; String) -&gt; Text -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679771283"><span class="hs-identifier hs-var">msgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isCekEvaluationFailureWithMsg"><span class="hs-identifier hs-var">isCekEvaluationFailureWithMsg</span></a></span><span> </span><span id="local-6989586621679771286"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771286"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679771287"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771287"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected 'CekEvaluationFailure' with specific messages, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771286"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771287"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Ensure that all results produced by the set of traces encoded by the</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- 'StagedMockChain' satisfy the given predicate. If you wish to build custom</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- predicates you can use 'testSatisfiesFrom'' directly and see</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- 'testBinaryRelatedBy' as an example.</span><span>
</span><span id="line-141"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#testAllSatisfiesFrom"><span class="hs-identifier hs-type">testAllSatisfiesFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679771069"><span class="annot"><a href="#local-6989586621679771069"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span id="local-6989586621679771070"><span class="annot"><a href="#local-6989586621679771070"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771069"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679771070"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771069"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771070"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="#local-6989586621679771069"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-149"></span><span id="testAllSatisfiesFrom"><span class="annot"><span class="annottext">testAllSatisfiesFrom :: forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; (Either MockChainError (a, UtxoState) -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAllSatisfiesFrom"><span class="hs-identifier hs-var hs-var">testAllSatisfiesFrom</span></a></span></span><span> </span><span id="local-6989586621679771295"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771295"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679771296"><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState) -&gt; prop
</span><a href="#local-6989586621679771296"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
forall a prop.
([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSatisfiesFrom%27"><span class="hs-identifier hs-var">testSatisfiesFrom'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either MockChainError (a, UtxoState), MockChainLog) -&gt; prop)
-&gt; [(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop
forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var">testAll</span></a></span><span> </span><span class="annot"><span class="annottext">(Either MockChainError (a, UtxoState), MockChainLog) -&gt; prop
</span><a href="#local-6989586621679771297"><span class="hs-identifier hs-var">go</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="#local-6989586621679771297"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679771070"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#MockChainLog"><span class="hs-identifier hs-type">MockChainLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771069"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679771297"><span class="annot"><span class="annottext">go :: (Either MockChainError (a, UtxoState), MockChainLog) -&gt; prop
</span><a href="#local-6989586621679771297"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679771298"><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679771298"><span class="hs-identifier hs-var">prop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679771299"><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771299"><span class="hs-identifier hs-var">mcLog</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MockChainLog -&gt; DocCooked) -&gt; MockChainLog -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainLog -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771295"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771299"><span class="hs-identifier hs-var">mcLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState) -&gt; prop
</span><a href="#local-6989586621679771296"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679771298"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Asserts that the given 'StagedMockChain' produces exactly two outcomes,</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- both of which are successful and have their resulting states related by a</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- given predicate. A typical usage would look like:</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- &gt; testBinaryRelatedBy equalModuloAda myInitDistr $ do</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt;   x &lt;- trPrepare</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- &gt;   execOption1 x &lt;|&gt; execOption2 x</span><span>
</span><span id="line-161"></span><span id="local-6989586621679771102"><span id="local-6989586621679771103"><span class="annot"><a href="Cooked.MockChain.Testing.html#testBinaryRelatedBy"><span class="hs-identifier hs-type">testBinaryRelatedBy</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771102"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771102"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771103"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="#local-6989586621679771102"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-168"></span><span id="testBinaryRelatedBy"><span class="annot"><span class="annottext">testBinaryRelatedBy :: forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; (UtxoState -&gt; UtxoState -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBinaryRelatedBy"><span class="hs-identifier hs-var hs-var">testBinaryRelatedBy</span></a></span></span><span> </span><span id="local-6989586621679771329"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679771330"><span class="annot"><span class="annottext">UtxoState -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679771330"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
forall a prop.
([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSatisfiesFrom%27"><span class="hs-identifier hs-var">testSatisfiesFrom'</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
 -&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop)
-&gt; ([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679771331"><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679771331"><span class="hs-identifier hs-var">ra</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679771332"><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771332"><span class="hs-identifier hs-var">ta</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679771333"><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679771333"><span class="hs-identifier hs-var">rb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679771334"><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771334"><span class="hs-identifier hs-var">tb</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679771331"><span class="hs-identifier hs-var">ra</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679771333"><span class="hs-identifier hs-var">rb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679771335"><span class="annot"><span class="annottext">(a, UtxoState)
</span><a href="#local-6989586621679771335"><span class="hs-identifier hs-var">resA</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679771336"><span class="annot"><span class="annottext">(a, UtxoState)
</span><a href="#local-6989586621679771336"><span class="hs-identifier hs-var">resB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679771330"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, UtxoState) -&gt; UtxoState
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(a, UtxoState)
</span><a href="#local-6989586621679771335"><span class="hs-identifier hs-var">resA</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, UtxoState) -&gt; UtxoState
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(a, UtxoState)
</span><a href="#local-6989586621679771336"><span class="hs-identifier hs-var">resB</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679771338"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771338"><span class="hs-identifier hs-var">errA</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, UtxoState)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected two outcomes, the first failed with:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771338"><span class="hs-identifier hs-var">errA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainLog -&gt; DocCooked) -&gt; MockChainLog -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainLog -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771332"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, UtxoState)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679771340"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771340"><span class="hs-identifier hs-var">errB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected two outcomes, the second failed with:&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771340"><span class="hs-identifier hs-var">errB</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainLog -&gt; DocCooked) -&gt; MockChainLog -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainLog -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771334"><span class="hs-identifier hs-var">tb</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679771341"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771341"><span class="hs-identifier hs-var">errA</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679771342"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771342"><span class="hs-identifier hs-var">errB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected two outcomes, both failed with:&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>            </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771341"><span class="hs-identifier hs-var">errA</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771342"><span class="hs-identifier hs-var">errB</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n First: &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>            </span><span class="annot"><span class="annottext">(MockChainLog -&gt; DocCooked) -&gt; MockChainLog -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainLog -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771332"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nSecond: &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-185"></span><span>            </span><span class="annot"><span class="annottext">(MockChainLog -&gt; DocCooked) -&gt; MockChainLog -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainLog -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771329"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771334"><span class="hs-identifier hs-var">tb</span></a></span><span>
</span><span id="line-186"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679771343"><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><a href="#local-6989586621679771343"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected exactly two outcomes, received: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><a href="#local-6989586621679771343"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Generalizes 'testBinaryRelatedBy', asserting that the given</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- 'StagedMockChain' produces more than two outcomes, say @[x,y,z,w]@, all of</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- which are successful (i.e. are not a 'MockChainError') and these states are</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- in the same equivalence class of (~); that is, they satisfy:</span><span>
</span><span id="line-193"></span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- &gt; x ~ y &amp;&amp; x ~ z &amp;&amp; x ~ z &amp;&amp; x ~ w</span><span>
</span><span id="line-195"></span><span class="hs-comment">--</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- Because @(~)@ should be symmetric and transitive we can estabilish that these</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- states all belong to the same equivalence class. This function does /not/</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- check each pointwise case.</span><span>
</span><span id="line-199"></span><span id="local-6989586621679771346"><span id="local-6989586621679771347"><span class="annot"><a href="Cooked.MockChain.Testing.html#testOneEquivClass"><span class="hs-identifier hs-type">testOneEquivClass</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771346"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771346"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771347"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="#local-6989586621679771346"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-206"></span><span id="testOneEquivClass"><span class="annot"><span class="annottext">testOneEquivClass :: forall prop a.
IsProp prop =&gt;
PrettyCookedOpts
-&gt; (UtxoState -&gt; UtxoState -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testOneEquivClass"><span class="hs-identifier hs-var hs-var">testOneEquivClass</span></a></span></span><span> </span><span id="local-6989586621679771367"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771367"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679771368"><span class="annot"><span class="annottext">UtxoState -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679771368"><span class="hs-identifier hs-var">rel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
forall a prop.
([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSatisfiesFrom%27"><span class="hs-identifier hs-var">testSatisfiesFrom'</span></a></span><span> </span><span class="annot"><span class="annottext">(([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
 -&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop)
-&gt; ([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution
-&gt; StagedMockChain a
-&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected two of more outcomes, received: 0&quot;</span></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Either MockChainError (a, UtxoState), MockChainLog)
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected two of more outcomes, received: 1&quot;</span></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679771369"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771369"><span class="hs-identifier hs-var">errX</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679771370"><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771370"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;First outcome is a failure: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771367"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771369"><span class="hs-identifier hs-var">errX</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainLog -&gt; DocCooked) -&gt; MockChainLog -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainLog -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771367"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771370"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679771371"><span class="annot"><span class="annottext">(a, UtxoState)
</span><a href="#local-6989586621679771371"><span class="hs-identifier hs-var">resX</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679771372"><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><a href="#local-6989586621679771372"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoState
-&gt; [(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop
</span><a href="#local-6989586621679771373"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, UtxoState) -&gt; UtxoState
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(a, UtxoState)
</span><a href="#local-6989586621679771371"><span class="hs-identifier hs-var">resX</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><a href="#local-6989586621679771372"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- we can flag a success here because 'xs' above is guarnateed to have at</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-comment">-- least one element since we ruled out the empty and the singleton lists in</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-comment">-- the \case</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679771373"><span class="annot"><span class="annottext">go :: UtxoState
-&gt; [(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop
</span><a href="#local-6989586621679771373"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679771374"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679771374"><span class="hs-identifier hs-var">_resX</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="#local-6989586621679771373"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679771375"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679771375"><span class="hs-identifier hs-var">_resX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679771376"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771376"><span class="hs-identifier hs-var">errY</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679771377"><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771377"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;An outcome is a failure: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771367"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679771376"><span class="hs-identifier hs-var">errY</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(MockChainLog -&gt; DocCooked) -&gt; MockChainLog -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Common.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainLog -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679771367"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><a href="#local-6989586621679771377"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="#local-6989586621679771373"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679771378"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679771378"><span class="hs-identifier hs-var">resX</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679771379"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679771379"><span class="hs-identifier hs-var">resY</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MockChainLog
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679771380"><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><a href="#local-6989586621679771380"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">UtxoState -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679771368"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679771378"><span class="hs-identifier hs-var">resX</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679771379"><span class="hs-identifier hs-var">resY</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UtxoState
-&gt; [(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop
</span><a href="#local-6989586621679771373"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679771378"><span class="hs-identifier hs-var">resX</span></a></span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)]
</span><a href="#local-6989586621679771380"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Asserts that the results produced by running the given 'StagedMockChain'</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- from some speficied 'InitialDistribution' satisfy a given assertion. In this</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- case, the predicate gets the trace descriptions that led to each potential</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- outcome and is responsible for calling 'testCounterexample' communicate these</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- to the user.</span><span>
</span><span id="line-224"></span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- Although this function is mainly used internally, as a building block for the</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- simpler predicates, it can be useful in building some custom</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- predicates. Check 'testAllSatisfiesFrom' or 'testBinaryRelatedBy' for</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- examples on using this.</span><span>
</span><span id="line-229"></span><span id="local-6989586621679771100"><span id="local-6989586621679771101"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSatisfiesFrom%27"><span class="hs-identifier hs-type">testSatisfiesFrom'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679771100"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#MockChainLog"><span class="hs-identifier hs-type">MockChainLog</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679771101"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679771100"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="#local-6989586621679771101"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-234"></span><span id="testSatisfiesFrom%27"><span class="annot"><span class="annottext">testSatisfiesFrom' :: forall a prop.
([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; InitialDistribution -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSatisfiesFrom%27"><span class="hs-identifier hs-var hs-var">testSatisfiesFrom'</span></a></span></span><span> </span><span id="local-6989586621679771382"><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop
</span><a href="#local-6989586621679771382"><span class="hs-identifier hs-var">predi</span></a></span></span><span> </span><span id="local-6989586621679771383"><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679771383"><span class="hs-identifier hs-var">i0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop
</span><a href="#local-6989586621679771382"><span class="hs-identifier hs-var">predi</span></a></span><span> </span><span class="annot"><span class="annottext">([(Either MockChainError (a, UtxoState), MockChainLog)] -&gt; prop)
-&gt; (StagedMockChain a
    -&gt; [(Either MockChainError (a, UtxoState), MockChainLog)])
-&gt; StagedMockChain a
-&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *).
 Monad m =&gt;
 MockChainT m a -&gt; m (Either MockChainError (a, UtxoState)))
-&gt; StagedMockChain a
-&gt; [(Either MockChainError (a, UtxoState), MockChainLog)]
forall a res.
(forall (m :: * -&gt; *). Monad m =&gt; MockChainT m a -&gt; m res)
-&gt; StagedMockChain a -&gt; [(res, MockChainLog)]
</span><a href="Cooked.MockChain.Staged.html#interpretAndRunWith"><span class="hs-identifier hs-var">interpretAndRunWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution
-&gt; MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
forall (m :: * -&gt; *) a.
Monad m =&gt;
InitialDistribution
-&gt; MockChainT m a -&gt; m (Either MockChainError (a, UtxoState))
</span><a href="Cooked.MockChain.Direct.html#runMockChainTFrom"><span class="hs-identifier hs-var">runMockChainTFrom</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679771383"><span class="hs-identifier hs-var">i0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><span class="hs-comment">-- * 'TestResult' instances</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- Catches a HUnit test failure, if the test fails.</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-type">assertionToMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span id="assertionToMaybe"><span class="annot"><span class="annottext">assertionToMaybe :: Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var hs-var">assertionToMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IO (Maybe HUnitFailure)
 -&gt; [Handler (Maybe HUnitFailure)] -&gt; IO (Maybe HUnitFailure))
-&gt; [Handler (Maybe HUnitFailure)]
-&gt; IO (Maybe HUnitFailure)
-&gt; IO (Maybe HUnitFailure)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe HUnitFailure)
-&gt; [Handler (Maybe HUnitFailure)] -&gt; IO (Maybe HUnitFailure)
forall a. IO a -&gt; [Handler a] -&gt; IO a
</span><span class="hs-identifier hs-var">E.catches</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; Handler (Maybe HUnitFailure)
forall a e. Exception e =&gt; (e -&gt; IO a) -&gt; Handler a
</span><span class="hs-identifier hs-var">E.Handler</span></span><span> </span><span class="annot"><span class="annottext">((HUnitFailure -&gt; IO (Maybe HUnitFailure))
 -&gt; Handler (Maybe HUnitFailure))
-&gt; (HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; Handler (Maybe HUnitFailure)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; (HUnitFailure -&gt; Maybe HUnitFailure)
-&gt; HUnitFailure
-&gt; IO (Maybe HUnitFailure)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; Maybe HUnitFailure
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(IO (Maybe HUnitFailure) -&gt; IO (Maybe HUnitFailure))
-&gt; (Assertion -&gt; IO (Maybe HUnitFailure))
-&gt; Assertion
-&gt; IO (Maybe HUnitFailure)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure) -&gt; IO (Maybe HUnitFailure)
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679771405"><span class="annot"><span class="annottext">testCounterexample :: String -&gt; Assertion -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var hs-var hs-var hs-var">testCounterexample</span></a></span></span><span> </span><span id="local-6989586621679771406"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771406"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion
-&gt; (HUnitFailure -&gt; Assertion) -&gt; Maybe HUnitFailure -&gt; Assertion
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Assertion
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HUnitFailure -&gt; Assertion
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">(HUnitFailure -&gt; Assertion)
-&gt; (HUnitFailure -&gt; HUnitFailure) -&gt; HUnitFailure -&gt; Assertion
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; HUnitFailure
</span><a href="#local-6989586621679771409"><span class="hs-identifier hs-var">adjustMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe HUnitFailure -&gt; Assertion)
-&gt; (Assertion -&gt; IO (Maybe HUnitFailure)) -&gt; Assertion -&gt; Assertion
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var">assertionToMaybe</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><a href="#local-6989586621679771411"><span class="hs-identifier hs-type">joinMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-246"></span><span>      </span><span id="local-6989586621679771411"><span class="annot"><span class="annottext">joinMsg :: String -&gt; String
</span><a href="#local-6989586621679771411"><span class="hs-identifier hs-var hs-var">joinMsg</span></a></span></span><span> </span><span id="local-6989586621679771412"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771412"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771406"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771412"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><a href="#local-6989586621679771409"><span class="hs-identifier hs-type">adjustMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span>
</span><span id="line-249"></span><span>      </span><span id="local-6989586621679771409"><span class="annot"><span class="annottext">adjustMsg :: HUnitFailure -&gt; HUnitFailure
</span><a href="#local-6989586621679771409"><span class="hs-identifier hs-var hs-var">adjustMsg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span> </span><span id="local-6989586621679771414"><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679771414"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679771415"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771415"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="annottext">Maybe SrcLoc -&gt; String -&gt; HUnitFailure
</span><span class="hs-identifier hs-var">HU.HUnitFailure</span></span><span> </span><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679771414"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679771411"><span class="hs-identifier hs-var">joinMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771415"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679771418"><span class="annot"><span class="annottext">testFailure :: Assertion
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assertion
forall a. HasCallStack =&gt; String -&gt; IO a
</span><span class="hs-identifier hs-var">HU.assertFailure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679771422"><span class="annot"><span class="annottext">testFailureMsg :: String -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailureMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assertion
forall a. HasCallStack =&gt; String -&gt; IO a
</span><span class="hs-identifier hs-var">HU.assertFailure</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679771425"><span class="annot"><span class="annottext">testConjoin :: [Assertion] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679771431"><span class="annot"><span class="annottext">testDisjoin :: [Assertion] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testDisjoin</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679771432"><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679771432"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679771433"><span class="annot"><span class="annottext">[Assertion]
</span><a href="#local-6989586621679771433"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var">assertionToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679771432"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe HUnitFailure)
-&gt; (Maybe HUnitFailure -&gt; Assertion) -&gt; Assertion
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Assertion
-&gt; (HUnitFailure -&gt; Assertion) -&gt; Maybe HUnitFailure -&gt; Assertion
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="annot"><span class="annottext">[Assertion]
</span><a href="#local-6989586621679771433"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; Assertion
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679771435"><span class="annot"><span class="annottext">testSuccess :: Assertion
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var hs-var hs-var">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Assertion
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679771442"><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679771447"><span class="annot"><span class="annottext">testCounterexample :: String -&gt; Property -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var hs-var hs-var hs-var">testCounterexample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.counterexample</span></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679771451"><span class="annot"><span class="annottext">testFailure :: Property
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679771454"><span class="annot"><span class="annottext">testSuccess :: Property
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var hs-var hs-var">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679771456"><span class="annot"><span class="annottext">testConjoin :: [Property] -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">QC.conjoin</span></span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679771459"><span class="annot"><span class="annottext">testDisjoin :: [Property] -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testDisjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">QC.disjoin</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Here we provide our own universsal quantifier instead of 'QC.forAll', so we</span><span>
</span><span id="line-270"></span><span class="hs-comment">--  can monomorphize it to returning a 'QC.Property'</span><span>
</span><span id="line-271"></span><span id="local-6989586621679771158"><span class="annot"><a href="Cooked.MockChain.Testing.html#forAll"><span class="hs-identifier hs-type">forAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679771158"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621679771158"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679771158"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span></span><span>
</span><span id="line-272"></span><span id="forAll"><span class="annot"><span class="annottext">forAll :: forall a. Show a =&gt; Gen a -&gt; (a -&gt; Property) -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#forAll"><span class="hs-identifier hs-var hs-var">forAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; Property) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">QC.forAll</span></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- TODO: Discuss this instance; its here to enable us to easily run things in a</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- repl but I'm not sure whether to ignore the counterexample messages or not.</span><span>
</span><span id="line-276"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679771470"><span id="local-6989586621679771474"><span id="local-6989586621679771477"><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679771479"><span class="annot"><span class="annottext">testCounterexample :: String -&gt; Bool -&gt; Bool
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var hs-var hs-var hs-var">testCounterexample</span></a></span></span><span> </span><span id="local-6989586621679771480"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771480"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Bool
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679771480"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621679771482"><span class="annot"><span class="annottext">testConjoin :: [Bool] -&gt; Bool
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621679771485"><span class="annot"><span class="annottext">testDisjoin :: [Bool] -&gt; Bool
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testDisjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span id="local-6989586621679771165"><span class="annot"><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-type">assertSubset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679771165"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679771165"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679771165"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679771165"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span></span><span>
</span><span id="line-283"></span><span id="assertSubset"><span class="annot"><span class="annottext">assertSubset :: forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var hs-var">assertSubset</span></a></span></span><span> </span><span id="local-6989586621679771501"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771501"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679771502"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771502"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Assertion) -&gt; [a] -&gt; [Assertion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679771503"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679771503"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
String -&gt; Bool -&gt; Assertion
</span><span class="hs-identifier hs-var">HU.assertBool</span></span><span>
</span><span id="line-288"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not a subset:\n\n&quot;</span></span><span>
</span><span id="line-289"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679771503"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-290"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nis not an element of\n\n&quot;</span></span><span>
</span><span id="line-291"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771502"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-292"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>              </span><span class="annot"><span class="annottext">(Bool -&gt; Assertion) -&gt; Bool -&gt; Assertion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679771503"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771502"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771501"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span id="local-6989586621679771506"><span class="annot"><a href="Cooked.MockChain.Testing.html#assertSameSets"><span class="hs-identifier hs-type">assertSameSets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679771506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679771506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679771506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679771506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span></span><span>
</span><span id="line-299"></span><span id="assertSameSets"><span class="annot"><span class="annottext">assertSameSets :: forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSameSets"><span class="hs-identifier hs-var hs-var">assertSameSets</span></a></span></span><span> </span><span id="local-6989586621679771529"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771529"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679771530"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771530"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
String -&gt; Bool -&gt; Assertion
</span><span class="hs-identifier hs-var">HU.assertBool</span></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected lists of the same length, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771529"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771530"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771529"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771530"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">Assertion -&gt; Assertion -&gt; Assertion
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Assertion
forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var">assertSubset</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771529"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771530"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">Assertion -&gt; Assertion -&gt; Assertion
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Assertion
forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var">assertSubset</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771530"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679771529"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-305"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This modules provides primitives to run tests over mockchain executions and</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- to give expectation on the result of these runs.</span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.MockChain.Testing</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html"><span class="hs-identifier">Cooked.InitialDistribution</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html"><span class="hs-identifier">Cooked.MockChain.BlockChain</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html"><span class="hs-identifier">Cooked.MockChain.Direct</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html"><span class="hs-identifier">Cooked.MockChain.Staged</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html"><span class="hs-identifier">Cooked.MockChain.UtxoState</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.html"><span class="hs-identifier">Cooked.Pretty</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">QC</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.HUnit</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HU</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="annot"><span class="hs-comment">-- * Common interface between HUnit and QuickCheck</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- | 'IsProp' is a common interface for HUnit and QuickCheck tests. It abstracts</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- uses of 'HU.Assertion' and 'QC.Property' for @(IsProp prop) =&gt; prop@, then</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- provide instances for both @HU.Asserton@ and @QC.Property@.</span><span>
</span><span id="line-24"></span><span class="hs-keyword">class</span><span> </span><span id="IsProp"><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-var">IsProp</span></a></span></span><span> </span><span id="local-6989586621679831879"><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-comment">-- | Displays the string to the user in case of failure</span><span>
</span><span id="line-26"></span><span>  </span><span id="testCounterexample"><span class="annot"><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-type">testCounterexample</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-comment">-- | Conjunction of a number of results</span><span>
</span><span id="line-29"></span><span>  </span><span id="testConjoin"><span class="annot"><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-type">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-comment">-- | Disjunction of a number of results</span><span>
</span><span id="line-32"></span><span>  </span><span id="testDisjoin"><span class="annot"><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-type">testDisjoin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-comment">-- | Flags a failure</span><span>
</span><span id="line-35"></span><span>  </span><span id="testFailure"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-type">testFailure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span id="local-6989586621679832090"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var">testFailure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- | Flags a success</span><span>
</span><span id="line-39"></span><span>  </span><span id="testSuccess"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-type">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679832093"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var">testSuccess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-comment">-- | Flags a failure with a message</span><span>
</span><span id="line-43"></span><span>  </span><span id="testFailureMsg"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-type">testFailureMsg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831879"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679832096"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var hs-var">testFailureMsg</span></a></span><span> </span><span id="local-6989586621679832099"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832099"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832099"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><span class="hs-comment">-- | Turns a boolean into a @prop@</span></span><span>
</span><span id="line-47"></span><span id="local-6989586621679831882"><span class="annot"><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-type">testBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831882"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831882"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-48"></span><span id="testBool"><span class="annot"><span class="annottext">testBool :: forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var hs-var">testBool</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><span class="hs-comment">-- | Ensures all elements of a list satisfy a given @prop@</span></span><span>
</span><span id="line-52"></span><span id="local-6989586621679831884"><span id="local-6989586621679831885"><span class="annot"><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-type">testAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831884"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679831885"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831884"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679831885"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831884"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-53"></span><span id="testAll"><span class="annot"><span class="annottext">testAll :: forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var hs-var">testAll</span></a></span></span><span> </span><span id="local-6989586621679832107"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679832107"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="annot"><span class="annottext">([prop] -&gt; prop) -&gt; ([a] -&gt; [prop]) -&gt; [a] -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; prop) -&gt; [a] -&gt; [prop]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679832107"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-type">.==.</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><span class="hs-comment">-- | Lifts an equality test to a @prop@</span></span><span>
</span><span id="line-58"></span><span id="local-6989586621679831893"><span id="local-6989586621679831894"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-type">(.==.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831893"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679831894"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831894"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831894"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831893"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-59"></span><span id="local-6989586621679832114"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832114"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%3D%3D."><span class="annot"><span class="annottext">.==. :: forall prop a. (IsProp prop, Eq a) =&gt; a -&gt; a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%3D%3D."><span class="hs-operator hs-var hs-var">.==.</span></a></span></span><span> </span><span id="local-6989586621679832115"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832115"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; prop
forall prop. IsProp prop =&gt; Bool -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testBool"><span class="hs-identifier hs-var">testBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; prop) -&gt; Bool -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832114"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832115"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">3</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-type">.&amp;&amp;.</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><span class="hs-comment">-- | Conjunction of two @prop@s</span></span><span>
</span><span id="line-64"></span><span id="local-6989586621679831901"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-type">(.&amp;&amp;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831901"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831901"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831901"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831901"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-65"></span><span id="local-6989586621679832119"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832119"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%26%26."><span class="annot"><span class="annottext">.&amp;&amp;. :: forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var hs-var">.&amp;&amp;.</span></a></span></span><span> </span><span id="local-6989586621679832120"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832120"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832119"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832120"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">2</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-type">.||.</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">-- | Disjunction of two @prop@s</span></span><span>
</span><span id="line-70"></span><span id="local-6989586621679832122"><span class="annot"><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-type">(.||.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832122"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832122"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832122"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832122"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-71"></span><span id="local-6989586621679832125"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832125"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id=".%7C%7C."><span class="annot"><span class="annottext">.||. :: forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%7C%7C."><span class="hs-operator hs-var hs-var">.||.</span></a></span></span><span> </span><span id="local-6989586621679832126"><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832126"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[prop] -&gt; prop
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832125"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prop
</span><a href="#local-6989586621679832126"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="annot"><span class="hs-comment">-- | Catches a HUnit test failure, if the test fails.</span></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-type">assertionToMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span id="assertionToMaybe"><span class="annot"><span class="annottext">assertionToMaybe :: Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var hs-var">assertionToMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(IO (Maybe HUnitFailure)
 -&gt; [Handler (Maybe HUnitFailure)] -&gt; IO (Maybe HUnitFailure))
-&gt; [Handler (Maybe HUnitFailure)]
-&gt; IO (Maybe HUnitFailure)
-&gt; IO (Maybe HUnitFailure)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe HUnitFailure)
-&gt; [Handler (Maybe HUnitFailure)] -&gt; IO (Maybe HUnitFailure)
forall a. IO a -&gt; [Handler a] -&gt; IO a
</span><span class="hs-identifier hs-var">E.catches</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; Handler (Maybe HUnitFailure)
forall a e. Exception e =&gt; (e -&gt; IO a) -&gt; Handler a
</span><span class="hs-identifier hs-var">E.Handler</span></span><span> </span><span class="annot"><span class="annottext">((HUnitFailure -&gt; IO (Maybe HUnitFailure))
 -&gt; Handler (Maybe HUnitFailure))
-&gt; (HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; Handler (Maybe HUnitFailure)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure))
-&gt; (HUnitFailure -&gt; Maybe HUnitFailure)
-&gt; HUnitFailure
-&gt; IO (Maybe HUnitFailure)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; Maybe HUnitFailure
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(IO (Maybe HUnitFailure) -&gt; IO (Maybe HUnitFailure))
-&gt; (Assertion -&gt; IO (Maybe HUnitFailure))
-&gt; Assertion
-&gt; IO (Maybe HUnitFailure)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure) -&gt; IO (Maybe HUnitFailure)
forall a b. IO a -&gt; IO b -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure -&gt; IO (Maybe HUnitFailure)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe HUnitFailure
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | HUnit instance of 'IsProp'</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679832145"><span class="annot"><span class="annottext">testCounterexample :: String -&gt; Assertion -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var hs-var hs-var hs-var">testCounterexample</span></a></span></span><span> </span><span id="local-6989586621679832146"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832146"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion
-&gt; (HUnitFailure -&gt; Assertion) -&gt; Maybe HUnitFailure -&gt; Assertion
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Assertion
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HUnitFailure -&gt; Assertion
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span> </span><span class="annot"><span class="annottext">(HUnitFailure -&gt; Assertion)
-&gt; (HUnitFailure -&gt; HUnitFailure) -&gt; HUnitFailure -&gt; Assertion
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; HUnitFailure
</span><a href="#local-6989586621679832149"><span class="hs-identifier hs-var">adjustMsg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe HUnitFailure -&gt; Assertion)
-&gt; (Assertion -&gt; IO (Maybe HUnitFailure)) -&gt; Assertion -&gt; Assertion
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var">assertionToMaybe</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>      </span><span class="annot"><a href="#local-6989586621679832151"><span class="hs-identifier hs-type">joinMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-82"></span><span>      </span><span id="local-6989586621679832151"><span class="annot"><span class="annottext">joinMsg :: String -&gt; String
</span><a href="#local-6989586621679832151"><span class="hs-identifier hs-var hs-var">joinMsg</span></a></span></span><span> </span><span id="local-6989586621679832152"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832152"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832146"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832152"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><a href="#local-6989586621679832149"><span class="hs-identifier hs-type">adjustMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span>
</span><span id="line-85"></span><span>      </span><span id="local-6989586621679832149"><span class="annot"><span class="annottext">adjustMsg :: HUnitFailure -&gt; HUnitFailure
</span><a href="#local-6989586621679832149"><span class="hs-identifier hs-var hs-var">adjustMsg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HU.HUnitFailure</span></span><span> </span><span id="local-6989586621679832154"><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679832154"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679832155"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832155"><span class="hs-identifier hs-var">txt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">Maybe SrcLoc -&gt; String -&gt; HUnitFailure
</span><span class="hs-identifier hs-var">HU.HUnitFailure</span></span><span> </span><span class="annot"><span class="annottext">Maybe SrcLoc
</span><a href="#local-6989586621679832154"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679832151"><span class="hs-identifier hs-var">joinMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679832155"><span class="hs-identifier hs-var">txt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679832158"><span class="annot"><span class="annottext">testFailure :: Assertion
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assertion
forall a. HasCallStack =&gt; String -&gt; IO a
</span><span class="hs-identifier hs-var">HU.assertFailure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679832162"><span class="annot"><span class="annottext">testFailureMsg :: String -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailureMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Assertion
forall a. HasCallStack =&gt; String -&gt; IO a
</span><span class="hs-identifier hs-var">HU.assertFailure</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679832166"><span class="annot"><span class="annottext">testConjoin :: [Assertion] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679832172"><span class="annot"><span class="annottext">testDisjoin :: [Assertion] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testDisjoin</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var">testFailure</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679832173"><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679832173"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679832174"><span class="annot"><span class="annottext">[Assertion]
</span><a href="#local-6989586621679832174"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Assertion -&gt; IO (Maybe HUnitFailure)
</span><a href="Cooked.MockChain.Testing.html#assertionToMaybe"><span class="hs-identifier hs-var">assertionToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Assertion
</span><a href="#local-6989586621679832173"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Maybe HUnitFailure)
-&gt; (Maybe HUnitFailure -&gt; Assertion) -&gt; Assertion
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Assertion
-&gt; (HUnitFailure -&gt; Assertion) -&gt; Maybe HUnitFailure -&gt; Assertion
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var">testDisjoin</span></a></span><span> </span><span class="annot"><span class="annottext">[Assertion]
</span><a href="#local-6989586621679832174"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HUnitFailure -&gt; Assertion
forall a e. Exception e =&gt; e -&gt; a
</span><span class="hs-identifier hs-var">E.throw</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679832176"><span class="annot"><span class="annottext">testSuccess :: Assertion
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var hs-var hs-var">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Assertion
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">-- | QuickCheck instance of 'IsProp'</span></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679832183"><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679832188"><span class="annot"><span class="annottext">testCounterexample :: String -&gt; Property -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var hs-var hs-var hs-var">testCounterexample</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.counterexample</span></span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679832192"><span class="annot"><span class="annottext">testFailure :: Property
</span><a href="Cooked.MockChain.Testing.html#testFailure"><span class="hs-identifier hs-var hs-var hs-var hs-var">testFailure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679832195"><span class="annot"><span class="annottext">testSuccess :: Property
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var hs-var hs-var hs-var">testSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">QC.property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679832197"><span class="annot"><span class="annottext">testConjoin :: [Property] -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testConjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">QC.conjoin</span></span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679832200"><span class="annot"><span class="annottext">testDisjoin :: [Property] -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#testDisjoin"><span class="hs-identifier hs-var hs-var hs-var hs-var">testDisjoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">QC.disjoin</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Here we provide our own universsal quantifier instead of 'QC.forAll', so we</span><span>
</span><span id="line-107"></span><span class="hs-comment">--  can monomorphize it to returning a 'QC.Property'</span><span>
</span><span id="line-108"></span><span id="local-6989586621679831942"><span class="annot"><a href="Cooked.MockChain.Testing.html#forAll"><span class="hs-identifier hs-type">forAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679831942"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Gen</span></span><span> </span><span class="annot"><a href="#local-6989586621679831942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679831942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QC.Property</span></span></span><span>
</span><span id="line-109"></span><span id="forAll"><span class="annot"><span class="annottext">forAll :: forall a. Show a =&gt; Gen a -&gt; (a -&gt; Property) -&gt; Property
</span><a href="Cooked.MockChain.Testing.html#forAll"><span class="hs-identifier hs-var hs-var">forAll</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen a -&gt; (a -&gt; Property) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">QC.forAll</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><span class="hs-comment">-- * Extra HUnit assertions</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><span class="hs-comment">-- | Asserts whether a set is a subset of another one, both given as lists.</span></span><span>
</span><span id="line-114"></span><span id="local-6989586621679831947"><span class="annot"><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-type">assertSubset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679831947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679831947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679831947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679831947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span></span><span>
</span><span id="line-115"></span><span id="assertSubset"><span class="annot"><span class="annottext">assertSubset :: forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var hs-var">assertSubset</span></a></span></span><span> </span><span id="local-6989586621679832221"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832221"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679832222"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832222"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="annottext">[Assertion] -&gt; Assertion
forall prop. IsProp prop =&gt; [prop] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testConjoin"><span class="hs-identifier hs-var">testConjoin</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Assertion) -&gt; [a] -&gt; [Assertion]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832223"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832223"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
String -&gt; Bool -&gt; Assertion
</span><span class="hs-identifier hs-var">HU.assertBool</span></span><span>
</span><span id="line-120"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not a subset:\n\n&quot;</span></span><span>
</span><span id="line-121"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832223"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-122"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\nis not an element of\n\n&quot;</span></span><span>
</span><span id="line-123"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832222"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-124"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>              </span><span class="annot"><span class="annottext">(Bool -&gt; Assertion) -&gt; Bool -&gt; Assertion
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832223"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832222"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832221"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><span class="hs-comment">-- | Asserts whether 2 sets are equal, both given as lists.</span></span><span>
</span><span id="line-131"></span><span id="local-6989586621679832227"><span class="annot"><a href="Cooked.MockChain.Testing.html#assertSameSets"><span class="hs-identifier hs-type">assertSameSets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679832227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679832227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679832227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679832227"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HU.Assertion</span></span></span><span>
</span><span id="line-132"></span><span id="assertSameSets"><span class="annot"><span class="annottext">assertSameSets :: forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSameSets"><span class="hs-identifier hs-var hs-var">assertSameSets</span></a></span></span><span> </span><span id="local-6989586621679832251"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832251"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679832252"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832252"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><span class="annottext">HasCallStack =&gt; String -&gt; Bool -&gt; Assertion
String -&gt; Bool -&gt; Assertion
</span><span class="hs-identifier hs-var">HU.assertBool</span></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected lists of the same length, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832251"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832252"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832251"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832252"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">Assertion -&gt; Assertion -&gt; Assertion
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Assertion
forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var">assertSubset</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832251"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832252"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">Assertion -&gt; Assertion -&gt; Assertion
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Assertion
forall a. (Show a, Eq a) =&gt; [a] -&gt; [a] -&gt; Assertion
</span><a href="Cooked.MockChain.Testing.html#assertSubset"><span class="hs-identifier hs-var">assertSubset</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832252"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679832251"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="annot"><span class="hs-comment">-- * Testing mockchain traces</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><span class="hs-comment">-- | Data structure to test a mockchain trace</span></span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="Test"><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-var">Test</span></a></span></span><span> </span><span id="local-6989586621679831955"><span class="annot"><a href="#local-6989586621679831955"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679831956"><span class="annot"><a href="#local-6989586621679831956"><span class="hs-identifier hs-type">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Test"><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-var">Test</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-comment">-- | The mockchain trace to test</span></span><span>
</span><span id="line-144"></span><span>    </span><span id="testTrace"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; StagedMockChain a
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-identifier hs-var hs-var">testTrace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831955"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The initial distribution from which the trace should be run</span></span><span>
</span><span id="line-146"></span><span>    </span><span id="testInitDist"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; InitialDistribution
</span><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var hs-var">testInitDist</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The requirement on the number of results</span></span><span>
</span><span id="line-148"></span><span>    </span><span id="testSizeProp"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; Integer -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var hs-var">testSizeProp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831956"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The property should hold in case of failure</span></span><span>
</span><span id="line-150"></span><span>    </span><span id="testErrorProp"><span class="annot"><span class="annottext">forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; MockChainError
-&gt; [MockChainLogEntry]
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var hs-var">testErrorProp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831956"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The property that should hold in case of success</span></span><span>
</span><span id="line-152"></span><span>    </span><span id="testResultProp"><span class="annot"><span class="annottext">forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; a
-&gt; UtxoState
-&gt; [MockChainLogEntry]
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var hs-var">testResultProp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831955"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679831956"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The printing option that should be use to render test results</span></span><span>
</span><span id="line-154"></span><span>    </span><span id="testPrettyOpts"><span class="annot"><span class="annottext">forall a prop. Test a prop -&gt; PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var hs-var">testPrettyOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a success from a trace</span></span><span>
</span><span id="line-158"></span><span id="local-6989586621679831976"><span id="local-6989586621679831977"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustSucceedTest"><span class="hs-identifier hs-type">mustSucceedTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831976"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831977"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831977"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831976"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-159"></span><span id="mustSucceedTest"><span class="annot"><span class="annottext">mustSucceedTest :: forall prop a. IsProp prop =&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustSucceedTest"><span class="hs-identifier hs-var hs-var">mustSucceedTest</span></a></span></span><span> </span><span id="local-6989586621679832272"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679832272"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testTrace :: StagedMockChain a
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-identifier hs-var">testTrace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679832272"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><span class="annottext">testInitDist :: InitialDistribution
</span><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var">testInitDist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>      </span><span class="annot"><span class="annottext">testSizeProp :: Integer -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; Integer -&gt; prop
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">testErrorProp :: PrettyCookedOpts -&gt; MockChainError -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832275"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832275"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679832276"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832276"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832275"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832276"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">testResultProp :: PrettyCookedOpts -&gt; a -&gt; UtxoState -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">testPrettyOpts :: PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><span class="hs-comment">-- | A test template which expects a failure from a trace</span></span><span>
</span><span id="line-170"></span><span id="local-6989586621679831988"><span id="local-6989586621679831989"><span class="annot"><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-type">mustFailTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831988"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679831989"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831989"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831988"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-171"></span><span id="mustFailTest"><span class="annot"><span class="annottext">mustFailTest :: forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var hs-var">mustFailTest</span></a></span></span><span> </span><span id="local-6989586621679832289"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679832289"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testTrace :: StagedMockChain a
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-identifier hs-var">testTrace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679832289"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">testInitDist :: InitialDistribution
</span><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var">testInitDist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">testSizeProp :: Integer -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; Integer -&gt; prop
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">testErrorProp :: PrettyCookedOpts -&gt; MockChainError -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><span class="annottext">testResultProp :: PrettyCookedOpts -&gt; a -&gt; UtxoState -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832290"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832290"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679832291"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832291"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679832292"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832292"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((a, UtxoState) -&gt; DocCooked) -&gt; (a, UtxoState) -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; (a, UtxoState) -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832290"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832291"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832292"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="annottext">testPrettyOpts :: PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><span class="hs-comment">-- | A test template with no particular requirement on the trace</span></span><span>
</span><span id="line-182"></span><span id="local-6989586621679832293"><span id="local-6989586621679832294"><span class="annot"><a href="Cooked.MockChain.Testing.html#emptyTest"><span class="hs-identifier hs-type">emptyTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832293"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832294"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832294"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832293"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-183"></span><span id="emptyTest"><span class="annot"><span class="annottext">emptyTest :: forall prop a. IsProp prop =&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#emptyTest"><span class="hs-identifier hs-var hs-var">emptyTest</span></a></span></span><span> </span><span id="local-6989586621679832302"><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679832302"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">testTrace :: StagedMockChain a
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-identifier hs-var">testTrace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679832302"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="annottext">testInitDist :: InitialDistribution
</span><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var">testInitDist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitialDistribution
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">testSizeProp :: Integer -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop -&gt; Integer -&gt; prop
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><span class="annottext">testErrorProp :: PrettyCookedOpts -&gt; MockChainError -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><span class="annottext">testResultProp :: PrettyCookedOpts -&gt; a -&gt; UtxoState -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-190"></span><span>      </span><span class="annot"><span class="annottext">testPrettyOpts :: PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><span class="hs-comment">-- | Appending an initial distribution to a test</span></span><span>
</span><span id="line-194"></span><span id="local-6989586621679831995"><span id="local-6989586621679831996"><span class="annot"><a href="Cooked.MockChain.Testing.html#withInitDist"><span class="hs-identifier hs-type">withInitDist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831996"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.InitialDistribution.html#InitialDistribution"><span class="hs-identifier hs-type">InitialDistribution</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831995"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831996"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-195"></span><span id="withInitDist"><span class="annot"><span class="annottext">withInitDist :: forall a prop. Test a prop -&gt; InitialDistribution -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withInitDist"><span class="hs-identifier hs-var hs-var">withInitDist</span></a></span></span><span> </span><span id="local-6989586621679832304"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832304"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832305"><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679832305"><span class="hs-identifier hs-var">initDist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832304"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cooked.MockChain.Testing.html#testInitDist"><span class="hs-identifier hs-var">testInitDist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679832305"><span class="hs-identifier hs-type">initDist</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><span class="hs-comment">-- | Appending printing options to a test</span></span><span>
</span><span id="line-198"></span><span id="local-6989586621679831999"><span id="local-6989586621679832000"><span class="annot"><a href="Cooked.MockChain.Testing.html#withPrettyOpts"><span class="hs-identifier hs-type">withPrettyOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831999"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832000"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679831999"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832000"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-199"></span><span id="withPrettyOpts"><span class="annot"><span class="annottext">withPrettyOpts :: forall a prop. Test a prop -&gt; PrettyCookedOpts -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyOpts"><span class="hs-identifier hs-var hs-var">withPrettyOpts</span></a></span></span><span> </span><span id="local-6989586621679832307"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832307"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832308"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832308"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832307"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cooked.MockChain.Testing.html#testPrettyOpts"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679832308"><span class="hs-identifier hs-type">opts</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Appending a predicate over the log to a test. This will be used both in</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- case of success or failure of the trace.</span><span>
</span><span id="line-203"></span><span id="local-6989586621679832003"><span id="local-6989586621679832004"><span class="annot"><a href="Cooked.MockChain.Testing.html#withJournalPred"><span class="hs-identifier hs-type">withJournalPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832003"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832003"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainLogEntry"><span class="hs-identifier hs-type">MockChainLogEntry</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832003"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832004"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832003"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-204"></span><span id="withJournalPred"><span class="annot"><span class="annottext">withJournalPred :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; ([MockChainLogEntry] -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withJournalPred"><span class="hs-identifier hs-var hs-var">withJournalPred</span></a></span></span><span> </span><span id="local-6989586621679832313"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832313"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832314"><span class="annot"><span class="annottext">[MockChainLogEntry] -&gt; prop
</span><a href="#local-6989586621679832314"><span class="hs-identifier hs-var">journalPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832313"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832315"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832315"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679832316"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832316"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679832317"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832317"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop
-&gt; PrettyCookedOpts
-&gt; MockChainError
-&gt; [MockChainLogEntry]
-&gt; prop
forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; MockChainError
-&gt; [MockChainLogEntry]
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832313"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832315"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832316"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832317"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry] -&gt; prop
</span><a href="#local-6989586621679832314"><span class="hs-identifier hs-var">journalPred</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832317"><span class="hs-identifier hs-var">journal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832318"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832318"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679832319"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832319"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679832320"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832320"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679832321"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832321"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop
-&gt; PrettyCookedOpts
-&gt; a
-&gt; UtxoState
-&gt; [MockChainLogEntry]
-&gt; prop
forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; a
-&gt; UtxoState
-&gt; [MockChainLogEntry]
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832313"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832318"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832319"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832320"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832321"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry] -&gt; prop
</span><a href="#local-6989586621679832314"><span class="hs-identifier hs-var">journalPred</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832321"><span class="hs-identifier hs-var">journal</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Appending a predicate over the return value and state, which will be used</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- in case of success of the trace.</span><span>
</span><span id="line-212"></span><span id="local-6989586621679832007"><span id="local-6989586621679832008"><span class="annot"><a href="Cooked.MockChain.Testing.html#withValueAndStatePred"><span class="hs-identifier hs-type">withValueAndStatePred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832007"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832007"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679832008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832007"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832008"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832007"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-213"></span><span id="withValueAndStatePred"><span class="annot"><span class="annottext">withValueAndStatePred :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (a -&gt; UtxoState -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withValueAndStatePred"><span class="hs-identifier hs-var hs-var">withValueAndStatePred</span></a></span></span><span> </span><span id="local-6989586621679832325"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832325"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832326"><span class="annot"><span class="annottext">a -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679832326"><span class="hs-identifier hs-var">resultPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832325"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832327"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832327"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679832328"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832328"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679832329"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832329"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679832330"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832330"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop
-&gt; PrettyCookedOpts
-&gt; a
-&gt; UtxoState
-&gt; [MockChainLogEntry]
-&gt; prop
forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; a
-&gt; UtxoState
-&gt; [MockChainLogEntry]
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testResultProp"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832325"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832327"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832328"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832329"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832330"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; UtxoState -&gt; prop
</span><a href="#local-6989586621679832326"><span class="hs-identifier hs-var">resultPred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832328"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832329"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="annot"><span class="hs-comment">-- | Ensuring the number of results of a test is exactly as expected</span></span><span>
</span><span id="line-219"></span><span id="local-6989586621679832011"><span id="local-6989586621679832012"><span class="annot"><a href="Cooked.MockChain.Testing.html#withExactSize"><span class="hs-identifier hs-type">withExactSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832011"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832012"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832011"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832012"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832011"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-220"></span><span id="withExactSize"><span class="annot"><span class="annottext">withExactSize :: forall prop a. IsProp prop =&gt; Test a prop -&gt; Integer -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withExactSize"><span class="hs-identifier hs-var hs-var">withExactSize</span></a></span></span><span> </span><span id="local-6989586621679832349"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832349"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832350"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679832350"><span class="hs-identifier hs-var">reqSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832349"><span class="hs-identifier hs-var">test</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#testSizeProp"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832351"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679832351"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679832351"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679832350"><span class="hs-identifier hs-var">reqSize</span></a></span><span>
</span><span id="line-224"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-225"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incorrect number of results (expected: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679832350"><span class="hs-identifier hs-var">reqSize</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; but got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679832351"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Appending a predicate over the return value, which will be used in case of</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- success of the trace.</span><span>
</span><span id="line-230"></span><span id="local-6989586621679832017"><span id="local-6989586621679832018"><span class="annot"><a href="Cooked.MockChain.Testing.html#withValuePred"><span class="hs-identifier hs-type">withValuePred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832017"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832017"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679832018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832017"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832017"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-231"></span><span id="withValuePred"><span class="annot"><span class="annottext">withValuePred :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (a -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withValuePred"><span class="hs-identifier hs-var hs-var">withValuePred</span></a></span></span><span> </span><span id="local-6989586621679832355"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832355"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832356"><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679832356"><span class="hs-identifier hs-var">valuePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; (a -&gt; UtxoState -&gt; prop) -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (a -&gt; UtxoState -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withValueAndStatePred"><span class="hs-identifier hs-var">withValueAndStatePred</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832355"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; UtxoState -&gt; prop) -&gt; Test a prop)
-&gt; (a -&gt; UtxoState -&gt; prop) -&gt; Test a prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832357"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832357"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; prop
</span><a href="#local-6989586621679832356"><span class="hs-identifier hs-var">valuePred</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832357"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Appending a predicate over the return state, which will be used in case of</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- success of the trace.</span><span>
</span><span id="line-235"></span><span id="local-6989586621679832021"><span id="local-6989586621679832022"><span class="annot"><a href="Cooked.MockChain.Testing.html#withStatePred"><span class="hs-identifier hs-type">withStatePred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832021"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832022"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832021"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.UtxoState.html#UtxoState"><span class="hs-identifier hs-type">UtxoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832021"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832022"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832021"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-236"></span><span id="withStatePred"><span class="annot"><span class="annottext">withStatePred :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (UtxoState -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withStatePred"><span class="hs-identifier hs-var hs-var">withStatePred</span></a></span></span><span> </span><span id="local-6989586621679832361"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832361"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832362"><span class="annot"><span class="annottext">UtxoState -&gt; prop
</span><a href="#local-6989586621679832362"><span class="hs-identifier hs-var">statePred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; (a -&gt; UtxoState -&gt; prop) -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (a -&gt; UtxoState -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withValueAndStatePred"><span class="hs-identifier hs-var">withValueAndStatePred</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832361"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; UtxoState -&gt; prop) -&gt; Test a prop)
-&gt; (a -&gt; UtxoState -&gt; prop) -&gt; Test a prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679832363"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832363"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UtxoState -&gt; prop
</span><a href="#local-6989586621679832362"><span class="hs-identifier hs-var">statePred</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832363"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Appending a predicate over an error which uses the printing options, which</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- will be used in case of failure of the trace.</span><span>
</span><span id="line-240"></span><span id="local-6989586621679832025"><span id="local-6989586621679832026"><span class="annot"><a href="Cooked.MockChain.Testing.html#withPrettyAndErrorPred"><span class="hs-identifier hs-type">withPrettyAndErrorPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832025"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832026"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832025"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832025"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832026"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832025"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-241"></span><span id="withPrettyAndErrorPred"><span class="annot"><span class="annottext">withPrettyAndErrorPred :: forall prop a.
IsProp prop =&gt;
Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyAndErrorPred"><span class="hs-identifier hs-var hs-var">withPrettyAndErrorPred</span></a></span></span><span> </span><span id="local-6989586621679832367"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832367"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832368"><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="#local-6989586621679832368"><span class="hs-identifier hs-var">errorPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832367"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832369"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832369"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679832370"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832370"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679832371"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832371"><span class="hs-identifier hs-var">journal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Test a prop
-&gt; PrettyCookedOpts
-&gt; MockChainError
-&gt; [MockChainLogEntry]
-&gt; prop
forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; MockChainError
-&gt; [MockChainLogEntry]
-&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testErrorProp"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832367"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832369"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832370"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832371"><span class="hs-identifier hs-var">journal</span></a></span><span> </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="#local-6989586621679832368"><span class="hs-identifier hs-var">errorPred</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832369"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832370"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-comment">-- | Appends a predicate over an error to a 'Test'</span></span><span>
</span><span id="line-244"></span><span id="local-6989586621679832029"><span id="local-6989586621679832030"><span class="annot"><a href="Cooked.MockChain.Testing.html#withErrorPred"><span class="hs-identifier hs-type">withErrorPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832029"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832030"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832029"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832029"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832030"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832029"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-245"></span><span id="withErrorPred"><span class="annot"><span class="annottext">withErrorPred :: forall prop a.
IsProp prop =&gt;
Test a prop -&gt; (MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withErrorPred"><span class="hs-identifier hs-var hs-var">withErrorPred</span></a></span></span><span> </span><span id="local-6989586621679832375"><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832375"><span class="hs-identifier hs-var">test</span></a></span></span><span> </span><span id="local-6989586621679832376"><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679832376"><span class="hs-identifier hs-var">errorPred</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyAndErrorPred"><span class="hs-identifier hs-var">withPrettyAndErrorPred</span></a></span><span> </span><span class="annot"><span class="annottext">Test a prop
</span><a href="#local-6989586621679832375"><span class="hs-identifier hs-var">test</span></a></span><span> </span><span class="annot"><span class="annottext">((PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop)
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679832377"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832377"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MockChainError -&gt; prop
</span><a href="#local-6989586621679832376"><span class="hs-identifier hs-var">errorPred</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832377"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><span class="hs-comment">-- | This takes a test and transforms it into an actual test case in prop.</span></span><span>
</span><span id="line-248"></span><span id="local-6989586621679832033"><span id="local-6989586621679832034"><span class="annot"><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-type">testToProp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832033"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832034"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832033"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832033"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-249"></span><span id="testToProp"><span class="annot"><span class="annottext">testToProp :: forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var hs-var">testToProp</span></a></span></span><span> </span><span class="annot"><a href="Cooked.MockChain.Testing.html#Test"><span class="hs-identifier hs-type">Test</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679832388"><span id="local-6989586621679832389"><span id="local-6989586621679832390"><span id="local-6989586621679832391"><span id="local-6989586621679832392"><span id="local-6989586621679832393"><span class="annot"><span class="annottext">StagedMockChain a
PrettyCookedOpts
InitialDistribution
Integer -&gt; prop
PrettyCookedOpts -&gt; a -&gt; UtxoState -&gt; [MockChainLogEntry] -&gt; prop
PrettyCookedOpts -&gt; MockChainError -&gt; [MockChainLogEntry] -&gt; prop
testTrace :: forall a prop. Test a prop -&gt; StagedMockChain a
testInitDist :: forall a prop. Test a prop -&gt; InitialDistribution
testSizeProp :: forall a prop. Test a prop -&gt; Integer -&gt; prop
testErrorProp :: forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; MockChainError
-&gt; [MockChainLogEntry]
-&gt; prop
testResultProp :: forall a prop.
Test a prop
-&gt; PrettyCookedOpts
-&gt; a
-&gt; UtxoState
-&gt; [MockChainLogEntry]
-&gt; prop
testPrettyOpts :: forall a prop. Test a prop -&gt; PrettyCookedOpts
testTrace :: StagedMockChain a
testInitDist :: InitialDistribution
testSizeProp :: Integer -&gt; prop
testErrorProp :: PrettyCookedOpts -&gt; MockChainError -&gt; [MockChainLogEntry] -&gt; prop
testResultProp :: PrettyCookedOpts -&gt; a -&gt; UtxoState -&gt; [MockChainLogEntry] -&gt; prop
testPrettyOpts :: PrettyCookedOpts
</span><a href="Cooked.MockChain.Testing.html#testTrace"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679832394"><span class="annot"><span class="annottext">innerProp :: (Either MockChainError (a, UtxoState), MockChainBook) -&gt; prop
</span><a href="#local-6989586621679832394"><span class="hs-identifier hs-var hs-var">innerProp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679832395"><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679832395"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainBook"><span class="hs-identifier hs-type">MockChainBook</span></a></span><span> </span><span id="local-6989586621679832397"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832397"><span class="hs-identifier hs-var">mcLog</span></a></span></span><span> </span><span id="local-6989586621679832398"><span class="annot"><span class="annottext">Map BuiltinByteString String
</span><a href="#local-6989586621679832398"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><a href="#local-6989586621679832395"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-252"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679832399"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832399"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="#local-6989586621679832391"><span class="hs-identifier hs-var">testErrorProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map BuiltinByteString String
-&gt; PrettyCookedOpts -&gt; PrettyCookedOpts
</span><a href="Cooked.Pretty.Options.html#addHashNames"><span class="hs-identifier hs-var">addHashNames</span></a></span><span> </span><span class="annot"><span class="annottext">Map BuiltinByteString String
</span><a href="#local-6989586621679832398"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832393"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832399"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832397"><span class="hs-identifier hs-var">mcLog</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679832401"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832401"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679832402"><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832402"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; a -&gt; UtxoState -&gt; [MockChainLogEntry] -&gt; prop
</span><a href="#local-6989586621679832392"><span class="hs-identifier hs-var">testResultProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map BuiltinByteString String
-&gt; PrettyCookedOpts -&gt; PrettyCookedOpts
</span><a href="Cooked.Pretty.Options.html#addHashNames"><span class="hs-identifier hs-var">addHashNames</span></a></span><span> </span><span class="annot"><span class="annottext">Map BuiltinByteString String
</span><a href="#local-6989586621679832398"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832393"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679832401"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoState
</span><a href="#local-6989586621679832402"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832397"><span class="hs-identifier hs-var">mcLog</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span id="local-6989586621679832403"><span class="annot"><span class="annottext">results :: [(Either MockChainError (a, UtxoState), MockChainBook)]
</span><a href="#local-6989586621679832403"><span class="hs-identifier hs-var hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *).
 Monad m =&gt;
 MockChainT m a
 -&gt; m (Either MockChainError (a, UtxoState), MockChainBook))
-&gt; StagedMockChain a
-&gt; [(Either MockChainError (a, UtxoState), MockChainBook)]
forall a res.
(forall (m :: * -&gt; *). Monad m =&gt; MockChainT m a -&gt; m res)
-&gt; StagedMockChain a -&gt; [res]
</span><a href="Cooked.MockChain.Staged.html#interpretAndRunWith"><span class="hs-identifier hs-var">interpretAndRunWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitialDistribution
-&gt; MockChainT m a
-&gt; m (Either MockChainError (a, UtxoState), MockChainBook)
forall (m :: * -&gt; *) a.
Monad m =&gt;
InitialDistribution
-&gt; MockChainT m a -&gt; m (MockChainReturn a UtxoState)
</span><a href="Cooked.MockChain.Direct.html#runMockChainTFrom"><span class="hs-identifier hs-var">runMockChainTFrom</span></a></span><span> </span><span class="annot"><span class="annottext">InitialDistribution
</span><a href="#local-6989586621679832389"><span class="hs-identifier hs-var">testInitDist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StagedMockChain a
</span><a href="#local-6989586621679832388"><span class="hs-identifier hs-var">testTrace</span></a></span><span>
</span><span id="line-255"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; prop
</span><a href="#local-6989586621679832390"><span class="hs-identifier hs-var">testSizeProp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><span class="hs-identifier hs-var">toInteger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainBook)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainBook)]
</span><a href="#local-6989586621679832403"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><span class="annottext">prop -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; prop -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#.%26%26."><span class="hs-operator hs-var">.&amp;&amp;.</span></a></span><span> </span><span class="annot"><span class="annottext">((Either MockChainError (a, UtxoState), MockChainBook) -&gt; prop)
-&gt; [(Either MockChainError (a, UtxoState), MockChainBook)] -&gt; prop
forall prop a. IsProp prop =&gt; (a -&gt; prop) -&gt; [a] -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testAll"><span class="hs-identifier hs-var">testAll</span></a></span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679832408"><span class="annot"><span class="annottext">res :: (Either MockChainError (a, UtxoState), MockChainBook)
</span><a href="#local-6989586621679832408"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either MockChainError (a, UtxoState)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.MockChain.Direct.html#MockChainBook"><span class="hs-identifier hs-type">MockChainBook</span></a></span><span> </span><span id="local-6989586621679832409"><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832409"><span class="hs-identifier hs-var">mcLog</span></a></span></span><span> </span><span id="local-6989586621679832410"><span class="annot"><span class="annottext">Map BuiltinByteString String
</span><a href="#local-6989586621679832410"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; prop -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testCounterexample"><span class="hs-identifier hs-var">testCounterexample</span></a></span><span>
</span><span id="line-259"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([MockChainLogEntry] -&gt; DocCooked) -&gt; [MockChainLogEntry] -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; [MockChainLogEntry] -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map BuiltinByteString String
-&gt; PrettyCookedOpts -&gt; PrettyCookedOpts
</span><a href="Cooked.Pretty.Options.html#addHashNames"><span class="hs-identifier hs-var">addHashNames</span></a></span><span> </span><span class="annot"><span class="annottext">Map BuiltinByteString String
</span><a href="#local-6989586621679832410"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832393"><span class="hs-identifier hs-var">testPrettyOpts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MockChainLogEntry]
</span><a href="#local-6989586621679832409"><span class="hs-identifier hs-var">mcLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either MockChainError (a, UtxoState), MockChainBook) -&gt; prop
</span><a href="#local-6989586621679832394"><span class="hs-identifier hs-var">innerProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Either MockChainError (a, UtxoState), MockChainBook)
</span><a href="#local-6989586621679832408"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>          </span><span class="annot"><span class="annottext">[(Either MockChainError (a, UtxoState), MockChainBook)]
</span><a href="#local-6989586621679832403"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Ensure that all results produced by the staged mockchain /succeed/,</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- starting from the default initial distribution</span><span>
</span><span id="line-266"></span><span id="local-6989586621679832049"><span id="local-6989586621679832050"><span class="annot"><a href="Cooked.MockChain.Testing.html#testSucceeds"><span class="hs-identifier hs-type">testSucceeds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832049"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832050"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832049"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-267"></span><span id="testSucceeds"><span class="annot"><span class="annottext">testSucceeds :: forall prop a. IsProp prop =&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSucceeds"><span class="hs-identifier hs-var hs-var">testSucceeds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; prop
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; prop)
-&gt; (StagedMockChain a -&gt; Test a prop) -&gt; StagedMockChain a -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a. IsProp prop =&gt; StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustSucceedTest"><span class="hs-identifier hs-var">mustSucceedTest</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="annot"><span class="hs-comment">-- | Ensure that all results produced by the staged mockchain /fail/</span></span><span>
</span><span id="line-270"></span><span id="local-6989586621679832053"><span id="local-6989586621679832054"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFails"><span class="hs-identifier hs-type">testFails</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832053"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679832054"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832053"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-271"></span><span id="testFails"><span class="annot"><span class="annottext">testFails :: forall prop a. (IsProp prop, Show a) =&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFails"><span class="hs-identifier hs-var hs-var">testFails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; prop
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; prop)
-&gt; (StagedMockChain a -&gt; Test a prop) -&gt; StagedMockChain a -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="annot"><span class="hs-comment">-- | A property to ensure a phase 1 failure</span></span><span>
</span><span id="line-274"></span><span id="local-6989586621679832057"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-type">isPhase1Failure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832057"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832057"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-275"></span><span id="isPhase1Failure"><span class="annot"><span class="annottext">isPhase1Failure :: forall prop.
IsProp prop =&gt;
PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-var hs-var">isPhase1Failure</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase1</span></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-276"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-var">isPhase1Failure</span></a></span><span> </span><span id="local-6989586621679832430"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832430"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679832431"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832431"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 1 evaluation failure, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832430"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832431"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><span class="hs-comment">-- | A test that succeeds when the trace results in a phase 1 failure</span></span><span>
</span><span id="line-279"></span><span id="local-6989586621679832432"><span id="local-6989586621679832433"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailsInPhase1"><span class="hs-identifier hs-type">testFailsInPhase1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832432"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679832433"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832433"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832432"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-280"></span><span id="testFailsInPhase1"><span class="annot"><span class="annottext">testFailsInPhase1 :: forall prop a. (IsProp prop, Show a) =&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailsInPhase1"><span class="hs-identifier hs-var hs-var">testFailsInPhase1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; prop
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; prop)
-&gt; (StagedMockChain a -&gt; Test a prop) -&gt; StagedMockChain a -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyAndErrorPred"><span class="hs-operator hs-var">`withPrettyAndErrorPred`</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; prop
forall prop.
IsProp prop =&gt;
PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1Failure"><span class="hs-identifier hs-var">isPhase1Failure</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; Test a prop)
-&gt; (StagedMockChain a -&gt; Test a prop)
-&gt; StagedMockChain a
-&gt; Test a prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><span class="hs-comment">-- | A property to ensure a phase 2 failure</span></span><span>
</span><span id="line-283"></span><span id="local-6989586621679832442"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-type">isPhase2Failure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832442"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832442"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-284"></span><span id="isPhase2Failure"><span class="annot"><span class="annottext">isPhase2Failure :: forall prop.
IsProp prop =&gt;
PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-var hs-var">isPhase2Failure</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase2</span></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-var">isPhase2Failure</span></a></span><span> </span><span id="local-6989586621679832451"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832451"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679832452"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832452"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 2 evaluation failure, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832451"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832452"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><span class="hs-comment">-- | A test that succeeds when the trace results in a phase 2 failure</span></span><span>
</span><span id="line-288"></span><span id="local-6989586621679832453"><span id="local-6989586621679832454"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailsInPhase2"><span class="hs-identifier hs-type">testFailsInPhase2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832453"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679832454"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832453"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-289"></span><span id="testFailsInPhase2"><span class="annot"><span class="annottext">testFailsInPhase2 :: forall prop a. (IsProp prop, Show a) =&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailsInPhase2"><span class="hs-identifier hs-var hs-var">testFailsInPhase2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; prop
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; prop)
-&gt; (StagedMockChain a -&gt; Test a prop) -&gt; StagedMockChain a -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyAndErrorPred"><span class="hs-operator hs-var">`withPrettyAndErrorPred`</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; prop
forall prop.
IsProp prop =&gt;
PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2Failure"><span class="hs-identifier hs-var">isPhase2Failure</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; Test a prop)
-&gt; (StagedMockChain a -&gt; Test a prop)
-&gt; StagedMockChain a
-&gt; Test a prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><span class="hs-comment">-- | Same as 'isPhase1Failure' with an added predicate on the text error</span></span><span>
</span><span id="line-292"></span><span id="local-6989586621679832066"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-type">isPhase1FailureWithMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832066"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832066"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-293"></span><span id="isPhase1FailureWithMsg"><span class="annot"><span class="annottext">isPhase1FailureWithMsg :: forall prop.
IsProp prop =&gt;
(String -&gt; Bool) -&gt; PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-var hs-var">isPhase1FailureWithMsg</span></a></span></span><span> </span><span id="local-6989586621679832470"><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832470"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.CardanoLedgerValidationError</span></span><span> </span><span id="local-6989586621679832472"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679832472"><span class="hs-identifier hs-var">text</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832470"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; String -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679832472"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-294"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-var">isPhase1FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679832474"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832474"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679832475"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832475"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 1 evaluation failure with constrained messages, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832474"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832475"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><span class="hs-comment">-- | Same as 'testFailsInPhase1' with an added predicate on the text error</span></span><span>
</span><span id="line-297"></span><span id="local-6989586621679832069"><span id="local-6989586621679832070"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailsInPhase1WithMsg"><span class="hs-identifier hs-type">testFailsInPhase1WithMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832069"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679832070"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832070"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832069"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-298"></span><span id="testFailsInPhase1WithMsg"><span class="annot"><span class="annottext">testFailsInPhase1WithMsg :: forall prop a.
(IsProp prop, Show a) =&gt;
(String -&gt; Bool) -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailsInPhase1WithMsg"><span class="hs-identifier hs-var hs-var">testFailsInPhase1WithMsg</span></a></span></span><span> </span><span id="local-6989586621679832484"><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832484"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; prop
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; prop)
-&gt; (StagedMockChain a -&gt; Test a prop) -&gt; StagedMockChain a -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyAndErrorPred"><span class="hs-operator hs-var">`withPrettyAndErrorPred`</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; PrettyCookedOpts -&gt; MockChainError -&gt; prop
forall prop.
IsProp prop =&gt;
(String -&gt; Bool) -&gt; PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase1FailureWithMsg"><span class="hs-identifier hs-var">isPhase1FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832484"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; Test a prop)
-&gt; (StagedMockChain a -&gt; Test a prop)
-&gt; StagedMockChain a
-&gt; Test a prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><span class="hs-comment">-- | Same as 'isPhase2Failure' with an added predicate over the text error</span></span><span>
</span><span id="line-301"></span><span id="local-6989586621679832485"><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-type">isPhase2FailureWithMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832485"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Pretty.Options.html#PrettyCookedOpts"><span class="hs-identifier hs-type">PrettyCookedOpts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MockChainError"><span class="hs-identifier hs-type">MockChainError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832485"><span class="hs-identifier hs-type">prop</span></a></span></span><span>
</span><span id="line-302"></span><span id="isPhase2FailureWithMsg"><span class="annot"><span class="annottext">isPhase2FailureWithMsg :: forall prop.
IsProp prop =&gt;
(String -&gt; Bool) -&gt; PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-var hs-var">isPhase2FailureWithMsg</span></a></span></span><span> </span><span id="local-6989586621679832494"><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832494"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.BlockChain.html#MCEValidationError"><span class="hs-identifier hs-type">MCEValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationPhase
</span><span class="hs-identifier hs-var">Ledger.Phase2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.ScriptFailure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ledger.EvaluationError</span></span><span> </span><span id="local-6989586621679832497"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679832497"><span class="hs-identifier hs-var">texts</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Bool) -&gt; [Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832494"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; (Text -&gt; String) -&gt; Text -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679832497"><span class="hs-identifier hs-var">texts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">prop
forall prop. IsProp prop =&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testSuccess"><span class="hs-identifier hs-var">testSuccess</span></a></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-var">isPhase2FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679832499"><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832499"><span class="hs-identifier hs-var">pcOpts</span></a></span></span><span> </span><span id="local-6989586621679832500"><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832500"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; prop
forall prop. IsProp prop =&gt; String -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailureMsg"><span class="hs-identifier hs-var">testFailureMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; prop) -&gt; String -&gt; prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected phase 2 evaluation failure with constrained messages, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MockChainError -&gt; DocCooked) -&gt; MockChainError -&gt; String
forall a. (a -&gt; DocCooked) -&gt; a -&gt; String
</span><a href="Cooked.Pretty.Class.html#renderString"><span class="hs-identifier hs-var">renderString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrettyCookedOpts -&gt; MockChainError -&gt; DocCooked
forall a. PrettyCooked a =&gt; PrettyCookedOpts -&gt; a -&gt; DocCooked
</span><a href="Cooked.Pretty.Class.html#prettyCookedOpt"><span class="hs-identifier hs-var">prettyCookedOpt</span></a></span><span> </span><span class="annot"><span class="annottext">PrettyCookedOpts
</span><a href="#local-6989586621679832499"><span class="hs-identifier hs-var">pcOpts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainError
</span><a href="#local-6989586621679832500"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><span class="hs-comment">-- | Same as 'testFailsInPhase2' with an added predicate over the text error</span></span><span>
</span><span id="line-306"></span><span id="local-6989586621679832501"><span id="local-6989586621679832502"><span class="annot"><a href="Cooked.MockChain.Testing.html#testFailsInPhase2WithMsg"><span class="hs-identifier hs-type">testFailsInPhase2WithMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Testing.html#IsProp"><span class="hs-identifier hs-type">IsProp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832501"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679832502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.MockChain.Staged.html#StagedMockChain"><span class="hs-identifier hs-type">StagedMockChain</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679832502"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679832501"><span class="hs-identifier hs-type">prop</span></a></span></span></span><span>
</span><span id="line-307"></span><span id="testFailsInPhase2WithMsg"><span class="annot"><span class="annottext">testFailsInPhase2WithMsg :: forall prop a.
(IsProp prop, Show a) =&gt;
(String -&gt; Bool) -&gt; StagedMockChain a -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testFailsInPhase2WithMsg"><span class="hs-identifier hs-var hs-var">testFailsInPhase2WithMsg</span></a></span></span><span> </span><span id="local-6989586621679832511"><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832511"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Test a prop -&gt; prop
forall prop a. IsProp prop =&gt; Test a prop -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#testToProp"><span class="hs-identifier hs-var">testToProp</span></a></span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; prop)
-&gt; (StagedMockChain a -&gt; Test a prop) -&gt; StagedMockChain a -&gt; prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
forall prop a.
IsProp prop =&gt;
Test a prop
-&gt; (PrettyCookedOpts -&gt; MockChainError -&gt; prop) -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#withPrettyAndErrorPred"><span class="hs-operator hs-var">`withPrettyAndErrorPred`</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; PrettyCookedOpts -&gt; MockChainError -&gt; prop
forall prop.
IsProp prop =&gt;
(String -&gt; Bool) -&gt; PrettyCookedOpts -&gt; MockChainError -&gt; prop
</span><a href="Cooked.MockChain.Testing.html#isPhase2FailureWithMsg"><span class="hs-identifier hs-var">isPhase2FailureWithMsg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679832511"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Test a prop -&gt; Test a prop)
-&gt; (StagedMockChain a -&gt; Test a prop)
-&gt; StagedMockChain a
-&gt; Test a prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StagedMockChain a -&gt; Test a prop
forall prop a.
(IsProp prop, Show a) =&gt;
StagedMockChain a -&gt; Test a prop
</span><a href="Cooked.MockChain.Testing.html#mustFailTest"><span class="hs-identifier hs-var">mustFailTest</span></a></span><span>
</span><span id="line-308"></span></pre></body></html>
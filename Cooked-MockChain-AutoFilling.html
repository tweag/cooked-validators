<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cooked.MockChain.AutoFilling</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cooked-validators</span><ul class="links" id="page-menu"><li><a href="src/Cooked.MockChain.AutoFilling.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cooked.MockChain.AutoFilling</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Auto filling withdrawal amounts</a></li><li><a href="#g:2">Auto filling constitution script</a></li><li><a href="#g:3">Auto filling reference scripts</a></li><li><a href="#g:4">Auto filling min ada amounts</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module exposes functions to automatically fill parts of a
 <code><a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></code> based on the current state of the blockchain.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:autoFillWithdrawalAmounts">autoFillWithdrawalAmounts</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainWithoutValidation" title="Cooked.MockChain.BlockChain">MonadBlockChainWithoutValidation</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></li><li class="src short"><a href="#v:autoFillConstitution">autoFillConstitution</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainWithoutValidation" title="Cooked.MockChain.BlockChain">MonadBlockChainWithoutValidation</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></li><li class="src short"><a href="#v:updateRedeemedScript">updateRedeemedScript</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChain" title="Cooked.MockChain.BlockChain">MonadBlockChain</a> m =&gt; [<a href="https://hackage.haskell.org/package/-/docs/Ledger-Tx-Internal.html#t:TxOutRef" title="Ledger.Tx.Internal">TxOutRef</a>] -&gt; <a href="Cooked-Skeleton-User.html#t:User" title="Cooked.Skeleton.User">User</a> <a href="Cooked-Skeleton-User.html#v:IsScript" title="Cooked.Skeleton.User">IsScript</a> <a href="Cooked-Skeleton-User.html#v:Redemption" title="Cooked.Skeleton.User">Redemption</a> -&gt; m (<a href="Cooked-Skeleton-User.html#t:User" title="Cooked.Skeleton.User">User</a> <a href="Cooked-Skeleton-User.html#v:IsScript" title="Cooked.Skeleton.User">IsScript</a> <a href="Cooked-Skeleton-User.html#v:Redemption" title="Cooked.Skeleton.User">Redemption</a>)</li><li class="src short"><a href="#v:autoFillReferenceScripts">autoFillReferenceScripts</a> :: <span class="keyword">forall</span> m. <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChain" title="Cooked.MockChain.BlockChain">MonadBlockChain</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></li><li class="src short"><a href="#v:getTxSkelOutMinAda">getTxSkelOutMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton-Output.html#t:TxSkelOut" title="Cooked.Skeleton.Output">TxSkelOut</a> -&gt; m <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude.html#t:Integer" title="Distribution.Compat.Prelude">Integer</a></li><li class="src short"><a href="#v:toTxSkelOutWithMinAda">toTxSkelOutWithMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton-Output.html#t:TxSkelOut" title="Cooked.Skeleton.Output">TxSkelOut</a> -&gt; m <a href="Cooked-Skeleton-Output.html#t:TxSkelOut" title="Cooked.Skeleton.Output">TxSkelOut</a></li><li class="src short"><a href="#v:autoFillMinAda">autoFillMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Auto filling withdrawal amounts</h1></a><div class="top"><p class="src"><a id="v:autoFillWithdrawalAmounts" class="def">autoFillWithdrawalAmounts</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainWithoutValidation" title="Cooked.MockChain.BlockChain">MonadBlockChainWithoutValidation</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> <a href="src/Cooked.MockChain.AutoFilling.html#autoFillWithdrawalAmounts" class="link">Source</a> <a href="#v:autoFillWithdrawalAmounts" class="selflink">#</a></p><div class="doc"><p>Goes through all the withdrawals of the input skeleton and attempts to fill
 out the withdrawn amount based on the associated user rewards. Does not
 tamper with an existing specified amount in such withdrawals. Logs an event
 when an amount has been successfully auto-filled.</p></div></div><a href="#g:2" id="g:2"><h1>Auto filling constitution script</h1></a><div class="top"><p class="src"><a id="v:autoFillConstitution" class="def">autoFillConstitution</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainWithoutValidation" title="Cooked.MockChain.BlockChain">MonadBlockChainWithoutValidation</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> <a href="src/Cooked.MockChain.AutoFilling.html#autoFillConstitution" class="link">Source</a> <a href="#v:autoFillConstitution" class="selflink">#</a></p><div class="doc"><p>Goes through all the proposals of the input skeleton and attempts to fill
 out the constitution scripts with the current one. Does not tamper with an
 existing specified script in such withdrawals. Logs an event when the
 constitution script has been successfully auto-filled.</p></div></div><a href="#g:3" id="g:3"><h1>Auto filling reference scripts</h1></a><div class="top"><p class="src"><a id="v:updateRedeemedScript" class="def">updateRedeemedScript</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChain" title="Cooked.MockChain.BlockChain">MonadBlockChain</a> m =&gt; [<a href="https://hackage.haskell.org/package/-/docs/Ledger-Tx-Internal.html#t:TxOutRef" title="Ledger.Tx.Internal">TxOutRef</a>] -&gt; <a href="Cooked-Skeleton-User.html#t:User" title="Cooked.Skeleton.User">User</a> <a href="Cooked-Skeleton-User.html#v:IsScript" title="Cooked.Skeleton.User">IsScript</a> <a href="Cooked-Skeleton-User.html#v:Redemption" title="Cooked.Skeleton.User">Redemption</a> -&gt; m (<a href="Cooked-Skeleton-User.html#t:User" title="Cooked.Skeleton.User">User</a> <a href="Cooked-Skeleton-User.html#v:IsScript" title="Cooked.Skeleton.User">IsScript</a> <a href="Cooked-Skeleton-User.html#v:Redemption" title="Cooked.Skeleton.User">Redemption</a>) <a href="src/Cooked.MockChain.AutoFilling.html#updateRedeemedScript" class="link">Source</a> <a href="#v:updateRedeemedScript" class="selflink">#</a></p><div class="doc"><p>Attempts to find in the index a utxo containing a reference script with the
 given script hash, and attaches it to a redeemer when it does not yet have a
 reference input and when it is allowed, in which case an event is logged.</p></div></div><div class="top"><p class="src"><a id="v:autoFillReferenceScripts" class="def">autoFillReferenceScripts</a> :: <span class="keyword">forall</span> m. <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChain" title="Cooked.MockChain.BlockChain">MonadBlockChain</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> <a href="src/Cooked.MockChain.AutoFilling.html#autoFillReferenceScripts" class="link">Source</a> <a href="#v:autoFillReferenceScripts" class="selflink">#</a></p><div class="doc"><p>Goes through the various parts of the skeleton where a redeemer can appear,
 and attempts to attach a reference input to each of them, whenever it is
 allowed and one has not already been set. Logs an event whenever such an
 addition occurs.</p></div></div><a href="#g:4" id="g:4"><h1>Auto filling min ada amounts</h1></a><div class="top"><p class="src"><a id="v:getTxSkelOutMinAda" class="def">getTxSkelOutMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton-Output.html#t:TxSkelOut" title="Cooked.Skeleton.Output">TxSkelOut</a> -&gt; m <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude.html#t:Integer" title="Distribution.Compat.Prelude">Integer</a> <a href="src/Cooked.MockChain.AutoFilling.html#getTxSkelOutMinAda" class="link">Source</a> <a href="#v:getTxSkelOutMinAda" class="selflink">#</a></p><div class="doc"><p>Compute the required minimal ADA for a given output</p></div></div><div class="top"><p class="src"><a id="v:toTxSkelOutWithMinAda" class="def">toTxSkelOutWithMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton-Output.html#t:TxSkelOut" title="Cooked.Skeleton.Output">TxSkelOut</a> -&gt; m <a href="Cooked-Skeleton-Output.html#t:TxSkelOut" title="Cooked.Skeleton.Output">TxSkelOut</a> <a href="src/Cooked.MockChain.AutoFilling.html#toTxSkelOutWithMinAda" class="link">Source</a> <a href="#v:toTxSkelOutWithMinAda" class="selflink">#</a></p><div class="doc"><p>This transforms an output into another output which contains the minimal
 required ada. If the previous quantity of ADA was sufficient, it remains
 unchanged. This can require a few iterations to converge, as the added ADA
 will increase the size of the UTXO which in turn might need more ADA.</p></div></div><div class="top"><p class="src"><a id="v:autoFillMinAda" class="def">autoFillMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> <a href="src/Cooked.MockChain.AutoFilling.html#autoFillMinAda" class="link">Source</a> <a href="#v:autoFillMinAda" class="selflink">#</a></p><div class="doc"><p>This goes through all the <code><a href="Cooked-Skeleton-Output.html#t:TxSkelOut" title="Cooked.Skeleton.Output">TxSkelOut</a></code>s of the given skeleton and updates
 their ada value when requested by the user and required by the protocol
 parameters. Logs an event whenever such a change occurs.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.2</p></div></body></html>
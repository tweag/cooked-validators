<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cooked.Attack</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cooked-validators-2.0.0</span><ul class="links" id="page-menu"><li><a href="src/Cooked.Attack.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cooked.Attack</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">newtype</span> <a href="#t:DatumHijackingLbl">DatumHijackingLbl</a> = <a href="#v:DatumHijackingLbl">DatumHijackingLbl</a> Address</li><li class="src short"><a href="#v:redirectScriptOutputTweak">redirectScriptOutputTweak</a> :: (<a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m, Is k A_Traversal, <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> (DatumType a), ToData (DatumType a)) =&gt; Optic' k is <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> (<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script)) -&gt; (<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script) -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Maybe" title="Distribution.Compat.Prelude.Internal">Maybe</a> (TypedValidator a)) -&gt; (<a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a>) -&gt; m [<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script)]</li><li class="src short"><a href="#v:datumHijackingAttack">datumHijackingAttack</a> :: <span class="keyword">forall</span> a m. (<a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m, <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> (DatumType a), <a href="Cooked-Pretty-Class.html#t:PrettyCooked" title="Cooked.Pretty.Class">PrettyCooked</a> (DatumType a), ToData (DatumType a), <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Typeable.html#t:Typeable" title="Distribution.Compat.Typeable">Typeable</a> (DatumType a), <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Typeable.html#t:Typeable" title="Distribution.Compat.Typeable">Typeable</a> a) =&gt; (<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script) -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a>) -&gt; (<a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a>) -&gt; m [<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script)]</li><li class="src short"><span class="keyword">data</span> <a href="#t:DupTokenLbl">DupTokenLbl</a> = <a href="#v:DupTokenLbl">DupTokenLbl</a></li><li class="src short"><a href="#v:dupTokenAttack">dupTokenAttack</a> :: <a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m =&gt; (AssetClass -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a>) -&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; m Value</li><li class="src short"><span class="keyword">data</span> <a href="#t:DoubleSatLbl">DoubleSatLbl</a> = <a href="#v:DoubleSatLbl">DoubleSatLbl</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:DoubleSatDelta">DoubleSatDelta</a> = (<a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef <a href="Cooked-Skeleton.html#t:TxSkelRedeemer" title="Cooked.Skeleton">TxSkelRedeemer</a>, [<a href="Cooked-Skeleton.html#t:TxSkelOut" title="Cooked.Skeleton">TxSkelOut</a>], <a href="Cooked-Skeleton.html#t:TxSkelMints" title="Cooked.Skeleton">TxSkelMints</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:DoubleSatSplitMode">DoubleSatSplitMode</a><ul class="subs"><li>= <a href="#v:TryCombinations">TryCombinations</a></li><li>| <a href="#v:AllSeparate">AllSeparate</a></li></ul></li><li class="src short"><a href="#v:doubleSatAttack">doubleSatAttack</a> :: (<a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m, Is k A_Fold) =&gt; Optic' k is <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> a -&gt; (a -&gt; m [<a href="Cooked-Attack.html#t:DoubleSatDelta" title="Cooked.Attack">DoubleSatDelta</a>]) -&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatSplitMode" title="Cooked.Attack">DoubleSatSplitMode</a> -&gt; m ()</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:AddTokenLbl">AddTokenLbl</a> = <a href="#v:AddTokenLbl">AddTokenLbl</a> TokenName</li><li class="src short"><a href="#v:addTokenAttack">addTokenAttack</a> :: <a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m =&gt; (Versioned MintingPolicy -&gt; [(TokenName, NonZero <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a>)]) -&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; m Value</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:DatumHijackingLbl" class="def">DatumHijackingLbl</a> <a href="src/Cooked.Attack.DatumHijacking.html#DatumHijackingLbl" class="link">Source</a> <a href="#t:DatumHijackingLbl" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DatumHijackingLbl" class="def">DatumHijackingLbl</a> Address</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:DatumHijackingLbl">Instances</h4><details id="i:DatumHijackingLbl" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DatumHijackingLbl:Eq:1"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a></span> <a href="src/Cooked.Attack.DatumHijacking.html#line-107" class="link">Source</a> <a href="#t:DatumHijackingLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DatumHijackingLbl:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DatumHijacking.html">Cooked.Attack.DatumHijacking</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DatumHijackingLbl:Ord:2"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Ord" title="Distribution.Compat.Prelude.Internal">Ord</a> <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a></span> <a href="src/Cooked.Attack.DatumHijacking.html#line-107" class="link">Source</a> <a href="#t:DatumHijackingLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DatumHijackingLbl:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DatumHijacking.html">Cooked.Attack.DatumHijacking</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Ordering" title="Distribution.Compat.Prelude.Internal">Ordering</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> <a href="#v:min" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DatumHijackingLbl:Show:3"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a></span> <a href="src/Cooked.Attack.DatumHijacking.html#line-107" class="link">Source</a> <a href="#t:DatumHijackingLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DatumHijackingLbl:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DatumHijacking.html">Cooked.Attack.DatumHijacking</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a>] -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:redirectScriptOutputTweak" class="def">redirectScriptOutputTweak</a> <a href="src/Cooked.Attack.DatumHijacking.html#redirectScriptOutputTweak" class="link">Source</a> <a href="#v:redirectScriptOutputTweak" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m, Is k A_Traversal, <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> (DatumType a), ToData (DatumType a))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; Optic' k is <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> (<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; (<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script) -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Maybe" title="Distribution.Compat.Prelude.Internal">Maybe</a> (TypedValidator a))</td><td class="doc"><p>Return <code>Just</code> the new validator, or <code>Nothing</code> if you want to leave this
 output unchanged.</p></td></tr><tr><td class="src">-&gt; (<a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a>)</td><td class="doc"><p>The redirection described by the previous argument might apply to more
 than one of the script outputs of the transaction. Use this predicate to
 select which of the redirectable script outputs to actually redirect. We
 count the redirectable script outputs from the left to the right, starting
 with zero.</p></td></tr><tr><td class="src">-&gt; m [<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Redirect script outputs from one validator to another validator of the same
 type. Returns the list of outputs it redirected (as they were before the
 modification), in the order in which they occurred on the original
 transaction.</p><p>Something like <code>txSkelOutsL % traversed % txSkelOutOwnerTypeP </code>(Pl.TypedValidator a)@
 might be useful to construct the optics used by this tweak.</p></div></div><div class="top"><p class="src"><a id="v:datumHijackingAttack" class="def">datumHijackingAttack</a> <a href="src/Cooked.Attack.DatumHijacking.html#datumHijackingAttack" class="link">Source</a> <a href="#v:datumHijackingAttack" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> a m. (<a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m, <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> (DatumType a), <a href="Cooked-Pretty-Class.html#t:PrettyCooked" title="Cooked.Pretty.Class">PrettyCooked</a> (DatumType a), ToData (DatumType a), <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Typeable.html#t:Typeable" title="Distribution.Compat.Typeable">Typeable</a> (DatumType a), <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Typeable.html#t:Typeable" title="Distribution.Compat.Typeable">Typeable</a> a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script) -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a>)</td><td class="doc"><p>Predicate to select outputs to steal, depending on the intended
 recipient, the datum, and the value.</p></td></tr><tr><td class="src">-&gt; (<a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a>)</td><td class="doc"><p>The selection predicate may match more than one output, restrict to the
 i-th of the output(s) (counting from the left, starting at zero) chosen by
 the selection predicate with this predicate.</p></td></tr><tr><td class="src">-&gt; m [<a href="Cooked-Output.html#t:ConcreteOutput" title="Cooked.Output">ConcreteOutput</a> (TypedValidator a) <a href="Cooked-Skeleton.html#t:TxSkelOutDatum" title="Cooked.Skeleton">TxSkelOutDatum</a> Value (Versioned Script)]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A datum hijacking attack, simplified: This attack tries to substitute a
 different recipient on <code>PaysScript</code> constraints, but leaves the datum as it
 is. That is, it tests for careless uses of something like <code>txInfoOutputs</code> in
 places where something like <code>getContinuingOutputs</code> should be used. If this
 attack goes through, however, a &quot;proper&quot; datum hijacking attack that modifies
 the datum in a way that (the relevant part of) the
 <code>toBuiltinData</code>-translation stays the same will also work.</p><p>A <code><a href="Cooked-Attack.html#t:DatumHijackingLbl" title="Cooked.Attack">DatumHijackingLbl</a></code> with the hash of the &quot;thief&quot; validator is added to the
 labels of the <code><a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></code> using <code>addLabel</code>.</p><p>This attack returns the list of outputs it redirected, in the order in which
 they occurred on the original transaction. If no output is redirected, this
 attack fails.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DupTokenLbl" class="def">DupTokenLbl</a> <a href="src/Cooked.Attack.DupToken.html#DupTokenLbl" class="link">Source</a> <a href="#t:DupTokenLbl" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DupTokenLbl" class="def">DupTokenLbl</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:DupTokenLbl">Instances</h4><details id="i:DupTokenLbl" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DupTokenLbl:Eq:1"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a></span> <a href="src/Cooked.Attack.DupToken.html#line-60" class="link">Source</a> <a href="#t:DupTokenLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DupTokenLbl:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DupToken.html">Cooked.Attack.DupToken</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DupTokenLbl:Ord:2"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Ord" title="Distribution.Compat.Prelude.Internal">Ord</a> <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a></span> <a href="src/Cooked.Attack.DupToken.html#line-60" class="link">Source</a> <a href="#t:DupTokenLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DupTokenLbl:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DupToken.html">Cooked.Attack.DupToken</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Ordering" title="Distribution.Compat.Prelude.Internal">Ordering</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> <a href="#v:min" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DupTokenLbl:Show:3"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a></span> <a href="src/Cooked.Attack.DupToken.html#line-60" class="link">Source</a> <a href="#t:DupTokenLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DupTokenLbl:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DupToken.html">Cooked.Attack.DupToken</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a>] -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:dupTokenAttack" class="def">dupTokenAttack</a> <a href="src/Cooked.Attack.DupToken.html#dupTokenAttack" class="link">Source</a> <a href="#v:dupTokenAttack" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (AssetClass -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a>)</td><td class="doc"><p>A function describing how the amount of tokens specified by a <code>Mints</code>
 constraint should be changed, depending on the asset class and the amount
 specified by the constraint. The given function <code>f</code> should probably satisfy
 <code>f ac i &gt; i</code> for all <code>ac</code> and <code>i</code>, i.e. it should increase the minted
 amount. If it does *not* increase the minted amount, the amount will be
 left unchanged.</p></td></tr><tr><td class="src">-&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a></td><td class="doc"><p>The wallet of the attacker. Any additional tokens that are minted by the
 modified transaction but were not minted by the original transaction are
 paid to this wallet.</p></td></tr><tr><td class="src">-&gt; m Value</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A token duplication attack increases values in <code>Mints</code>-constraints of a
 <code><a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></code> according to some conditions, and pays the extra minted value to a
 given recipient wallet. This adds a <code><a href="Cooked-Attack.html#t:DupTokenLbl" title="Cooked.Attack">DupTokenLbl</a></code> to the labels of the
 transaction using <code>addLabel</code>. Returns the <code>Value</code> by which the minted value
 was increased.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DoubleSatLbl" class="def">DoubleSatLbl</a> <a href="src/Cooked.Attack.DoubleSat.html#DoubleSatLbl" class="link">Source</a> <a href="#t:DoubleSatLbl" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:DoubleSatLbl" class="def">DoubleSatLbl</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:DoubleSatLbl">Instances</h4><details id="i:DoubleSatLbl" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DoubleSatLbl:Eq:1"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a></span> <a href="src/Cooked.Attack.DoubleSat.html#line-227" class="link">Source</a> <a href="#t:DoubleSatLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DoubleSatLbl:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DoubleSat.html">Cooked.Attack.DoubleSat</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DoubleSatLbl:Ord:2"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Ord" title="Distribution.Compat.Prelude.Internal">Ord</a> <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a></span> <a href="src/Cooked.Attack.DoubleSat.html#line-227" class="link">Source</a> <a href="#t:DoubleSatLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DoubleSatLbl:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DoubleSat.html">Cooked.Attack.DoubleSat</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Ordering" title="Distribution.Compat.Prelude.Internal">Ordering</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> <a href="#v:min" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DoubleSatLbl:Show:3"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a></span> <a href="src/Cooked.Attack.DoubleSat.html#line-227" class="link">Source</a> <a href="#t:DoubleSatLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DoubleSatLbl:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-DoubleSat.html">Cooked.Attack.DoubleSat</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cooked-Attack.html#t:DoubleSatLbl" title="Cooked.Attack">DoubleSatLbl</a>] -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:DoubleSatDelta" class="def">DoubleSatDelta</a> = (<a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef <a href="Cooked-Skeleton.html#t:TxSkelRedeemer" title="Cooked.Skeleton">TxSkelRedeemer</a>, [<a href="Cooked-Skeleton.html#t:TxSkelOut" title="Cooked.Skeleton">TxSkelOut</a>], <a href="Cooked-Skeleton.html#t:TxSkelMints" title="Cooked.Skeleton">TxSkelMints</a>) <a href="src/Cooked.Attack.DoubleSat.html#DoubleSatDelta" class="link">Source</a> <a href="#t:DoubleSatDelta" class="selflink">#</a></p><div class="doc"><p>A triple of transaction inputs, transaction outputs, and minted value. This
 is what we can add to the transaction in order to try a double satisfaction
 attack.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DoubleSatSplitMode" class="def">DoubleSatSplitMode</a> <a href="src/Cooked.Attack.DoubleSat.html#DoubleSatSplitMode" class="link">Source</a> <a href="#t:DoubleSatSplitMode" class="selflink">#</a></p><div class="doc"><p>How to combine extra constraints added for different reasons in the
 <code><a href="Cooked-Attack.html#v:doubleSatAttack" title="Cooked.Attack">doubleSatAttack</a></code>. See the comments there.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TryCombinations" class="def">TryCombinations</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:AllSeparate" class="def">AllSeparate</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:doubleSatAttack" class="def">doubleSatAttack</a> <a href="src/Cooked.Attack.DoubleSat.html#doubleSatAttack" class="link">Source</a> <a href="#v:doubleSatAttack" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m, Is k A_Fold)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; Optic' k is <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> a</td><td class="doc"><p>Each focus of this optic is a potential reason to add some extra
 constraints.</p><p>As an example, one could go through the <code><a href="Cooked-Skeleton.html#v:paysScript" title="Cooked.Skeleton">paysScript</a></code> outputs for
 validators of type <code>t</code> with the following traversal:</p><pre>txSkelOutsL % taversed % txSkelOutputToTypedValidatorP @t</pre></td></tr><tr><td class="src">-&gt; (a -&gt; m [<a href="Cooked-Attack.html#t:DoubleSatDelta" title="Cooked.Attack">DoubleSatDelta</a>])</td><td class="doc"><p>Which inputs, outputs, and mints to add, for each of the foci. There
 might be different options for each focus, that's why the return value is a
 list.</p><p>Continuing the example, for each of the focused <code><a href="Cooked-Skeleton.html#v:paysScript" title="Cooked.Skeleton">paysScript</a></code> outputs, you
 might want to try adding some <code>spendsScript</code> inputs to the
 transaction. Since it might be interesting to try different redeemers on
 these extra <code>spendsScript</code> inputs, you can just provide a list of all the
 options you want to try adding for a given <code><a href="Cooked-Skeleton.html#v:paysScript" title="Cooked.Skeleton">paysScript</a></code> that's already on
 the transaction.</p><p>###################################</p><p>ATTENTION: If you modify the state while computing these lists, the
 behaviour of the <code><a href="Cooked-Attack.html#v:doubleSatAttack" title="Cooked.Attack">doubleSatAttack</a></code> might be strange: Any modification of
 the state that happens on any call to this function will be applied to all
 returned transactions. For example, if you <code><a href="Cooked-MockChain-BlockChain.html#v:awaitTime" title="Cooked.MockChain.BlockChain">awaitTime</a></code> in any of these
 computations, the <code><a href="Cooked-Attack.html#v:doubleSatAttack" title="Cooked.Attack">doubleSatAttack</a></code> will wait for all returned
 transactions.</p><p>TODO: Make this interface safer, for example by using (some kind of) an
 <code>UtxoState</code> argument.</p><p>###################################</p></td></tr><tr><td class="src">-&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a></td><td class="doc"><p>The wallet of the attacker, where any surplus is paid to.</p><p>In the example, the extra value in the added <code>spendsScript</code> constraints
 will be paid to the attacker.</p></td></tr><tr><td class="src">-&gt; <a href="Cooked-Attack.html#t:DoubleSatSplitMode" title="Cooked.Attack">DoubleSatSplitMode</a></td><td class="doc"><p>Since there are potentially multiple triples of inputs, outputs, and
 mints produced for each of the foci, the question is whether (and how) to
 combine additions that were triggered by different foci.</p><p>In the example: Let's say that the unmodified transaction had three focused
 <code><a href="Cooked-Skeleton.html#v:paysScript" title="Cooked.Skeleton">paysScript</a></code> outputs (let's denote them by a, b, and c), and that you want
 to try 2, 3, and 5 additional <code>spendsScript</code> inputs for each of them,
 respectively (let's call those a1, a2, and b1, b2, b3, and c1, c2, c3, c4,
 c5).</p><ul><li>If you want to try each additional <code>spendsScript</code> on its own modified
   transaction, use <code><a href="Cooked-Attack.html#v:AllSeparate" title="Cooked.Attack">AllSeparate</a></code>. Thus, there'll be 2+3+5=10 modified
   transactions. Namely, for each element of the list</li></ul><pre>[a1, a2, b1, b2, b3, c1, c2, c3, c4, c5]  ,</pre><p>you'll get one modified transaction that includes that additional input.</p><ul><li>If you want to try combining all options from one focus with all options
   from all of the other foci, use <code><a href="Cooked-Attack.html#v:TryCombinations" title="Cooked.Attack">TryCombinations</a></code>. Then, there'll be
   (2+1)*(3+1)*(5+1)=72 possible combinations, if you include all of the
   combinations where <em>at most</em> three (one for each focus) extra constraints
   are added. One of these combinations is of course the one where nothing
   is added, and that one is omitted, which brings the grand total down to
   71 modified transactions, the additional <code>spendsScript</code> inputs of which
   are given by the following list:</li></ul><pre>[ -- one additional input (the 10 cases from above)
  [a1],
  [a2],
  ...
  [c4],
  [c5],

  -- two additional inputs, from different foci (2*3 + 2*5 + 3*5 = 31 cases)
  [a1, b1],
  [a1, b2],
  ...
  [b3, c4],
  [b3, c5],

  -- three additional inputs, one from each focus (2*3*5 = 30 cases)
  [a1, b1, c1],
  [a1, b1, c2],
  ...
  [a1, b3, c4],
  [a1, b3, c5]
]</pre><p>So you see that this attack can branch quite wildly. Use with caution!</p></td></tr><tr><td class="src">-&gt; m ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Double satisfacion attack. See the comment above for what such an attack is
 about conceptually.</p><p>This attack consists in adding some extra constraints to a transaction, and
 hoping that the additional minting policies or validator scripts thereby
 involved are fooled by what's already present on the transaction. Any extra
 value contained in new inputs to the transaction is then paid to the
 attacker.</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:AddTokenLbl" class="def">AddTokenLbl</a> <a href="src/Cooked.Attack.AddToken.html#AddTokenLbl" class="link">Source</a> <a href="#t:AddTokenLbl" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:AddTokenLbl" class="def">AddTokenLbl</a> TokenName</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:AddTokenLbl">Instances</h4><details id="i:AddTokenLbl" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:AddTokenLbl:Eq:1"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a></span> <a href="src/Cooked.Attack.AddToken.html#line-61" class="link">Source</a> <a href="#t:AddTokenLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:AddTokenLbl:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-AddToken.html">Cooked.Attack.AddToken</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a> -&gt; <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:AddTokenLbl:Show:2"></span> <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a></span> <a href="src/Cooked.Attack.AddToken.html#line-61" class="link">Source</a> <a href="#t:AddTokenLbl" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:AddTokenLbl:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-Attack-AddToken.html">Cooked.Attack.AddToken</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a>] -&gt; <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:addTokenAttack" class="def">addTokenAttack</a> <a href="src/Cooked.Attack.AddToken.html#addTokenAttack" class="link">Source</a> <a href="#v:addTokenAttack" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Cooked-Tweak-Common.html#t:MonadTweak" title="Cooked.Tweak.Common">MonadTweak</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (Versioned MintingPolicy -&gt; [(TokenName, NonZero <a href="https://hackage.haskell.org/package/-/docs/Distribution-Compat-Prelude-Internal.html#t:Integer" title="Distribution.Compat.Prelude.Internal">Integer</a>)])</td><td class="doc"><p>For each policy that occurs in some <code>Mints</code> constraint, return a list of
 token names together with how many tokens with that name should be
 minted.</p><p>For each of the elements of the returned list, one modified transaction
 with the additional tokens will be generated. (This means for example that,
 if there were three minting policies on the original transaction, and the
 lists returned for each of them have n,m, and o elements, respectively,
 there'll be n*m*o modified transactions.)</p><p>The redeemer will be the one that's already being used on the transaction.</p></td></tr><tr><td class="src">-&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a></td><td class="doc"><p>The wallet of the attacker. Any extra tokens will be paid to this wallet.</p></td></tr><tr><td class="src">-&gt; m Value</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>This attack adds extra tokens, depending on the minting policy. It is
 different from the <code>dupTokenAttack</code> in that it does not merely try to
 increase the amount of tokens minted: It tries to mint tokens of asset
 classes that were not necessarily present on the unmodified transaction.</p><p>This attack adds an <code><a href="Cooked-Attack.html#t:AddTokenLbl" title="Cooked.Attack">AddTokenLbl</a></code> with the token name of the additional
 minted token(s). It returns additional value minted.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>